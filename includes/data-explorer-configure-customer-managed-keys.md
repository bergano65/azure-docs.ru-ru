---
author: orspod
ms.service: data-explorer
ms.topic: include
ms.date: 01/07/2020
ms.author: orspodek
ms.openlocfilehash: 7f5c02c6c009e8916ed063454e0ae6049892e95c
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80297899"
---
Azure Data Explorer шифрует все данные в учетной записи хранения в состоянии покоя. По умолчанию данные шифруются с помощью ключей, управляемых корпорацией Майкрософт. Для дополнительного контроля над ключами шифрования можно предоставить управляемые клиентом ключи для использования для шифрования данных. 

Ключи, управляемые клиентом, должны храниться в [Хранилище ключей Azure.](/azure/key-vault/key-vault-overview) Вы можете создать свои собственные ключи и хранить их в хранилище ключей, или вы можете использовать API-извешую клавиши Azure Key Vault для генерации ключей. Кластер Azure Data Explorer и хранилище ключей должны находиться в одном регионе, но они могут быть в разных подписках. Для получения подробного разъяснения ключей, управляемых клиентами, [см.](/azure/storage/common/storage-service-encryption) 

В этой статье показано, как настроить клавиши, управляемые клиентом.

## <a name="configure-azure-key-vault"></a>Настройка Azure Key Vault

Чтобы настроить управляемые клиентом клавиши с помощью Azure Data Explorer, необходимо [установить два свойства на хранилище ключей:](/azure/key-vault/key-vault-ovw-soft-delete) **Soft Delete** и Do **Not Purge.** Эти свойства не включены по умолчанию. Чтобы включить эти свойства, выполните **Включение в функцию мягкого удаления** и включение защиты от **очистки** в [PowerShell](/azure/key-vault/key-vault-soft-delete-powershell) или [Azure CLI](/azure/key-vault/key-vault-soft-delete-cli) на новом или существующем хранилище ключей. Поддерживаются только клавиши RSA размером 2048. Для получения дополнительной информации о ключах, [см.](/azure/key-vault/about-keys-secrets-and-certificates#key-vault-keys)

> [!NOTE]
> Шифрование данных с помощью управляемых клиентами ключей не поддерживается в [кластерах лидеров и последователей.](/azure/data-explorer/follower) 

## <a name="assign-an-identity-to-the-cluster"></a>Назначить иждивественность кластеру

Чтобы включить ключевые клавиши, управляемые клиентом для кластера, сначала назначьте кластеру назначенное системой управляемое удостоверение. Это управляемое удостоверение будет использоваться для предоставления разрешения кластера на доступ к хранилищу ключей. Чтобы настроить назначенные системой управляемые идентификаторы, [см. управляемые идентификаторы.](/azure/data-explorer/managed-identities)