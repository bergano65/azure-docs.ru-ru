---
title: Как устанавливать и запускать контейнеры
titlesuffix: Computer Vision - Cognitive Services - Azure
description: В этом пошаговом руководстве показано, как скачивать, устанавливать и выполнять контейнеры компьютерного зрения.
services: cognitive-services
author: diberry
manager: cgronlun
ms.service: cognitive-services
ms.component: text-analytics
ms.topic: article
ms.date: 11/14/2018
ms.author: diberry
ms.openlocfilehash: 2ba7039fe42e3b5638b99161e12e9888bc852f87
ms.sourcegitcommit: 0b7fc82f23f0aa105afb1c5fadb74aecf9a7015b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/14/2018
ms.locfileid: "51634937"
---
# <a name="install-and-run-containers"></a>Установка и запуск контейнеров

Контейнеризация — это подход к распространению программного обеспечения, в котором приложение или служба входит в состав образа контейнера. Конфигурация и зависимости приложения или службы включены в образ контейнера. Образ контейнера может быть развернут в узле контейнера с незначительной модификацией или без нее. Контейнеры изолированы друг от друга и от базовой операционной системы. При этом они расходуют меньше ресурсов, чем виртуальная машина. Контейнеры для краткосрочных задач можно создавать из образов контейнеров и удалять, когда они станут ненужными.

Служба "Распознавание текста", входящая в состав Компьютерного зрения, также доступна в виде контейнера Docker. Это позволяет определять и извлекать печатный текст с изображений различных объектов с разными поверхностями и фонами, например чеков, плакатов и визитных карточек.  
> [!IMPORTANT]
> Контейнер распознавания текста в настоящее время работает только на английском языке.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="preparation"></a>Подготовка

Прежде чем использовать контейнер распознавания текста, необходимо выполнить следующие условия:

**Модуль Docker.** Модуль Docker должен быть установлен в локальной среде. Docker предоставляет пакеты, которые настраивают среду Docker для [macOS](https://docs.docker.com/docker-for-mac/), [Linux](https://docs.docker.com/engine/installation/#supported-platforms) и [Windows](https://docs.docker.com/docker-for-windows/). В Windows Docker должен быть настроен для поддержки контейнеров Linux. Контейнеры Docker также можно развертывать непосредственно в [службе Azure Kubernetes](/azure/aks/), [экземплярах контейнеров Azure](/azure/container-instances/) или в кластере [Kubernetes](https://kubernetes.io/), развернутом в [Azure Stack](/azure/azure-stack/). Дополнительные сведения о развертывании Kubernetes в Azure Stack см. в статье [Развертывание Kubernetes в Azure Stack](/azure/azure-stack/user/azure-stack-solution-template-kubernetes-deploy).

Docker должен быть настроен так, чтобы разрешать контейнерам подключать и отправлять данные о выставлении счетов в Azure.

**Опыт работы с Реестром контейнеров Майкрософт и Docker.** Вам следует иметь базовое представление о Реестре контейнеров Майкрософт и понятиях, связанных с Docker, таких как реестры, репозитории, контейнеры и образы контейнеров, а также знать основные команды `docker`.  

Ознакомьтесь с [общими сведениями о Docker и контейнерах](https://docs.docker.com/engine/docker-overview/).

### <a name="server-requirements-and-recommendations"></a>Требования к серверу и рекомендации

Контейнеру распознавания текста необходимо как минимум 1 ядро ЦП частотой не менее 2,6 гигагерц (ГГц) и 8 гигабайт (ГБ) выделенной памяти, но рекомендуется как минимум 2 ядра ЦП и 8 ГБ выделенной памяти.

## <a name="request-access-to-the-private-container-registry"></a>Запрос доступа к частному реестру контейнеров

Для начала необходимо заполнить и отправить [форму запроса к контейнерам Cognitive Services Vision](https://aka.ms/VisionContainersPreview), чтобы запросить доступ к контейнеру распознавания текста. Форма запрашивает сведения о вас, вашей компании и пользовательском сценарии, для которого будет использоваться контейнер. После отправки команда Azure Cognitive Services просматривает форму, чтобы убедиться, что соблюдаются критерии доступа к частному реестру контейнеров.

> [!IMPORTANT]
> Необходимо использовать электронный адрес, связанный с учетной записью Майкрософт или учетной записью Azure Active Directory (Azure AD) в форме.

Если ваш запрос будет утвержден, вы получите по электронной почте инструкции по получению учетных данных и доступу к частному реестру контейнеров.

## <a name="create-a-computer-vision-resource-on-azure"></a>Создание ресурса компьютерного зрения в Azure

Если вы хотите использовать контейнер распознавания текста, необходимо создать ресурс компьютерного зрения в Azure. После создания ресурса вы можете использовать ключ подписки и URL-адрес конечной точки из ресурса, чтобы создать экземпляр контейнера. Дополнительные сведения о создании экземпляра контейнера см. в разделе [Создание экземпляра контейнера из скачанного образа контейнера](#instantiate-a-container-from-a-downloaded-container-image).

Выполните указанные ниже действия, чтобы создать и получить сведения из ресурса Azure.

1. Создайте ресурс Azure на портале Azure.  
   Если вы хотите использовать контейнер распознавания текста, необходимо сначала создать соответствующий ресурс компьютерного зрения на портале Azure. Дополнительные сведения см. в статье [Краткое руководство. Создание учетной записи Cognitive Services на портале Azure](../cognitive-services-apis-create-account.md).

   > [!IMPORTANT]
   > Ресурс компьютерного зрения должен использовать ценовую категорию F0.

1. Получите URL-адрес конечной точки и ключ подписки для ресурса Azure.  
   После создания ресурса Azure необходимо использовать URL-адрес конечной точки и ключ подписки из этого ресурса, чтобы создать экземпляр соответствующего контейнера распознавания текста. Вы можете скопировать URL-адрес конечной точки и ключ подписки с, соответственно, страниц "Быстрое начало" и "Ключи" ресурса компьютерного зрения на портале Azure.

## <a name="log-in-to-the-private-container-registry"></a>Вход в частный реестр контейнеров

Выполнить проверку подлинности с частным реестром контейнеров для контейнеров Cognitive Services можно несколькими способами, но в качестве командной строки рекомендуется использовать [Docker CLI](https://docs.docker.com/engine/reference/commandline/cli/).

Используйте команду [docker login](https://docs.docker.com/engine/reference/commandline/login/), как показано в приведенном ниже примере, чтобы войти в `containerpreview.azurecr.io` — частный реестр контейнеров Cognitive Services. Замените *\<username\>* на имя пользователя, а *\<password\>* — на пароль, предоставленный в учетных данных, полученных от команды Azure Cognitive Services.

```docker
docker login containerpreview.azurecr.io -u <username> -p <password>
```

Если вы сохранили свои учетные данные в текстовом файле, содержимое этого текстового файла можно сцепить с помощью команды `cat` в команду `docker login`, как показано в приведенном ниже примере. Замените *\<passwordFile\>* на путь и имя текстового файла, содержащие пароль, а *\<username\>* — на имя пользователя, предоставленное в учетных данных.

```docker
cat <passwordFile> | docker login containerpreview.azurecr.io -u <username> --password-stdin
```

## <a name="download-container-images-from-the-private-container-registry"></a>Скачивание образов контейнера из частного реестра контейнеров

Образ контейнера распознавания текста можно получить из частного реестра контейнеров Docker под названием `containerpreview.azurecr.io` в реестре контейнеров Azure. Образ контейнера распознавания текста необходимо скачать из репозитория, чтобы запустить контейнер в локальной среде.

Используйте команду [docker pull](https://docs.docker.com/engine/reference/commandline/pull/), чтобы скачать образ контейнера из репозитория. Например, чтобы скачать из репозитория образ контейнера распознавания текста последней версии, выполните следующую команду:

```Docker
docker pull containerpreview.azurecr.io/microsoft/cognitive-services-recognize-text:latest
```

Полное описание доступных тегов для контейнера распознавания текста см. в статье [Распознавание текста](https://go.microsoft.com/fwlink/?linkid=2018655) в Центре Docker.

> [!TIP]
> Используйте команду [docker images](https://docs.docker.com/engine/reference/commandline/images/), чтобы получить список скачанных образов контейнеров. Например, следующая команда возвращает идентификатор, репозиторий и тег каждого скачанного образа контейнера, отформатированные в виде таблицы:
>
>  ```Docker
>  docker images --format "table {{.ID}}\t{{.Repository}}\t{{.Tag}}"
>  ```
>

## <a name="instantiate-a-container-from-a-downloaded-container-image"></a>Создание экземпляра контейнера из скачанного образа

Используйте команду [docker run](https://docs.docker.com/engine/reference/commandline/run/), чтобы создать экземпляр контейнера из скачанного образа. Например, следующая команда:

* создает экземпляр контейнера из образа контейнера распознавания текста;
* выделяет два ядра ЦП и 8 гигабайт (ГБ) памяти;
* открывает TCP-порт 5000 и выделяет псевдотелетайп для контейнера;
* автоматически удаляет контейнер после его выхода из системы.

```docker
docker run --rm -it -p 5000:5000 --memory 8g --cpus 2 containerpreview.azurecr.io/microsoft/cognitive-services-recognize-text Eula=accept Billing=https://westus.api.cognitive.microsoft.com/vision/v2.0 ApiKey=0123456789
```

После создания экземпляра вы можете вызывать операции из контейнера с помощью URI узла контейнера. Например, следующий URI узла представляет контейнер распознавания текста, созданный в предыдущем примере:

```http
http://localhost:5000/
```

> [!IMPORTANT]
> Вы можете просмотреть [спецификацию OpenAPI](https://swagger.io/docs/specification/about/) (прежнее название — спецификация Swagger), в которой описываются операции, поддерживаемые контейнером экземпляра относительного URI `/swagger` для этого контейнера. Например, следующий URI представляет доступ к спецификации OpenAPI контейнеру распознавания текста, созданному в предыдущем примере:
>
>  ```http
>  http://localhost:5000/swagger
>  ```

Вы можете либо [вызывать операции REST API](https://docs.microsoft.com/azure/cognitive-services/computer-vision/vision-api-how-to-topics/howtocallvisionapi), доступные в контейнере, для асинхронного или синхронного распознавания текста, либо использовать клиентскую библиотеку [пакета SDK Компьютерного зрения для Azure Cognitive Services](https://www.nuget.org/packages/Microsoft.Azure.CognitiveServices.Vision.ComputerVision) для вызова этих операций.  
> [!IMPORTANT]
> Для использования клиентской библиотеки в контейнере необходим пакет SDK Компьютерного зрения для Azure Cognitive Services версии 3.2.0 или выше.

### <a name="asynchronous-text-recognition"></a>Асинхронное распознавание текста

Вы можете использовать операции `POST /vision/v2.0/recognizeText` и `GET /vision/v2.0/textOperations/*{id}*` для асинхронного распознавания печатного текста на изображении подобно тому, как служба "Компьютерное зрение" использует соответствующие операции REST. В настоящее время контейнер распознавания текста определяет только печатный текст и не распознает рукописный, поэтому параметр `mode`, обычно указываемый для операции службы "Компьютерное зрение", игнорируется контейнером распознавания текста.

### <a name="synchronous-text-recognition"></a>Синхронное распознавание текста

С помощью операции `POST /vision/v2.0/recognizeTextDirect` можно синхронно распознавать печатный текст на изображении. Так как эта операция является синхронной, текст запроса для нее будет таким же, как и для операции `POST /vision/v2.0/recognizeText`, но текст отклика для этой нее будет таким же, как и для операции `GET /vision/v2.0/textOperations/*{id}*`.

### <a name="billing"></a>Выставление счетов

Контейнер распознавания текста отправляет данные для выставления счетов в Azure, используя соответствующий ресурс компьютерного зрения в учетной записи Azure. Для выставления счетов контейнер распознавания текста использует следующие параметры:

| Параметр | ОПИСАНИЕ |
|--------|-------------|
| `ApiKey` | Ключ API ресурса компьютерного зрения используется для отслеживания данных о выставлении счетов.<br/>Значение этого параметра должно быть присвоено ключу API для подготовленного ресурса компьютерного зрения Azure, определенного в `Billing`. |
| `Billing` | Конечная точка ресурса компьютерного зрения используется для отслеживания данных о выставлении счетов.<br/>Значение этого параметра должно быть присвоено конечной точке URI для подготовленного ресурса компьютерного зрения Azure.|
| `Eula` | Указывает, что вы приняли условия лицензии для контейнера.<br/>Для этого параметра необходимо задать значение `accept`. |

> [!IMPORTANT]
> Для всех трех параметров необходимо задать допустимые значения. В противном случае контейнер не запустится.

Дополнительные сведения об этих параметрах см. в статье [Настройка контейнеров](computer-vision-resource-container-config.md).

## <a name="summary"></a>Сводка

Из этой статьи вы узнали основные понятия и рабочий процесс, позволяющий скачивать, устанавливать и запускать контейнеры компьютерного зрения. В разделе "Сводка" сделайте следующее.

* Компьютерное зрение предоставляет один контейнер Linux для Docker, чтобы обнаруживать и извлекать печатный текст.
* Образы контейнеров скачиваются из частного реестра контейнеров в Azure.
* Образы контейнеров, которые выполняются в Docker.
* Указав URI узла контейнера, пакет SDK или REST API можно использовать для вызова операций в контейнерах компьютерного зрения.
* При создании контейнера необходимо указать данные для выставления счетов.
* ** Контейнеры Cognitive Services не лицензируются для запуска без подключения к Azure для отслеживания использования. Клиенты должны разрешить контейнерам в любой момент обмениваться данными для выставления счетов в службе контроля потребления. Контейнеры Cognitive Services не отправляют в корпорацию Майкрософт данные клиента (например, изображение или текст, который анализируется).  

## <a name="next-steps"></a>Дополнительная информация

* Ознакомьтесь со статьей о [параметрах конфигурации](computer-vision-resource-container-config.md).
* Дополнительные сведения о распознавании печатного и рукописного текста см. в статье [Обзор компьютерного зрения](Home.md).  
* Дополнительные сведения о методах, поддерживаемых контейнером, см. в статье [API компьютерного зрения](//westus.dev.cognitive.microsoft.com/docs/services/5adf991815e1060e6355ad44/operations/56f91f2e778daf14a499e1fa).
* Чтобы разрешать проблемы, связанные с функциональностью Компьютерного зрения, ознакомьтесь с [часто задаваемыми вопросами](FAQ.md).
