---
title: Руководство. Создание акустической модели с помощью службы "Речь"
titlesuffix: Azure Cognitive Services
description: В этом документе описывается создание акустической модели с помощью службы "Речь" в Azure Cognitive Services.
services: cognitive-services
author: PanosPeriorellis
manager: cgronlun
ms.service: cognitive-services
ms.component: speech-service
ms.topic: tutorial
ms.date: 06/25/2018
ms.author: panosper
ms.openlocfilehash: 70fc9c34599f27eb5d67b79ef823f8037ae55ba9
ms.sourcegitcommit: 6e09760197a91be564ad60ffd3d6f48a241e083b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2018
ms.locfileid: "50215248"
---
# <a name="tutorial-create-a-custom-acoustic-model"></a>Учебник. Создание пользовательской акустической модели

Пользовательская акустическая модель полезна в тех случаях, когда ваше приложение разработано для особых условий применения, например в автомобиле, ориентировано на определенные устройства и условия записи либо на конкретную категорию пользователей. В качестве примера можно привести речь с акцентом, наличие фонового шума или использование определенного микрофона для записи.

В этой статье раскрываются следующие темы:
> [!div class="checklist"]
> * Подготовка данных
> * Импорт набора акустических данных
> * Создание пользовательской акустической модели

Если у вас еще нет учетной записи Azure Cognitive Services, создайте [бесплатную учетную запись](https://azure.microsoft.com/try/cognitive-services), а затем приступайте к работе.

## <a name="prerequisites"></a>Предварительные требования

Подключите учетную запись Cognitive Services к подписке. Для этого откройте страницу [подписок Cognitive Services](https://cris.ai/Subscriptions).

Кроме того, можно подключиться к подписке службы "Речь", созданной на портале Azure, выбрав **Connect existing subscription** (Подключиться к имеющейся подписке).

Дополнительные сведения о создании подписок службы "Речь" на портале Azure см. на странице [Бесплатная пробная подписка на службу "Речь"](get-started.md).

## <a name="prepare-the-data"></a>Подготовка данных

Чтобы настроить акустическую модель для определенной области применения, требуется получить данные для распознавания речи. Эта коллекция может варьироваться от нескольких фраз до нескольких сотен часов записанной речи. Она состоит из набора звуковых файлов с данными речи и текстового файла, который содержит расшифровку каждого звукового файла. Представленные звуковые данные должны соответствовать сценарию, в котором планируется использовать систему распознавания речи.

Например: 

* Если вы хотите оптимизировать распознавание речи в шумных производственных условиях, звуковые файлы должны содержать речь людей, записанную на фоне соответствующего шума.
* Если вы хотите улучшить распознавание речи конкретного человека, &mdash;например хотите транскрибировать запись цикла передач с одним ведущим&mdash;, звуковые файлы должны содержать примеры речи только этого человека.

Набор акустических данных для настройки акустической модели состоит из двух частей: (1) набор звуковых файлов, содержащих данные для распознавания речи, и (2) файл с транскрипцией всех звуковых файлов.

### <a name="audio-data-recommendations"></a>Рекомендации по подготовке звуковых данных

* Все звуковые файлы должны храниться в формате WAV (RIFF).
* У файла должна быть частота дискретизации 8 или 16 килогерц (кГц). Значения сэмплов должны храниться в формате 16-разрядных целых чисел PCM со знаком без сжатия (короткие звуковые файлы).
* Поддерживаются только одноканальные (монофонические) звуковые файлы.
* Длина звуковых файлов может варьироваться от 100 микросекунд до 1 минуты, но оптимальная длительность составляет примерно 10–12 секунд. В идеальном случае в начале и конце каждого звукового файла должен присутствовать период молчания длительностью около 100 микросекунд, а сама длина файла должна составлять от 500 микросекунд до 1 секунды.
* Если данные содержат фоновый шум, также рекомендуется добавить в них несколько образцов с более продолжительными фрагментами тишины &mdash;например, несколько секунд&mdash; до и/или после речи.
* Каждый звуковой файл должен содержать одну фразу, &mdash;например одно предложение из выступления, один вопрос или одно действие диалоговой системы.
* У каждого звукового файла в наборе данных должно быть уникальное имя и расширение WAV.
* Набор звуковых файлов должен располагаться в одной папке без подкаталогов. Весь набор должен быть упакован в один архивный ZIP-файл.

> [!NOTE]
> Максимальный размер набора акустических данных ограничен 2 ГБ (ограничение на импорт данных через веб-портал). Этот размер соответствует примерно 17 часам звука при частоте дискретизации 16 кГц или 34 часам звука при частоте дискретизации 8 кГц. Основные требования к звуковым данным описываются в следующей таблице.
>

| Свойство | Значение |
|---------- |----------|
| Формат файла | RIFF (WAV) |
| Частота дискретизации | 8000 герц (Гц) или 16 000 Гц |
| Каналы | 1 (моно) |
| Формат выборки | PCM, 16-разрядные целые числа |
| Продолжительность файла | 0,1–12 с | 
| Период тишины | > 0,1 с |
| Формат архива | .zip |
| Максимальный размер архива | 2 ГБ |

> [!NOTE]
> Для имен файлов стоит использовать только латинские символы, кроме того они должны быть формата "имя файла.расширение"

## <a name="language-support"></a>Поддержка языков

Полный список языков, поддерживаемых для пользовательских языковых моделей **преобразования речи в текст**, см. в разделе [Преобразование речи в текст](language-support.md#speech-to-text).

### <a name="transcriptions-for-the-audio-dataset"></a>Транскрипции для набора звуковых данных

Транскрипции всех WAV-файлов должны содержаться в одном текстовом файле. Каждая строка файла транскрипции должна содержать имя звукового файла и соответствующую ему транскрипцию. Для разделения имени файла и транскрипции необходимо использовать символ табуляции (\t).

  Например: 
```
  speech01.wav  speech recognition is awesome
  speech02.wav  the quick brown fox jumped all over the place
  speech03.wav  the lazy dog was not amused
```
> [!NOTE]
> Для кодировки транскрипции необходимо использовать метку порядка байтов UTF-8.

Текст транскрипции нормализуется для эффективной обработки системой. Однако есть некоторые важные действия нормализации, которые пользователь должен выполнять _перед_ отправкой данных в пользовательскую службу распознавания речи. Чтобы использовать соответствующий язык при подготовке транскрипций, обратитесь к статье [Рекомендации по транскрибированию для обучения службы "Речь"](prepare-transcription.md).

Выполните действия в следующих разделах с помощью [портала службы "Речь"](https://cris.ai).

## <a name="import-the-acoustic-dataset"></a>Импорт набора акустических данных

После подготовки звуковых файлов и транскрипций их можно импортировать на веб-портал службы.

Чтобы импортировать их, сначала убедитесь, что вы вошли на [портал службы "Речь"](https://cris.ai). Затем в раскрывающемся списке **Настраиваемое распознавание речи** на ленте выберите **Adaptation Data** (Данные адаптации). Если вы впервые передаете данные в Пользовательскую службу распознавания речи, отобразится пустая таблица с именем **Наборы данных**. 

В строке **Acoustic Datasets** (Акустические наборы данных) нажмите кнопку **Import** (Импорт), и на сайте появится страница для отправки нового набора данных.

![Страница импорта акустических данных](media/stt/speech-acoustic-datasets-import.png)

В поля **Имя** и **Description** (Описание) введите соответствующую информацию. Для удобства отслеживания передаваемых наборов данных рекомендуется использовать понятное описание. 

В полях **Transcriptions file (.txt)** (Транскрипция файла (.txt)) и **Audio files (.zip)** (Звуковые файлы (.zip)) выберите **Browse** (Обзор), а затем выберите файл транскрибирования с простым текстом и ZIP-файл архива отдельных WAV-файлов. После завершения подготовки нажмите кнопку **Import** (Импорт), чтобы отправить данные. Данные будут отправлены. Процесс импорта может занять несколько минут для крупных наборов данных.

После завершения отправки вернитесь к таблице **Acoustic Datasets** (Акустические наборы данных). Отображается запись, которая соответствует акустическому набору данных. Обратите внимание, что ему был присвоен уникальный идентификатор (GUID). Данные отображают текущее состояние :*Не начато*, если данные ставятся в очередь для обработки, *Идет обработка*, если выполняется проверка, и *Выполнено*, когда данные можно использовать.

При проверке данных проверяются формат, продолжительность и частота дискретизации звуковых файлов, а также формат файлов транскрипции. Кроме того, для транскрипции выполняются некоторые операции по нормализации текста.

Если состояние акустического набора данных — *Успешно*, вы можете просмотреть отчет о проверке, щелкнув **Сведения**. Отобразится количество успешных и неудачных проверок, а также сведения о фразах, завершившихся сбоем. В примере на следующем рисунке два WAV-файла не прошли проверку из-за неверного формата звуковых данных. В одном случае неправильная частота дискретизации, а в другом — неправильный формат файла.

![Страница сведений о данных адаптации](media/stt/speech-acoustic-datasets-report.png)

Если вы хотите изменить имя или описание набора данных, щелкните ссылку **Изменить** и внесите соответствующие изменения. Изменять звуковые файлы и транскрипцию нельзя.

## <a name="create-a-custom-acoustic-model"></a>Создание пользовательской акустической модели

Как только состояние акустического набора данных станет *Выполнено*, его можно использовать для создания пользовательской акустической модели. Для этого щелкните **Acoustic Models** (Акустические модели) в раскрывающемся меню **Настраиваемое распознавание речи**. В таблице с подписью **Your models** (Ваши модели) перечислены все пользовательские акустические модели. При первом использовании эта таблица будет пустой. В заголовке таблицы отображается текущий языковой стандарт. В настоящее время акустические модели можно создавать только для английского языка (США).

Чтобы создать модель, щелкните **Создать** под заголовком таблицы. Как и ранее, введите имя и описание, чтобы определить эту модель в будущем. Например, в поле **Description** (Описание) можно указать, на основе каких модели и набора акустических данных была создана эта модель. 

Затем из раскрывающегося списка **Base Acoustic Model** (Базовая акустическая модель) выберите базовую модель. Эта базовая модель — отправная точка настройки. Вы можете выбрать из двух базовых акустических моделей.
* **Акустическая модель поиска и диктовки Майкрософт** подходит для речи, направленной в приложение, например команд, поисковых запросов или диктовки. 
* **Разговорная акустическая модель Майкрософт** подходит для распознавания речи при общении. Этот тип речи обычно направлен на другого человека и встречается в колл-центрах или на встречах. 

Разговорная модель характеризуется большей задержкой для частичных результатов по сравнению с моделью поиска и диктовки.

> [!NOTE]
> На данный момент ведется подготовка к развертыванию новой **универсальной** модели, которая будет охватывать оба этих сценария. Вышеупомянутые модели по-прежнему будут находиться в общем доступе.

Затем из раскрывающегося списка **Acoustic Data** (Акустические данные) выберите акустические данные, которые вы хотите использовать для выполнения настройки.

![Страница создания акустической модели](media/stt/speech-acoustic-models-create2.png)

После завершения обработки вы можете выбрать тестирование новой модели на точность. В этом случае будет выполнена оценка эффективности преобразования речи в текст для указанного набора акустических данных с использованием пользовательской акустической модели. По результатам оценки будет подготовлен отчет. Чтобы выполнить проверку, установите флажок **Accuracy Testing** (Тестирование на точность). Затем в раскрывающемся списке выберите языковую модель. Если пользовательская языковая модель не была создана, в раскрывающемся списке будут представлены только базовые языковые модели. Чтобы выбрать наиболее подходящую языковую модель, обратитесь к [руководству по созданию пользовательской языковой модели](how-to-customize-language-model.md).

Наконец, выберите набор акустических данных, который вы хотите использовать для оценки пользовательской модели. Если вы выполняете тестирование на точность, важно выбрать набор акустических данных, отличный от использованного при создании модели. Это позволит более реалистично оценить эффективность модели. Если использовать обучающие данные для тестирования на точность, оценка эффективности адаптированной модели в реальных условиях не будет соответствовать действительности. В таком случае результат будет слишком оптимистичным. Обратите внимание, что объем тестирования на точность ограничен 1000 фразами. Если набор акустических данных большого размера, для оценки будут использоваться первые 1000 фраз.

Если все готово к запуску процесса настройки, щелкните **Create** (Создать).

В таблице акустических моделей отображается новая запись, которая соответствует новой модели. В ней также отображается состояние процесса: *Ожидание*, *Обработка* или *Завершено*.

![Страница акустических моделей](media/stt/speech-acoustic-models-creating.png)

## <a name="next-steps"></a>Дополнительная информация

- [Пробная версия Cognitive Services](https://azure.microsoft.com/try/cognitive-services/)
- [Краткое руководство. Распознавание речи с помощью пакета SDK службы распознавания речи Cognitive Services C#](quickstart-csharp-dotnet-windows.md)
- [Образец данных Git](https://github.com/Microsoft/Cognitive-Custom-Speech-Service)
