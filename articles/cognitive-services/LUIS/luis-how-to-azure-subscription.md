---
title: Как использовать ключи разработки и среды выполнения — LUIS
titleSuffix: Azure Cognitive Services
description: При первом использовании Language Understanding (LUIS) не нужно создавать ключ разработки. Если вы планируете опубликовать приложение, а затем используйте конечную точку среды выполнения, необходимо создать и назначить приложению ключ среды выполнения.
services: cognitive-services
author: diberry
manager: nitinme
ms.custom: seodec18
ms.service: cognitive-services
ms.subservice: language-understanding
ms.topic: conceptual
ms.date: 09/09/2019
ms.author: diberry
ms.openlocfilehash: 5c2e81cd11826a0325cd78384a22ec7eefb3a565
ms.sourcegitcommit: adc1072b3858b84b2d6e4b639ee803b1dda5336a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2019
ms.locfileid: "70844867"
---
# <a name="using-authoring-and-runtime-resource-keys"></a>Использование ключей ресурсов для разработки и среды выполнения

Разработка и ресурсы среды выполнения обеспечивают проверку подлинности для приложения LUIS и конечной точки прогнозирования.

<a name="create-luis-service"></a>
<a name="create-language-understanding-endpoint-key-in-the-azure-portal"></a>

При входе на портал LUIS можно продолжить:

* Бесплатная [пробная версия ключа](#trial-key) — создание и несколько запросов к конечной точке прогнозирования.
* новый ресурс Azure LUIS Authoring — создание нового ресурса. Это не то же самое, что ресурс-конечная точка прогнозирования. 


<a name="starter-key"></a>

## <a name="sign-in-to-luis-portal-and-begin-authoring"></a>Войдите на портал LUIS и начните создание

1. Войдите на [портал Luis](https://www.luis.ai) и примите условия использования.
1. Начните работу с приложения LUIS, выбрав тип LUISого ключа, который вы хотите использовать: бесплатный пробный ключ или новый ключ создания Azure LUIS. 

    ![Выбор типа ресурса для разработки в службе "Распознавание речи"](./media/luis-how-to-azure-subscription/sign-in-create-resource.png)

1. По завершении процесса выбора ресурсов [Создайте новое приложение](luis-how-to-start-new-app.md#create-new-app-in-luis). 

## <a name="trial-key"></a>Ключ пробной версии

Для вас предоставляется пробный ключ (начальная версия). Он используется в качестве ключа проверки подлинности для запроса среды выполнения прогнозирующих конечных точек, до 1000 запросов в месяц. 

Он отображается как на странице **параметров пользователя** , так и на страницах **ресурсов Azure "Управление >** " на портале Luis. 

Когда вы будете готовы опубликовать конечную точку прогноза, создайте и назначьте ключи среды выполнения для создания и прогнозирования, чтобы заменить функциональность начального ключа. 

## <a name="create-resources-in-the-azure-portal"></a>Создание ресурсов в портал Azure

1. Войдите на [портале Azure](https://azure.microsoft.com/free/). 
1. Выберите действие **Создать ресурс**.
1. В поле поиска введите `Language understanding`.
1. Выберите **Создать**, чтобы начать процесс создания. 
1. Создайте и то, и **другое** , чтобы создать создание и ключ среды выполнения для конечной точки прогнозирования. 
1. Введите сведения, необходимые для создания ресурса, а затем щелкните **создать** , чтобы завершить процесс.

    ![Создание ресурса для понимания языка](./media/luis-how-to-azure-subscription/create-resource-in-azure.png)

    |Название|Цель|
    |--|--|
    |Имя ресурса| Выбранное пользователем имя, используемое в качестве части URL-адреса для запросов конечной точки создания и прогнозирования.|
    |Название подписки| Подписка, для которой будет выставлен счет за ресурс.|
    |Группа ресурсов| Имя настраиваемой группы ресурсов, которую вы выбираете или создаете. Группы ресурсов позволяют группировать ресурсы Azure для доступа и управления в одном регионе.|
    |Место разработки|Регион, связанный с вашей моделью.|
    |Ценовая категория создания|Ценовая категория определяет максимальное количество транзакций в секунду и месяц.|
    |Расположение среды выполнения|Регион, связанный с опубликованной средой выполнения конечной точки прогнозирования.|
    |Ценовая категория среды выполнения|Ценовая категория определяет максимальное количество транзакций в секунду и месяц.|

    После создания обоих ресурсов Назначьте ресурсы на портале LUIS.

## <a name="create-resources-in-azure-cli"></a>Создание ресурсов в Azure CLI

Используйте [Azure CLI](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest) , чтобы создать каждый ресурс по отдельности. 

Ресурс `kind`:

* Работы`LUIS.Authoring`
* Прогнозирующее`LUIS` 

1. Войдите в Azure CLI:

    ```console
    az login
    ```

    Откроется браузер, позволяющий выбрать правильную учетную запись и обеспечить проверку подлинности.

1. Создайте ресурс для создания **Luis**, `LUIS.Authoring`тип `my-luis-authoring-resource` которого в _существующей_ группе ресурсов с именем `my-resource-group` для `westus` региона. 

    ```console
    az cognitiveservices account create -n my-luis-authoring-resource -g my-resource-group --kind LUIS.Authoring --sku F0 -l westus --yes
    ```

1. Создайте **ресурс Luis прогнозирующих точек**типа `LUIS` `my-luis-prediction-resource` с именем в _существующей_ группе ресурсов с именем `my-resource-group` для `westus` региона. Если требуется более высокая пропускная способность, чем уровень Free `F0` , `S0`измените на. Дополнительные сведения о [ценовых категориях и пропускной способности](luis-boundaries.md#key-limits).

    ```console
    az cognitiveservices account create -n my-luis-prediction-resource -g my-resource-group --kind LUIS --sku F0 -l westus --yes
    ```

    > [!Note] 
    > Эти ключи не используются порталом LUIS, пока они **не** назначены на ПОРТАЛе Luis в **ресурсах управления > Azure**.

## <a name="assign-an-authoring-resource-in-the-luis-portal-for-all-apps"></a>Назначение ресурса для разработки на портале LUIS для всех приложений

Вы можете назначить ресурс для создания отдельного приложения или для всех приложений в LUIS. Следующая процедура назначает всем приложениям один ресурс для создания.

1. Войдите на [портал Luis](https://www.luis.ai).
1. На верхней панели навигации справа выберите учетную запись пользователя, а затем щелкните **Параметры**.
1. На странице **Параметры пользователя** выберите **Добавить ресурс для разработки** и выберите существующий ресурс разработки. Щелкните **Сохранить**. 

## <a name="assign-a-resource-to-an-app"></a>Назначение ресурса для приложения

Можно назначить один ресурс, среду выполнения для создания или прогнозирования конечных точек в приложение, выполнив следующую процедуру.

1. Войдите на [портал Luis](https://www.luis.ai), а затем выберите приложение из списка **Мои приложения** .
1. Перейдите на страницу **Управление ресурсами Azure >** .

    ![Выберите ресурсы Azure "Управление >" на портале LUIS, чтобы назначить ресурс приложению.](./media/luis-how-to-azure-subscription/manage-azure-resources-prediction.png)

1. Выберите вкладку ресурс прогноза или разработки, а затем нажмите кнопку **Добавить прогнозирующий ресурс** или **Добавить ресурс для создания ресурса** . 
1. Выберите поля в форме, чтобы найти правильный ресурс, а затем нажмите кнопку **сохранить**.  

### <a name="assign-runtime-resource-without-using-luis-portal"></a>Назначение ресурса среды выполнения без использования портала LUIS

В целях автоматизации, таких как конвейер CI/CD, может потребоваться автоматизировать назначение ресурса среды выполнения LUIS приложению LUIS. Для этого необходимо выполнить указанные ниже действия.

1. Запросите маркер Azure Resource Manager с этого [веб-сайта](https://resources.azure.com/api/token?plaintext=true). Срок действия этого маркера ограничен, поэтому его следует использовать сразу. По запросу возвращается маркер Azure Resource Manager.

    ![Запрашивание и получение маркера Azure Resource Manager](./media/luis-manage-keys/get-arm-token.png)

1. Используйте маркер, чтобы запросить ресурсы среды выполнения LUIS в подписках из [API-интерфейса получения Luis учетных записей Azure](https://westus.dev.cognitive.microsoft.com/docs/services/5890b47c39e2bb17b84a55ff/operations/5be313cec181ae720aa2b26c), к которому имеет доступ ваша учетная запись пользователя. 

    Этот API POST принимает указанные ниже параметры.

    |Header|Значение|
    |--|--|
    |`Authorization`|Значение заголовка `Authorization` — `Bearer {token}`. Обратите внимание, что перед значением маркера должны находиться слово `Bearer` и пробел.| 
    |`Ocp-Apim-Subscription-Key`|Ваш ключ разработки.|

    Этот API возвращает массив объектов JSON ваших подписок LUIS, включая идентификатор подписки, группу ресурсов и имя ресурса, возвращаемое в виде имени учетной записи. Найдите в массиве один элемент, соответствующий ресурсу LUIS, который требуется назначить приложению LUIS. 

1. Назначьте маркер ресурсу LUIS с помощью API [назначения учетных записей Azure LUIS приложению](https://westus.dev.cognitive.microsoft.com/docs/services/5890b47c39e2bb17b84a55ff/operations/5be32228e8473de116325515). 

    Этот API POST принимает указанные ниже параметры.

    |Type|Параметр|Значение|
    |--|--|--|
    |Header|`Authorization`|Значение заголовка `Authorization` — `Bearer {token}`. Обратите внимание, что перед значением маркера должны находиться слово `Bearer` и пробел.|
    |Header|`Ocp-Apim-Subscription-Key`|Ваш ключ разработки.|
    |Header|`Content-type`|`application/json`|
    |Строка запроса|`appid`|Идентификатор приложения LUIS. 
    |Body||{"AzureSubscriptionId":"ddda2925-af7f-4b05-9ba1-2155c5fe8a8e",<br>"ResourceGroup": "resourcegroup-2",<br>"AccountName": "luis-uswest-S0-2"}|

    При успешном выполнении этого API возвращается состояние "201 - created". 

## <a name="unassign-resource"></a>Отменить присвоение ресурса

1. Войдите на [портал Luis](https://www.luis.ai), а затем выберите приложение из списка **Мои приложения** .
1. Перейдите на страницу **Управление ресурсами Azure >** .
1. Выберите вкладку ресурс прогноза или разработки, а затем нажмите кнопку **Отменить назначение ресурса** для ресурса. 

При удалении ресурса он не удаляется из Azure. Он только потеряет связь из LUIS. 

## <a name="reset-authoring-key"></a>Сброс ключа разработки

**Для [создания перенесенных приложений ресурсов](luis-migration-authoring.md)** . Если ваш ключ разработки скомпрометирован, сбросьте ключ в портал Azure на странице **ключи** для этого ресурса. 

**Для приложений, которые еще не перенесены**: ключ сброшен для всех приложений на портале Luis. Если вы разрабатываете приложения с помощью API-интерфейсов создания, необходимо изменить значение OCP-Apim-Subscription-Key на новый ключ.

## <a name="regenerate-azure-key"></a>Повторное создание ключа Azure

Повторно создайте ключи Azure из портал Azure на странице **ключи** .

## <a name="delete-account"></a>Удалить учетную запись

Дополнительные сведения о том, какие данные удаляются при удалении учетной записи см. статью [Data storage and removal](luis-concept-data-storage.md#accounts) (Хранение и удаление данных).

## <a name="change-pricing-tier"></a>Смена ценовой категории

1.  В [Azure](https://portal.azure.com) найдите подписку LUIS. Выберите подписку LUIS.
    ![Найдите подписку LUIS](./media/luis-usage-tiers/find.png)
1.  Выберите **Ценовая категория**, чтобы просмотреть доступные ценовые категории. 
    ![Просмотрите ценовые категории](./media/luis-usage-tiers/subscription.png)
1.  Выберите ценовую категорию и нажмите кнопку **Выбрать**, чтобы сохранить внесенные изменения. 
    ![Измените ценовую категорию LUIS](./media/luis-usage-tiers/plans.png)
1.  После изменения ценовой категории появится всплывающее окно с новой ценовой категорией. 
    ![Проверьте ценовую категорию LUIS](./media/luis-usage-tiers/updated.png)
1. Не забудьте [назначить этот ключ конечной точки](#assign-a-resource-to-an-app) на странице **публикации** и использовать его во всех запросах конечной точки. 

## <a name="viewing-azure-resource-metrics"></a>Просмотр метрик ресурсов Azure

### <a name="viewing-azure-resource-summary-usage"></a>Просмотр сводных сведений об использовании ресурсов Azure
Вы можете просмотреть сведения об использовании службы LUIS в Azure. На странице **Обзор** отображаются последние сводные сведения, включая вызовы и ошибки. При отправке запроса конечной точки LUIS сведения об использовании на **странице обзора** отображаются в течение пяти минут.

![Просмотр сводки использования](./media/luis-usage-tiers/overview.png)

### <a name="customizing-azure-resource-usage-charts"></a>Настройка диаграмм использования ресурсов Azure
Метрики обеспечивают более подробное представление данных.

![Метрики по умолчанию](./media/luis-usage-tiers/metrics-default.png)

Для диаграмм метрик можно настроить тип метрики и период времени. 

![Настраиваемые метрики](./media/luis-usage-tiers/metrics-custom.png)

### <a name="total-transactions-threshold-alert"></a>Оповещение о пороговом значении "Всего транзакций"
Если вы хотите знать, когда будет достигнуто определенное пороговое значение транзакций (например, 10 000), вы можете создать оповещение. 

![Оповещения по умолчанию](./media/luis-usage-tiers/alert-default.png)

Добавьте оповещение для метрики **общее число вызовов** за определенный период времени. Добавьте адреса электронной почты всех пользователей, которые должны получать оповещение. Добавьте веб-привязки для всех систем, которые должны получать оповещения. При запуске оповещения также может выполняться приложение логики. 

## <a name="next-steps"></a>Следующие шаги

* Узнайте [, как использовать версии](luis-how-to-manage-versions.md) для управления жизненным циклом приложения.
* Изучите основные понятия, в том числе [ресурсы для разработки](luis-concept-keys.md#authoring-key) и [участников](luis-concept-keys.md#contributions-from-other-authors) этого ресурса.
* Сведения [о создании](luis-how-to-azure-subscription.md) ресурсов разработки и среды выполнения
* Переход на новый [ресурс создания](luis-migration-authoring.md) 