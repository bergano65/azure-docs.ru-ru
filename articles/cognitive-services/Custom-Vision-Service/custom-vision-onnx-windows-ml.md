---
title: Использование модели ONNX с Windows ML — Пользовательская служба визуального распознавания
titleSuffix: Azure Cognitive Services
description: Сведения о создании приложения Windows UWP, в котором используется модель ONNX, экспортированная из Azure Cognitive Services.
services: cognitive-services
author: PatrickFarley
manager: nitinme
ms.service: cognitive-services
ms.subservice: custom-vision
ms.topic: conceptual
ms.date: 04/29/2020
ms.author: pafarley
ms.openlocfilehash: 58ced0c45d66223ac3e40112126e92a4539db32d
ms.sourcegitcommit: 9706bee6962f673f14c2dc9366fde59012549649
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/13/2020
ms.locfileid: "94616082"
---
# <a name="use-an-onnx-model-from-custom-vision-with-windows-ml-preview"></a>Использование модели ONNX из Пользовательской службы визуального распознавания с Windows ML (предварительная версия)

Сведения об использовании модели ONNX, экспортированной из пользовательской службы визуального распознавания, с Windows ML (предварительная версия).

В этом руководство вы узнаете, как использовать файл ONNX, экспортированный из Пользовательская служба визуального распознавания с помощью Windows ML. Вы будете использовать пример приложения UWP с собственным обученным классификатором изображений.

## <a name="prerequisites"></a>Предварительные требования

* Windows 10 версии 1809 и выше
* Windows SDK для сборки 17763 или более поздней версии.
* Visual Studio 2017 версии 15.7 или более поздней с включенной рабочей нагрузкой __Разработка приложений для универсальной платформы Windows__ ;
* На компьютере включен режим разработчика. Дополнительные сведения см. в разделе [Включение устройства для разработки](/windows/uwp/get-started/enable-your-device-for-development).

## <a name="about-the-example-app"></a>Сведения о примере приложения

Включенное приложение — это универсальное приложение Windows UWP. Он позволяет выбрать образ на компьютере, который затем обрабатывается локально хранимой моделью классификации. Теги и оценки, возвращаемые моделью, отображаются рядом с изображением.

## <a name="get-the-example-code"></a>Получение примера кода

Пример приложения доступен на сайте [COGNITIVE Services ONNX пользовательское визуальное распознавание образце](https://github.com/Azure-Samples/cognitive-services-onnx-customvision-sample) репозитория на сайте GitHub. Клонировать его на локальный компьютер и открыть *самплеоннксевалуатионапп. sln* в Visual Studio.

## <a name="test-the-application"></a>Тестирование приложения

1. Чтобы запустить приложение из Visual Studio, нажмите клавишу `F5`. Вам может быть предложено включить режим разработчика.
1. При запуске приложения используйте кнопку, чтобы выбрать изображение для оценки. Модель ONNX по умолчанию обучена для классификации различных типов планктон.

## <a name="use-your-own-model"></a>Использование своей модели

Чтобы использовать собственную модель классификатора изображений, выполните следующие действия.

1. Создайте и обучите классификатор с помощью Пользовательской службы визуального распознавания. Инструкции по выполнению этой задачи см. в разделе [Создание и обучение классификатора](./getting-started-build-a-classifier.md). Используйте один из **компактных** доменов, например **General (Compact)**. 
   * При наличии существующего классификатора, использующего другой домен, его можно преобразовать в параметр " **Сжать** " в настройках проекта. Затем выполните повторное обучение проекта, прежде чем продолжить.
1. Экспортируйте модель. Перейдите на вкладку "производительность" и выберите итерацию, обученную с помощью **компактного** домена. Нажмите появившуюся кнопку **Экспорт** . Затем выберите **ONNX** , а затем — **Экспорт**. Когда файл будет готов, нажмите кнопку **Download** (Скачать). Дополнительные сведения о параметрах экспорта см. в разделе [Экспорт модели](./export-your-model.md).
1. Откройте скачанный *ZIP* -файл и извлеките из него файл *model. onnx* . Этот файл содержит модель-классификатор.
1. В обозреватель решений в Visual Studio щелкните правой кнопкой мыши папку **активы** и выберите команду __Добавить существующий элемент__. Выберите файл ONNX.
1. В обозреватель решений щелкните правой кнопкой мыши файл ONNX и выберите пункт **Свойства**. Измените следующие свойства файла:
   * __Build Action__ -> __Content__ (Действие при сборке > Содержимое);
   * __Copy to Output Directory__ -> __Copy if newer__ (Копировать в выходной каталог > Копировать, если новее).
1. Затем откройте _MainPage.XAML.CS_ и измените значение `_ourOnnxFileName` на имя файла ONNX.
1. Используйте `F5` для сборки и запуска проекта.
1. Нажмите кнопку, чтобы выбрать изображение для оценки.

## <a name="next-steps"></a>Дальнейшие действия

Сведения о других способах экспорта и использования модели пользовательской службы визуального распознавания см. в следующих документах:

* [Экспорт модели](./export-your-model.md)
* [Использование экспортированной модели Tensorflow в приложении Android](https://github.com/Azure-Samples/cognitive-services-android-customvision-sample)
* [Использование экспортированной модели CoreML в приложении Swift iOS](https://go.microsoft.com/fwlink/?linkid=857726)
* [Использование экспортированной модели CoreML в приложении iOS с помощью Xamarin](https://github.com/xamarin/ios-samples/tree/master/ios11/CoreMLAzureModel)

Дополнительные сведения об использовании моделей ONNX с Windows ML см. в статье [Интеграция модели в приложение с помощью Windows ML](/windows/ai/windows-ml/integrate-model).