---
title: 'Функции: Действия и контекст. Персонализатор'
titleSuffix: Azure Cognitive Services
description: Для улучшения предложений относительно ранжирования Персонализатор использует признаки — сведения действиях и контексте. Признаки могут быть как универсальными, так и характерными для элемента.
services: cognitive-services
author: diberry
manager: nitinme
ms.service: cognitive-services
ms.subservice: personalizer
ms.topic: conceptual
ms.date: 06/24/2019
ms.author: diberry
ms.openlocfilehash: 1960856ce2f15945d1b1bfa093f349771d481ffc
ms.sourcegitcommit: e3b0fb00b27e6d2696acf0b73c6ba05b74efcd85
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/30/2019
ms.locfileid: "68663845"
---
# <a name="features-are-information-about-actions-and-context"></a>Признаки — сведения о действиях и контексте

Персонализатор обучается на содержимом, отображаемым приложением для пользователей в заданном контексте.

Персонализатор использует **признаки**, которые представляют сведения о **текущем контексте**, для выбора лучшего **действия**. Признаки представляют все сведения, на основе которых Персонализатор может достичь более высокого вознаграждения. Признаки могут быть как универсальными, так и характерными для элемента. 

Например, **признаки** могут представлять следующее:

* _пользователя_, например `UserID`; 
* _содержимое_, включая, например, такое видео, как `Documentary`, `Movie` или `TV Series`, а также сведения о том, доступен ли определенный продукт в магазине;
* _текущий_ период времени, указывающий, например, день недели.

Персонализация не предписывает, ограничивает или исправляет функции, которые можно отправить для действий и контекста:

* Вы можете отправлять определенные признаки только для определенных действий, которые у вас есть. Например, у телевизионного сериала могут быть атрибуты, которых нет у кинофильма.
* Некоторые признаки могут быть доступными только в некоторых случаях. Например, мобильное приложение может предоставлять больше информации, чем веб-страница. 
* Со временем вы можете добавлять и удалять признаки, связанные с контекстом и действиями. Персонализатор обучается на доступной информации.
* Для контекста требуется минимум один признак. Персонализатор не поддерживает пустой контекст. Если вы каждый раз отправляете только определенный контекст, Персонализатор выберет действие для ранжирования на основе признаков в действиях.
* Для функций категории не нужно определять возможные значения, и не нужно предварительно определять диапазоны для числовых значений.

## <a name="supported-feature-types"></a>Типы поддерживаемых признаков

Персонализатор поддерживает признаки строковых, числовых и логических типов.

### <a name="how-choice-of-feature-type-affects-machine-learning-in-personalizer"></a>Влияние выбора типа функции на Машинное обучение в персонализации

* **Строки**: Для строковых типов каждое сочетание ключа и значения создает новые весовые коэффициенты в модели машинного обучения персонализации. 
* **Числовые**значения: Следует использовать числовые значения, если число должно быть пропорционально изменено на результат персонализации. Это очень зависимый сценарий. В упрощенном примере, например при персонализации розничной торговли, Нумберофпетсовнед может быть функцией, которая является числовой, так как может потребоваться, чтобы люди с 2 или 3 pets могли повлиять на результат персонализации дважды или чаще так, как если бы у них было 1 Pet. Функции, основанные на числовых единицах, но при которых значение не линейное (например, возраст, температура или высота пользователя) лучше всего кодируются как строки, а качество функций, как правило, можно улучшить с помощью диапазонов. Например, Age можно закодировать как «Age»: «0-5», «Age»: «6-10» и т. д.
* **Логические** значения, отправленные со значением "false", ведут себя так, как если бы они не отправлялись вообще.

Признаки, которые не существуют, должны быть пропущены в запросе. Избегайте отправки признаков со значением NULL, так как при обучении модели они обрабатываются как существующие признаки со значением NULL.

## <a name="categorize-features-with-namespaces"></a>Классификация признаков по пространствам имен

Персонализатор принимает признаки, которые упорядочены по пространствам имен. В приложении можно определить, используются ли пространства имен и какими они должны быть. Пространства имен используются для группирования сходных признаков или признаков, которые поступают из определенного источника.

Ниже приведены примеры пространств имен признаков, используемые приложениями:

* User_Profile_from_CRM
* Time
* Mobile_Device_Info
* http_user_agent
* VideoResolution
* UserDeviceInfo
* Weather
* Product_Recommendation_Ratings
* current_time
* NewsArticle_TextAnalytics

Можно присваивать пространствам имен любые имена, которые являются допустимыми ключами JSON. Пространства имен используются для организации компонентов в отдельные наборы и для устранения неоднозначности с похожими именами. Пространства имен можно считать префиксом, который добавляется к именам функций. Пространства имен не могут быть вложенными.


В приведенном ниже коде JSON `user`, `state` и `device` — это пространства имен признаков. Примечание общедоступной предварительной версии: В настоящее время настоятельно рекомендуется использовать имена для пространств имен компонентов, которые основаны на кодировке UTF-8, и начинаться с разных букв. `user` Например,`device` , и начинаются с`u` ,`s`и .`d` `state` В настоящее время пространства имен с одинаковыми первыми символами могут привести к конфликтам в индексах, используемых для машинного обучения.

Объекты JSON могут включать вложенные объекты JSON и простые свойства и значения. Массив может быть добавлен, только если элементы массива являются числами. 

```JSON
{
    "contextFeatures": [
        { 
            "user": {
                "profileType":"AnonymousUser",
                "latlong": [47.6, -122.1]
            }
        },
        {
            "state": {
                "timeOfDay": "noon",
                "weather": "sunny"
            }
        },
        {
            "device": {
                "mobile":true,
                "Windows":true
            }
        }
    ]
}
```

## <a name="how-to-make-feature-sets-more-effective-for-personalizer"></a>Оптимизация наборов признаков для Персонализатора

Хороший набор признаков помогает Персонализатору научиться прогнозировать действие для получения наивысшего вознаграждения. 

При отправке признаков в API ранжирования Персонализатора следуйте этим рекомендациям:

* Должно быть достаточно признаков для персонализации. Чем более точным должно быть содержимое, тем больше требуется признаков.

* Должно быть достаточно признаков разной *плотности*. Признак является *плотным*, если в несколько групп группируется много элементов. Например, тысячи видео можно классифицировать как продолжительные (от пяти минут) и короткие (до пяти минут). Это *очень плотный* признак. С другой стороны, эти же тысячи элементов могут иметь атрибут "заголовок", значение которого у всех этих элементов практически никогда не будут одинаковым. В таком случае признаки будут очень неплотными или *разреженными*.  

Наличие признаков высокой плотности помогает Персонализатору экстраполировать обучение на основе разных элементов. Но если есть только несколько признаков, и все они являются слишком плотными, Персонализатор попытается точно определить содержимое с помощью нескольких доступных групп.

### <a name="improve-feature-sets"></a>Оптимизация наборов признаков 

Проанализируйте поведение пользователей, выполнив автономную оценку. Так вы просмотрите последние данные и определите, какие признаки помогают достичь наивысшего вознаграждения, а какие — нет. Вы узнаете, какие признаки являются полезными, чтобы ваше приложение могло отправлять Персонализатору релевантные признаки. Это позволит вам существенно оптимизировать процесс.

В следующих разделах приведены общие рекомендации по улучшению признаков, отправляемых Персонализатору.

#### <a name="make-features-more-dense"></a>Уплотнение признаков

Вы можете улучшить наборы признаков, сделав их более крупными или изменив уровень плотности.

Например, посекундная метка времени — это очень разреженный признак. Его можно сделать более плотным (эффективным), используя такую классификацию, как "утро", "полдень", "день" и т. д.


#### <a name="expand-feature-sets-with-extrapolated-information"></a>Расширение наборов признаков на основе экстраполированных данных

Вы можете получить больше признаков на основе неиспользуемых атрибутов, которые в свою очередь получены из уже имеющихся сведений. Например, в вымышленной персонализации списка фильмов можно сделать так, чтобы выходные и рабочие дни могли повлиять на поведение пользователей? Следовательно, время могут описывать такие атрибуты, как "выходной день" или "рабочий день". В государственные праздники пользователи могут отдавать предпочтение определенным типам фильмов. Например, атрибут "Хэллоуин" будет полезен в соответствующих регионах. Возможно, что дождливая погода оказывает значительное влияние на выбор фильм у многих людей. На основе времени и места метеорологическая служба может предоставить определенную информацию, которую можно добавить, как дополнительный признак. 

#### <a name="expand-feature-sets-with-artificial-intelligence-and-cognitive-services"></a>Расширение наборов признаков за счет искусственного интеллекта и когнитивных служб

Искусственный интеллект и готовые к запуску службы Cognitive Services могут быть огромным подспорьем в работе Персонализатора. 

Выполняя предварительную обработку элементов с помощью служб искусственного интеллекта, вы можете автоматически извлекать информацию, которая, вероятнее всего, будет релевантной для персонализации.

Пример:

* Можно запустить фильм с помощью [Индексатора видео](https://azure.microsoft.com/services/media-services/video-indexer/), чтобы извлечь элементы сцены, текст, тональность и многие другие атрибуты. Эти атрибуты можно затем можно сделать более плотными, чтобы они отражали характеристики, которые отсутствуют в исходных метаданных элемента. 
* Изображения можно открывать с помощью средств обнаружения объектов, лиц, тональности и т. д.
* Сведения в тексте можно дополнить, извлекая сущности и тональности, а также расширяя сущности с помощью графа знаний Bing и т. д.

Можно использовать и другие службы [Azure Cognitive Services](https://www.microsoft.com/cognitive-services), например перечисленные ниже.

* [Связывание сущностей](../entitylinking/home.md)
* [Анализ текста](../text-analytics/overview.md)
* [Распознавание эмоций](../emotion/home.md)
* [Компьютерное зрение](../computer-vision/home.md)

## <a name="actions-represent-a-list-of-options"></a>Действия представляют список параметров

Каждое действие имеет следующие характеристики:

* Действия имеют идентификаторы.
* Действия имеют список признаков.
* Список может включать сотни признаков, но мы рекомендуем вам оценивать их эффективность, чтобы исключать признаки, которые не помогут получить вознаграждения. 
* Признаки в **действиях** могут коррелировать или не коррелировать с признаками в **контексте**, которые использует Персонализатор.
* Признаки могут присутствовать только в определенных действиях. 
* Признаки для определенного идентификатора действия могут использоваться в течение одного дня, после чего они могут быть недоступными. 

Хотя алгоритмы машинного обучения Персонализатора работают эффективнее при наличии стабильных наборов признаков, вызовы ранжирования не будут завершатся ошибкой, если такие наборы будут изменяться со временем.

Не добавляйте более 50 действий при ранжировании действий. Это могут быть как одни и те же, так и изменяющиеся действия. Например, если у вас есть каталог с продукцией, включающий 10 000 элементов для приложения электронной коммерции, вы можете использовать рекомендацию или механизм фильтрации для определения первых 40 элементов, которые вероятнее всего заинтересуют пользователей. Затем вы можете использовать Персонализатор, чтобы определить элементы с наивысшим вознаграждением (например, те, которые будут добавлены в корзину) в текущем контексте.


### <a name="examples-of-actions"></a>Примеры действий

Действия, которые вы отправляете в API ранжирования, будут зависеть от того, что вы пытаетесь персонализировать.

Далее приводятся некоторые примеры.

|Цель|Action|
|--|--|
|Персонализация для выбора статей, которые будут выделены на веб-сайте новостей.|Каждое действие является потенциальной новостной статьей.|
|Оптимизация размещения рекламы на веб-сайте.|Каждое действие будет макетом или правилами для создания макета для рекламы (например, в вверху, справа, небольшие или крупные изображения).|
|Отображение персонализированного ранжирования рекомендуемых элементов на торговом веб-сайте.|Каждое действие является определенным продуктом.|
|Предложение элементов пользовательского интерфейса, например фильтров, для применения к определенной фотографии.|Каждое действие может быть каким-либо фильтром.|
|Выбор ответа бота для уточнения намерения пользователя или предложения действия.|Каждое действие может быть вариантом интерпретации ответа.|
|Выбор элементов для отображения в верхней части списка результатов поиска|Каждое действие — это один из нескольких верхних результатов поиска в списке.|


### <a name="examples-of-features-for-actions"></a>Примеры признаков для действий

Ниже приведены актуальные примеры признаков для действий. Каждый признак будет в большой степени зависеть от каждого приложения.

* Признаки с характеристиками действий. Например, это может быть фильм или телевизионная передача.
* Признаки, информирующие о том, как пользователи могли взаимодействовать с этим действием в прошлом. Например, фильм мог просматриваться преимущественно пользователями определенных категорий населения (А или Б), и показывался он обычно не более одного раза.
* Признаки, информирующие о том, как пользователи *видят* действия. Например, афиша фильма в эскизе видео может включать лица, автомобили или ландшафты.

### <a name="load-actions-from-the-client-application"></a>Загрузка действий из клиентского приложения

Признаки в действиях обычно могут поступать из систем управления содержимым, каталогов и систем рекомендаций. Приложение отвечает за загрузку сведений о действиях из соответствующих доступных баз данных и систем. Если вы не изменяете свои действия или загружаете их каждый раз, когда регистрируете нежелательное влияние на производительность, вы можете добавить в приложение логику для кэширования этой информации.

### <a name="prevent-actions-from-being-ranked"></a>Предотвращение ранжирования действий

В определенных ситуациях вам не нужно отображать некоторые действия для пользователей. Лучший способ предотвратить ранжирование действия — это не включать его в верхнюю часть списка действий для API ранжирования.

В некоторых случаях вы сможете определить его позже в бизнес-логике, если результирующее _действие_ вызова API ранжирования будет отображаться пользователям. В таких случаях следует использовать _неактивные события_.

## <a name="json-format-for-actions"></a>Формат JSON для действий

При вызове ранжирования вы будете отправлять разные действия для выбора возможных вариантов:

Объекты JSON могут включать вложенные объекты JSON и простые свойства и значения. Массив может быть добавлен, только если элементы массива являются числами. 

```json
{
    "actions": [
    {
      "id": "pasta",
      "features": [
        {
          "taste": "salty",
          "spiceLevel": "medium",
          "grams": [400,800]
        },
        {
          "nutritionLevel": 5,
          "cuisine": "italian"
        }
      ]
    },
    {
      "id": "ice cream",
      "features": [
        {
          "taste": "sweet",
          "spiceLevel": "none",
          "grams": [150, 300, 450]
        },
        {
          "nutritionalLevel": 2
        }
      ]
    },
    {
      "id": "juice",
      "features": [
        {
          "taste": "sweet",
          "spiceLevel": "none",
          "grams": [300, 600, 900]
        },
        {
          "nutritionLevel": 5
        },
        {
          "drink": true
        }
      ]
    },
    {
      "id": "salad",
      "features": [
        {
          "taste": "salty",
          "spiceLevel": "low",
          "grams": [300, 600]
        },
        {
          "nutritionLevel": 8
        }
      ]
    }
  ]
}
```

## <a name="examples-of-context-information"></a>Примеры сведений для контекста

Хотя сведения для _контекста_ зависят от приложений и вариантов использования, обычно они включают следующие данные:

* Демографические данные и данные профиля пользователя.
* Данные, извлеченные из заголовков HTTP, например агент пользователя, или данные, полученные на основе сведений HTTP, например географический поиск информации на основе IP-адресов.
* Данные о текущем времени, например дне недели, выходных и праздниках или рабочих днях, времени суток т. д.
* Данные, извлеченные из мобильных приложений, например расположение, перемещения или уровень заряда батареи.
* Статистические данные о поведении пользователей в прошлом, например фильмы определенных жанров, которые пользователь просматривал чаще всего.

Приложение отвечает за загрузку сведений о контексте из соответствующих доступных баз данных, датчиков и систем. Если данные контекста не изменяются, вы можете добавить логику в приложение для кэширования этой информации перед отправкой в API ранжирования.

## <a name="json-format-for-context"></a>Формат JSON для контекста 

Контекст выражается в виде объекта JSON, отправляемого в API ранжирования:

Объекты JSON могут включать вложенные объекты JSON и простые свойства и значения. Массив может быть добавлен, только если элементы массива являются числами. 

```JSON
{
    "contextFeatures": [
        { 
            "user": {
                "name":"Doug"
            }
        },
        {
            "state": {
                "timeOfDay": "noon",
                "weather": "sunny"
            }
        },
        {
            "device": {
                "mobile":true,
                "Windows":true,
                "screensize": [1680,1050]
                }
            }
        }
    ]
}
```

## <a name="next-steps"></a>Следующие шаги

[Обучение с подкреплением](concepts-reinforcement-learning.md) 
