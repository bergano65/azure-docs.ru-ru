---
title: Хранение настроек пользователя
titleSuffix: Azure Cognitive Services
description: В этой статье будет показано, как сохранить предпочтения пользователя.
author: metanMSFT
manager: guillasi
ms.service: cognitive-services
ms.subservice: immersive-reader
ms.topic: conceptual
ms.date: 06/29/2020
ms.author: metan
ms.openlocfilehash: ddae4a99964e438c003fe0ff0db91c5808fa7631
ms.sourcegitcommit: 6a4687b86b7aabaeb6aacdfa6c2a1229073254de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/06/2020
ms.locfileid: "91761113"
---
# <a name="how-to-store-user-preferences"></a>Сохранение настроек пользователя

В этой статье показано, как сохранить параметры пользовательского интерфейса пользователя, формально называемые **пользовательскими настройками**, с помощью параметров пакета SDK " [-Preferences](./reference.md#options) [" и "](./reference.md#options) иммерсивное средство чтения".

Если для параметра пакета SDK [кукиеполици](./reference.md#cookiepolicy-options) задано значение *Enabled*, то приложение для чтения с помощью иммерсивного приложения сохраняет **пользовательские настройки** (размер текста, цвет темы, шрифт и т. д.) в файлах cookie, которые являются локальными для конкретного браузера и устройства. Каждый раз, когда пользователь запускает иммерсивное средство чтения на том же браузере и устройстве, оно открывается с предпочтениями пользователя из последнего сеанса на этом устройстве. Тем не менее, если пользователь открывает иммерсивное средство чтения в другом браузере или устройстве, параметры изначально будут настроены с параметрами иммерсивного модуля чтения, и пользователь должен будет снова задать свои настройки и так далее для каждого используемого устройства. `-preferences` `-onPreferencesChanged` Параметры пакета SDK для чтения и погружения позволяют приложениям перемещать настройки пользователя в различных браузерах и устройствах, чтобы обеспечить согласованную работу пользователей при использовании приложения.

Во-первых, указав `-onPreferencesChanged` параметр пакета SDK для обратного вызова при запуске иммерсивного приложения для чтения, иммерсивное средство чтения будет передавать `-preferences` строку обратно ведущему приложению каждый раз, когда пользователь изменяет свои настройки во время выполнения иммерсивного сеанса чтения. Затем ведущее приложение отвечает за хранение пользовательских настроек в собственной системе. Затем, когда тот же пользователь снова запускает иммерсивное средство чтения, ведущее приложение может получить настройки этого пользователя из хранилища и предоставить его в качестве `-preferences` параметра строки пакета SDK при запуске иммерсивного приложения чтения, чтобы восстановить параметры пользователя.

Эта функция может использоваться в качестве альтернативного способа хранения **пользовательских настроек** в случае, когда использование файлов cookie нежелательно или нецелесообразно.

> [!CAUTION]
> **Важно!** Не пытайтесь программно изменить значения `-preferences` строки, отправленной в иммерсивное приложение чтения и из него, так как это может привести к непредвиденному поведению, что приводит к снижению производительности пользователей. Ведущие приложения никогда не должны назначать строку или управлять ей пользовательским значением `-preferences` . При использовании `-preferences` параметра String используйте только точное значение, возвращенное из `-onPreferencesChanged` параметра обратного вызова.

## <a name="how-to-enable-storing-user-preferences"></a>Как включить сохранение настроек пользователя

параметр [лаунчасинк](./reference.md#launchasync) пакета SDK для иммерсивного чтения `options` содержит `-onPreferencesChanged` обратный вызов. Эта функция будет вызываться каждый раз, когда пользователь изменяет свои настройки. `value`Параметр содержит строку, которая представляет текущие предпочтения пользователя. Затем эта строка сохраняется для этого пользователя ведущим приложением.

```typescript
const options = {
    onPreferencesChanged: (value: string) => {
        // Store user preferences here
    }
};

ImmersiveReader.launchAsync(YOUR_TOKEN, YOUR_SUBDOMAIN, YOUR_DATA, options);
```

## <a name="how-to-load-user-preferences-into-the-immersive-reader"></a>Загрузка пользовательских настроек в иммерсивное средство чтения

Передайте предпочтения пользователя в иммерсивное средство чтения с помощью `-preferences` параметра. Упрощенный пример хранения и загрузки настроек пользователя выглядит следующим образом:

```typescript
const storedUserPreferences = localStorage.getItem("USER_PREFERENCES");
let userPreferences = storedUserPreferences === null ? null : storedUserPreferences;
const options = {
    preferences: userPreferences,
    onPreferencesChanged: (value: string) => {
        userPreferences = value;
        localStorage.setItem("USER_PREFERENCES", userPreferences);
    }
};
```

## <a name="next-steps"></a>Дальнейшие действия

* Ознакомьтесь со справочной документацией по [пакету SDK для иммерсивного средства чтения](./reference.md).