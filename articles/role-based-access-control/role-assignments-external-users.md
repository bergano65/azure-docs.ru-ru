---
title: Управление доступом к ресурсам Azure для внешних гостевых пользователей с помощью RBAC | Документация Майкрософт
description: Узнайте, как с помощью управления доступом на основе ролей (RBAC) управлять доступом к ресурсам Azure для внешних пользователей организации.
services: active-directory
documentationcenter: ''
author: rolyon
manager: mtillman
editor: ''
ms.assetid: ''
ms.service: role-based-access-control
ms.devlang: ''
ms.topic: conceptual
ms.tgt_pltfrm: ''
ms.workload: identity
ms.date: 09/12/2019
ms.author: rolyon
ms.reviewer: skwan
ms.custom: it-pro
ms.openlocfilehash: 12f4b0276074b6732cf57443f51ef5d867f205a6
ms.sourcegitcommit: fbea2708aab06c19524583f7fbdf35e73274f657
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2019
ms.locfileid: "70967344"
---
# <a name="manage-access-to-azure-resources-for-external-guest-users-using-rbac"></a>Управление доступом к ресурсам Azure для внешних гостевых пользователей с помощью RBAC

Управление доступом на основе ролей (RBAC) обеспечивает улучшенное управление безопасностью для крупных организаций, а также для малых и средних предприятий, работающих с внешними участниками совместной работы, поставщиками или Freelancer, которым необходим доступ к конкретным ресурсам в вашей среде, но не обязательно для всей инфраструктуры или областей, связанных с выставлением счетов. Вы можете использовать возможности [Azure Active Directory B2B](../active-directory/b2b/what-is-b2b.md) для совместной работы с внешними гостевыми пользователями. Вы можете использовать RBAC, чтобы предоставить только те разрешения, которые необходимы гостевым пользователям в вашей среде.

## <a name="when-would-you-invite-guest-users"></a>Когда вы приглашаете гостевых пользователей?

Ниже приведено несколько примеров сценариев, когда вы можете пригласить гостевых пользователей в организацию и предоставить разрешения:

- предоставление доступа к ресурсам Azure для определенного проекта внешнему независимому поставщику, у которого есть только учетная запись электронной почты;
- Разрешить внешнему партнеру управлять определенными ресурсами или целой подпиской.
- предоставление доступа к ресурсам Azure инженерам службы поддержки, не входящей в вашу организацию (например, службе поддержки Майкрософт) для устранения неполадок.

## <a name="permission-differences-between-member-users-and-guest-users"></a>Различия в разрешениях между членами группы "пользователи и гости"

Собственные члены каталога (пользователи-члены) имеют разные разрешения, чем пользователи, приглашенные из другого каталога в качестве гостя службы совместной работы B2B (гостевые пользователи). Например, участники могут читать почти все сведения о каталоге, в то время как гостевые пользователи имеют ограниченные разрешения каталога. Дополнительные сведения о пользователях и гостевых пользователях см. [в разделе что такое разрешения пользователей по умолчанию в Azure Active Directory?](../active-directory/fundamentals/users-default-permissions.md).

## <a name="add-a-guest-user-to-your-directory"></a>Добавление гостевого пользователя в каталог

Выполните следующие действия, чтобы добавить гостевого пользователя в каталог с помощью страницы Azure Active Directory.

1. Убедитесь, что параметры внешнего сотрудничества в вашей организации настроены таким образом, что вы можете приглашать гостей. Дополнительные сведения см. в статьях [Включение внешней совместной работы B2B и управление пользователями, которые могут приглашать гостей](../active-directory/b2b/delegate-invitations.md).

1. В портал Azure щелкните **Azure Active Directory** > **Пользователи** > **Новый гостевой пользователь**.

    ![Новый компонент "Гостевой пользователь" в портал Azure](./media/role-assignments-external-users/invite-guest-user.png)

1. Выполните действия, чтобы добавить нового пользователя Guest. Дополнительные сведения см. [в разделе добавление Azure Active Directory пользователей службы совместной работы B2B в портал Azure](../active-directory/b2b/add-users-administrator.md#add-guest-users-to-the-directory).

После добавления гостевого пользователя в каталог вы можете отправить ему прямую ссылку на общее приложение или он может щелкнуть URL-адрес активации в электронном письме с приглашением.

![Приглашение гостевого пользователя отправить сообщение](./media/role-assignments-external-users/invite-email.png)

Чтобы гостевой пользователь мог получить доступ к вашему каталогу, он должен завершить процесс приглашения.

![Разрешения на проверку для приглашения гостевого пользователя](./media/role-assignments-external-users/invite-review-permissions.png)

Дополнительные сведения о процессе приглашения см. в разделе [Azure Active Directory службы совместной работы B2B](../active-directory/b2b/redemption-experience.md).

## <a name="grant-access-to-a-guest-user"></a>Предоставление доступа гостевому пользователю

При использовании RBAC, чтобы предоставить доступ, нужно присвоить роль. Чтобы предоставить доступ гостевому пользователю, выполните [те же действия](role-assignments-portal.md#add-a-role-assignment) , что и для пользователя участника, группы, субъекта-службы или управляемого удостоверения. Выполните следующие действия, чтобы предоставить гостевой пользователю доступ к различным областям.

1. На портале Azure щелкните **Все службы**.

1.  Выберите набор ресурсов, к которым применяется доступ, также называемый областью. Например, можно выбрать **Группы управления**, **Подписки**, **Группы ресурсов** или конкретный ресурс.

1. Щелкните конкретный ресурс.

1. Щелкните **Управление доступом (IAM)** .

    На следующем снимке экрана показан пример колонки управления доступом (IAM) для группы ресурсов. Если вы вносите здесь изменения в контроль доступа, они будут применены только к группе ресурсов.

    ![Колонка "Управление доступом (IAM)" для группы ресурсов](./media/role-assignments-external-users/access-control-resource-group.png)

1. Щелкните вкладку **Назначения ролей**, чтобы просмотреть все назначения ролей в этой области.

1. Щелкните **Добавить** > **Добавить назначение ролей**, чтобы открыть панель Добавить назначение ролей.

    Если у вас нет прав назначать роли, функция "Добавить назначение роли" будет неактивна.

    ![Меню "Добавить"](./media/role-assignments-external-users/add-menu.png)

1. В раскрывающемся списке **Роли** выберите роль, например **Участник виртуальных машин**.

1. В списке **Выбор** выберите гостевой пользователь. Если пользователь не отображается в списке, можно ввести в поле **выбрать** , чтобы найти в каталоге отображаемые имена, адреса электронной почты и идентификаторы объектов.

   ![Область "Добавить назначение ролей"](./media/role-assignments-external-users/add-role-assignment.png)

1. Нажмите кнопку **сохранить** , чтобы назначить роль в выбранной области.

    ![Назначение ролей для участника виртуальной машины](./media/role-assignments-external-users/access-control-role-assignments.png)

## <a name="grant-access-to-a-guest-user-not-yet-in-your-directory"></a>Предоставление доступа к гостевому пользователю еще не в вашем каталоге

При использовании RBAC, чтобы предоставить доступ, нужно присвоить роль. Чтобы предоставить доступ гостевому пользователю, выполните [те же действия](role-assignments-portal.md#add-a-role-assignment) , что и для пользователя участника, группы, субъекта-службы или управляемого удостоверения.

Если гостевой пользователь еще не находится в каталоге, вы можете пригласить пользователя непосредственно из области добавить назначение ролей.

1. На портале Azure щелкните **Все службы**.

1.  Выберите набор ресурсов, к которым применяется доступ, также называемый областью. Например, можно выбрать **Группы управления**, **Подписки**, **Группы ресурсов** или конкретный ресурс.

1. Щелкните конкретный ресурс.

1. Щелкните **Управление доступом (IAM)** .

1. Щелкните вкладку **Назначения ролей**, чтобы просмотреть все назначения ролей в этой области.

1. Щелкните **Добавить** > **Добавить назначение ролей**, чтобы открыть панель Добавить назначение ролей.

    ![Меню "Добавить"](./media/role-assignments-external-users/add-menu.png)

1. В раскрывающемся списке **Роли** выберите роль, например **Участник виртуальных машин**.

1. В списке **Выбор** введите адрес электронной почты пользователя, которого вы хотите пригласить, и выберите этого пользователя.

   ![Приглашение гостевого пользователя в области "Добавление назначения ролей"](./media/role-assignments-external-users/add-role-assignment-new-guest.png)

1. Нажмите кнопку **сохранить** , чтобы добавить гостевого пользователя в каталог, назначить роль и отправить приглашение.

    Через несколько секунд вы увидите уведомление о назначении роли и сведения о приглашении.

    ![Назначение ролей и уведомление приглашаемого пользователя](./media/role-assignments-external-users/invited-user-notification.png)

1. Чтобы вручную пригласить гостевого пользователя, щелкните правой кнопкой мыши и скопируйте ссылку на приглашение в уведомлении. Не щелкайте ссылку приглашения, поскольку она запускает процесс приглашения.

    Ссылка на приглашение будет иметь следующий формат:

    `https://invitations.microsoft.com/redeem/...`

1. Отправьте ссылку на приглашение гостевому пользователю, чтобы завершить процесс приглашения.

    Дополнительные сведения о процессе приглашения см. в разделе [Azure Active Directory службы совместной работы B2B](../active-directory/b2b/redemption-experience.md).

## <a name="remove-a-guest-user-from-your-directory"></a>Удаление гостевого пользователя из каталога

Перед удалением гостевого пользователя из каталога сначала необходимо удалить все назначения ролей для этого гостевого пользователя. Выполните следующие действия, чтобы удалить гостевой пользователь из каталога.

1. Откройте **Управление доступом (IAM)** в области, например в группе управления, подписке, группе ресурсов или ресурсе, где гостевой пользователь имеет назначение ролей.

1. Перейдите на вкладку **назначения ролей** , чтобы просмотреть все назначения ролей.

1. В списке назначений ролей добавьте флажок рядом с гостевым пользователем с назначением роли, которое необходимо удалить.

   ![Удалить назначение роли](./media/role-assignments-external-users/remove-role-assignment-select.png)

1. Нажмите кнопку **Удалить**.

   ![Сообщение об удалении назначения роли](./media/role-assignments-external-users/remove-role-assignment.png)

1. В появившемся сообщении об отзыве назначения роли щелкните **Да**.

1. На панели навигации слева щелкните **Azure Active Directory** > **Пользователи**.

1. Щелкните гостевой пользователь, которого хотите удалить.

1. Нажмите кнопку **Delete**(Удалить).

   ![Удаление гостевого пользователя](./media/role-assignments-external-users/delete-guest-user.png)

1. В появившемся сообщении об удалении нажмите кнопку **Да**.

## <a name="troubleshoot"></a>Устранение неполадок

### <a name="guest-user-cannot-browse-the-directory"></a>Гостевой пользователь не может просматривать каталог

Гостевые пользователи имеют ограниченные разрешения каталога. Например, гостевые пользователи не могут просматривать каталог и не могут искать группы или приложения. Дополнительные сведения см. [в разделе что такое разрешения пользователя по умолчанию в Azure Active Directory?](../active-directory/fundamentals/users-default-permissions.md).

![Гостевой пользователь не может просматривать пользователей в каталоге](./media/role-assignments-external-users/directory-no-users.png)

Если гостевой пользователю требуются дополнительные привилегии в каталоге, можно назначить роль каталога пользователю guest. Если вы действительно хотите, чтобы гостевой пользователь имел полный доступ на чтение каталога, вы можете добавить гостевой пользователь в роль " [читатели каталога](../active-directory/users-groups-roles/directory-assign-admin-roles.md) " в Azure AD. Дополнительные сведения см. [в статье предоставление разрешений пользователям из партнерских организаций в клиенте Azure Active Directory](../active-directory/b2b/add-guest-to-role.md).

![Назначение роли читателей каталога](./media/role-assignments-external-users/directory-roles.png)

### <a name="guest-user-cannot-browse-users-groups-or-service-principals-to-assign-roles"></a>Гостевой пользователь не может просматривать пользователей, группы или субъекты-службы для назначения ролей

Гостевые пользователи имеют ограниченные разрешения каталога. Даже если гостевой пользователь является [владельцем](built-in-roles.md#owner) области, при попытке создать назначение роли для предоставления другому пользователю доступа он не сможет просматривать список пользователей, групп или субъектов-служб.

![Гостевой пользователь не может просматривать субъекты безопасности для назначения ролей](./media/role-assignments-external-users/directory-no-browse.png)

Если гостевой пользователь знает точное имя входа в каталог, он может предоставить доступ. Если вы действительно хотите, чтобы гостевой пользователь имел полный доступ на чтение каталога, вы можете добавить гостевой пользователь в роль " [читатели каталога](../active-directory/users-groups-roles/directory-assign-admin-roles.md) " в Azure AD. Дополнительные сведения см. [в статье предоставление разрешений пользователям из партнерских организаций в клиенте Azure Active Directory](../active-directory/b2b/add-guest-to-role.md).

### <a name="guest-user-cannot-register-applications-or-create-service-principals"></a>Гостевой пользователь не может зарегистрировать приложения или создать субъект-службу

Гостевые пользователи имеют ограниченные разрешения каталога. Если гостевой пользователь должен иметь возможность регистрировать приложения или создавать субъекты-службы, вы можете добавить гостевого пользователя в роль [разработчика приложения](../active-directory/users-groups-roles/directory-assign-admin-roles.md) в Azure AD. Дополнительные сведения см. [в статье предоставление разрешений пользователям из партнерских организаций в клиенте Azure Active Directory](../active-directory/b2b/add-guest-to-role.md).

![Гостевой пользователь не может зарегистрировать приложения](./media/role-assignments-external-users/directory-access-denied.png)

### <a name="guest-user-does-not-see-the-new-directory"></a>Гостевой пользователь не увидит новый каталог

Если гостевой пользователь предоставил доступ к каталогу, но не увидит новый каталог, указанный в портал Azure при попытке переключения на панель **каталог и подписка** , убедитесь, что гостевой пользователь завершил процесс приглашения. Дополнительные сведения о процессе приглашения см. в разделе [Azure Active Directory службы совместной работы B2B](../active-directory/b2b/redemption-experience.md).

### <a name="guest-user-does-not-see-resources"></a>Гостевой пользователь не увидит ресурсы

Если гостевой пользователь предоставил доступ к каталогу, но он не увидит ресурсы, к которым им был предоставлен доступ, в портал Azure убедитесь, что гостевой пользователь выбрал правильный каталог. Гостевой пользователь может иметь доступ к нескольким каталогам. Чтобы переключиться на каталоги, в верхнем левом углу щелкните **Каталог + подписка**, а затем выберите соответствующий каталог.

![Панель "каталоги и подписки" в портал Azure](./media/role-assignments-external-users/directory-subscription.png)

## <a name="next-steps"></a>Следующие шаги

- [Add Azure Active Directory B2B collaboration users in the Azure portal](../active-directory/b2b/add-users-administrator.md) (Добавление пользователей службы совместной работы Azure Active Directory B2B на портале Azure)
- [Основные свойства пользователя службы совместной работы Azure AD B2B](../active-directory/b2b/user-properties.md)
- [Элементы электронной почты с приглашением службы совместной работы B2B — Azure Active Directory](../active-directory/b2b/invitation-email-elements.md)