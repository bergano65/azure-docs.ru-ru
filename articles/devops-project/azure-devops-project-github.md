---
title: Руководство. Создание конвейера CI/CD для существующего кода с помощью Azure DevOps Projects
description: Azure DevOps Projects помогает быстро приступить к работе с Azure. С помощью DevOps Projects вы можете использовать собственный код и репозиторий GitHub для запуска приложения в выбранной службе Azure за несколько простых шагов.
services: vsts
documentationcenter: vs-devops-build
ms.author: mlearned
ms.manager: douge
editor: ''
ms.assetid: ''
ms.workload: web
ms.prod: devops
ms.technology: devops-cicd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 07/09/2018
author: mlearned
ms.custom: mvc
monikerRange: vsts
ms.openlocfilehash: 88ee15a3b5cc53542d9e098dee485b8a526bb9a6
ms.sourcegitcommit: ebf2f2fab4441c3065559201faf8b0a81d575743
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2018
ms.locfileid: "52161760"
---
# <a name="tutorial-create-a-cicd-pipeline-for-your-existing-code-by-using-azure-devops-projects"></a>Руководство. Создание конвейера CI/CD для существующего кода с помощью Azure DevOps Projects

Azure DevOps Projects представляет собой упрощенный интерфейс, который позволяет добавить существующий код и репозиторий Git либо выбрать пример приложения, чтобы создать конвейер непрерывной интеграции (CI) и непрерывной поставки (CD) в Azure.

Вы сможете выполнять следующие задачи:

> [!div class="checklist"]
> * создание конвейера CI/CD с помощью DevOps Projects;
> * настройка доступа к репозиторию GitHub и выбор платформы;
> * настройка Azure DevOps и подписки Azure; 
> * фиксация изменений в GitHub и их автоматическое развертывание в Azure;
> * изучение конвейера CI/CD в Azure Pipelines;
> * настройка мониторинга Azure Application Insights;
> * очистка ресурсов.

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Вы можете получить бесплатную подписку с помощью [Visual Studio Dev Essentials](https://visualstudio.microsoft.com/dev-essentials/).
* Доступ к GitHub или внешнему репозиторию Git, содержащему код .NET, Java, PHP, Node, Python или статический веб-код.

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Azure DevOps Projects создает конвейер CI/CD в Azure Pipelines. Вы можете создать новую организацию Azure DevOps или использовать существующую. Azure DevOps Projects также создает ресурсы Azure в требуемой подписке Azure.

1. Войдите на [портале Azure](https://portal.azure.com).

1. В области слева выберите **Создать**.

1. В поле поиска введите **DevOps Projects**, а затем выберите **Создать**.

    ![Панель мониторинга DevOps Projects](_img/azure-devops-project-github/fullbrowser.png)

1. Выберите **Добавьте свой код** и нажмите кнопку **Далее**.

## <a name="configure-access-to-your-github-repo-and-choose-a-framework"></a>Настройка доступа к репозиторию GitHub и выбор платформы

1. Щелкните **GitHub** или "Внешний Git", а затем выберите репозиторий и ветвь, содержащую ваше приложение.

1. Выберите веб-платформу и нажмите кнопку **Далее**.

    ![Платформа .NET](_img/azure-devops-project-github/webframework.png)

    Платформа приложения, которую вы выбрали ранее, определяет доступный тип объекта развертывания в службе Azure. 
    
1. Выберите целевую службу и нажмите кнопку **Далее**.

## <a name="configure-azure-devops-and-an-azure-subscription"></a>Настройка Azure DevOps и подписки Azure 

1. Создайте новую организацию Azure DevOps или выберите существующую.

    a. Задайте имя проекта в Azure DevOps. 
    
    b. Выберите подписку Azure и расположение, введите имя приложения и нажмите кнопку **Готово**.

    Через несколько минут панель мониторинга DevOps Projects отобразится на портале Azure. Пример приложения настраивается в репозитории в организации Azure DevOps, после чего выполняется сборка и развертывание приложения в Azure. На этой панели мониторинга отображаются сведения о репозитории кода GitHub, конвейере CI/CD и приложении в Azure. 
    
1. Выберите **Обзор**, чтобы просмотреть выполняющееся приложение.

    ![Представление панели мониторинга DevOps Projects](_img/azure-devops-project-github/dashboardnopreview.png) 
    
Azure DevOps Projects автоматически настраивает сборку непрерывной интеграции и триггер выпуска. Код остается в репозитории GitHub или другом внешнем репозитории. 

## <a name="commit-changes-to-github-and-automatically-deploy-them-to-azure"></a>Фиксация изменений в GitHub и их автоматическое развертывание в Azure 

Теперь вы готовы к совместной работе над приложением с использованием процесса CI/CD, который позволяет автоматически развернуть последние результаты работы на веб-сайте. При каждом изменении в репозитории GitHub запускается сборка в Azure DevOps, и конвейер CD выполняет развертывание в Azure.

1. Внесите изменения в приложение и зафиксируйте их в репозитории GitHub.  
    Через несколько секунд в Azure Pipelines начнется выполнение сборки. Состояние сборки вы можете отслеживать на панели мониторинга DevOps Projects или в браузере в организации Azure DevOps.

1. После завершения сборки обновите приложение, чтобы проверить внесенные изменения.

## <a name="examine-the-azure-pipelines-cicd-pipeline"></a>Изучение конвейера CI/CD в Azure Pipelines

Azure DevOps Projects автоматически настраивает конвейер CI/CD в Azure Pipelines. При необходимости изучите и настройте конвейер. Чтобы составить представление о конвейерах сборки и выпуска, сделайте следующее:

1. В верхней части панели мониторинга DevOps Projects выберите **Конвейеры сборки**.  
    На вкладке браузера отобразится конвейер сборки нового проекта.

1. Выберите поле **Состояние** и щелкните значок многоточия (…).  
    В появившемся меню содержится несколько пунктов, таких как постановка в очередь новой сборки, приостановка сборки и изменение конвейера сборки.

1. Выберите **Изменить**

1. В этой области можно просмотреть различные задачи для конвейера сборки.  
    Конвейер сборки выполняет различные задачи, такие как получение источников из репозитория Git, восстановление зависимостей и публикация результатов, используемых для развертывания.

1. Выберите имя конвейера сборки в верхней части соответствующей области.

1. Замените имя конвейера сборки более понятным для себя, выберите **Сохранить и поместить в очередь** и нажмите кнопку **Сохранить**.

1. Под именем конвейера сборки щелкните **Журнал**.  
    Вы увидите журнал аудита последних изменений сборки. Azure DevOps отслеживает все изменения, внесенные в конвейер сборки, и позволяет сравнивать версии.

1. Выберите **Триггеры**.  
    Azure DevOps Projects автоматически создает триггер CI, а каждая фиксация в репозитории создает новую сборку. При необходимости выберите для процесса непрерывной интеграции включение или исключение ветвей.

1. Щелкните **Период удержания**.  
        В зависимости от сценария можно указать политики для хранения или удаления определенного количества сборок.

1. Выберите **Сборка и выпуск**, а затем щелкните **Выпуски**.  
    Azure DevOps Projects создает конвейер выпуска для управления развертываниями в Azure.

1. Щелкните многоточие (…) рядом с конвейером выпуска и выберите **Изменить**.  
    Конвейер выпуска содержит *конвейер*, в котором определен процесс выпуска. 
    
1. В разделе **Артефакты** выберите **Удалить**.  
    Конвейер сборки, который вы изучали на предыдущих этапах, создаст выходные данные для артефакта. 

1. Рядом со значком **Удалить** выберите **Триггер непрерывного развертывания**.  
    Этот выпуск конвейера содержит триггер непрерывного развертывания, выполняющий развертывание каждый раз, когда становится доступным новый артефакт сборки. При желании можно отключить триггер, чтобы выполнить развертывание вручную. 

1. В области слева выберите **Задачи**.  
    Задачи — это действия, которые выполняются в процессе развертывания. В этом примере задача заключается в развертывании в Службе приложений Azure.

1. В области справа выберите **Просмотреть выпуски**, чтобы отобразить журнал выпусков.

1. Щелкните многоточие (…) рядом с конвейером выпуска и выберите **Открыть**.  
    В этом представлении доступно несколько меню, например меню сводки по выпуску, меню связанных рабочих элементов и тестов.

1. Щелкните **Фиксации**.  
    В этом представлении отображаются фиксации кода, связанные с этим развертыванием. 

1. Выберите **Журналы**.  
    Журналы содержат полезную информацию о процессе развертывания. Их можно просматривать во время и после развертывания.

## <a name="configure-azure-application-insights-monitoring"></a>Настройка мониторинга Azure Application Insights

С помощью Azure Application Insights можно легко отслеживать производительность и использование своего приложения. Azure DevOps Projects автоматически настраивает ресурс Application Insights для вашего приложения. Вы можете дополнительно настроить различные предупреждения и возможности мониторинга по мере необходимости.

1. На портале Azure перейдите к панели мониторинга DevOps Projects. 

1. В правом нижнем углу щелкните ссылку **Application Insights** для вашего приложения.  
    Откроется панель **Application Insights**. Это представление содержит информацию об использовании, производительности и доступности приложения.

    ![Панель Application Insights](_img/azure-devops-project-github/appinsights.png) 

1. Щелкните **Диапазон времени**, а затем выберите **За последний час**. Щелкните **Обновить**, чтобы отфильтровать результаты.  
    Теперь вы можете просмотреть все действия за последние 60 минут. Чтобы закрыть представление диапазона времени, щелкните **x**.

1. Выберите **Оповещения** и щелкните **Добавить оповещение метрики**. 

1. Введите имя оповещения.

1. В раскрывающемся списке **Source Alter on** (Изменить источник) выберите **App Service resource** (Ресурс Службы приложений). <!-- Please confirm whether this should be "Source Alter on" or "Source Alert on" -->

1. В раскрывающемся списке **Метрика** просмотрите различные оповещения метрик.  
    По умолчанию оповещение отображается, если **время отклика сервера превышает 1 секунду**. Различные оповещения можно легко настроить, чтобы улучшить возможности мониторинга приложения.

1. Установите флажок **Notify via Email owners, contributors, and readers** (Уведомлять по электронной почте владельцев, участников и читателей).  
    При желании вы можете выполнять дополнительные действия, когда срабатывает оповещение, реализовав приложение логики в Azure.

1. Нажмите кнопку **ОК**, чтобы создать оповещение.  
    Через несколько секунд предупреждение появится на панели мониторинга как активное.
    
1. Выйдите из области **оповещений** и вернитесь на панель **Application Insights**.

1. Выберите **Доступность**, а затем щелкните **Добавить тест**. 

1. Введите имя теста и нажмите кнопку **Создать**.  
    Создается простой тест проверки связи для проверки доступности вашего приложения. Через несколько минут результаты тестирования будут доступны, а на панели мониторинга Application Insights отобразится состояние доступности.

## <a name="clean-up-resources"></a>Очистка ресурсов

Службу приложений Azure и связанные с ней ресурсы, созданные при работе с этим руководством, можно удалить, если они больше не нужны. Для этого воспользуйтесь функцией **Удалить** на панели мониторинга DevOps Projects.

## <a name="next-steps"></a>Дополнительная информация

После настройки процесса CI/CD с помощью этого руководства в Azure DevOps Projects автоматически создается конвейер сборки и выпуска. Вы можете изменить эти конвейеры сборки и выпуска в соответствии с потребностями вашей команды. Вы научились выполнять следующие задачи:

> [!div class="checklist"]
> * создание конвейера CI/CD с помощью DevOps Projects;
> * настройка доступа к репозиторию GitHub и выбор платформы;
> * настройка Azure DevOps и подписки Azure; 
> * фиксация изменений в GitHub и их автоматическое развертывание в Azure;
> * изучение конвейера CI/CD в Azure Pipelines;
> * настройка мониторинга Azure Application Insights;
> * очистка ресурсов.

Дополнительные сведения о конвейере CI/CD

> [!div class="nextstepaction"]
> [Define your multi-stage continuous deployment (CD) pipeline](https://docs.microsoft.com/azure/devops/pipelines/release/define-multistage-release-process?view=vsts) (Настройка многоэтапного конвейера для непрерывного развертывания)
