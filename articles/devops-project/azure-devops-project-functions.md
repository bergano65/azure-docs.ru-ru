---
title: Руководство по Развертывание приложений ASP.NET в Функциях Azure с помощью Azure DevOps Starter
description: Служба Azure DevOps Starter позволяет быстро приступить к работе с Azure. С помощью DevOps Starter вы можете развернуть приложение ASP.NET в Функциях Azure, выполнив несколько быстрых действий.
ms.author: mlearned
ms.manager: gwallace
ms.prod: devops
ms.technology: devops-cicd
ms.topic: tutorial
ms.date: 03/24/2020
author: mlearned
ms.custom: devx-track-csharp
ms.openlocfilehash: 3277fefb5615fd492b2859b741ef8e6f991eaf23
ms.sourcegitcommit: d95cab0514dd0956c13b9d64d98fdae2bc3569a0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2020
ms.locfileid: "91355480"
---
# <a name="deploy-to-azure-functions-with-devops-starter"></a>Развертывание в Функциях Azure с помощью DevOps Starter

Azure DevOps Starter — это упрощенный интерфейс, который позволяет добавить существующий код и репозиторий Git либо выбрать пример приложения, чтобы создать конвейер непрерывной интеграции (CI) и непрерывной поставки (CD) в Azure.

Кроме того, DevOps Starter может выполнять следующие задачи:

* автоматически создавать ресурсы Azure, например Функции Azure;

* создавать и настраивать конвейер выпуска в Azure DevOps для CI/CD.

Выполняя данное руководство, вы сделаете следующее:

> [!div class="checklist"]
>* развернете приложение ASP.NET в Функциях Azure с помощью DevOps Starter;
>* настройка Azure DevOps и подписки Azure;
>* изучать Функции Azure;
>* Просмотр конвейера CI
>* Просмотр конвейера CD
>* фиксация изменений в Git и их автоматическое развертывание в Azure;
>* Очистка ресурсов

В настоящее время поддерживаемыми средами выполнения для функций являются **.NET** и **Node.js**. Мы используем среду выполнения .NET в этом руководстве, чтобы выполнить развертывание в Функции Azure. 

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Вы можете получить бесплатную подписку с помощью [Visual Studio Dev Essentials](https://visualstudio.microsoft.com/dev-essentials/)

## <a name="use-devops-starter-to-deploy-an-aspnet-app-to-azure-functions"></a>Использование DevOps Starter для развертывания приложения ASP.NET в Функциях Azure

DevOps Starter позволяет создать конвейер CI/CD в Azure Pipelines. Вы можете создать новую организацию Azure DevOps или использовать существующую. DevOps Projects также создает ресурсы Azure, такие как Интернет вещей, в нужной подписке Azure.

1. Войдите на [портал Azure](https://portal.azure.com)

1. В поле поиска введите **DevOps Starter**, а затем выберите ресурс. Щелкните **Добавить**, чтобы создать новый ресурс.

    ![Панель мониторинга DevOps Starter](_img/azure-devops-starter-aks/search-devops-starter.png)

1. Выберите **.NET**, а затем **Далее**. В поле **Выбор исполняющей среды** выберите **ASP.NET** и кликните на **Далее**.

1. Выберите **Приложение-функция**, а затем нажмите кнопку **Далее**.

## <a name="configure-azure-devops-and-azure-subscription"></a>Настройка Azure DevOps и подписки Azure

1. Задайте имя проекта Azure DevOps.

1. Создайте новую организацию Azure DevOps или выберите существующую.

1. Выберите подписку Azure.

1. Чтобы просмотреть дополнительные параметры конфигурации Azure, а также определить ценовую категорию и расположение, щелкните **Дополнительные параметры**. В этой области отображаются параметры для настройки ценовой категории и расположения служб Azure.

1. Выйдите из области конфигурации Azure и щелкните **Готово**.

1. Через несколько минут процесс будет завершен. Пример приложения ASP.NET настраивается в репозитории Git в вашей организации Azure DevOps, создается приложение-функция и Application Insights, выполняется CI/CD конвейер, и ваше приложение устанавливается в Azure.

   После завершения процесса на портале Azure отобразится панель мониторинга Azure DevOps Starter. Кроме того, вы можете перейти к панели мониторинга DevOps Starter непосредственно на вкладке **Все ресурсы** на портале Azure.

   Панель мониторинга позволяет просматривать репозиторий кода Azure DevOps, конвейер CI/CD и Функцию Azure. В конвейере Azure DevOps можно настроить дополнительные параметры CI/CD. Справа выберите **Приложение-функция** для просмотра.

## <a name="examine-the-function-app"></a>Анализ приложения-функция

Служба DevOps Starter автоматически настраивает приложение-функцию, которое можно просмотреть и настроить. Чтобы получить сведения о приложение-функции, выполните следующие действия.

1. Перейдите к панели мониторинга DevOps Starter.

    ![Панель мониторинга DevOps Projects](_img/azure-devops-project-functions/fapp-dashboard.png)

1. В правой части выберите приложение-функцию. Откроется область для приложения-функции. В этом представлении можно выполнять различные действия, такие как мониторинг операций, поиск в журналах.

    ![Приложение-функция](_img/azure-devops-project-functions/function-app.png)

## <a name="examine-the-ci-pipeline"></a>Просмотр конвейера CI

DevOps Starter автоматически настраивает конвейер CI/CD в вашей организации Azure DevOps. Вы можете изучить и настроить конвейер. Для этого сделайте следующее:

1. Перейдите к панели мониторинга DevOps Starter.

1. Щелкните гиперссылку в разделе **Сборка**. На вкладке браузера отобразится конвейер сборки нового проекта.

    ![Снимок экрана: панель мониторинга DevOps Starter на портале Azure, где стрелка указывает на ссылку в разделе "Сборка"](_img/azure-devops-project-functions/build.png)

1. Выберите команду **Изменить**. В этой области можно просмотреть различные задачи для конвейера сборки. Сборка выполняет различные задачи, такие как выборка исходного кода из репозитория Git, сборка приложения, выполнение модульных тестов и публикация выходных данных, используемых для развертываний.

1. Выберите **Триггеры**. DevOps Starter автоматически создает триггер CI, а при каждой фиксации в репозитории запускается новая сборка. При необходимости выберите для процесса непрерывной интеграции включение или исключение ветвей.

1. Щелкните **Период удержания**. В зависимости от сценария можно указать политики для хранения или удаления определенного количества сборок.

1. Выберите имя конвейера сборки в верхней части соответствующей области.

1. Замените имя конвейера сборки более понятным для себя, и затем выберите **Сохранить** из раскрывающегося меню **Save & queue** (Сохранить и поместить в очередь).

1. Под именем конвейера сборки щелкните **Журнал**. В этой области отображается журнал аудита последних изменений сборки. Azure DevOps отслеживает все изменения, внесенные в конвейер сборки и позволяет сравнивать версии.

## <a name="examine-the-cd-release-pipeline"></a>Просмотр конвейера выпуска CD

DevOps Starter автоматически создает и настраивает необходимые шаги для развертывания из вашей организации Azure DevOps в подписке Azure. Эти шаги включают настройку подключения к службе Azure для аутентификации Azure DevOps в подписке Azure. Также автоматически создается конвейер выпуска, обеспечивающий непрерывное развертывание в Azure. Чтобы получить дополнительные сведения о конвейере выпуска, сделайте следующее:

1. Перейдите к **Конвейеры | Выпуски**.

1. Щелкните **Edit** (Редактировать).

1. В разделе **Артефакты** выберите **Удалить**. Конвейер сборки, который вы изучали на предыдущих этапах, создаст выходные данные для артефакта.

1. Справа от значка **Удалить** выберите **Триггер непрерывного развертывания**. В этом конвейере выпуска активирован триггер непрерывного развертывания, выполняющий развертывание каждый раз, когда становится доступным новый артефакт сборки. При желании можно отключить триггер, чтобы выполнить развертывание вручную.

1. В области справа выберите **Просмотреть выпуски**, чтобы отобразился журнал выпусков.

1. Щелкните выпуск, в котором будет отображаться конвейер. Нажмите на любую среду, чтобы проверить выпуск **Сводка, Фиксация** связанные с **Рабочие элементы**.

1. Щелкните **Фиксации**. В этом представлении отображаются фиксации кода, связанные с текущим развертыванием. Сравните выпуски, чтобы просмотреть различия между развертываниями.

1. Выберите **Просмотр журналов**. Журналы содержат полезную информацию о процессе развертывания. Их можно просматривать во время и после развертывания.

## <a name="commit-code-changes-and-execute-cicd"></a>Фиксация изменений, внесенных в код, и выполнение CI/CD

> [!NOTE]
> Ниже описана процедура для проверки конвейера CI/CD путем простого изменения текста.

Теперь вы готовы к совместной работе над приложением с использованием процесса CI/CD для автоматического развертывания последних результатов работы на вашей функции Azure. При каждом изменении в репозитории Git запускается сборка в Azure DevOps и конвейер CD выполняет развертывание в Azure. Используйте описанную в этом разделе процедуру или другой метод, чтобы зафиксировать изменения в репозитории. Например, можно скопировать репозиторий Git в предпочитаемое вами средство или интегрированную среду разработки, а затем отправить изменения в этот репозиторий.

1. В меню Azure DevOps последовательно выберите **Репозитории | Файлы** и затем перейдите к репозиторию.

1. Репозиторий уже содержит код для модуля названный **SampleFunctionApp**, основанный на языке приложения, выбранного в процессе создания. Откройте файл **Application/SampleFunctionApp/Function1.cs**.

1. Выберите **Редактировать** и внесите изменения в **строку 31**. Например, вы можете обновить его, чтобы увидеть **Hello there! Welcome to Azure Functions using DevOps Starter** (Привет! Добро пожаловать в Функции Azure с помощью DevOps Starter).

1. В правом верхнем углу выберите **Зафиксировать**, после чего снова нажмите **Зафиксировать**, чтобы отправить изменения.

1. Откройте файл **Application/SampleFunctionApp.Test/Function1TestRunner.cs**. 

1. Выберите **Редактировать** и внесите изменения в **строку 21**. Например, вы можете обновить его, чтобы увидеть **Hello there! Welcome to Azure Functions using Azure DevOps Starter** (Привет! Добро пожаловать в Функции Azure с помощью Azure DevOps Starter).

     Через несколько секунд начнется процесс сборки в Azure DevOps, после чего будет выполнена операция выпуска для развертывания изменений. Вы можете отслеживать состояние сборки на панели мониторинга DevOps Starter или в браузере в своей организации Azure DevOps.

## <a name="clean-up-resources"></a>Очистка ресурсов

Вы можете удалить связанные ресурсы, которые вы создали, когда они больше не нужны. Воспользуйтесь функцией **Удалить** на панели мониторинга DevOps Starter.

## <a name="next-steps"></a>Дальнейшие действия

Вы можете по желанию изменить эти конвейеры сборки и выпуска в соответствии с потребностями вашей команды. Вы также можете использовать этот шаблон CI/CD в качестве шаблона для других конвейеров. В этом руководстве вы узнали, как выполнять следующие задачи:

> [!div class="checklist"]
> * использовать DevOps Starter для развертывания приложения ASP.NET Core в Функциях Azure;
> * настройка Azure DevOps и подписки Azure; 
> * изучать Функции Azure;
> * Просмотр конвейера CI
> * Просмотр конвейера CD
> * фиксация изменений в Git и их автоматическое развертывание в Azure;
> * Очистка ресурсов

