---
title: Создание и запуск заданий в приложении Azure IoT Central | Документация Майкрософт
description: Задания IoT Central Azure позволяют выполнять дополнительные функции управления устройствами, такие как обновление свойств или выполнение команды.
ms.service: iot-central
services: iot-central
author: philmea
ms.author: philmea
ms.date: 09/30/2020
ms.topic: how-to
ms.openlocfilehash: b8106c154a91d1e823a124a90f7571b7f52ae8cb
ms.sourcegitcommit: c157b830430f9937a7fa7a3a6666dcb66caa338b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "94682155"
---
# <a name="create-and-run-a-job-in-your-azure-iot-central-application"></a>Создание и выполнение задания в приложении IoT Central Azure

Вы можете использовать IoT Central Azure для управления подключенными устройствами в масштабных заданиях. Задания позволяют выполнять групповые обновления свойств устройства и облака, а также выполнять команды. В этой статье показано, как приступить к работе с заданиями в собственном приложении.

## <a name="create-and-run-a-job"></a>Создание и запуск заданий

В следующем примере показано, как создать и запустить задание, чтобы задать пороговое значение освещения для группы устройств шлюза логистической цепочки. Мастер заданий используется для создания и запуска заданий. Вы можете сохранить задание для последующего выполнения.

1. На левой панели выберите **задания**.

1. Выберите **+ создать задание**.

1. На странице **Настройка задания** введите имя и описание, чтобы определить создаваемое задание.

1. Выберите группу целевых устройств, к которой должно применяться задание. Вы можете увидеть, сколько устройств использует конфигурация задания под выбранной **группой устройств** .

1. Выберите **свойство облака**, **свойство** или **команду** в качестве **типа задания**:

    Чтобы настроить задание **Свойства** , выберите свойство и задайте его новое значение. Чтобы настроить **командное** задание, выберите команду для выполнения. Задание свойства может задавать несколько свойств.

    :::image type="content" source="media/howto-run-a-job/configure-job.png" alt-text="Снимок экрана, на котором показаны параметры для создания задания свойства с именем &quot;задать освещение&quot;":::

    Выберите **сохранить и выйти** , чтобы добавить задание в список сохраненных заданий на странице **задания** . Позже можно вернуться к заданию из списка сохраненных заданий.

1. Нажмите кнопку **Далее** , чтобы перейти на страницу **Параметры доставки** . Страница **Параметры доставки** позволяет задать параметры доставки для этого задания: **пакеты** и **пороговое значение отмены**.

    Пакеты позволяют разрешать задания для большого количества устройств. Задание делится на несколько пакетов, и каждый пакет содержит подмножество устройств. Пакеты помещаются в очередь и выполняются последовательно.

    Порог отмены позволяет автоматически отменить задание, если число ошибок превышает установленный предел. Пороговое значение может применяться ко всем устройствам в задании или к отдельным пакетам.

    :::image type="content" source="media/howto-run-a-job/job-wizard-delivery-options.png" alt-text="Снимок экрана: страница параметров доставки мастера заданий":::

1. Нажмите кнопку **Далее** , чтобы перейти на страницу **Расписание** . На странице **Расписание** можно включить расписание выполнения задания в будущем.

    Выберите параметр повторения для расписания. Вы можете настроить задание для выполнения:

    * Однократно
    * Ежедневно
    * Weekly (Еженедельно);

    Задайте дату и время начала запланированного задания. Дата и время зависят от часового пояса, а не местного времени устройства.

    Чтобы завершить повторяющееся расписание, выберите:

    * В **этот день** , чтобы задать дату окончания для расписания.
    * **Чтобы задать** количество запусков задания, выполните указанные выше значения.

    Запланированные задания всегда выполняются на устройствах в группе устройств, даже если во время изменения членства в группе устройств.

    :::image type="content" source="media/howto-run-a-job/job-wizard-schedule.png" alt-text="Снимок экрана: страница параметров расписания мастера заданий":::

1. Нажмите кнопку **Далее** , чтобы перейти на страницу **Проверка** . На странице " **Проверка** " отображаются сведения о конфигурации задания. Выберите **Расписание** , чтобы запланировать задание:

    :::image type="content" source="media/howto-run-a-job/job-wizard-schedule-review.png" alt-text="Снимок экрана страницы проверки мастера запланированных заданий":::

1. На странице сведения о задании отображаются сведения о запланированных заданиях. При выполнении запланированного задания отображается список экземпляров задания. Запланированное выполнение задания также является частью **последнего 30-дневного** списка заданий.

    На этой странице можно **отменять** **Расписание** задания или изменять запланированное задание. Вы можете вернуться к запланированному заданию из списка запланированных заданий.

    :::image type="content" source="media/howto-run-a-job/job-schedule-details.png" alt-text="Снимок экрана со страницей сведений о запланированном задании":::

1. В мастере заданий можно выбрать не планировать задание и запустить его немедленно. На следующем снимке экрана показано задание без расписания, готового к запуску немедленно. Выберите **выполнить** , чтобы запустить задание:

    :::image type="content" source="media/howto-run-a-job/job-wizard-schedule-immediate.png" alt-text="Снимок экрана: страница проверки мастера заданий":::

1. Задание проходит через *отложенные*, *выполняющиеся* и *Завершенные* этапы. Сведения о выполнении задания содержат метрики результата, сведения о длительности и сетку списка устройств.

    После завершения задания можно выбрать **журнал результатов** , чтобы скачать CSV-файл сведений о задании, включая устройства и их значения состояния. Эти сведения могут быть полезны для устранения неполадок.

    :::image type="content" source="media/howto-run-a-job/download-details.png" alt-text="Снимок экрана, отображающий состояние устройства":::

1. Теперь задание отображается в списке **последних 30 дней** на странице **задания** . На этой странице отображаются текущие выполняемые задания и журнал всех ранее выполненных или сохраненных заданий.

    > [!NOTE]
    > Вы можете просмотреть историю ранее выполненных заданий в течение 30 дней.

## <a name="manage-jobs"></a>Управление заданиями

Чтобы прерывать выполнение задания, откройте его и выберите пункт " **Закрыть**". Состояние задания изменяется в соответствии с тем, что задание остановлено. В разделе " **Сводка** " показано, какие устройства были завершены, завершились с ошибками или все еще ожидаются.

:::image type="content" source="media/howto-run-a-job/manage-job.png" alt-text="Снимок экрана, на котором показано выполняющееся задание и кнопка для остановки задания":::

Если задание находится в остановленном состоянии, можно нажать кнопку **продолжить** , чтобы возобновить выполнение задания. Состояние задания изменяется в соответствии с тем, что задание теперь запускается снова. В разделе " **Сводка** " продолжается обновление с учетом последнего хода выполнения.

:::image type="content" source="media/howto-run-a-job/stopped-job.png" alt-text="Снимок экрана, на котором показано остановленное задание и кнопка для продолжения задания":::

## <a name="copy-a-job"></a>Копирование задания

Чтобы скопировать существующее задание, выберите выполненное задание. На странице "результаты задания" или "сведения о заданиях" выберите **Копировать** .

:::image type="content" source="media/howto-run-a-job/job-details-copy.png" alt-text="Снимок экрана, на котором изображена кнопка копирования":::

Будет открыта копия конфигурации задания для изменения, а **копирование** добавляется к имени задания.

## <a name="view-job-status"></a>Просмотр состояния задания

После создания задания в столбце **состояние** обновляется Последнее сообщение о состоянии задания. В следующей таблице перечислены возможные значения *состояния задания* .

| Сообщение о состоянии       | Значение состояния                                          |
| -------------------- | ------------------------------------------------------- |
| Завершено            | Это задание запущено на всех устройствах.              |
| Сбой               | Это задание завершилось сбоем и не было полностью запущено на устройствах.  |
| Ожидает              | Это задание еще не запущено на устройствах.         |
| Запущен              | Это задание в настоящее время выполняется на устройствах.             |
| Остановлена              | Пользователь вручную остановил это задание.           |
| Отменено             | Это задание было отменено, так как было превышено пороговое значение на странице **параметров доставки** . |

После сообщения о состоянии следует обзор устройств в задании. В следующей таблице перечислены возможные значения *состояния устройства* .

| Сообщение о состоянии       | Значение состояния                                                     |
| -------------------- | ------------------------------------------------------------------ |
| Выполнено            | Число устройств, на которых успешно выполнялось задание.       |
| Сбой               | Число устройств, на которых не удалось запустить задание.       |

Чтобы просмотреть состояние задания и всех затронутых устройств, откройте задание. Рядом с каждым именем устройства отображается одно из следующих сообщений о состоянии:

| Сообщение о состоянии       | Значение состояния                                                                |
| -------------------- | ----------------------------------------------------------------------------- |
| Завершено            | Задание запущено на этом устройстве.                                     |
| Сбой               | Не удалось запустить задание на этом устройстве. В сообщении об ошибке содержатся дополнительные сведения.  |
| Ожидает              | Задание еще не запущено на этом устройстве.                                   |

Чтобы скачать CSV-файл, содержащий сведения о задании, а также список устройств и их значения состояния, выберите **журнал результатов**.

## <a name="filter-the-device-list"></a>Фильтрация списка устройств

Вы можете отфильтровать список устройств на странице **сведений о задании** , щелкнув значок фильтра. Можно выполнить фильтрацию по полю Идентификатор или **состояние** **устройства** :

:::image type="content" source="media/howto-run-a-job/filter.png" alt-text="Снимок экрана, на котором показаны параметры фильтрации списка устройств.":::

## <a name="customize-columns-in-the-device-list"></a>Настройка столбцов в списке устройств

Вы можете добавить столбцы в список устройств, выбрав значок Параметры столбца:

:::image type="content" source="media/howto-run-a-job/column-options.png" alt-text="Снимок экрана, на котором показан значок параметров столбца.":::

Используйте диалоговое окно **Параметры столбца** для выбора столбцов списка устройств. Выберите столбцы, которые необходимо отобразить, щелкните стрелку вправо и нажмите кнопку **ОК**. Чтобы выбрать все доступные столбцы, выберите **выбрать все**. Выбранные столбцы появятся в списке устройств.

Выбранные столбцы сохраняются в пользовательском сеансе или во всех пользовательских сеансах, имеющих доступ к приложению.

## <a name="rerun-jobs"></a>Повторное выполнение заданий

Можно повторно запустить задание, которое содержит неисправные устройства. Не удалось выбрать повторный **Запуск в случае сбоя**:

:::image type="content" source="media/howto-run-a-job/rerun.png" alt-text="Снимок экрана, на котором показана кнопка для перезапуска задания на устройствах с ошибками.":::

Введите имя и описание задания, а затем выберите **повторное задание**. Новое задание отправляется для повторного выполнения действия на неисправных устройствах.

> [!NOTE]
> Невозможно одновременно запустить более пяти заданий из приложения IoT Central Azure.
>
> После завершения задания и удаления устройства, которое находится в списке устройств задания, запись устройства отображается как удаленная в имени устройства. Ссылка на сведения недоступна для удаленного устройства.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы узнали, как создавать задания в приложении IoT Central Azure, выполните следующие действия.

- [Управление устройствами](howto-manage-devices.md)
- [Создание версии шаблона нового устройства](howto-version-device-template.md)
