---
title: Использование данных расположения в решении Azure IoT Central
description: Узнайте, как использовать данные о расположении, отправленные с устройства, подключенного к приложению IoT Central. Построение данных о расположении на карте или создание правил георазграничения.
author: dominicbetts
ms.author: dobett
ms.date: 01/08/2021
ms.topic: how-to
ms.service: iot-central
services: iot-central
ms.openlocfilehash: c909fd1438488e3625f3674dd26f959cf6fad79f
ms.sourcegitcommit: 02b1179dff399c1aa3210b5b73bf805791d45ca2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "98128026"
---
# <a name="use-location-data-in-an-azure-iot-central-solution"></a>Использование данных расположения в решении Azure IoT Central

В этой статье показано, как использовать данные о расположении в приложении IoT Central. Устройство, подключенное к IoT Central, может передавать данные о расположении как поток телеметрии или использовать свойство устройства для передачи данных о расположении.

Построитель решений может использовать данные о расположении для:

* Отображает сообщаемое расположение на карте.
* Выведите на диаграмму схему расположения телеметрии OM.
* Создание правил геозоны для уведомления оператора о том, что устройство входит в определенную область или выходит из нее.

## <a name="add-location-capabilities-to-a-device-template"></a>Добавление возможностей расположения в шаблон устройства

На следующем снимке экрана показан шаблон устройства с примерами свойства устройства и типа телеметрии, которые используют данные о расположении. В определениях используется тип семантики **Location** и схема **географического расположения** :

:::image type="content" source="media/howto-use-location-data/location-device-template.png" alt-text="Снимок экрана с определением свойства Location в шаблоне устройства":::

Определения [дтдл](https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/dtdlv2.md) для этих возможностей в справочных целях можно найти в следующем фрагменте кода:

```json
{
  "@type": [
    "Property",
    "Location"
  ],
  "displayName": {
    "en": "DeviceLocation"
  },
  "name": "DeviceLocation",
  "schema": "geopoint",
  "writable": false
},
{
  "@type": [
    "Telemetry",
    "Location"
  ],
  "displayName": {
    "en": "Tracking"
  },
  "name": "Tracking",
  "schema": "geopoint"
}
```

> [!NOTE]
> Тип схемы **геоточек** не является частью [спецификации дтдл](https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/dtdlv2.md). В настоящее время IoT Central поддерживает тип схемы **географической** **точки** и тип семантики расположения для обеспечения обратной совместимости.

## <a name="send-location-data-from-a-device"></a>Отправка данных о расположении с устройства

Когда устройство отправляет данные для свойства **девицелокатион** , показанного в предыдущем разделе, полезная нагрузка выглядит как следующий фрагмент кода JSON:

```json
{
  "DeviceLocation": {
    "lat": 47.64263,
    "lon": -122.13035,
    "alt": 0
  }
}
```

Когда устройство отправляет данные телеметрии **отслеживания** , как показано в предыдущем разделе, полезные данные выглядят как следующий фрагмент кода JSON:

```json
{
  "Tracking": {
    "lat": 47.64263,
    "lon": -122.13035,
    "alt": 0
  }
}
```

## <a name="display-device-location"></a>Отображение расположения устройства

Данные расположения можно отображать в нескольких местах приложения IoT Central. Например, для представлений, связанных с отдельным устройством или на панелях мониторинга.

При создании представления для устройства можно выбрать построение расположения на карте или показать отдельные значения:

:::image type="content" source="media/howto-use-location-data/location-views.png" alt-text="Снимок экрана, показывающий пример представления с данными расположения":::

Плитки карт можно добавить на панель мониторинга, чтобы отобразить расположение одного или нескольких устройств. При добавлении плитки карты для отображения данных телеметрии расположения можно отобразить расположение в течение периода времени. На следующем снимке экрана показано расположение, сообщаемое имитацией устройства за последние 30 минут:

:::image type="content" source="media/howto-use-location-data/location-dashboard.png" alt-text="Снимок экрана, показывающий пример панели мониторинга с данными расположения":::

## <a name="create-a-geofencing-rule"></a>Создание правила геозоны

Вы можете использовать телеметрию расположения, чтобы создать правило геозоны, которое создает предупреждение, когда устройство перемещается в прямоугольную область или из нее. На следующем снимке экрана показано правило, использующее четыре условия для определения прямоугольной области с использованием значений широты и долготы. Правило создает сообщение электронной почты, когда устройство перемещается в прямоугольную область:

:::image type="content" source="media/howto-use-location-data/geofence-rule.png" alt-text="Снимок экрана, на котором показано определение правила геозоны":::

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы узнали, как использовать свойства в приложении IoT Central Azure, см. следующие статьи:

* [Полезных данных](concepts-telemetry-properties-commands.md)
* [Создание клиентского приложения и его подключение к приложению Azure IoT Central](tutorial-connect-device.md)