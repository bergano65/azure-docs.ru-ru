---
title: Как отслеживать доступность кластера с помощью Apache Ambari в Azure HDInsight
description: Узнайте, как использовать Apache Ambari для мониторинга работоспособности и доступности кластера.
author: hrasheed-msft
ms.author: hrasheed
ms.reviewer: jasonh
ms.service: hdinsight
ms.topic: how-to
ms.custom: hdinsightactive,seoapr2020
ms.date: 05/01/2020
ms.openlocfilehash: 615e23dc388f36f5ae1cd7e0d846acc14ffa2236
ms.sourcegitcommit: 124f7f699b6a43314e63af0101cd788db995d1cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/08/2020
ms.locfileid: "86086421"
---
# <a name="how-to-monitor-cluster-availability-with-apache-ambari-in-azure-hdinsight"></a>Как отслеживать доступность кластера с помощью Apache Ambari в Azure HDInsight

Кластеры HDInsight включают Apache Ambari, который предоставляет сведения о работоспособности на быстром и предопределенных оповещениях.

В этой статье показано, как использовать Ambari для мониторинга кластера и пошаговые инструкции по настройке оповещений Ambari, наблюдению за доступностью узлов и созданию оповещения Azure Monitor, которое срабатывает, когда период пульса не был получен с одного или нескольких узлов за пять часов.

## <a name="dashboard"></a>Панель мониторинга

Доступ к панели мониторинга Ambari можно получить, перейдя по ссылке **Ambari** в разделе **панели мониторинга кластера** в обзоре HDInsight в портал Azure, как показано ниже. Кроме того, доступ к нему можно получить, перейдя `https://CLUSTERNAME.azurehdinsight.net` в браузер, где имя_кластера — это имя кластера.

![Представление портала ресурсов HDInsight](media/hdinsight-cluster-availability/azure-portal-dashboard-ambari.png)

Затем вам будет предложено ввести имя пользователя и пароль для входа в кластер. Введите учетные данные, выбранные при создании кластера.

Затем вы перейдете на панель мониторинга Ambari, которая содержит мини-приложения, отображающие несколько метрик, чтобы получить краткий обзор работоспособности кластера HDInsight. Эти мини-приложения показывают метрики, такие как количество динамических узлов данных (рабочих узлов) и Жаурналнодес (узел Zookeeper), время бесперебойной работы Наменодес (головные узлы), а также метрики, относящиеся к определенным типам кластеров, такие как YARN время работы ResourceManager для кластеров Spark и Hadoop.

![Отображение панели мониторинга с помощью Apache Ambari](media/hdinsight-cluster-availability/apache-ambari-dashboard.png)

## <a name="hosts--view-individual-node-status"></a>Узлы — Просмотр состояния отдельного узла

Также можно просмотреть сведения о состоянии отдельных узлов. Перейдите на вкладку **узлы** , чтобы просмотреть список всех узлов в кластере, и ознакомьтесь с основными сведениями о каждом узле. Зеленая галочка слева от имени каждого узла указывает на то, что все компоненты находятся на узле. Если компонент не работает на узле, вместо зеленой проверки отображается красный предупреждающий треугольник.

![Представление узлов HDInsight Apache Ambari](media/hdinsight-cluster-availability/apache-ambari-hosts1.png)

Затем можно выбрать **имя** узла, чтобы просмотреть более подробные метрики узла для этого конкретного узла. В этом представлении отображается состояние и доступность каждого отдельного компонента.

![Apache Ambari размещает представление одного узла](media/hdinsight-cluster-availability/apache-ambari-hosts-node.png)

## <a name="ambari-alerts"></a>Ambari оповещения

Ambari также предлагает несколько настраиваемых оповещений, которые могут предоставлять уведомления о определенных событиях. Когда оповещения запускаются, они отображаются в левом верхнем углу Ambari в красном значке, содержащем количество оповещений. При выборе этого значка отображается список текущих оповещений.

![Число текущих предупреждений Apache Ambari](media/hdinsight-cluster-availability/apache-ambari-alerts.png)

Чтобы просмотреть список определений предупреждений и их состояний, перейдите на вкладку **оповещения** , как показано ниже.

![Представление определений предупреждений Ambari](media/hdinsight-cluster-availability/ambari-alerts-definitions.png)

Ambari предлагает множество стандартных предупреждений, относящихся к доступности, в том числе:

| Имя предупреждения                        | Описание:   |
|---|---|
| Сводка по работоспособности узла           | Это предупреждение уровня обслуживания активируется при наличии неработоспособных узлов с данным|
| Работоспособность высокой доступности NameNode | Это предупреждение уровня обслуживания активируется, если не запущены активные NameNode или резервные NameNode.|
| Процент доступных Жаурналнодес    | Это оповещение активируется, если количество Жаурналнодес вниз в кластере превышает заданное критическое пороговое значение. Он объединяет результаты проверок процесса Жаурналноде. |
| Доступно узлов в процентах       | Это оповещение активируется, если число отключенных узлов данных в кластере превышает заданное критическое пороговое значение. В нем суммируются результаты проверок в процессе обработки узлов данных.|

Полный список оповещений Ambari, помогающих отслеживать доступность кластера, можно найти [здесь](https://docs.microsoft.com/azure/hdinsight/hdinsight-high-availability-linux#ambari-web-ui).

Чтобы просмотреть сведения о предупреждении или изменить критерии, выберите **имя** оповещения. В качестве примера следует использовать **сводку по работоспособности узлов** . Вы можете просмотреть описание предупреждения, а также конкретные критерии, которые активируют предупреждение или критическое оповещение и интервал проверки для критерия. Чтобы изменить конфигурацию, нажмите кнопку **изменить** в правом верхнем углу окна конфигурации.

![Настройка оповещений Apache Ambari](media/hdinsight-cluster-availability/ambari-alert-configuration.png)

Здесь можно изменить описание и, что более важно, интервал проверки и пороговые значения для предупреждений или критических оповещений.

![Представление для изменения конфигураций оповещений Ambari](media/hdinsight-cluster-availability/ambari-alert-configuration-edit.png)

В этом примере можно создать два неработоспособных узла, которые активируют критическое оповещение, и 1 неработоспособный узел только запустит предупреждение. По завершении редактирования нажмите кнопку **сохранить** .

## <a name="email-notifications"></a>Уведомления по электронной почте

При необходимости можно также настроить уведомления по электронной почте для оповещений Ambari. Для этого на вкладке **оповещения** нажмите кнопку **действия** в левом верхнем углу, а затем **Управление уведомлениями.**

![Действие "Управление уведомлениями" Ambari](media/hdinsight-cluster-availability/ambari-manage-notifications.png)

Откроется диалоговое окно для управления уведомлениями об оповещениях. Выберите в **+** нижней части диалогового окна и заполните обязательные поля, чтобы указать Ambari с данными о почтовом сервере, с которых следует отправлять сообщения электронной почты.

> [!TIP]
> Настройка уведомлений по электронной почте Ambari может быть хорошим способом получения оповещений в одном месте при управлении множеством кластеров HDInsight.

## <a name="next-steps"></a>Следующие шаги

- [Доступность и надежность кластеров Apache Hadoop в HDInsight](hdinsight-high-availability-linux.md)
- [Доступность кластера — журналы Azure Monitor](./cluster-availability-monitor-logs.md)
- [Использование журналов Azure Monitor](hdinsight-hadoop-oms-log-analytics-tutorial.md)
- [Уведомления по электронной почте Apache Ambari](apache-ambari-email.md)
