---
title: Основные сведения о Службах машинного обучения в Azure HDInsight
description: Узнайте, как с помощью служб машинного обучения в HDInsight создать приложения для анализа больших данных.
author: hrasheed-msft
ms.author: hrasheed
ms.reviewer: jasonh
ms.service: hdinsight
ms.topic: overview
ms.custom: hdinsightactive
ms.date: 04/03/2020
ms.openlocfilehash: 5bf405840de54c4e2399ee73e723201acca9e6bc
ms.sourcegitcommit: 62c5557ff3b2247dafc8bb482256fef58ab41c17
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/03/2020
ms.locfileid: "80657031"
---
# <a name="what-is-ml-services-in-azure-hdinsight"></a>Общие сведения о службах машинного обучения в HDInsight

Microsoft Machine Learning Server доступен в качестве варианта развертывания при создании кластеров HDInsight в Azure. Тип кластера, предоставляющий этот вариант, называется **Службы машинного обучения**. Эта возможность обеспечивает доступ к адаптируемым распределенным методам аналитики в HDInsight по требованию.

В Службах машинного обучения в HDInsight предоставляются новейшие возможности для анализа наборов данных практически любого размера. Наборы данных можно загрузить в хранилище BLOB-объектов или Data Lake в Azure. Приложения на основе R могут использовать более 8000 пакетов R с открытым кодом. Также доступны процедуры в пакете аналитики больших данных ScaleR, созданным корпорацией Майкрософт.

Для подключения к кластеру и выполнения скриптов на языке R удобно использовать граничный узел. Граничный узел позволяет параллельно выполнять распределенные функции на нескольких ядрах сервера. Кроме того, вы можете выполнять эти функции на узлах кластера с помощью Hadoop Map Reduce из пакета ScaleR. Можно также использовать контексты вычислений Apache Spark.

Модели или прогнозы, полученные в результате анализа, можно загрузить для локального использования. Их также можно применять в других службах Azure. Например, через [Студию машинного обучения Azure (классическая)](https://studio.azureml.net) или [веб-службу](../../machine-learning/studio/deploy-a-machine-learning-web-service.md).

## <a name="get-started-with-ml-services-on-hdinsight"></a>Начало работы со службами машинного обучения в HDInsight

Чтобы создать кластер Служб машинного обучения в HDInsight, выберите тип кластера **Службы машинного обучения**. В кластере такого типа на узлах данных и на граничном узле выполняется ML Server. Граничный узел выполняет роль целевой зоны для аналитики на основе Служб машинного обучения. Пошаговое руководство по созданию кластера см. в статье [Create Linux-based clusters in HDInsight by using the Azure portal](../hdinsight-hadoop-create-linux-clusters-portal.md) (Создание кластеров Linux в HDInsight с помощью портала Azure).

## <a name="why-choose-ml-services-in-hdinsight"></a>Почему следует выбрать службы машинного обучения в HDInsight?

Ниже приведены преимущества использования служб машинного обучения в HDInsight.

### <a name="ai-innovation-from-microsoft-and-open-source"></a>Инновации в области искусственного интеллекта корпорации Майкрософт с открытым кодом

  Службы машинного обучения предоставляют масштабируемый распределенный набор алгоритмов, таких как [RevoscaleR](https://docs.microsoft.com/machine-learning-server/r-reference/revoscaler/revoscaler), [revoscalepy](https://docs.microsoft.com/machine-learning-server/python-reference/revoscalepy/revoscalepy-package) и [microsoftML](https://docs.microsoft.com/machine-learning-server/python-reference/microsoftml/microsoftml-package). Эти алгоритмы могут работать с данными, размер которых превышает размер физической памяти. Кроме того, они могут выполняться на разных платформах в распределенном режиме. Узнайте о коллекции пользовательских [R-пакетов](https://docs.microsoft.com/machine-learning-server/r-reference/introducing-r-server-r-package-reference) и [пакетов Python](https://docs.microsoft.com/machine-learning-server/python-reference/introducing-python-package-reference) корпорации Майкрософт, которые включены в продукт.
  
  Службы машинного обучения объединяют инновации корпорации Майкрософт с продуктами, созданными сообществом открытого кода (наборы средств для R, Python и искусственного интеллекта). Все это строится на единой платформе корпоративного класса. Любые пакеты машинного обучения с открытым кодом R или Python могут работать вместе с любой инновацией от корпорации Майкрософт.

### <a name="simple-secure-and-high-scale-operationalization-and-administration"></a>Простой, безопасный и крупномасштабный ввод в эксплуатацию и администрирование

  Организации опираются на традиционные парадигмы и среды, поэтому им приходится вкладывать большое количество времени и усилий в ввод в эксплуатацию. Это действие приводит к лишним затратам средств и времени на преобразование моделей, итераций для поддержки корректности и актуальности моделей, нормативных утверждений и управления разрешениями.

  Службы машинного обучения поддерживают [ввод в эксплуатацию](https://docs.microsoft.com/machine-learning-server/what-is-operationalization) на корпоративном уровне. Завершив работу над моделью машинного обучения, вы можете всего несколькими щелчками мыши создать API-интерфейсы веб-служб. Эти [веб-службы](https://docs.microsoft.com/machine-learning-server/operationalize/concept-what-are-web-services) размещены на облачной серверной сетке и могут быть интегрированы с бизнес-приложениями. Возможность развертывания на базе эластичной сетки позволяет масштабироваться с учетом потребностей бизнеса, как для пакетной поставки, так и для оценки в реальном времени. Инструкции см. в статье о [вводе в эксплуатацию служб машинного обучения в Azure HDInsight](r-server-operationalize.md).

<!---
* **Deep ecosystem engagements to deliver customer success with optimal total cost of ownership**

  Individuals embarking on the journey of making their applications intelligent or simply wanting to learn the new world of AI and machine learning, need the right resources to help them get started. In addition to this documentation, Microsoft provides several learning resources and has engaged several training partners to help you ramp up and become productive quickly.
--->

> [!NOTE]  
> Тип кластера "Службы машинного обучения" в HDInsight поддерживается только в HDInsight 3.6. Прекращение поддержки HDInsight 3.6 запланировано на 31 декабря 2020 г.

## <a name="key-features-of-ml-services-on-hdinsight"></a>Основные возможности служб машинного обучения в HDInsight

Следующие компоненты включены в службы машинного обучения в HDInsight.

| Категория компонента | Описание |
|------------------|-------------|
| Поддержка R | [Пакеты R](https://docs.microsoft.com/machine-learning-server/r-reference/introducing-r-server-r-package-reference) для решений на языке R в сочетании с дистрибутивом R с открытым кодом и инфраструктурой среды выполнения для выполнения скриптов. |
| Поддержка Python | [Модули Python](https://docs.microsoft.com/machine-learning-server/python-reference/introducing-python-package-reference) для решений на языке Python в сочетании с дистрибутивом Python с открытым кодом и инфраструктурой среды выполнения для выполнения скриптов.
| [Предварительно подготовленные модели](https://docs.microsoft.com/machine-learning-server/install/microsoftml-install-pretrained-models) | Для визуального анализа и анализа тональности публикаций, готовых к оценке предоставляемых данных. |
| [Развертывание и потребление](r-server-operationalize.md) | Ввод в эксплуатацию сервера и развернутого решения в качестве веб-службы. |
| [Удаленное выполнение](r-server-hdinsight-manage.md#connect-remotely-to-microsoft-ml-services) | Запускайте удаленные сеансы на кластере служб машинного обучения в своей сети со своей клиентской рабочей станции. |

## <a name="data-storage-options-for-ml-services-on-hdinsight"></a>Варианты хранилищ данных для служб машинного обучения в HDInsight

Хранилищем по умолчанию для файловой системы HDFS может выступать учетная запись службы хранилища Azure или Azure Data Lake Storage. Данные, переданные в хранилище кластера в ходе анализа, сохраняются неограниченно долго. Они будут доступны даже после удаления кластера. Для передачи данных в хранилище можно использовать разные средства. Например, средство отправки на портале для учетной записи хранения или служебную программу [AzCopy](../../storage/common/storage-use-azcopy.md).

Во время создания кластера вы можете настроить доступ к дополнительным хранилищам BLOB-объектов и Data Lake. Вы не ограничены основным вариантом для организации хранилища.  Сведения об использовании нескольких учетных записей хранения см. в статье о [вариантах хранилищ хранилища Azure для служб машинного обучения в HDInsight](./r-server-storage.md).

На граничном узле для хранения данных можно также использовать [файлы Azure](../../storage/files/storage-how-to-use-files-linux.md). Файлы Azure позволяют подключить общую папку, созданную в службе хранилища Azure, к файловой системе Linux. Дополнительные сведения см. в статье [Решения службы хранилища Azure для служб машинного обучения в Azure HDInsight](r-server-storage.md).

## <a name="access-ml-services-edge-node"></a>Доступ к граничному узлу служб машинного обучения

К серверу Microsoft ML Server на граничном узле можно подключиться через браузер или по протоколу SSH, например из программы PuTTY. Консоль R устанавливается по умолчанию во время создания кластера.  

## <a name="develop-and-run-r-scripts"></a>Разработка и выполнение сценариев R

Скрипты R могут использовать любой из более чем 8000 пакетов R с открытым кодом. Также вам доступны параллельные и распределенные подпрограммы из библиотеки ScaleR. На граничном узле скрипты выполняются в интерпретаторе R, работающем на этом узле. Это не относится к действиям, которые вызывают функцию ScaleR с контекстом вычислений Map Reduce (RxHadoopMR) или Spark (RxSpark). Такие функции выполняются в распределенном режиме на узлах данных, которые связаны с соответствующими данными. Дополнительные сведения о вариантах контекста см. в статье о [вариантах контекста вычислений для Служб машинного обучения в HDInsight](r-server-compute-contexts.md).

## <a name="operationalize-a-model"></a>Ввод модели в эксплуатацию

После того как моделирование данных будет завершено, вы можете запустить модель в эксплуатацию для составления прогнозов на основе новых данных в Azure или в локальной среде. Этот процесс называется оценкой. Оценка может осуществляться в HDInsight, Машинном обучении Azure или локальной среде.

### <a name="score-in-hdinsight"></a>Оценка в HDInsight

Для выполнения оценки в HDInsight напишите функцию R. Эта функция будет вызывать модель для создания прогнозов для нового файла данных, загруженного в учетную запись хранения. Сохраните прогнозы в учетной записи хранения. Эту процедуру можно выполнять на граничном узле кластера по требованию или по расписанию.

### <a name="score-in-azure-machine-learning-aml"></a>Оценка в Машинном обучении Azure

Для оценки с помощью Машинного обучения Azure используйте пакет R с открытым кодом для Машинного обучения Azure, известный как [AzureML](https://cran.r-project.org/src/contrib/Archive/AzureML/), чтобы опубликовать модель как веб-службу Azure. Для удобства этот пакет предварительно установлен на граничном узле. Используйте средства машинного обучения Azure, чтобы создать пользовательский интерфейс для веб-службы. Затем вызовите веб-службу, чтобы выполнить оценку. Затем преобразуйте объекты моделей ScaleR в эквивалентные объекты модели с открытым кодом, которые будут использоваться с веб-службой. Для этого используйте функции приведения ScaleR, такие как `as.randomForest()`, для моделей на основе ансамблей.

### <a name="score-on-premises"></a>Оценка в локальной среде

Чтобы выполнить оценку в локальной среде после создания модели, сделайте следующее: сериализуйте модель в R, скачайте ее на локальный компьютер, десериализуйте и примените для оценки новых данных. Вы можете оценить новые данные, используя подход, описанный ранее в разделе [Оценка в HDInsight](#score-in-hdinsight), или с помощью [веб-служб](https://docs.microsoft.com/machine-learning-server/operationalize/concept-what-are-web-services).

## <a name="maintain-the-cluster"></a>Обслуживание кластера

### <a name="install-and-maintain-r-packages"></a>Установка и обслуживание пакетов R

Большинство используемых вами пакетов R должны находиться на граничном узле, так как именно там выполняется основная часть действий скриптов R. Для установки дополнительных пакетов R на граничном узле можно использовать метод `install.packages()` в R.

Если вы используете только подпрограммы из библиотеки ScaleR, дополнительные пакеты R обычно не требуются. Но дополнительные пакеты могут быть нужны для выполнения **rxExec** или **RxDataStep** на узлах данных.

Такие пакеты можно установить после создания кластера с помощью действия скрипта. Дополнительные сведения см. в статье об [управлении кластером служб машинного обучения в HDInsight](r-server-hdinsight-manage.md).

### <a name="change-apache-hadoop-mapreduce-memory-settings"></a>Изменение параметров памяти Apache Hadoop MapReduce

Объем памяти, доступной для Служб машинного обучения, можно изменить при выполнении задания MapReduce. Чтобы изменить кластер, используйте пользовательский интерфейс Apache Ambari. Инструкции по использованию Ambari см. в статье [Управление кластерами HDInsight с помощью веб-интерфейса Ambari](../hdinsight-hadoop-manage-ambari.md).

Объем памяти, доступной для Служб машинного обучения, можно изменить с помощью параметров Hadoop в вызове **RxHadoopMR**:

    hadoopSwitches = "-libjars /etc/hadoop/conf -Dmapred.job.map.memory.mb=6656"  

### <a name="scale-your-cluster"></a>Масштабирование кластера

Масштаб имеющегося кластера служб машинного обучения в HDInsight можно увеличить или уменьшить на портале. Увеличивая масштаб, вы получаете дополнительную емкость для более крупных задач обработки. Пока кластер не используется, его масштаб можно уменьшить. Инструкции по масштабированию кластера см. в статье [Управление кластерами Hadoop в HDInsight с помощью портала Azure](../hdinsight-administer-use-portal-linux.md).

### <a name="maintain-the-system"></a>Поддержка системы

Обслуживание ОС проводится на базовых виртуальных машинах Linux в кластере HDInsight в нерабочее время. Обычно это происходит каждый понедельник и четверг в 3:30 по местному времени (для виртуальной машины). Обновления затрагивают не более четверти кластера за раз.

Выполнение заданий во время обслуживания может замедлиться. Тем не менее они все равно будут выполняться до завершения. Обслуживание не затрагивает установленное пользовательское программное обеспечение или локальные данные, если в системе не возникнет серьезная ошибка, для устранения которой потребуется повторное создание кластера.

## <a name="ide-options-for-ml-services-on-hdinsight"></a>Варианты интегрированной среды разработки для служб машинного обучения в HDInsight

Граничный узел Linux в кластере HDInsight используется в качестве платформы для анализа на основе R. В последних версиях HDInsight на граничном узле предоставляется интегрированная среда разработки RStudio Server с браузерным интерфейсом. RStudio Server более удобен для разработки и выполнения, чем консоль R.

Интегрированная среда разработки для настольных компьютеров может обращаться к кластеру через удаленный контекст вычислений MapReduce или Spark. Доступные параметры:  [Инструменты R для Visual Studio](https://marketplace.visualstudio.com/items?itemName=MikhailArkhipov007.RTVS2019) корпорации Майкрософт, RStudio и [StatET](http://www.walware.de/goto/statet) на базе Eclipse от Walware.

Консоль R на граничном узле можно открыть, введя команду **R** в командной строке. При использовании консольного интерфейса скрипты R удобнее всего создавать в текстовом редакторе. Копируйте и вставляйте сегменты скрипта в консоль R по мере готовности.

## <a name="pricing"></a>Цены

Кластер HDInsight со Службами машинного обучения оплачивается по той же схеме, что и другие кластеры HDInsight. Стоимость кластера зависит от размера основной виртуальной машины на разных узлах имен, узлах данных и граничных узлах. Также оплачивается время работы ядер. Дополнительные сведения см. на странице [цен на HDInsight](https://azure.microsoft.com/pricing/details/hdinsight/).

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об использовании Служб машинного обучения в кластерах HDInsight см. в следующих статьях.

* [Краткое руководство: выполнение сценария R в кластере служб машинного обучения в Azure HDInsight с помощью сервера RStudio](machine-learning-services-quickstart-job-rstudio.md)
* [Варианты контекста вычислений для кластера служб машинного обучения в HDInsight](r-server-compute-contexts.md)
* [Решения службы хранилища Azure для служб машинного обучения в Azure HDInsight](r-server-storage.md)
