---
title: Часто задаваемые вопросы об Apache Kafka в Azure HDInsight
description: Получите ответы на часто задаваемые вопросы о Apache Kafka в Azure HDInsight — управляемой облачной службе Hadoop.
author: hrasheed-msft
ms.author: hrasheed
ms.reviewer: jasonh
ms.service: hdinsight
ms.topic: conceptual
ms.date: 08/14/2019
ms.openlocfilehash: 057c77d4ddb4a760e196c0dc8d508efe15e6699d
ms.sourcegitcommit: 0e59368513a495af0a93a5b8855fd65ef1c44aac
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69520131"
---
# <a name="frequently-asked-questions-about-apache-kafka-in-azure-hdinsight"></a>Часто задаваемые вопросы о Apache Kafka в Azure HDInsight

В этой статье рассматриваются некоторые распространенные вопросы об использовании Apache Kafka в Azure HDInsight.

## <a name="what-kafka-versions-are-supported-by-hdinsight"></a>Какие версии Kafka поддерживаются в HDInsight?

Дополнительные сведения о официально поддерживаемых версиях компонентов HDInsight см. в статье [что такое Apache Hadoop компоненты и версии, доступные в HDInsight?](../hdinsight-component-versioning.md#supported-hdinsight-versions). Рекомендуется всегда использовать последнюю версию, чтобы обеспечить оптимальную производительность и удобство работы пользователей.

## <a name="what-resources-are-provided-in-an-hdinsight-kafka-cluster-and-what-resources-am-i-charged-for"></a>Какие ресурсы предоставляются в кластере HDInsight Kafka и какие ресурсы взимается за них?

Кластер HDInsight Kafka содержит следующие ресурсы:

* Головные узлы
* Узлы Zookeeper
* Узлы брокера (рабочие роли) 
* Управляемые диски Azure, подключенные к узлам брокера
* Узлы шлюза

Плата за использование всех этих ресурсов зависит от [модели ценообразования HDInsight](https://azure.microsoft.com/pricing/details/hdinsight/), за исключением узлов шлюзов. У вас нет оплаты за узлы шлюза.

Более подробное описание различных типов узлов см. в статье [Архитектура виртуальной сети Azure HDInsight](../hdinsight-virtual-network-architecture.md). Цена основана на использовании узла за минуту. Цены зависят от размера узла, количества узлов, типа используемого управляемого диска и региона.

## <a name="do-apache-kafka-apis-work-with-hdinsight"></a>Работают ли Apache Kafka API с HDInsight?

Да, HDInsight использует собственные API Kafka. Код клиентского приложения изменять не требуется. Пошаговые инструкции см. в [руководстве Используйте API-интерфейсы](./apache-kafka-producer-consumer-api.md) производителя и потребителя Apache Kafka, чтобы узнать, как можно использовать интерфейсы API производителя и потребителя на основе Java с кластером.

## <a name="can-i-change-cluster-configurations"></a>Можно ли изменить конфигурации кластера?

Да, через портал Ambari. Каждый компонент на портале имеет раздел **конфигурации** , который можно использовать для изменения конфигураций компонентов. Некоторые изменения могут потребовать перезапуска компонента Service Broker.

## <a name="what-type-of-authentication-does-hdinsight-support-for-apache-kafka"></a>Какой тип проверки подлинности поддерживает HDInsight для Apache Kafka?

С помощью [Корпоративный пакет безопасности (ESP)](../domain-joined/apache-domain-joined-architecture.md)можно получить безопасность на уровне разделов для своих кластеров Kafka. Пошаговые инструкции см. в [руководстве Настройка политик Apache Kafka в HDInsight с корпоративный пакет безопасности (Предварительная](../domain-joined/apache-domain-joined-run-kafka.md)версия) для получения дополнительных сведений.

## <a name="is-my-data-encrypted-can-i-use-my-own-keys"></a>Зашифрованы ли данные? Можно ли использовать собственные ключи?

Все сообщения Kafka на управляемых дисках шифруются с помощью [Azure шифрование службы хранилища (SSE)](../../storage/common/storage-service-encryption.md). Транзитные данные (например, данные, передаваемые от клиентов в брокеры и наоборот), не шифруются по умолчанию. Можно зашифровать такой трафик, настроив [SSL самостоятельно](./apache-kafka-ssl-encryption-authentication.md). Кроме того, HDInsight позволяет управлять собственными ключами для шифрования неактивных данных. Дополнительные сведения см. в статье о том, как получить [собственный ключ для Apache Kafka в Azure HDInsight](apache-kafka-byok.md).

## <a name="how-do-i-connect-clients-to-my-cluster"></a>Разделы справки подключить клиентов к кластеру?

Чтобы клиенты Kafka могли обмениваться данными с брокерами Kafka, они должны иметь доступ к брокерам по сети. Для кластеров HDInsight виртуальная сеть (VNet) является границей безопасности. Таким образом, самым простым способом подключения клиентов к кластеру HDInsight является создание клиентов в той же виртуальной сети, что и кластер. К другим сценариям относятся:

* Подключение клиентов в другой виртуальной сети Azure — одноранговая виртуальная сеть кластера и виртуальная сеть клиента и настройка кластера для [объявления IP-адресов](apache-kafka-connect-vpn-gateway.md#configure-kafka-for-ip-advertising). При использовании объявления IP-адресов клиенты Kafka должны использовать IP-адреса брокера для подключения к брокерам вместо полных доменных имен (FQDN).

* Подключение локальных клиентов — использование сети VPN и настройка пользовательских DNS-серверов, как описано в статье [планирование виртуальной сети для Azure HDInsight](../hdinsight-plan-virtual-network-deployment.md).

* Создание общедоступной конечной точки для службы Kafka. Если корпоративные требования к безопасности позволяют вам, вы можете развернуть общедоступную конечную точку для брокеров Kafka или самостоятельно управляемую конечную точку RESTFUL с открытым исходным кодом с общедоступной конечной точкой.

## <a name="can-i-add-more-disk-space-on-an-existing-cluster"></a>Можно ли добавить дополнительное дисковое пространство в существующий кластер?

Чтобы увеличить объем пространства, доступного для сообщений Kafka, можно увеличить количество узлов. В настоящее время добавление дисков в существующий кластер не поддерживается.

## <a name="how-can-i-have-maximum-data-durability"></a>Как можно получить максимальную устойчивость данных?

Устойчивость данных позволяет достичь самого низкого риска потери сообщений. Для достижения максимальной устойчивости данных рекомендуется использовать следующие параметры:

* использовать минимальный фактор репликации 3 в большинстве регионов
* использовать минимальный фактор репликации 4 в регионах с двумя доменами сбоя
* Отключение отмены очистки лидера выборы
* Задайте **min. unsync. реплики** — 2 или более. это приведет к изменению числа реплик, которые должны быть полностью синхронизированы с лидером, прежде чем запись может быть продолжена.
* Установите для свойства **ACK** значение **все** — это свойство требует, чтобы все реплики подтвердили все сообщения.

Настройка Kafka для повышения согласованности данных влияет на доступность брокеров для создания запросов.

## <a name="can-i-replicate-my-data-to-multiple-clusters"></a>Можно ли реплицировать данные в несколько кластеров?

Да, данные можно реплицировать в несколько кластеров с помощью Kafka MirrorMaker. Дополнительные сведения о настройке MirrorMaker можно найти в разделах, [посвященных зеркальному Apache Kafka](apache-kafka-mirroring.md). Кроме того, существуют другие самостоятельно управляемые технологии и поставщики с открытым исходным кодом, которые могут помочь в достижении репликации в несколько кластеров, например [Бруклин](https://github.com/linkedin/Brooklin/).

## <a name="can-i-upgrade-my-cluster-how-should-i-upgrade-my-cluster"></a>Можно ли обновить кластер? Как обновить кластер?

В настоящее время обновления версии кластера на месте не поддерживаются. Чтобы обновить кластер до более высокой версии Kafka, создайте новый кластер с требуемой версией и перенесите клиенты Kafka для использования нового кластера.

## <a name="how-do-i-monitor-my-kafka-cluster"></a>Разделы справки отслеживать кластер Kafka?

Используйте Azure Monitor для анализа [журналов Kafka](./apache-kafka-log-analytics-operations-management.md).

## <a name="next-steps"></a>Следующие шаги

* [Настройка шифрования и проверки подлинности SSL (SSL) для Apache Kafka в Azure HDInsight](./apache-kafka-ssl-encryption-authentication.md)
* [Репликация разделов Apache Kafka с помощью Kafka в HDInsight и MirrorMaker](./apache-kafka-mirroring.md)
