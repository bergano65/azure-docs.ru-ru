---
title: Развертывание существующего пула узлов с новыми узлами сеансов — Azure
description: Развертывание существующего пула узлов с новыми узлами сеансов в виртуальном рабочем столе Windows.
services: virtual-desktop
author: Heidilohr
ms.service: virtual-desktop
ms.topic: conceptual
ms.date: 02/21/2020
ms.author: helohr
manager: lizross
ms.openlocfilehash: aee5195fe86fed3e631908a38d3bdb7d5e4883b8
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "79365225"
---
# <a name="expand-an-existing-host-pool-with-new-session-hosts"></a>Развертывание существующего пула узлов с новыми узлами сеансов

По мере увеличения использования в пуле узлов может потребоваться расширить существующий пул узлов с новыми узлами сеансов, чтобы справиться с новой нагрузкой.

В этой статье вы узнаете, как расширить существующий пул узлов с помощью новых узлов сеансов.

## <a name="what-you-need-to-expand-the-host-pool"></a>Что необходимо для расширения пула узлов

Прежде чем начать, убедитесь, что вы создали пул узлов и виртуальные машины узла сеансов, используя один из следующих методов.

- [Предложение Azure Marketplace](./create-host-pools-azure-marketplace.md)
- [Шаблон Azure Resource Manager GitHub](./create-host-pools-arm-template.md)
- [Создание пула узлов с помощью PowerShell](./create-host-pools-powershell.md)

Кроме того, при создании пула узлов и виртуальных машин узла сеансов вам потребуются следующие сведения:

- Префикс размера виртуальной машины, образа и имени
- Учетные данные для приподключения к домену и администратора клиента виртуальных рабочих столов Windows
- имя виртуальной сети и имя подсети;

Следующие три раздела — это три метода, которые можно использовать для развертывания пула узлов. Для этого можно использовать любое удобное средство развертывания.

>[!NOTE]
>На этапе развертывания вы увидите сообщения об ошибках для ресурсов виртуальной машины узла предыдущего сеанса, если они в настоящее время выключены. Эти ошибки возникают из-за того, что Azure не может запустить расширение PowerShell DSC, чтобы убедиться, что виртуальные машины узла сеансов правильно зарегистрированы в существующем пуле узлов. Можно спокойно проигнорировать эти ошибки или избежать ошибок, запустив все виртуальные машины узла сеансов в существующем пуле узлов перед началом процесса развертывания.

## <a name="redeploy-from-azure"></a>Повторное развертывание из Azure

Если вы уже создали пул узлов и виртуальные машины узла сеансов с помощью [предложения Azure Marketplace](./create-host-pools-azure-marketplace.md) или [GitHub Azure Resource Manager](./create-host-pools-arm-template.md), можно повторно развернуть тот же шаблон из портал Azure. При повторном развертывании шаблона все введенные данные автоматически перевводятся в исходный шаблон, за исключением паролей.

Вот как повторно развернуть шаблон Azure Resource Manager, чтобы развернуть пул узлов:

1. Войдите на [портал Azure](https://portal.azure.com/).
2. На панели поиска в верхней части портал Azure найдите **группы ресурсов** и выберите элемент в разделе **службы**.
3. Найдите и выберите группу ресурсов, созданную при создании пула узлов.
4. На панели в левой части браузера выберите **развертывания**.
5. Выберите подходящее развертывание для процесса создания пула узлов:
     - Если вы создали исходный пул узлов с помощью предложения Azure Marketplace, выберите развертывание, начиная с **RDS. ВВД-готовить-Host-Pool**.
     - Если вы создали исходный пул узлов с помощью шаблона Azure Resource Manager GitHub, выберите развертывание с именем **Microsoft. Template**.
6. Выберите **Повторное развертывание**.
     
     >[!NOTE]
     >Если шаблон не будет автоматически повторно развертываться при нажатии на кнопку Повторное **развертывание**, выберите **шаблон** на панели в левой части браузера, а затем щелкните **развернуть**.

7. Выберите группу ресурсов, содержащую виртуальные машины узла текущего сеанса в существующем пуле узлов.
     
     >[!NOTE]
     >Если появится сообщение об ошибке, сообщающее выбрать другую группу ресурсов, несмотря на то, что введен правильный, выберите другую группу ресурсов, а затем выберите исходную группу ресурсов.

8. Введите следующий URL-адрес для *_artifactsLocation*:`https://raw.githubusercontent.com/Azure/RDS-Templates/master/wvd-templates/`
9. Введите новое общее число узлов сеансов, которые вы хотите использовать *для экземпляров узлов сеансов удаленных рабочих столов*. Например, если вы разрабатываете пул узлов с пяти узлов сеансов до восьми, введите **8**.
10. Введите тот же пароль домена, который использовался для существующего имени участника-пользователя домена. Не изменяйте имя пользователя, так как это приведет к ошибке при запуске шаблона.
11. Введите тот же пароль администратора клиента, который использовался для идентификатора пользователя или приложения, введенного для имени субъекта- *администратора клиента или идентификатора приложения*. Опять же, не меняйте имя пользователя.
12. Завершите отправку, чтобы развернуть пул узлов.

## <a name="run-the-azure-marketplace-offering"></a>Запуск предложения Azure Marketplace

Следуйте инструкциям в статье [Создание пула узлов с помощью Azure Marketplace](./create-host-pools-azure-marketplace.md) , пока не будет достигнуто [предложение Azure Marketplace для создания пула узлов](./create-host-pools-azure-marketplace.md#run-the-azure-marketplace-offering-to-provision-a-new-host-pool). При переходе к этому моменту необходимо ввести следующие сведения для каждой вкладки:

### <a name="basics"></a>Основы

Все значения в этом разделе должны совпадать с указанными при создании пула узлов и виртуальных машин узла сеансов, за исключением *пользователей рабочего стола по умолчанию*:

1.    В поле *Подписка*выберите подписку, в которой сначала был создан пул узлов.
2.    В поле *Группа ресурсов*выберите ту же группу ресурсов, в которой находятся существующие виртуальные машины узла сеансов пула узлов.
3.    В поле *регион*выберите тот же регион, в котором находятся существующие виртуальные машины узла сеансов пула узлов.
4.    В поле *имя хостпул*введите имя существующего пула узлов.
5.    В поле *тип рабочего стола*выберите тип рабочего стола, соответствующий существующему пулу узлов.
6.    Для *пользователей рабочего стола по умолчанию*введите разделенный запятыми список дополнительных пользователей, которые будут входить в клиенты виртуальных рабочих столов Windows, и получите доступ к рабочему столу после завершения предложения Azure Marketplace. Например, если вы хотите user3@contoso.com назначить и user4@contoso.com получить доступ, введите user3@contoso.com,.user4@contoso.com
7.    Нажмите кнопку **Далее: Настройка виртуальной машины**.

>[!NOTE]
>За исключением *пользователей рабочего стола по умолчанию*, все поля должны точно совпадать с настройками в существующем пуле узлов. При обнаружении несоответствия, которое приведет к созданию нового пула узлов.

### <a name="configure-virtual-machines"></a>Настройка виртуальных машин

Все значения параметров в этом разделе должны совпадать с параметрами, которые вы указали при создании пула узлов и виртуальных машин узла сеансов, за исключением общего числа виртуальных машин. Количество виртуальных машин, которые вы вводите, будет равно количеству виртуальных машин в развернутом пуле узлов:

1. Выберите размер виртуальной машины, соответствующий существующим виртуальным машинам узла сеансов.
    
    >[!NOTE]
    >Если конкретный размер виртуальной машины не отображается в селекторе размеров виртуальных машин, это связано с тем, что мы еще не подключили этот размер к средству Azure Marketplace. Чтобы запросить размер виртуальной машины, создайте новый запрос или проголосуйте за существующий на [форуме UserVoice по Виртуальному рабочему столу Windows](https://windowsvirtualdesktop.uservoice.com/forums/921118-general).

2. Настройте параметры *профиль использования*, *Общее число пользователей*и *число параметров виртуальных машин* , чтобы выбрать общее количество узлов сеансов, которые вы хотите разместить в пуле узлов. Например, если вы разрабатываете пул узлов с пяти узлов сеансов до восьми, настройте эти параметры для получения 8 виртуальных машин.
3. Введите префикс для имен виртуальных машин. Например, если вы введете имя prefix, имена виртуальных машин будут prefix-0, prefix-1 и т. д.
4. Нажмите кнопку **Далее: параметры виртуальной машины**.

### <a name="virtual-machine-settings"></a>Параметры виртуальной машины

Все значения параметров в этом разделе должны соответствовать указанным при первом создании пула узлов и виртуальных машин узла сеансов.

1. В качестве *источника образа* и *версии ОС образа*введите те же сведения, которые вы указали при создании пула узлов.
2. Для *Присоединение к домену имени участника-пользователя* и соответствующих паролей введите те же сведения, которые вы указали при создании пула узлов, чтобы присоединить виртуальные машины к домену Active Directory. Эти учетные данные будут использоваться для создания локальной учетной записи на виртуальных машинах. Вы можете сбросить эти локальные учетные записи, чтобы позже изменить их учетные данные.
3. Для сведений о виртуальной сети выберите ту же виртуальную сеть и подсеть, где находятся существующие виртуальные машины узла сеансов пула узлов.
4. Нажмите кнопку **Далее: Настройка сведений о виртуальных рабочих столах Windows**.

### <a name="windows-virtual-desktop-information"></a>Сведения о виртуальном рабочем столе Windows

Все значения параметров в этом разделе должны соответствовать указанным при первом создании пула узлов и виртуальных машин узла сеансов.

1. Введите *имя группы клиента Виртуального рабочего стола Windows* в группе вашего клиента. Оставьте значение по умолчанию, если вам не было предоставлено определенное имя группы клиента.
2. В поле *Windows Virtual Desktop tenant name* (Имя клиента Виртуального рабочего стола Windows) введите имя клиента, в котором будет создан этот пул узлов.
3. Укажите те же учетные данные, которые использовались при первом создании пула узлов и виртуальных машин узла сеансов. Если вы используете субъект-службу, введите идентификатор экземпляра Azure Active Directory, в котором находится субъект-служба.
4. Нажмите кнопку **Далее: Проверка и создание**.

## <a name="run-the-github-azure-resource-manager-template"></a>Запуск шаблона Azure Resource Manager GitHub

Следуйте инструкциям в разделе [Запуск шаблона Azure Resource Manager для подготовки нового пула узлов](./create-host-pools-arm-template.md#run-the-azure-resource-manager-template-for-provisioning-a-new-host-pool) и укажите все те же значения параметров, кроме *количества экземпляров узлов удаленных рабочих столов*. Введите число виртуальных машин узла сеансов, которые нужно разместить в пуле узлов после запуска шаблона. Например, если вы разрабатываете пул узлов с пяти узлов сеансов до восьми, введите **8**.

## <a name="next-steps"></a>Дальнейшие шаги

Теперь, когда вы развернули существующий пул узлов, вы можете войти в клиент виртуальных рабочих столов Windows, чтобы протестировать их в рамках сеанса пользователя. Подключиться к сеансу можно с помощью любого из следующих клиентов:

- [Подключение к клиенту Windows Desktop](./connect-windows-7-and-10.md)
- [Подключение к веб-клиенту](./connect-web.md)
- [Подключение к клиенту Android](./connect-android.md)
- [Подключение с помощью клиента macOS](./connect-macos.md)
- [Подключение с помощью клиента iOS](./connect-ios.md)
