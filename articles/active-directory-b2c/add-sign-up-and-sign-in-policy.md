---
title: Настройка потока регистрации и входа в систему
titleSuffix: Azure AD B2C
description: Узнайте, как настроить поток регистрации и входа в Azure Active Directory B2C.
services: active-directory-b2c
author: msmimart
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: how-to
ms.date: 12/16/2020
ms.author: mimart
ms.subservice: B2C
zone_pivot_groups: b2c-policy-type
ms.openlocfilehash: 29dd67e9e6e15aaafec0cc47d89da32cbf369938
ms.sourcegitcommit: 86acfdc2020e44d121d498f0b1013c4c3903d3f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/17/2020
ms.locfileid: "97618825"
---
# <a name="set-up-a-sign-up-and-sign-in-flow-in-azure-active-directory-b2c"></a>Настройка потока регистрации и входа в Azure Active Directory B2C

[!INCLUDE [active-directory-b2c-choose-user-flow-or-custom-policy](../../includes/active-directory-b2c-choose-user-flow-or-custom-policy.md)]

## <a name="sign-up-and-sign-in-flow"></a>Последовательность регистрации и входа

Политика регистрации и входа позволяет пользователям: 

* Регистрация с использованием локальной учетной записи
* Вход с использованием локальной учетной записи
* Регистрация или вход с помощью учетной записи социальных сетей
* Сброс паролей

![Поток редактирования профиля](./media/add-sign-up-and-sign-in-policy/add-sign-up-and-sign-in-flow.png)

## <a name="prerequisites"></a>Предварительные требования

Если вы еще не сделали этого, [зарегистрируйте веб-приложение в Azure Active Directory B2C](tutorial-register-applications.md).

::: zone pivot="b2c-user-flow"

## <a name="create-a-sign-up-and-sign-in-user-flow"></a>Создание потока пользователя для регистрации и входа в систему

Потоки пользователей регистрации и входа регулируют процедуры регистрации и входа в систему в рамках одной конфигурации. Пользователи вашего приложения проходят через соответствующую процедуру в зависимости от контекста.

1. Войдите на [портал Azure](https://portal.azure.com).
1. Выберите значок **Каталог и подписка** в верхней панели инструментов портала, а затем выберите каталог, содержащий клиент Azure AD B2C.
1. На портале Azure найдите и выберите **Azure AD B2C**.
1. В разделе **Политики** выберите **Потоки пользователей** и щелкните **Создать поток пользователя**.

    ![Страница "Потоки пользователей" на портале с выделенной кнопкой "Создать поток пользователя"](./media/add-sign-up-and-sign-in-policy/signup-signin-user-flow.png)

1. На странице **Создание потока пользователя** выберите поток пользователя **Регистрация и вход**.

    ![Страница выбора потока пользователя с выделенным потоком "Регистрация и вход"](./media/add-sign-up-and-sign-in-policy/select-user-flow-type.png)

1. В разделе **Выбор версии**, выберите элемент **Рекомендуемая** и нажмите кнопку **Создать**. (См. сведения о [версиях потоков пользователей](user-flow-versions.md).)

    ![Страница создания потока пользователя на портале Azure с выделенными свойствами](./media/add-sign-up-and-sign-in-policy/select-version.png)

1. Введите **имя** потока пользователя. Например, *signupsignin1*.
1. Для **поставщиков удостоверений** выберите **Электронная почта регистрация**.
1. В разделе **Атрибуты пользователя и утверждения** выберите утверждения и атрибуты, которые вы хотите собирать и отправлять от пользователя во время регистрации. Например, щелкните **Показать еще**, а затем выберите атрибуты и утверждения **Страна или регион**, **Отображаемое имя** и **Почтовый индекс**. Нажмите кнопку **ОК**.

    ![Страница выбора атрибутов и утверждений с тремя выбранными утверждениями](./media/add-sign-up-and-sign-in-policy/signup-signin-attributes.png)

1. Для добавления потока пользователя щелкните **Создать**. Префикс *B2C_1* добавляется к имени автоматически.

### <a name="test-the-user-flow"></a>Тестирование потока пользователя

1. Выберите созданный поток пользователя, чтобы открыть его страницу обзора, а затем щелкните **Выполнить поток пользователя**.
1. В разделе **Приложение** выберите зарегистрированное ранее веб-приложение с именем *webapp1*. В поле **URL-адрес ответа** должно содержаться значение `https://jwt.ms`.
1. Щелкните **Выполнить поток пользователя**, а затем выберите **Зарегистрироваться сейчас**.

    ![Страница выполнения потока пользователя на портале с выделенной кнопкой "Выполнить поток пользователя"](./media/add-sign-up-and-sign-in-policy/signup-signin-run-now.PNG)

1. Введите допустимый адрес электронной почты, щелкните **Отправить код проверки**, а затем введите полученный код проверки и щелкните **Проверить код**.
1. Введите новый пароль и подтвердите его.
1. Выберите свою страну и регион, введите отображаемое имя, укажите почтовый индекс и щелкните **Создать**. Токен должен вернуться по адресу `https://jwt.ms` и отобразиться пользователю.
1. Теперь вы снова можете запустить поток пользователя и на этот раз войти в учетную запись, которую создали. Полученный токен содержит выбранные утверждения страны и региона, имени и почтового индекса.

> [!NOTE]
> Функция "Выполнить поток пользователя" в настоящее время не совместима с URL-адресом ответа типа SPA при использовании потока кода авторизации. Чтобы использовать эту функцию с приложениями таких типов, зарегистрируйте URL-адрес ответа с веб-переадресацией и включите неявный поток, как описано [здесь](tutorial-register-spa.md).

::: zone-end

::: zone pivot="b2c-custom-policy"

## <a name="create-a-sign-up-and-sign-in-policy"></a>Создание политики регистрации и входа в систему

Пользовательские политики — это набор XML-файлов, отправляемых в клиент Azure AD B2C для определения путей взаимодействия пользователя. Мы предоставляем начальные пакеты с несколькими предварительно созданными политиками, в том числе: регистрация и вход, сброс пароля и политика редактирования профиля. Дополнительные сведения см. [в разделе Приступая к работе с пользовательскими политиками в Azure AD B2C](custom-policy-get-started.md).

::: zone-end

## <a name="next-steps"></a>Дальнейшие действия

* Добавьте [Вход с помощью поставщика удостоверений в социальных сетях](add-identity-provider.md).
* Настройка [потока сброса пароля](add-password-reset-policy.md).
