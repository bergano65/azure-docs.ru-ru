---
title: Руководство по настройке пользовательского интерфейса приложений в Azure Active Directory B2C | Документация Майкрософт
description: Узнайте, как настроить пользовательский интерфейс своих приложений в Azure Active Directory B2C с помощью портала Azure.
services: B2C
author: davidmu1
manager: daveba
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 11/30/2018
ms.author: davidmu
ms.subservice: B2C
ms.openlocfilehash: 1c95772eeb6057b4ff7b12a79897fda73e1e017c
ms.sourcegitcommit: d3200828266321847643f06c65a0698c4d6234da
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2019
ms.locfileid: "55156667"
---
# <a name="tutorial-customize-the-user-interface-of-your-applications-in-azure-active-directory-b2c"></a>Руководство. Настройка пользовательского интерфейса приложений в Azure Active Directory B2C

Для наиболее распространенных операций пользователя, таких как регистрация, вход и редактирование профиля, в Azure Active Directory (Azure AD) B2C можно использовать [потоки пользователя](active-directory-b2c-reference-policies.md). Сведения в этом руководстве помогут вам узнать, как [настроить пользовательский интерфейс](customize-ui-overview.md) этих функций, используя собственные HTML- и CSS-файлы.

В этой статье раскрываются следующие темы:

> [!div class="checklist"]
> * Создание файлов настройки пользовательского интерфейса.
> * Создание потока пользователя для регистрации и входа, использующего файлы.
> * Тестирование настраиваемого пользовательского интерфейса.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="prerequisites"></a>Предварительные требования

Если вы еще не создали собственный [клиент Azure AD B2C](tutorial-create-tenant.md), создайте его сейчас. Можно использовать существующий клиент, если он был создан при работе с предыдущим руководством.

## <a name="create-customization-files"></a>Создание файлов настройки

Можно создать учетную запись хранения Azure и контейнер, а затем поместить в этот контейнер основные HTML- и CSS-файлы.

### <a name="create-a-storage-account"></a>Создание учетной записи хранения

Хотя можно хранить файлы разными способами, в этом руководстве они будут размещены в [хранилище BLOB-объектов Azure](../storage/blobs/storage-blobs-introduction.md).

1. Убедитесь, что вы используете каталог, содержащий подписку Azure. Щелкните **фильтр каталога и подписки** в верхнем меню и выберите каталог, который содержит вашу подписку. Этот каталог отличается от каталога, который содержит ваш клиент Azure B2C.

    ![Переключение на каталог подписки](./media/tutorial-customize-ui/switch-directories.png)

2. Выберите "Все службы" в левом верхнем углу окна портала Azure, найдите пункт **Учетные записи хранения** и выберите его. 
3. Выберите **Добавить**.
4. В разделе **Группа ресурсов** щелкните **Создать**, введите имя новой группы ресурсов и нажмите кнопку **ОК**.
5. Введите имя учетной записи хранения. Имя должно быть уникальным для Azure, содержать от 3 до 24 символов и состоять только из цифр и строчных букв.
6. Выберите расположение учетной записи хранения или примите расположение по умолчанию. 
7. Примите все остальные значения по умолчанию, выберите **Просмотр и создание**, а затем щелкните **Создать**.
8. После создания учетной записи хранения выберите **Перейти к ресурсу**.

### <a name="create-a-container"></a>Создание контейнера

1. На странице "Обзор" учетной записи хранения выберите **Большие двоичные объекты**.
2. Выберите **Контейнер**, введите имя для контейнера, выберите **Blob (anonymous read access for blobs only)** (Большой двоичный объект (анонимный доступ на чтение только для больших двоичных объектов)), а затем нажмите кнопку **ОК**.

### <a name="enable-cors"></a>Включение CORS

 Код Azure AD B2C в браузере использует современный и стандартный подход для загрузки настраиваемого содержимого по URL-адресу, указанному в потоке пользователя. Механизм CORS (общий доступ к ресурсам независимо от источника) позволяет запрашивать из других доменов ресурсы с ограничением доступа, представленные на веб-странице.

1. В меню выберите **CORS**.
2. В поле **Допустимые источники** введите `https://your-tenant-name.b2clogin.com`. Замените `your-tenant-name` именем вашего клиента Azure AD B2C. Например, `https://fabrikam.b2clogin.com`. Необходимо использовать только строчные буквы в имени вашего клиента.
3. В поле **Допустимые методы** выберите `GET` и `OPTIONS`.
4. В поле **Допустимые заголовки** введите звездочку (*).
5. В поле **Доступные заголовки** введите звездочку (*).
6. В поле **Максимальный возраст** введите 200.

    ![Включение CORS](./media/tutorial-customize-ui/enable-cors.png)

5. Выберите команду **Сохранить**.

### <a name="create-the-customization-files"></a>Создание файлов настройки

Чтобы настроить пользовательский интерфейс регистрации, сначала создайте простые HTML-файл и CSS-файл. Можно настроить HTML-файл как угодно, но он должен содержать элемент **div** с идентификатором `api`. Например, `<div id="api"></div>`. Azure AD B2C внедряет элементы в контейнер `api` при отображении страницы.

1. В локальной папке создайте приведенный ниже файл и обязательно замените `your-storage-account` именем учетной записи хранения, а `your-container` — именем контейнера, которые вы создали. Например, `https://store1.blob.core.windows.net/b2c/style.css`.

    ```html
    <!DOCTYPE html>
    <html>
      <head>
        <title>My B2C Application</title>
        <link rel="stylesheet" href="https://your-storage-account.blob.core.windows.net/your-container/style.css">
      </head>
      <body>  
        <h1>My B2C Application</h1>
        <div id="api"></div>
      </body>
    </html>
    ```

    Страница может быть создана любым способом, но элемент **api** div является обязательным для любого создаваемого вами HTML-файла настройки. 

3. Сохраните этот файл как *custom-ui.html*.
4. Создайте приведенный ниже простой CSS-файл, который выравнивает по центру все элементы на странице регистрации или входа в систему, включая элементы, которые внедряет Azure AD B2C.

    ```css
    h1 {
      color: blue;
      text-align: center;
    }
    .intro h2 {
      text-align: center; 
    }
    .entry {
      width: 300px ;
      margin-left: auto ;
      margin-right: auto ;
    }
    .divider h2 {
      text-align: center; 
    }
    .create {
      width: 300px ;
      margin-left: auto ;
      margin-right: auto ;
    }
    ```

5. Сохраните этот файл как *style.css*.

### <a name="upload-the-customization-files"></a>Передача файлов настройки

В этом руководстве созданные файлы сохраняются в учетной записи хранения, чтобы они были доступны службе Azure AD B2C.

1. Выберите **Все службы** в левом верхнем углу окна портала Azure, найдите пункт **Учетные записи хранения** и выберите его.
2. Выберите созданную учетную запись хранения, выберите **Большие двоичные объекты**, а затем выберите созданный контейнер.
3. Выберите **Отправить**, найдите и выберите файл *custom-ui.html*, затем нажмите кнопку **Отправить**.

    ![Передача файлов настройки](./media/tutorial-customize-ui/upload-blob.png)

4. Скопируйте URL-адрес для файла, который вы передали, для дальнейшего использования в этом руководстве.
5. Повторите шаги 3 и 4 для файла *style.css*.

## <a name="create-a-sign-up-and-sign-in-user-flow"></a>Создание потока пользователя для регистрации и входа в систему

Для выполнения шагов в этом руководстве необходимо создать тестовое приложение и поток пользователя для регистрации или входа в Azure AD B2C. Можно применить принципы, описанные в этом руководстве, и к другим пользовательским интерфейсам, например, для изменения профиля.

### <a name="create-an-azure-ad-b2c-application"></a>Создание приложения Azure AD B2C

Связь с Azure AD B2C осуществляется с помощью приложения, созданного в вашем клиенте. Ниже приведены инструкции по созданию приложения, перенаправляющего маркер авторизации, который возвращается [https://jwt.ms](https://jwt.ms).

1. Войдите на [портале Azure](https://portal.azure.com).
2. Убедитесь, что используете каталог, содержащий клиент Azure AD B2C, щелкнув **Фильтр каталога и подписки** в верхнем меню и выбрав каталог, содержащий ваш клиент.
3. Выберите **Все службы** в левом верхнем углу окна портала Azure, а затем найдите и выберите **Azure AD B2C**.
4. Щелкните **Приложения**, а затем выберите **Добавить**.
5. Задайте имя для приложения, например *testapp1*.
6. В пункте **Веб-приложение или веб-интерфейс API**выберите `Yes`, а затем в пункте **URL-адрес ответа** введите `https://jwt.ms`.
7. Нажмите кнопку **Создать**.

### <a name="create-the-user-flow"></a>Создание потока пользователя

Чтобы проверить файлы настройки, создайте встроенный поток пользователя для регистрации или входа, который использует ранее созданное приложение.

1. На странице клиента Azure AD B2C выберите **Потоки пользователей**, а затем щелкните **Создать поток пользователя**.
2. На вкладке **Recommended** (Рекомендуется) щелкните **Sign up and sign in** (Регистрация и вход).
3. Введите имя потока пользователя. Например, *signup_signin*. При создании потока пользователя к его имени автоматически добавляется префикс *B2C_1*.
4. В разделе **Поставщики удостоверений** выберите **Email sign-up** (Регистрация по электронной почте).
5. В разделе **Атрибуты пользователя и утверждения** щелкните **Больше**.
6. В столбце **Собрать атрибут** выберите атрибуты, которые хотите получить от клиента во время регистрации. Например, введите **Страну/Регион**, **Отображаемое имя** и **Почтовый индекс**.
7. В столбце **Вернуть утверждение** выберите утверждения, которые необходимо вернуть в маркерах авторизации, отправляемых приложению после успешной регистрации или входа. Например, выберите **Отображаемое имя**, **Поставщик удостоверений**, **Почтовый индекс**, **User is new** (Новый пользователь) и **ИД объекта пользователя**.
8. Последовательно выберите **ОК**.
9. Нажмите кнопку **Создать**.
10. В разделе **Настройка** выберите **Page layouts** (Макеты страниц). Выберите **Единая страница регистрации или входа** и щелкните **Да** для параметра **Использовать пользовательское содержимое страницы**.
11. В поле **Код URI пользовательской страницы** введите URL-адрес файла *custom-ui.html*, записанный ранее.
12. В верхней части страницы нажмите кнопку **Сохранить**.

## <a name="test-the-user-flow"></a>Тестирование потока пользователя

1. На странице клиента Azure AD B2C выберите **Потоки пользователей**, а затем выберите созданный поток пользователя. Например, *B2C_1_signup_signin*.
2. В верхней части страницы щелкните **Выполнить поток пользователя**.
3. Нажмите кнопку **Выполнить поток пользователя**.

    ![Запуск потока пользователя для регистрации или входа в систему](./media/tutorial-customize-ui/run-user-flow.png)

    Вы должны увидеть страницу с элементами, выровненными по центру в соответствии CSS-файлом, который вы создали, как показано в примере ниже.

    ![Результаты потока пользователя](./media/tutorial-customize-ui/run-now.png) 

## <a name="next-steps"></a>Дополнительная информация

Из этой статьи вы узнали, как выполнять следующие задачи:

> [!div class="checklist"]
> * Создание файлов настройки пользовательского интерфейса.
> * Создание потока пользователя для регистрации и входа, использующего файлы.
> * Тестирование настраиваемого пользовательского интерфейса.

> [!div class="nextstepaction"]
> [Настройка языка в Azure Active Directory B2C](active-directory-b2c-reference-language-customization.md)
