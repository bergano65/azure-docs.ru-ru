---
title: Руководство по Регистрация одностраничного приложения
titleSuffix: Azure AD B2C
description: Из этого учебника вы узнаете, как зарегистрировать одностраничное приложение в Azure Active Directory B2C с помощью портала Azure.
services: active-directory-b2c
author: msmimart
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: tutorial
ms.date: 08/19/2020
ms.custom: project-no-code
ms.author: mimart
ms.subservice: B2C
ms.openlocfilehash: d2eaf1dce432821dcfc693dc69dcf975a3d8be8d
ms.sourcegitcommit: 59f506857abb1ed3328fda34d37800b55159c91d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2020
ms.locfileid: "92503867"
---
# <a name="tutorial-register-a-single-page-application-spa-in-azure-active-directory-b2c"></a>Руководство по Регистрация одностраничного приложения в Azure Active Directory B2C

Чтобы [приложения](application-types.md) могли взаимодействовать с Azure Active Directory B2C (Azure AD B2C), их нужно зарегистрировать в клиенте, которым вы управляете. В этом руководстве показано, как зарегистрировать одностраничное приложение с помощью портала Azure.

## <a name="overview-of-authentication-options"></a>Общие сведения о способах проверки подлинности

Многие современные веб-приложения создаются как клиентские одностраничные приложения. Разработчики пишут их с помощью JavaScript или платформы одностраничных приложений, например, Angular, Vue и React. Эти приложения работают в веб-браузере и имеют характеристики проверки подлинности, отличные от традиционных серверных веб-приложений.

Azure AD B2C предоставляет **два** способа входа одностраничных приложений в систему пользователей и получать маркеры для доступа к серверным службам или веб-API:

### <a name="authorization-code-flow-with-pkce"></a>Поток кода авторизации (с PKCE)
- [Поток кода авторизации OAuth 2.0 (с PKCE)](./authorization-code-flow.md). Поток кода авторизации позволяет приложению обмениваться кодом авторизации для маркеров **ID** для представления пользователя, прошедшего проверку подлинности, и маркеров **доступа** , необходимых для вызова защищенных интерфейсов API. Кроме того, он возвращает маркеры **обновления** , которые предоставляют долгосрочный доступ к ресурсам от имени пользователей без необходимости взаимодействия с этими пользователями. 

**Рекомендуем** использовать этот подход. Наличие маркеров обновления с ограниченным сроком действия позволяет приложению учитывать [современные ограничения браузеров в отношении конфиденциальности файлов cookie](../active-directory/develop/reference-third-party-cookies-spas.md), например Safari ITP.

Чтобы воспользоваться преимуществами этого потока, приложение может использовать библиотеку проверки подлинности, которая поддерживает ее, например [MSAL.js 2.x](https://github.com/Azure-Samples/ms-identity-b2c-javascript-spa). 

![Авторизация в одностраничных приложениях](./media/tutorial-single-page-app/spa-app-auth.svg)

### <a name="implicit-grant-flow"></a>Поток неявного предоставления
- [Неявный поток OAuth 2.0](implicit-flow-single-page-application.md). Некоторые платформы, такие как [MSAL.js 1.x](https://github.com/Azure-Samples/active-directory-b2c-javascript-msal-singlepageapp), поддерживают только потоки неявного предоставления разрешений. Поток неявного предоставления позволяет приложению получать маркеры **ID** и **Доступа** . В отличие от потока кода авторизации, поток неявного предоставления не возвращает маркер **обновления** . 

![Одностраничные приложения. Неявное предоставление разрешений](./media/tutorial-single-page-app/spa-app.svg)

Этот поток проверки подлинности не содержит сценарии приложений, в которых используются межплатформенные среды JavaScript, такие как Electron и React-Native. В этих сценариях требуются дополнительные возможности для взаимодействия с собственными платформами.

## <a name="prerequisites"></a>Предварительные требования

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

Если вы еще не создали собственный [клиент Azure AD B2C](tutorial-create-tenant.md), создайте его сейчас. Вы можете использовать имеющийся клиент Azure Active Directory B2C.

## <a name="register-the-spa-application"></a>Регистрация одностраничного приложения

1. Войдите на [портал Azure](https://portal.azure.com).
1. Выберите значок **Каталог и подписка** в верхней панели инструментов портала, а затем выберите каталог, содержащий клиент Azure AD B2C.
1. На портале Azure найдите и выберите **Azure AD B2C** .
1. Щелкните **Регистрация приложений** и выберите **Новая регистрация** .
1. Введите **имя** приложения. Например, *spaapp1* .
1. В разделе **Поддерживаемые типы учетных записей** выберите элемент **Accounts in any identity provider or organizational directory (for authenticating users with user flows)** (Учетные записи в любом поставщике удостоверений или каталоге организации (для аутентификации пользователей с использованием сведений о маршрутах пользователей)).
1. В разделе **URI перенаправления** выберите **Одностраничное приложение (SPA)** , а затем введите `https://jwt.ms` в текстовом поле URL-адреса.

    URI перенаправления — это конечная точка, в которую сервер авторизации (Azure AD B2C в данном случае) отправляет пользователя после завершения взаимодействия с пользователем и в которую отправляются маркер доступа или код авторизации после успешной авторизации. В рабочем приложении обычно это общедоступная конечная точка, в которой работает приложение, например `https://contoso.com/auth-response`. В целях тестирования, таких как этот учебник, можно задать для него значение `https://jwt.ms`, веб-приложение Майкрософт, которое отображает декодированное содержимое маркера (содержимое маркера никогда не покидает браузер). Во время разработки приложения можно добавить конечную точку, в которой приложение будет ожидать передачи данных локально, например `http://localhost:5000`. URI перенаправления в зарегистрированных приложениях можно добавлять и изменять в любое время.

    На URI перенаправления налагаются следующие ограничения.

    * URL-адрес ответа должен начинаться со схемы `https`, если не используется `localhost`.
    * В URL-адресе ответа учитывается регистр. Его регистр должен соответствовать регистру URL-пути выполняющегося приложения. Например, если приложение включает в состав своего пути `.../abc/response-oidc`, не указывайте `.../ABC/response-oidc` в URL-адресе ответа. Так как веб-браузер обрабатывает пути с учетом регистра, файлы cookie, связанные с `.../abc/response-oidc`, могут быть исключены при перенаправлении на не совпадающий по регистру знаков URL-адрес `.../ABC/response-oidc`.

1. В разделе **Разрешения** установите флажок *Предоставьте согласие администратора для разрешений openid и offline_access* .
1. Выберите **Зарегистрировать** .


## <a name="enable-the-implicit-flow"></a>Включение потока неявного предоставления
При использовании потока неявного предоставления необходимо включить этот поток в регистрации приложения.

1. В меню слева в разделе **Управление** выберите **Проверка подлинности** .
1. В разделе **Неявное предоставление разрешения** установите флажки **Маркеры доступа** и **Токен идентификатора** .
1. Щелкните **Сохранить** .

## <a name="migrate-from-the-implicit-flow"></a>Перенос из потока неявного предоставления

Если у вас есть приложение, использующее поток неявного предоставления, мы рекомендуем перейти на использование потока кода авторизации с помощью платформы, которая поддерживает ее, например [MSAL.js 2. x](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/lib/msal-browser).

Если все рабочие одностраничные приложения, представленные регистрацией приложения, используют поток кода авторизации, отключите параметры потока неявного предоставления разрешений. 

1. В меню слева в разделе **Управление** выберите **Проверка подлинности** .
1. В разделе **Неявное предоставление разрешения** снимите флажки **Маркеры доступа** и **Токен идентификатора** .
1. Щелкните **Сохранить** .

Но если вы оставите включенным неявный поток (установленный флажок), приложения с неявным потоком будут и дальше нормально работать.

* * *

## <a name="next-steps"></a>Дальнейшие шаги

Далее узнайте, как создавать последовательности пользователей, чтобы пользователи могли регистрироваться, входить в систему и управлять их профилями.

> [!div class="nextstepaction"]
> [Создание потоков пользователей в Azure Active Directory B2C >](tutorial-create-user-flows.md)
