---
title: Руководство по аварийному восстановлению для Авере Вфкст для Azure
description: Как защитить данные в Авере Вфкст для Azure от случайного удаления или простоя
author: ekpgh
ms.service: avere-vfxt
ms.topic: conceptual
ms.date: 12/10/2019
ms.author: rohogue
ms.openlocfilehash: 4a8dbe9d1c66955e585f7b2cbf842193c965252e
ms.sourcegitcommit: d614a9fc1cc044ff8ba898297aad638858504efa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2019
ms.locfileid: "74998775"
---
# <a name="disaster-recovery-guidance-for-avere-vfxt-for-azure"></a>Руководство по аварийному восстановлению для Авере Вфкст для Azure

В этой статье описываются стратегии защиты рабочего процесса Авере Вфкст для Azure и даются рекомендации по резервному копированию данных, чтобы можно было восстановить данные из всякое или простоев.

Авере Вфкст for Azure временно сохраняет данные в своем кэше. Данные хранятся в долгосрочных хранилищах серверных систем хранения — локальных аппаратных системах, контейнерах хранилища BLOB-объектов Azure или обоих.

Чтобы защититься от простоев и возможной потери данных, учитывайте следующие четыре области:

* Защита от простоев, если Авере Вфкст для системы Azure становится недоступным
* Защита данных в кэше кластера
* Защита данных в хранилище серверного оборудования NAS
* Защита данных в облачном хранилище BLOB-объектов Azure

Каждый Авере Вфкст для клиента Azure должен создать собственный комплексный план аварийного восстановления, который включает планы для этих элементов. Вы также можете создать устойчивость для приложений, используемых с кластером Вфкст. Для получения справки ознакомьтесь со ссылками в разделе [дальнейшие действия](#next-steps) .

## <a name="protect-against-downtime"></a>Защита от простоев

Избыточность встроена в Авере Вфкст для продукта Azure:

* Кластер является высокодоступным, и отдельные узлы кластера могут выполнять отработку отказа с минимальным перерывом.
* Данные, измененные в кэше, регулярно записываются во внутреннем ядре фильтрами определенными (аппаратный NAS или большой двоичный объект Azure) для долгосрочного хранения.

Каждый Авере Вфкст для кластера Azure должен находиться в одной зоне доступности, но можно использовать избыточные кластеры, расположенные в разных зонах или в разных регионах, чтобы обеспечить быстрый доступ в случае региональной простоя.

Вы также можете разместить контейнеры хранилища в нескольких регионах, если вы беспокоитесь о потере доступа к данным. Однако следует помнить, что транзакции между регионами имеют более высокую задержку и более высокие расходы, чем транзакции, которые остаются в пределах региона.

## <a name="protect-data-in-the-cluster-cache"></a>Защита данных в кэше кластера

Кэшированные данные всегда записываются в основной фильтрами определенными перед нормальным завершением работы, но при неуправляемом отключении изменения данных в кэше могут быть потеряны.

Если кластер используется только для оптимизации операций чтения файлов, нет изменений, которые можно потерять. Если кластер также используется для кэширования изменений в файлах (операций записи), подумайте, следует ли настраивать [политики кэша](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gui_manage_cache_policies.html) Core фильтрами определенными<!-- link to legacy doc --> Настройка частоты записи данных в долгосрочное хранение.

Как правило, план восстановления должен сосредоточиться на резервном копировании серверных систем хранения, которые содержат больше данных и, как правило, более важны для повторного создания рабочего процесса после сбоя.

## <a name="protect-data-in-nas-core-filers"></a>Защита данных в NAS Core фильтрами определенными

Используйте принятые методы для защиты данных, хранящихся в локальном фильтр аппаратного ядра NAS, включая моментальные снимки и полные резервные копии, как это рекомендовано поставщиком NAS. Аварийное восстановление для этих основных фильтрами определенными выходит за рамки этой статьи.

## <a name="protect-data-in-azure-blob-storage"></a>Защита данных в хранилище BLOB-объектов Azure

Авере Вфкст для Azure использует локально избыточное хранилище (LRS) для Azure BLOB Core фильтрами определенными. Это означает, что данные в контейнерах больших двоичных объектов автоматически копируются для защиты от временных сбоев оборудования в центре обработки данных.

В этом разделе приводятся советы по дальнейшей защите данных в хранилище BLOB-объектов из редких или случайных удалений на уровне региона.

Рекомендации по защите данных в хранилище BLOB-объектов Azure:

* Часто копируйте критически важные данные в другую учетную запись хранения в другом регионе (как часто определяется планом аварийного восстановления).
* Контролируйте доступ к данным во всех целевых системах, чтобы предотвратить случайное удаление или повреждение. Рассмотрите возможность использования [блокировок ресурсов](../azure-resource-manager/resource-group-lock-resources.md) в хранилище данных.
* Включите функцию Авере Вфкст для [облачного моментального снимка](<https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gui_cloud_snapshot_policies.html>) Azure для своего основного BLOB-объекта фильтрами определенными.

### <a name="copy-avere-vfxt-core-filer-data-to-a-backup-account"></a>Копирование данных Авере Вфкст Core фильтр в учетную запись резервной копии

Выполните следующие действия, чтобы установить резервную копию данных в другой учетной записи.

1. При необходимости создайте новый ключ шифрования и храните его в безопасном месте вне затронутых систем.

   Если данные шифруются с помощью Авере Вфкст для кластера Azure, необходимо создать новый ключ шифрования перед копированием данных в другую учетную запись хранения. Безопасно Храните ключ и пароль в надежном месте и не затронет региональный сбой.

   Этот ключ необходимо указать при добавлении контейнера в кластер, даже если он повторно добавлен в исходный кластер.

   Чтение [параметров шифрования в облаке](<https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gui_cloud_encryption_settings.html>)<!-- link to legacy doc site --> для получения подробных сведений.

   Если контейнер использует только встроенное шифрование Azure, этот шаг можно пропустить.

1. Удалите основные фильтр из системы. Это приведет к тому, что кластер будет записывать все измененные данные в хранилище серверной части.

   Несмотря на то, что после резервного копирования необходимо повторно добавить основные фильтр, удаление этого элемента является лучшим способом гарантировать, что все данные полностью записываются в серверную части. (Параметр "Suspend" иногда может оставить измененные данные в кэше.) <!-- xxx true? or just metadata? -->

   Запишите имя и сведения о присоединениях основного фильтр (перечисленные на странице **пространство имен** на панели управления), чтобы можно было выполнить репликацию при повторном добавлении контейнера после резервного копирования.

   Используйте панель управления кластера, чтобы удалить основные фильтр. [Откройте панель управления кластера](avere-vfxt-cluster-gui.md) и выберите **Core фильтр** > **Управление основными фильтрами определенными**. Найдите систему хранения, для которой требуется создать резервную копию, и удалите ее из кластера с помощью кнопки **Удалить** .

1. Создайте новый пустой контейнер хранилища BLOB-объектов в другой учетной записи хранения в другом регионе.

1. Используйте любое удобное средство копирования, чтобы скопировать данные базового фильтра в новый контейнер. Копия должна реплицировать данные без изменений и не нарушать собственный формат файловой системы, используемый Авере Вфкст для Azure. Средства на основе Azure включают [AzCopy](../storage/common/storage-use-azcopy-v10.md), [Azure PowerShell](../data-lake-store/data-lake-store-get-started-powershell.md)и [фабрику данных Azure](../data-factory/connector-azure-data-lake-store.md).

1. После копирования данных в контейнер резервного копирования добавьте исходный контейнер обратно в кластер, как описано в разделе [Настройка хранилища](avere-vfxt-add-storage.md).

   * Используйте те же сведения о базовом фильтр имени и разветвлении, чтобы избежать необходимости изменять рабочие процессы клиента.
   * Задайте для параметра **содержимое сегмента** значение существующий параметр данных.
   * Если контейнер был зашифрован кластером, необходимо ввести текущий ключ шифрования для его содержимого. (Это ключ, который вы обновили на шаге 1.)

Для резервного копирования после первого не нужно создавать новый контейнер хранилища. Однако рекомендуется создавать новый ключ шифрования каждый раз при резервном копировании, чтобы убедиться в том, что текущий ключ хранится в запоминаемом месте.

### <a name="access-a-backup-data-source-during-an-outage"></a>Доступ к источнику данных резервного копирования во время сбоя

Чтобы получить доступ к контейнеру резервного копирования из Авере Вфкст для кластера Azure, выполните следующую процедуру:

1. При необходимости создайте новый Авере Вфкст для кластера Azure в неизменяемом регионе.

   > [!TIP]
   > При создании Вфкст Авере для кластера Azure можно сохранить копию ее шаблона создания и параметров. При сохранении этих сведений при создании основного кластера его можно использовать для создания заменяющего кластера с теми же свойствами. На странице [Проверка и сводка](avere-vfxt-deploy.md#validation-and-purchase) щелкните ссылку **скачать шаблон и параметры** . Сохраните данные в файл, прежде чем нажать кнопку **ОК** , чтобы создать кластер.

1. Добавьте новый фильтр Cloud Core, указывающий на дублирующийся контейнер больших двоичных объектов.

   Обязательно укажите, что целевой контейнер уже содержит данные в параметре **содержимого сегмента** в мастере создания основного фильтр. (Система должна оповещать вас, если вы случайно оставите этот параметр **пустым**.)  <!-- you can't add a populated volume at cluster creation time via template, only create a fresh one -->

1. При необходимости обновите клиенты, чтобы они подключались к новому кластеру или новым основным фильтр, а не к исходному. (Если вы добавили замену Core фильтр с тем же именем и путем соединения, что и в исходном контейнере, вам не потребуется обновлять клиентские процессы, если не требуется подключать новый кластер по новому IP-адресу.)

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о настройке параметров для Авере Вфкст для Azure см. в статье [Настройка кластера](avere-vfxt-tuning.md).
* Дополнительные сведения об аварийном восстановлении и создании устойчивых приложений в Azure:

  * [Техническое руководство по обеспечению устойчивости в Azure](https://docs.microsoft.com/azure/architecture/framework/resiliency/overview)
  * [Восстановление после нарушения работы службы на уровне региона](https://docs.microsoft.com/azure/architecture/resiliency/recovery-loss-azure-region)
  * [Аварийное восстановление и высокий уровень доступности для приложений Azure](<https://docs.microsoft.com/azure/resiliency/resiliency-disaster-recovery-high-availability-azure-applications>)
  <!-- can't find these in the source tree to use relative links -->
