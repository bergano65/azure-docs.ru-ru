---
title: Общие сведения об уровне совместимости заданий Azure Stream Analytics
description: Узнайте, как установить уровень совместимости для задания Azure Stream Analytics и основные изменения в последнем уровне совместимости.
author: mamccrea
ms.author: mamccrea
ms.service: stream-analytics
ms.topic: conceptual
ms.date: 04/12/2019
ms.openlocfilehash: e4bbfdbcf7a295089570d4c8b77b07fd7270b3fd
ms.sourcegitcommit: bf509e05e4b1dc5553b4483dfcc2221055fa80f2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "59998266"
---
# <a name="compatibility-level-for-azure-stream-analytics-jobs"></a>Уровень совместимости заданий Azure Stream Analytics

В этой статье описывается параметр уровня совместимости в Azure Stream Analytics. Stream Analytics — это управляемая служба, с регулярными обновлениями компонентов и повышение производительности. Большинство обновлений службы среды выполнения, автоматически становятся доступными для конечных пользователей. 

Тем не менее некоторые новые функциональные возможности службы может привести к значительным изменениям, например изменение в поведении существующее задание, или изменения в способ, которым данные будут использоваться на выполнение заданий. Вы можете сохранить ваши существующие задания Stream Analytics, под управлением без существенных изменений, оставив параметр снижения гарантии уровня совместимости. Когда будете готовы для последней поведения среды выполнения, вы можете согласиться, повысив уровень совместимости. 

## <a name="choose-a-compatibility-level"></a>Выберите уровень совместимости

Уровень совместимости управляет поведением во время выполнения задания Stream Analytics. 

Azure Stream Analytics в настоящее время поддерживает три уровня совместимости:

* 1.0 — уровень по умолчанию
* 1.1. текущее поведение выпуска
* 1.2 (Предварительная версия) — новые поведения с помощью новейших усовершенствований в оценки

Исходному уровню совместимости 1.0 была представлена в общедоступной версии Azure Stream Analytics несколько лет назад.

При создании нового задания Stream Analytics, рекомендуется создать ее с помощью последний уровень совместимости. Запустите проект задания полагаются последнюю поведения, во избежание добавлены изменения и сложности позже.

## <a name="set-the-compatibility-level"></a>Установка уровня совместимости

Можно задать уровень совместимости для задания Stream Analytics на портале Azure или с помощью [создания вызова REST API задания](/rest/api/streamanalytics/stream-analytics-job).

Чтобы обновить уровень совместимости задания на портале Azure:

1. Используйте [портала Azure](https://portal.azure.com) искомого к заданию Stream Analytics.
2. **Остановить** задания перед обновлением уровень совместимости. Если задание выполняется, уровень совместимости обновить не удастся.
3. В разделе **Настройка** щелкните **уровень совместимости**.
4. Выберите значение уровня совместимости, которое требуется.
5. Выберите **Сохранить** в нижней части страницы.

![Уровень совместимости Stream Analytics на портале Azure](media/stream-analytics-compatibility-level/stream-analytics-compatibility.png)

При обновлении уровня совместимости компилятор T-SQL проверяет задание с помощью синтаксиса, отвечающего выбранному уровню совместимости.

## <a name="compatibility-level-12"></a>Уровень совместимости 1.2.

На уровне совместимости 1.2 вводятся следующие основные изменения:

### <a name="geospatial-functions"></a>Геопространственные функции

**Предыдущих уровней:** Azure Stream Analytics используется географических расчетов.

**1.2 уровень:** Azure Stream Analytics позволяет вычислять геометрические проецируемых географические координаты. Нет изменений в сигнатуре геопространственные функции. Тем не менее их семантика несколько отличается, позволяя более точные вычисления, чем прежде чем.

Azure Stream Analytics поддерживает Геопространственная индексация данных ссылки. Ссылочные данные, содержащие элементы геопространственных индексирования для ускорения вычислений соединения.

Обновленные геопространственные функции обеспечивают полный выразительности формата геопространственных Well Known Text (WKT). Можно указать другие геопространственных компоненты, которые не были ранее поддерживается с GeoJson.

Дополнительные сведения см. в разделе [обновляет геопространственных функций в Azure Stream Analytics — облачные и пограничные IoT](https://azure.microsoft.com/blog/updates-to-geospatial-functions-in-azure-stream-analytics-cloud-and-iot-edge/).

### <a name="parallel-query-execution-for-input-sources-with-multiple-partitions"></a>Параллельное выполнение запросов для источников входных данных с несколькими разделами

**Предыдущих уровней:** Запросы Azure Stream Analytics требуется использовать предложение PARTITION BY для параллельной обработки запросов между секциями источника входных данных.

**1.2 уровень:** Если логика запроса может выполняться параллельно по секциям источника входных данных, Azure Stream Analytics создает экземпляры отдельного запроса и выполняет вычисления в параллельном режиме.

### <a name="native-bulk-api-integration-with-cosmosdb-output"></a>Интерфейс API массового интеграции с выходные данные CosmosDB

**Предыдущих уровней:** Поведение upsert было *Вставка или слияние*.

**1.2 уровень:** Собственный интерфейс API массового интеграции с выходными данными CosmosDB увеличивает пропускную способность и эффективно обрабатывает запросы на регулирование. Дополнительные сведения см. в разделе [выходные данные Azure Stream Analytics в Azure Cosmos DB страницы](https://docs.microsoft.com/azure/stream-analytics/stream-analytics-documentdb-output#improved-throughput-with-compatibility-level-12).

Поведение upsert *Вставка или замена*.

### <a name="datetimeoffset-when-writing-to-sql-output"></a>DateTimeOffset при записи выходных данных SQL

**Предыдущих уровней:** [DateTimeOffset](https://docs.microsoft.com/sql/t-sql/data-types/datetimeoffset-transact-sql?view=sql-server-2017) типы были настроены в формате UTC.

**1.2 уровень:** DateTimeOffset больше не настраивается.

### <a name="strict-validation-of-prefix-of-functions"></a>Строгая проверка префикса функций

**Предыдущих уровней:** Возникла не строгая проверка функции префиксов.

**1.2 уровень:** Azure Stream Analytics имеет строгую проверку функция префиксов. Добавление префикса для встроенной функции вызывает ошибку. Например`myprefix.ABS(…)` не поддерживается.

Добавления префикса к встроенные агрегатные операции также приводит к ошибке. Например `myprefix.SUM(…)` не поддерживается.

С помощью префикса «система» для любой определяемые пользователем функции приведет к ошибке.

### <a name="disallow-array-and-object-as-key-properties-in-cosmos-db-output-adapter"></a>Запретить массива и объекта свойства ключа в выходной адаптер Cosmos DB

**Предыдущих уровней:** Массивовых и объектных типов поддерживались в качестве ключевого свойства.

**1.2 уровень:** Массивовых и объектных типов больше не поддерживаются в качестве ключевого свойства.

## <a name="compatibility-level-11"></a>Уровень совместимости 1.1

На уровне совместимости 1.1 представлены следующие основные изменения:

### <a name="service-bus-xml-format"></a>Формат служебной шины XML

**уровень 1.0:** Azure Stream Analytics использует DataContractSerializer, поэтому в содержимое сообщения включены XML-теги. Например: 

`@\u0006string\b3http://schemas.microsoft.com/2003/10/Serialization/\u0001{ "SensorId":"1", "Temperature":64\}\u0001`

**уровень 1.1:** Содержимое сообщения напрямую содержит поток без дополнительных тегов. Например: `{ "SensorId":"1", "Temperature":64}`

### <a name="persisting-case-sensitivity-for-field-names"></a>Учет регистра для имен полей

**уровень 1.0:** Имена полей преобразовывались в нижний регистр при обработке с помощью подсистемы Azure Stream Analytics.

**1.1 уровень:** учитывается регистр для имен полей, когда они обрабатываются обработчиком Azure Stream Analytics.

> [!NOTE]
> Возможность учета регистра еще не доступна для заданий Stream Analytics, размещенных с использованием среды IoT Edge. Поэтому, если задание размещено в IoT Edge, все имена полей преобразуются в нижний регистр.

### <a name="floatnandeserializationdisabled"></a>FloatNaNDeserializationDisabled

**уровень 1.0:** Команда CREATE TABLE не фильтрует события со значением NaN (не число, например Infinity, -Infinity) в типе столбца FLOAT, так как они не соответствуют задокументированному диапазону этих номеров.

**уровень 1.1:** Команда CREATE TABLE позволяет задать жесткую схему. Обработчик Stream Analytics проверяет соответствие данных этой схеме. С помощью этой модели команда может фильтровать события со значениями NaN.

### <a name="disable-automatic-upcast-for-datetime-strings-in-json"></a>Отключить автоматическое восходящее приведение типа для строки даты и времени в формате JSON

**уровень 1.0:** Анализатор JSON выполнял автоматическое восходящее приведение типа строковых значений с информацией о дате, времени, часовом поясе к типу DateTime, а затем преобразовывал его в UTC. Это поведение приводило к потере сведения о часовом поясе.

**уровень 1.1:** Автоматическое восходящее приведение типа строковых значений с информацией о дате, времени, часовом поясе к типу DateTime больше не используется. В результате информация о часовом поясе сохраняется.

## <a name="next-steps"></a>Дальнейшие действия

* [Устранение неполадок с входными подключениями](stream-analytics-troubleshoot-input.md)
* [Stream Analytics ресурсов работоспособности](stream-analytics-resource-health.md)
