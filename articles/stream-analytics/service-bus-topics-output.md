---
title: Разделы служебной шины, выводимые из Azure Stream Analytics
description: В этой статье описываются разделы служебной шины в качестве выходных данных для Azure Stream Analytics.
author: mamccrea
ms.author: mamccrea
ms.reviewer: mamccrea
ms.service: stream-analytics
ms.topic: conceptual
ms.date: 08/25/2020
ms.openlocfilehash: ef5802d0c5e35b9c12db1f40782ba5f190ad1883
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90907183"
---
# <a name="service-bus-topics-output-from-azure-stream-analytics"></a>Разделы служебной шины, выводимые из Azure Stream Analytics

Очереди служебной шины предоставляют метод связи "один к одному" между отправителем и получателем. [Разделы служебной шины](https://msdn.microsoft.com/library/azure/hh367516.aspx) предоставляют тип связи "один ко многим".

В таблице ниже приведены имена и описание свойств для создания выходных данных раздела служебной шины.

| Имя свойства | Описание |
| --- | --- |
| Псевдоним выходных данных |Понятное имя, которое используется в запросах для направления выходных данных запроса в раздел служебной шины. |
| Пространство имен служебной шины |Контейнер для набора сущностей обмена сообщениями. При создании концентратора событий создается также пространство имен служебной шины. |
| Имя раздела |Разделы являются сущностями обмена сообщениями, как концентраторы событий и очереди. Они предназначены для сбора потоков событий из устройств и служб. Созданному разделу присваивается определенное имя. Сообщения, отправленные в раздел, будут недоступны, пока не создана подписка. Поэтому убедитесь, что раздел содержит одну или несколько подписок. |
| Имя политики раздела |При создании раздела служебной шины можно также создать политики общего доступа на вкладке **Настройка** раздела. Каждой политике общего доступа присваивается имя, а также для нее задаются разрешения и ключи доступа. |
| Ключ политики раздела |Ключ общего доступа, используемый для аутентификации доступа к пространству имен Служебной шины. |
| Формат сериализации событий |Формат сериализации для выходных данных. Поддерживаются форматы JSON, CSV и Avro. |
| Кодирование |Если используется формат CSV или JSON, необходимо указать формат кодирования. В настоящее время единственным поддерживаемым форматом кодировки является UTF-8. |
| Разделитель |Применяется только для сериализации в формате CSV. Служба Stream Analytics позволяет использовать ряд распространенных разделителей для сериализации данных в формате CSV. Поддерживаются такие разделители: запятая, точка с запятой, пробел, табуляция и вертикальная черта. |
| Столбцы свойств | Необязательный параметр. Столбцы с разделителями-запятыми, которые необходимо присоединить как пользовательские свойства исходящего сообщения вместо полезных данных. Дополнительные сведения об этой функции см. в разделе [Свойства пользовательских метаданных для выходных данных](#custom-metadata-properties-for-output). |
| Столбцы системных свойств | Необязательный параметр. Пары "ключ-значение" системных свойств и соответствующих имен столбцов, которые необходимо присоединить к исходящему сообщению вместо полезных данных. |

Количество разделов [основано на размере и номере SKU служебной шины](../service-bus-messaging/service-bus-partitioning.md). Ключ раздела — это уникальное целое значение для каждого раздела.

## <a name="partitioning"></a>Секционирование

Секционирование выбирается автоматически. Количество разделов [основано на размере и номере SKU служебной шины](../service-bus-messaging/service-bus-partitioning.md). Ключ раздела — это уникальное целое значение для каждого раздела. Число модулей записи вывода совпадает с количеством секций в выходном разделе.

## <a name="output-batch-size"></a>Размер выходного пакета

Максимальный размер сообщения — 256 КБ на сообщение для уровня "Стандартный" и 1 МБ для уровня "Премиум". Дополнительные сведения см. в разделе [ограничения служебной шины](../service-bus-messaging/service-bus-quotas.md). Для оптимизации используйте одно событие для каждого сообщения.

## <a name="custom-metadata-properties-for-output"></a>Свойства пользовательских метаданных для выходных данных

Столбцы запросов можно прикреплять к исходящим сообщениям как пользовательские свойства. Эти столбцы не переходят в полезные данные. Свойства представлены в виде словаря в выходном сообщении. *Ключ* — это имя столбца, а *значение* — это значение столбца в словаре свойств. Поддерживаются все типы данных Stream Analytics, кроме записи и массива.

## <a name="system-properties"></a>Свойства системы

Столбцы запросов можно присоединять как [системные свойства](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.brokeredmessage?view=azure-dotnet#properties&preserve-view=true) к исходящим сообщениям очереди или раздела служебной шины. Эти столбцы не попадают в полезные данные, а соответствующее [системное свойство](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.brokeredmessage?view=azure-dotnet#properties&preserve-view=true) BrokeredMessage заполняется значениями столбцов запроса.
Эти системные свойства поддерживаются — `MessageId, ContentType, Label, PartitionKey, ReplyTo, SessionId, CorrelationId, To, ForcePersistence, TimeToLive, ScheduledEnqueueTimeUtc`.

Строковые значения этих столбцов анализируются как соответствующие типы значений системных свойств, а все ошибки синтаксического анализа обрабатываются как ошибки данных.
Это поле предоставляется в формате объекта JSON. Ниже приведены сведения об этом формате.

* Заключаются в фигурные скобки {}.
* Записываются в виде пар "ключ — значение".
* Ключи и значения должны быть строковыми.
* Ключ — это имя системного свойства, а значение — имя столбца запроса.
* Ключи и значения разделяются двоеточием.
* Каждая пара "ключ — значение" разделяется запятой.

В этом примере показано, как использовать это свойство —

* Запрос: `select *, column1, column2 INTO queueOutput FROM iotHubInput`
* Столбцы системных свойств: `{ "MessageId": "column1", "PartitionKey": "column2"}`

Задает `MessageId` в сообщениях очереди служебной шины со значениями `column1`, а для PartitionKey задаются значения `column2`.

## <a name="next-steps"></a>Дальнейшие действия

* [Краткое руководство. по созданию задания Stream Analytics с помощью портала Azure](stream-analytics-quick-create-portal.md)
* [Краткое руководство. Создание задания Azure Stream Analytics с помощью Azure CLI](quick-create-azure-cli.md)
* [Краткое руководство. Создание задания Azure Stream Analytics с помощью шаблона ARM](quick-create-azure-resource-manager.md)
* [Краткое руководство. Создание задания Stream Analytics с помощью Azure PowerShell](stream-analytics-quick-create-powershell.md)
* [Краткое руководство. Создание задания Azure Stream Analytics с помощью Visual Studio](stream-analytics-quick-create-vs.md)
* [Краткое руководство. Создание задания Azure Stream Analytics в Visual Studio Code](quick-create-visual-studio-code.md)
