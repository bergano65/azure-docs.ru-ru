---
title: Руководство по переносу веб-служб из Google Карт | Microsoft Azure Maps
description: В руководстве показано, как перенести веб-службы из Google Карт в Microsoft Azure Maps.
author: rbrundritt
ms.author: richbrun
ms.date: 08/19/2020
ms.topic: tutorial
ms.service: azure-maps
services: azure-maps
manager: cpendle
ms.custom: ''
ms.openlocfilehash: 813cb567ab3edddd6fb37cee050dc5e38ee4289f
ms.sourcegitcommit: 80c1056113a9d65b6db69c06ca79fa531b9e3a00
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/09/2020
ms.locfileid: "96904896"
---
# <a name="tutorial---migrate-web-service-from-google-maps"></a>Руководство по переносу веб-служб из Google Карт

Службы Azure и Google Карт предоставляют доступ к пространственным API через веб-службы REST. Интерфейсы API этих платформ выполняют аналогичные функции. Однако каждый из них использует разные соглашения об именовании и объекты отклика.

В этом учебнике рассматривается следующее.

> * прямое и обратное геокодирование;
> * Поиск точек интереса
> * Вычисление маршрутов и направлений
> * Получение изображения карты
> * Вычисление матрицы расстояний
> * получение сведений о часовом поясе.

Кроме того, вы: 

> [!div class="checklist"]
> * узнаете, какую службу REST Azure Maps использовать при миграции из веб-службы Google Карт;
> * получите советы по максимально эффективному использованию служб Azure Maps;
> * получите полезные сведения о других связанных службах Azure Maps.

В таблице приведены интерфейсы API службы Azure Maps, которые выполняют аналогичные функции для перечисленных API службы Google Карт.

| API-интерфейсы службы Google Карт | API-интерфейсы службы Azure Maps                                                                      |
|-------------------------|---------------------------------------------------------------------------------------------|
| Маршруты              | [Route](/rest/api/maps/route)                                     |                         
| Матрица расстояний         | [Матрица маршрута](/rest/api/maps/route/postroutematrixpreview)       |                         
| Геокодирование               | [Поиск](/rest/api/maps/search)                                   |                         
| Поиск мест           | [Поиск](/rest/api/maps/search)                                   |                         
| Автозавершение мест      | [Поиск](/rest/api/maps/search)                                   |                         
| Привязка к дороге            | См. раздел [Вычисление маршрутов и направлений](#calculate-routes-and-directions).            
| Ограничения скорости            | См. раздел [Обратное геокодирование координат](#reverse-geocode-a-coordinate).                  
| Статическая карта              | [Render](/rest/api/maps/render/getmapimage)                       |                         
| Часовой пояс               | [Часовой пояс](/rest/api/maps/timezone)                              |                         
| Elevation               | [Высота (предварительная версия)](/rest/api/maps/elevation)                   |                         |

Приведенные ниже API службы в настоящее время недоступны в Azure Maps.

- Географическое положение
- Информация о местах и их фотографии. Номера телефонов и URL-адреса веб-сайтов, доступных в API поиска Azure Maps.
- URL-адреса карт
- Ближайшие дороги. Эти данные можно получить с помощью веб-пакета SDK, как показано [здесь](https://azuremapscodesamples.azurewebsites.net/index.html?sample=Basic%20snap%20to%20road%20logic
), но сейчас возможность недоступна в качестве службы.
- Статическое представление улиц.

Azure Maps имеет несколько дополнительных веб-служб REST, которые могут представлять интерес:

- [Пространственные операции.](/rest/api/maps/spatial) Выполнение разгрузки сложных пространственных вычислений и операций, таких как геозонирование, в службу.
- [Дорожное движение.](/rest/api/maps/traffic) Предоставление доступа к данным дорожного движения и сведениям о дорожно-транспортных происшествиях в режиме реального времени.

## <a name="prerequisites"></a>Предварительные требования 

1. Войдите на [портал Azure](https://portal.azure.com). Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/), прежде чем начинать работу.
2. [Создайте учетную запись службы Azure Maps](quick-demo-map-app.md#create-an-azure-maps-account)
3. [Получите первичный ключ подписки](quick-demo-map-app.md#get-the-primary-key-for-your-account), который иногда называется первичным ключом или ключом подписки. Дополнительные сведения о проверке подлинности в Azure Maps см. в [этой статье](how-to-manage-authentication.md).

## <a name="geocoding-addresses"></a>Геокодирование адресов

Геокодирование — это процесс преобразования адреса в координаты. Например, адрес "1 Microsoft Way, Redmond, WA" преобразовывается в долготу –122,1298 и широту 47,64005. Полученные координаты могут использоваться для различных целей, например, для позиционирования центральной метки на карте.

Служба Azure Maps предоставляет несколько методов геокодирования адресов:

- [**Геокодирование адресов в свободной форме.**](/rest/api/maps/search/getsearchaddress) Позволяет указать отдельную строку адреса и немедленно обработать запрос. Пример отдельной строки адреса: "1 Microsoft Way, Redmond, WA". Мы рекомендуем использовать этот API, если нужно быстро выполнить геокодирование отдельных адресов.
- [**Структурированное геокодирование адресов.**](/rest/api/maps/search/getsearchaddressstructured) Позволяет указать части одного адреса, например название улицы, город, страну или регион, почтовый индекс, и немедленно обработать запрос. Мы рекомендуем использовать этот API, если необходимо быстро выполнить геокодирование отдельных адресов, а данные адреса уже проанализированы и разделены на отдельные части.
- [**Пакетное геокодирование адресов.**](/rest/api/maps/search/postsearchaddressbatchpreview) Позволяет создать запрос, содержащий до 10 000 адресов, и обработать их за определенный период времени. Все адреса будут параллельно геокодированы на сервере. После завершения можно скачать полный результирующий набор. Мы рекомендуем использовать этот метод, чтобы выполнить геокодирование больших наборов данных.
- [**Поиск нечетких соответствий.**](/rest/api/maps/search/getsearchfuzzy) Этот API-интерфейс сочетает выполнение геокодирования адреса с поиском точки интереса. Этот API принимает строку в свободной форме. Эта строка может быть адресом, местом, ориентиром, точкой интереса или категорией точек интереса. Этот API обрабатывает запрос почти в реальном времени. Мы рекомендуем использовать этот API для приложений, в которых пользователь может искать адреса или точки интереса в одном текстовом поле.
- [**Поиск пакетных нечетких соответствий.**](/rest/api/maps/search/postsearchfuzzybatchpreview) Позволяет создать запрос, содержащий до 10 000 адресов, мест, ориентиров или точек интереса, и обработать их за определенный период времени. Все данные будут параллельно обработаны на сервере. После завершения можно скачать полный результирующий набор.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps  |
|---------------------------|--------------------------------------|
| `address`                   | `query`                            |
| `bounds`                    | `topLeft` и `btmRight`           |
| `components`                | `streetNumber`<br/>`streetName`<br/>`crossStreet`<br/>`postalCode`<br/>`municipality` — город или другой населенный пункт<br/>`municipalitySubdivision` — округа, городской район или мегаполис<br/>`countrySubdivision` — штат или провинция<br/>`countrySecondarySubdivision` — область<br/>`countryTertiarySubdivision` — район<br/>`countryCode` — двухбуквенный код региона или страны |
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `region`                    | `countrySet`                       |

Пример использования службы поиска описан [здесь](how-to-search-for-address.md). Обязательно ознакомьтесь с [рекомендациями по поиску](how-to-use-best-practices-for-search.md).

> [!TIP]
> API геокодирования адресов в свободной форме и поиска нечетких соответствий можно использовать в режиме автозаполнения. Для этого добавьте `&typeahead=true` в URL-адрес запроса. Это сообщит серверу, что входной текст, скорее всего, неполный, и запрос перейдет в режим прогнозирования.

## <a name="reverse-geocode-a-coordinate"></a>Обратное геокодирование координат

Обратное геокодирование — это процесс преобразования географических координат в приблизительный адрес. Координаты с долготой –122,1298 и широтой 47,64005 преобразовываются в адрес "1 Microsoft Way, Redmond, WA".

Azure Maps предоставляет несколько методов обратного геокодирования:

- [**Обратное геокодирование адресов.**](/rest/api/maps/search/getsearchaddressreverse) Укажите одно значение географических координат, чтобы получить приблизительный адрес, соответствующий этим координатам. Обработка запроса выполняется почти в реальном времени.
- [**Обратное геокодирование перекрестков.**](/rest/api/maps/search/getsearchaddressreversecrossstreet) Позволяет указать одно значение географических координат, чтобы получить информацию о ближайших перекрестках, и немедленно обработать запрос. Например, вы можете получить сведения о перекрестках для "1st Ave" и "Main St.".
- [**Обратное пакетное геокодирование адресов.**](/rest/api/maps/search/postsearchaddressreversebatchpreview) Позволяет создать запрос, содержащий до 10 000 координат, и обработать его за определенный период времени. Все данные будут обрабатываться параллельно на сервере. По завершении запроса можно будет скачать полный набор результатов.

Данная таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт   | Сопоставимый параметр API Azure Maps   |
|-----------------------------|---------------------------------------|
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `latlng`                    | `query`  |
| `location_type`             | *Н/Д*     |
| `result_type`               | `entityType`    |

Ознакомьтесь с [рекомендациями по поиску](how-to-use-best-practices-for-search.md).

В API обратного геокодирования Azure Maps имеется несколько дополнительных функций, которые недоступны в Google Картах. Эти функции могут быть удобны для интеграции с переносимым приложением:

- функция для получения данных об ограничении скорости;
- функция для получения сведений о дороге: является ли она дорогой местного значения, магистральной, с ограниченным движением, на открытых работах и т. д.;
- получение стороны улицы, на которой находятся координаты.

## <a name="search-for-points-of-interest"></a>Поиск точек интереса

Данные о точках интереса можно искать в Google Картах с помощью API поиска мест. Этот API предоставляет три разных способа поиска точек интереса:

- **Поиск места исходя из текста.** Позволяет выполнить поиск точек интереса на основе имени, адреса или номера телефона.
- **Поиск поблизости.** Позволяет выполнить поиск точек интереса, которые находятся на определенном расстоянии от расположения.
- **Текстовый поиск.** Позволяет выполнить поиск мест с помощью текста в свободной форме, который содержит сведения о точке интереса и расположении. Например, "пицца в Нью-Йорке" или "рестораны рядом с главной улицей".

Azure Maps предоставляет несколько API поиска для точек интереса:

- [**Поиск точек интереса.**](/rest/api/maps/search/getsearchpoi) Позволяет выполнить поиск интересов по названию. Например, Starbucks.
- [**Поиск точек интереса по категориям.**](/rest/api/maps/search/getsearchpoicategory) Позволяет выполнить поиск интересов по категориям. Например, "ресторан".
- [**Поиск поблизости.**](/rest/api/maps/search/getsearchnearby) Позволяет выполнить поиск точек интереса, которые находятся на определенном расстоянии от расположения.
- [**Поиск нечетких соответствий.**](/rest/api/maps/search/getsearchfuzzy) Этот API-интерфейс сочетает выполнение геокодирования адреса с поиском точки интереса. Он принимает строку в свободной форме, которая может быть адресом, местом, ориентиром, точкой интереса или категорией точек интереса. Обработка запроса выполняется почти в реальном времени. Мы рекомендуем использовать этот API для приложений, в которых пользователь может искать адреса или точки интереса в одном текстовом поле.
- [**Поиск по геометрическим данным.**](/rest/api/maps/search/postsearchinsidegeometry) Позволяет выполнить поиск точек интереса, которые находятся в пределах заданной геометрической области. Например, можно искать точку интереса в пределах многоугольника.
- [**Поиск вдоль маршрута.**](/rest/api/maps/search/postsearchalongroute) Позволяет выполнить поиск точек интересов, которые находятся вдоль заданного маршрута.
- [**Поиск пакетных нечетких соответствий.**](/rest/api/maps/search/postsearchfuzzybatchpreview) Позволяет создать запрос, содержащий до 10 000 адресов, мест, ориентиров или точек интереса. Этот запрос обрабатывается в течение определенного времени. Все данные будут обрабатываться параллельно на сервере. По завершении обработки запроса можно будет скачать полный набор результатов.

В настоящее время Azure Maps не имеет API, сопоставимого с API текстового поиска Google Карт.

> [!TIP]
> API поиска точек интереса, точек интереса по категориям и нечетких соответствий можно использовать в режиме автозаполнения. Для этого добавьте `&typeahead=true` в URL-адрес запроса. Это укажет серверу, что входной текст, скорее всего, неполный, и API выполнит поиск в режиме прогнозирования.

Обязательно ознакомьтесь с документацией по [лучшим методикам поиска](how-to-use-best-practices-for-search.md).

### <a name="find-place-from-text"></a>Поиск места исходя из текста

Чтобы найти точки интереса по имени или адресу, можно использовать API [поиска точек интереса](/rest/api/maps/search/getsearchpoi) и [поиска нечетких соответствий](/rest/api/maps/search/getsearchfuzzy) Azure Maps.

Таблица содержит параметры API Google Карт и сопоставимые параметры API Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps |
|---------------------------|-------------------------------------|
| `fields`                  | *Н/Д*                               |
| `input`                   | `query`                             |
| `inputtype`               | *Н/Д*                               |
| `key`                     | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `locationbias`            | `lat`, `lon`и `radius`<br/>`topLeft` и `btmRight`<br/>`countrySet`  |

### <a name="nearby-search"></a>Поиск поблизости

API [поиска поблизости](/rest/api/maps/search/getsearchnearby) в Azure Maps позволяет получить данные о ближайших точках интереса.

Таблица содержит параметры API Google Карт и сопоставимые параметры API Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps  |
|---------------------------|--------------------------------------|
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `keyword`                   | `categorySet` и `brandSet`        |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `location`                  | `lat` и `lon`                     |
| `maxprice`                  | *Н/Д*                               |
| `minprice`                  | *Н/Д*                               |
| `name`                      | `categorySet` и `brandSet`        |
| `opennow`                   | *Н/Д*                               |
| `pagetoken`                 | `ofs` и `limit`                   |
| `radius`                    | `radius`                            |
| `rankby`                    | *Н/Д*                               |
| `type`                      | `categorySet –` ознакомьтесь с документацией о [поддерживаемых категориях поиска](supported-search-categories.md).   |

## <a name="calculate-routes-and-directions"></a>Вычисление маршрутов и направлений

С помощью Azure Maps можно вычислять маршруты и направления. Azure Maps обладает большинством аналогичных функций, что и служба маршрутизации Google Карт, например:

- функция вычисления времени прибытия и отправления;
- функция вычисления маршрутов дорожного движения в реальном времени на основе прогнозирования;
- различные режимы перемещения, например на машине, пешком, на велосипеде.

> [!NOTE]
> Azure Maps требует, чтобы все пункты маршрута были в виде координат. Адреса должны быть предварительно геокодированы.

Служба маршрутизации Azure Maps предоставляет следующие API для вычисления маршрутов:

- [**Вычисление маршрута.**](/rest/api/maps/route/getroutedirections) Позволяет вычислить маршрут и немедленно обработать запрос. Этот API поддерживает запросы GET и POST. Мы рекомендуем применять запросы POST при указании большого количества ориентиров или использовании большого количества вариантов маршрута. Это гарантирует, что запрос URL-адреса не будет слишком длинным и не приведет к проблемам. Направление маршрута POST в Azure Maps имеет параметр, который может предусматривать тысячи [поддерживающих точек](/rest/api/maps/route/postroutedirections#supportingpoints) и будет использовать их для повторного создания логического пути маршрута между ними (с привязкой к дороге). 
- [**Пакетные запросы маршрутов.**](/rest/api/maps/route/postroutedirectionsbatchpreview) Позволяет создать запрос, содержащий до 1000 запросов маршрута, и обработать их за определенный период времени. Все данные будут параллельно обработаны на сервере. После завершения можно скачать полный результирующий набор.
- [**Службы "Мобильность" (предварительная версия)**.](/rest/api/maps/mobility) Позволяют вычислить маршруты и направления, используя информацию об общедоступном транспорте.

Таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт    | Сопоставимый параметр API Azure Maps  |
|------------------------------|--------------------------------------|
| `alternatives`                 | `maxAlternatives`                  |
| `arrival_time`                | `arriveAt`                          |
| `avoid`                        | `avoid`                            |
| `departure_time`              | `departAt`                          |
| `destination`                  | `query` — координаты в формате `"lat0,lon0:lat1,lon1…."`.  |
| `key`                          | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                     | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).   |
| `mode`                         | `travelMode`                       |
| `optimize`                     | `computeBestOrder`                 |
| `origin`                       | `query`                            |
| `region`                       | *Н/Д* — это функция, связанная с геокодированием. Используйте параметр *countrySet* вместе с API геокодирования Azure Maps.  |
| `traffic_model`               | *Н/Д* — может только указать, следует ли использовать данные дорожного движения с параметром *traffic*. |
| `transit_mode`                | См. [документацию по службам "Мобильность" (предварительная версия)](/rest/api/maps/mobility). |
| `transit_routing_preference` | См. [документацию по службам "Мобильность" (предварительная версия)](/rest/api/maps/mobility). |
| `units`                        | *Н/Д* — Azure Maps использует только систему метрик.  |
| `waypoints`                    | `query`                            |

> [!TIP]
> По умолчанию API построения маршрута Azure Maps возвращает только сводку. Он возвращает расстояние и время, а также координаты пути маршрута. Параметр `instructionsType` позволяет получить пошаговые инструкции, а параметр `routeRepresentation` — отфильтровать сводку и путь маршрута.

API построения маршрута Azure Maps содержит дополнительные функции, которые недоступны в Google Картах. Если вы переносите приложение, рассмотрите возможность использования этих функций, так как они могут оказаться полезными.

- Поддержка типа маршрута: самый короткий, самый быстрый, прогулочный и маршрут для экономии топлива.
- Поддержка дополнительных режимов перемещений: на автобусе, мотоцикле, такси, грузовике и фургоне.
- Поддержка 150 ориентиров.
- Вычисление нескольких значений времени поездки в одном запросе: с учетом исторического, текущего дорожного движения и без учета дорожного движения.
- Возможность избежать дополнительных типов дорог: транзитных, грунтовых дорог и дорог, по которым вы уже путешествовали.
- Возможность указать специальные области, которых следует избегать.
- Ограничение высоты, на которую может подниматься маршрут.
- Построение маршрута на основе характеристик двигателя. Вычисление маршрутов для автомобилей с двигателями внутреннего сгорания или электрических автомобилей на основе данных об их оставшемся топливе и заряде, а также характеристик двигателя.
- Поддержка параметров для маршрутов коммерческого транспорта. Например, размеры автомобиля, вес, число осей и тип груза.
- Возможность указать максимальную скорость автомобиля.

Кроме того, служба маршрутов в Azure Maps поддерживает [вычисление диапазонов построения маршрута](/rest/api/maps/route/getrouterange). Вычисление диапазонов построения маршрутов также называется построением изохрон. Это означает создание многоугольника, охватывающего область, в которой можно перемещаться в любом направлении от исходной точки. Эта область ограничивается заданным количеством времени, топлива или платы.

Обязательно ознакомьтесь с документацией по [лучшим методикам построения маршрутов](how-to-use-best-practices-for-routing.md).

## <a name="retrieve-a-map-image"></a>Получение изображения карты

Azure Maps предоставляет API для отрисовки статических изображений карт с наложением данных. API [отрисовки изображений карты](/rest/api/maps/render/getmapimagerytile) в Azure Maps можно сравнить с API статических карт в Google Картах.

> [!NOTE]
> Для Azure Maps необходимы координаты центра, всех меток и расположений путей в виде "долгота,широта". В Google Картах же используется формат "широта,долгота". Сначала необходимо выполнить геокодирование адресов.

Таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps  |
|---------------------------|--------------------------------------|
| `center`                    | `center`                           |
| `format`                    | `format` — этот параметр указывается как часть URL адреса. Сейчас поддерживается только формат PNG. |
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `maptype`                   | `layer` и `style`. Ознакомьтесь с документацией о [поддерживаемых стилях карт](supported-map-styles.md). |
| `markers`                   | `pins`                             |
| `path`                      | `path`                             |
| `region`                    | *Н/Д* — это функция, связанная с геокодированием. Используйте параметр `countrySet` вместе с API геокодирования Azure Maps.  |
| `scale`                     | *Н/Д*                              |
| `size`                      | `width` и `height` могут иметь размер до 8192 x 8192. |
| `style`                     | *Н/Д*                              |
| `visible`                   | *Н/Д*                              |
| `zoom`                      | `zoom`                             |

> [!NOTE]
> В системе разбиения Azure Maps используются фрагменты, которые вдвое больше фрагментов карты в Google Картах. Таким образом, значение уровня масштаба в Azure Maps будет на один уровень больше по сравнению с Google Картами. Уменьшите коэффициент масштаба в переносимых запросах, чтобы компенсировать разницу.

Дополнительные сведения см. в статье [Render custom data on a raster map](how-to-render-custom-data.md) (Отображение пользовательских данных на растровой карте).

Кроме возможности создания статического изображения карты, служба отрисовки Azure Maps предоставляет возможность прямого доступа к фрагментам карты в растровом (PNG) и векторном форматах.

- [**Фрагмент карты.**](/rest/api/maps/render/getmaptile) Извлечение растровых (PNG) и векторных фрагментов для базовых карт (дорог, территориальных границ и дальних зон).
- [**Фрагмент снимков карты.**](/rest/api/maps/render/getmapimagerytile) Извлечение фрагментов аэро- и спутниковых снимков.

> [!TIP]
> Многие приложения Google Карт несколько лет назад стали использовать статические изображения карт вместо интерактивных. Это было сделано для сокращения затрат. Обычно в Azure Maps выгоднее использовать интерактивный элемент управления картой в веб-пакете SDK. Плата за элемент управления картой взимается в зависимости от загрузки фрагментов карты. Фрагменты карты в Azure Maps имеют большой размер. Часто требуется лишь несколько фрагментов, чтобы воссоздать такой же вид, как на статической карте. Фрагменты карты автоматически кэшируются браузером. Таким образом, интерактивный элемент управления картой часто создает лишь часть транзакции при воспроизведении статического вида карты. При панорамировании и масштабировании будут загружаться дополнительные фрагменты, однако в элементе управления картой есть параметры, позволяющие отключить это поведение. Интерактивный элемент управления картой также предоставляет гораздо больше параметров визуализации, чем службы статических карт.

### <a name="marker-url-parameter-format-comparison"></a>Сравнение формата параметра URL-адреса метки

**До: Google Карты**

Для добавления меток используется параметр `markers` в URL-адресе. Параметр `markers` принимает стиль и список расположений для прорисовки на карте в этом стиле:

```
&markers=markerStyles|markerLocation1|markerLocation2|...
```

Чтобы использовать дополнительные стили, можно добавить в URL-адрес параметр `markers` с другими стилем и набором расположений.

Расположения меток задаются в формате "широта,долгота".

Стили меток добавляются в формате `optionName:value` с разделением разных стилей вертикальной линией (\|), например optionName1:value1\|optionName2:value2. Обратите внимание, что название и значение параметра разделены двоеточием (:). Чтобы задать стили меток в Google Картах, можно использовать следующие параметры стиля.

- `color` — цвет стандартного значка метки. Это может быть 24-разрядный шестнадцатеричный цвет (`0xrrggbb`) или одно из следующих значений: `black`, `brown`, `green`, `purple`, `yellow`, `blue`, `gray`, `orange`, `red`, `white`.
- `label` — одиночный буквенно-цифровой символ верхнего регистра, отображаемый на значке.
- `size` — размер метки. Возможные значения: `tiny`, `mid` или `small`.

Для пользовательских значков в Google Картах можно использовать следующие параметры стиля.

- `anchor` — определяет способ приведения изображения значка в соответствие с координатами. Можно указать пиксельное значение (x, y) или одно из следующих: `top`, `bottom`, `left`, `right`, `center`, `topleft`, `topright`, `bottomleft` или `bottomright`.
- `icon` — URL-адрес, указывающий на изображение значка.

Например, давайте добавим на карту красную метку среднего размера с долготой –110 и широтой 45.

```
&markers=color:red|size:mid|45,-110
```


![Метка Google Карт](media/migrate-google-maps-web-services/google-maps-marker.png)

**После: Azure Maps**

На статическое изображение карты можно добавить метки, указав параметр `pins` в URL-адресе. Как и в Google Картах, в этом параметре можно указать стиль и список расположений. Параметр `pins` можно указать несколько раз, чтобы использовать метки с разными стилями.

```
&pins=iconType|pinStyles||pinLocation1|pinLocation2|...
```

Чтобы использовать дополнительные стили, можно добавить в URL-адрес параметр `pins` с другими стилем и набором расположений.

В Azure Maps расположение кнопки должно быть указано в формате "долгота широта". В Google Картах же используется формат "широта,долгота". В формате Azure Maps значения долготы и широты разделено пробелом а не запятой.

Параметр `iconType` задает тип создаваемой кнопки. Может иметь следующие значения.

- `default` — стандартный значок метки.
- `none` — значок не отображается, будут отображаться только метки.
- `custom` — указывает используемый пользовательский значок. URL-адрес, указывающий на изображение значка, можно добавить в конец параметра `pins` после сведений о расположении геометки.
- `{udid}` — уникальный идентификатор данных значка, хранящегося на платформе хранилища данных Azure Maps.

Добавлять стили кнопки следует в формате `optionNameValue`. Несколько стилей разделяются знаками вертикальной черты (\|). Например: `iconType|optionName1Value1|optionName2Value2`. Имя и значение параметров не разделены. Для указания стиля меток можно использовать следующие параметры.

- `al` — задает уровень непрозрачности (альфа-версия) метки. Выберите число от 0 до 1.
- `an` — задает привязку геометки. Укажите число пикселей по осям X и Y в формате "x y".
- `co` — цвет геометки. Укажите 24-разрядный шестнадцатеричный цвет: от `000000` до `FFFFFF`.
- `la` — указывает привязку метки. Укажите число пикселей по осям X и Y в формате "x y".
- `lc` — цвет метки. Укажите 24-разрядный шестнадцатеричный цвет: от `000000` до `FFFFFF`.
- `ls` — размер метки в пикселях. Выберите число больше 0.
- `ro` — значение в градусах для поворота значка. Выберите число от –360 до 360.
- `sc` — значение масштаба значка геометки. Выберите число больше 0.

Укажите значения надписи для каждого расположения кнопки. Этот подход более эффективен, чем применение одного значения надписи ко всем меткам в списке расположений. Значением надписи может быть строка из нескольких знаков. Заключите эту строку в одинарные кавычки, чтобы она не была ошибочно обработана как значение стиля или расположения.

Давайте добавим красный значок (`FF0000`) по умолчанию с надписью "Space Needle" под ним (15 50). Координаты значка: долгота –122,349300, широта 47,620180.

```
&pins=default|coFF0000|la15 50||'Space Needle' -122.349300 47.620180
```

![Метка Azure Maps](media/migrate-google-maps-web-services/azure-maps-marker.png)

Добавьте три кнопки с надписями "1", "2" и "3".

```
&pins=default||'1'-122 45|'2'-119.5 43.2|'3'-121.67 47.12
```

![Несколько меток в Azure Maps](media/migrate-google-maps-web-services/azure-maps-multiple-markers.png)

### <a name="path-url-parameter-format-comparison"></a>Сравнение формата параметра URL-адреса пути

**До: Google Карты**

На изображение статической карты можно добавить линии и многоугольники, используя параметр `path` в URL-адресе. Параметр `path` принимает стиль и список расположений для отрисовки на карте, как показано ниже.

```
&path=pathStyles|pathLocation1|pathLocation2|...
```

Чтобы использовать дополнительные стили, можно добавить в URL-адрес параметр `path` с другими стилем и набором расположений.

Расположения путей указываются в формате `latitude1,longitude1|latitude2,longitude2|…`. Пути могут быть закодированы или содержать адреса для точек.

Чтобы добавить несколько стилей пути в формате `optionName:value`, их нужно разделить знаками вертикальной черты (\|). Имя и значение параметров должны быть разделены двоеточием (:). Пример: `optionName1:value1|optionName2:value2`. Чтобы задать стили путей в Google Картах, можно использовать следующие параметры стилей:

- `color` — цвет контура пути или многоугольника. Можно указать 24-разрядный шестнадцатеричный цвет (`0xrrggbb`), 32-разрядный шестнадцатеричный цвет (`0xrrggbbbaa`) или одно из следующих значений: black, brown, green, purple, yellow, blue, gray, orange, red, white.
- `fillColor` — цвет заливки области пути (многоугольника). Можно указать 24-разрядный шестнадцатеричный цвет (`0xrrggbb`), 32-разрядный шестнадцатеричный цвет (`0xrrggbbbaa`) или одно из следующих значений: black, brown, green, purple, yellow, blue, gray, orange, red, white.
- `geodesic` — указывает, является ли путь линией, следующей за кривизной земли.
- `weight` — толщина линии пути в пикселях.

В параметре URL-адреса можно указать значение непрозрачности красной линии между координатами и ее толщину в пикселях, чтобы добавить на карту. В приведенном ниже примере линия имеет непрозрачность 50 % и толщину в четыре пикселя. Долгота и широта ее концов: –110, 45 и −100, 50.

```
&path=color:0xFF000088|weight:4|45,-110|50,-100
```

![Ломаная линия в Google Картах](media/migrate-google-maps-web-services/google-maps-polyline.png)

**После: Azure Maps**

На статическое изображение карты можно добавить линии и многоугольники, указав параметр `path` в URL-адресе. Как и в Google Картах, в этом параметре можно указать стиль и список расположений. Можно указать параметр `path` несколько раз, чтобы отобразить несколько кругов, линий и многоугольников с разными стилями.

```
&path=pathStyles||pathLocation1|pathLocation2|...
```

Однако для расположения путей в Azure Maps необходимо указать координаты в формате "долгота широта". В Google Картах же используется формат "широта,долгота". В формате Azure Maps значения долготы и широты разделено пробелом а не запятой. Azure Maps не поддерживает закодированные пути или адреса для точек. Большие наборы данных можно передать в качестве GEOJSON-файла в API хранилища данных Azure Maps, как описано [здесь](how-to-render-custom-data.md#get-data-from-azure-maps-data-storage).

Добавлять стили пути следует в формате `optionNameValue`. Несколько стилей разделяются знаками вертикальной черты (\|). Пример: `optionName1Value1|optionName2Value2`. Имя и значение параметров не разделены. Чтобы задать стили путей в Azure Maps, можно использовать следующие параметры стиля.

- `fa` — прозрачность цвета заливки (альфа-версия), используемая при отрисовке многоугольников. Выберите число от 0 до 1.
- `fc` — цвет заливки, используемый для отрисовки области многоугольника.
- `la` — прозрачность цвета линии (альфа-версия), используемая при отрисовке линий и контуров многоугольников. Выберите число от 0 до 1.
- `lc` — цвет линии, используемый при отрисовке линий и контуров многоугольников.
- `lw` — ширина линии в пикселях.
- `ra` — указывает радиус круга в метрах.

В параметре URL-адреса можно указать значение непрозрачности красной линии между координатами и ее толщину в пикселях. В приведенном ниже примере линия имеет непрозрачность 50 % и толщину в четыре пикселя. Долгота и широта ее концов: –110, 45 и −100, 50.

```
&path=lcFF0000|la.5|lw4||-110 45|-100 50
```

![Ломаная линия в Azure Maps](media/migrate-google-maps-web-services/azure-maps-polyline.png)

## <a name="calculate-a-distance-matrix"></a>Вычисление матрицы расстояний

Azure Maps предоставляет API матрицы расстояний. Этот API используется для вычисления времени поездки и расстояний между набором расположений с помощью матрицы расстояний. Он схож с API матрицы расстояний в Google Картах.

- [**Матрица маршрута.**](/rest/api/maps/route/postroutematrixpreview) Асинхронно вычисляет время и расстояния поездки для набора исходных мест и мест назначения. Поддерживает до 700 ячеек на запрос. Это количество исходных мест, умноженное на количество мест назначения. Учитывая это ограничение, примерами возможных матричных измерений могут быть такие: 700 x 1, 50 x 10, 10 x 10, 28 x 25, 10 x 70.

> [!NOTE]
> Запрос к API матрицы расстояний можно выполнить только с использованием запроса POST, содержащего в своем тексте сведения об исходном месте и месте назначения. Кроме того, для Azure Maps необходимо предоставить координаты всех исходных мест и мест назначения. Сначала необходимо выполнить геокодирование адресов.

Таблица содержит параметры API Google Карт и сопоставимые параметры API Azure Maps.

| Параметр API Google Карт      | Сопоставимый параметр API Azure Maps  |
|--------------------------------|--------------------------------------|
| `arrivial_time`                | `arriveAt`                           |
| `avoid`                        | `avoid`                              |
| `depature_time`                | `departAt`                           |
| `destinations`                 | `destination` — указывается в тексте запроса POST в формате GeoJSON. |
| `key`                          | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                     | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `mode`                         | `travelMode`                         |
| `origins`                      | `origins` — указывается в тексте запроса POST в формате GeoJSON.  |
| `region`                       | *Н/Д* — это функция, связанная с геокодированием. Используйте параметр `countrySet` вместе с API геокодирования Azure Maps. |
| `traffic_model`                | *Н/Д* — может только указать, следует ли использовать данные дорожного движения с параметром `traffic`. |
| `transit_mode`                 | *Н/Д* — матрицы расстояний на основе общественного транспорта в настоящее время не поддерживаются.  |
| `transit_routing_preference`   | *Н/Д* — матрицы расстояний на основе общественного транспорта в настоящее время не поддерживаются.  |
| `units`                        | *Н/Д* — Azure Maps использует только систему метрик. |

> [!TIP]
> Все дополнительные параметры построения маршрутов, доступные в API построения маршрутов Azure Maps, поддерживаются в API матрицы расстояний Azure Maps. К дополнительным параметрам относятся: построение маршрутов для грузовика, характеристики мотора, области, которые следует избегать и т. д.

Обязательно ознакомьтесь с документацией по [лучшим методикам построения маршрутов](how-to-use-best-practices-for-routing.md).

## <a name="get-a-time-zone"></a>Получение часового пояса

Azure Maps предоставляет API для получения часового пояса, в котором расположены указанные координаты. API часового пояса Azure Maps сравним с API часового пояса в Google Картах:

- [**Часовой пояс по координатам.**](/rest/api/maps/timezone/gettimezonebycoordinates) Можно указать координаты и получить сведения о часовом поясе, в котором они расположены.

Данная таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps   |
|---------------------------|---------------------------------------|
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md).       |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).    |
| `location`                  | `query`             |
| `timestamp`                 | `timeStamp`         |

Помимо этого API в Azure Maps доступен ряд API часового пояса. Эти API преобразовывают время на основе имен или идентификаторов часового пояса.

- [**Часовой пояс по идентификатору.**](/rest/api/maps/timezone/gettimezonebyid) Возвращает сведения о текущем, прошлом и будущем часовом поясе для указанного идентификатора часового пояса IANA.
- [**Перечисление часовых поясов IANA.**](/rest/api/maps/timezone/gettimezoneenumiana) Возвращает полный список идентификаторов часовых поясов IANA. Обновления службы IANA отражаются в системе в течение одного дня.
- [**Перечисление часовых поясов Windows.**](/rest/api/maps/timezone/gettimezoneenumwindows) Возвращает полный список идентификаторов часовых поясов Windows.
- [**Часовой пояс версии IANA.**](/rest/api/maps/timezone/gettimezoneianaversion) Возвращает текущий номер версии IANA, используемый Azure Maps.
- [**Часовой пояс IANA для Windows.**](/rest/api/maps/timezone/gettimezonewindowstoiana) Возвращает соответствующий идентификатор IANA с учетом допустимого идентификатора часового пояса Windows. Для одного идентификатора Windows может быть возвращено несколько идентификаторов IANA.

## <a name="client-libraries"></a>Клиентские библиотеки

Azure Maps предоставляет клиентские библиотеки для следующих языков:

- JavaScript, TypeScript, Node.js — [документация](how-to-use-services-module.md) \| [пакет NPM](https://www.npmjs.com/package/azure-maps-rest).

Клиентские библиотеки с открытым кодом для других языков программирования:

- .NET Standard 2.0 — [проект GitHub](https://github.com/perfahlen/AzureMapsRestServices) \| [пакет NuGet](https://www.nuget.org/packages/AzureMapsRestToolkit/).

## <a name="next-steps"></a>Дальнейшие действия

Подробнее о службах REST Azure Maps:

> [!div class="nextstepaction"]
> [Рекомендации по использованию службы поиска Azure Maps](how-to-use-best-practices-for-search.md)

> [!div class="nextstepaction"]
> [Поиск адреса с помощью службы поиска Azure Maps](how-to-search-for-address.md)

> [!div class="nextstepaction"]
> [Рекомендации по построению маршрутов](how-to-use-best-practices-for-routing.md)

> [!div class="nextstepaction"]
> [Справочная документация по API службы REST Azure Maps](/rest/api/maps/)

> [!div class="nextstepaction"]
> [Примеры кода](/samples/browse/?products=azure-maps)

> [!div class="nextstepaction"]
> [Сведения об использовании модуля служб Azure Maps](how-to-use-best-practices-for-routing.md)