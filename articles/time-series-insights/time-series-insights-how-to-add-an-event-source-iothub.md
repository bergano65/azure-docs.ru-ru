---
title: Как добавить источник событий центра Интернета вещей в службу "Аналитика временных рядов Azure" | Документация Майкрософт
description: Из этой статьи вы узнаете, как добавить в среду службы "Аналитика временных рядов" источник событий, подключенный к центру Интернета вещей.
ms.service: time-series-insights
services: time-series-insights
author: deepakpalled
ms.author: dpalled
manager: cshankar
ms.reviewer: v-mamcge, jasonh, kfile
ms.workload: big-data
ms.topic: conceptual
ms.date: 10/09/2019
ms.custom: seodec18
ms.openlocfilehash: f9dd79bacf2d21e0c7e7681e5217d5e874b2b30e
ms.sourcegitcommit: 92d42c04e0585a353668067910b1a6afaf07c709
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/28/2019
ms.locfileid: "72991198"
---
# <a name="add-an-iot-hub-event-source-to-your-time-series-insights-environment"></a>Добавление в среду службы "Аналитика временных рядов Azure" источник событий центра Интернета вещей

Из этой статьи вы узнаете, как с помощью портала Azure добавить в среду службы "Аналитика временных рядов Azure" источник события, который считывает данные из центра Интернета вещей Azure.

> [!NOTE]
> Инструкции в этой статье применяются к средам "Аналитика временных рядов" общедоступной и предварительной версий.

## <a name="prerequisites"></a>Технические условия

* Создайте [среду службы "Аналитика временных рядов Azure"](time-series-insights-update-create-environment.md).
* Создайте [центр Интернета вещей с помощью портала Azure](../iot-hub/iot-hub-create-through-portal.md).
* В центр Интернета вещей должны отправляться активные события сообщений.
* Создайте в центре Интернета вещей выделенную группу объектов-получателей, из которой среда службы "Аналитика временных рядов" будет получать информацию. Каждый источник событий Аналитики временных рядов должен иметь собственную выделенную группу объектов-получателей, не используемую другими объектами-получателями. Если несколько модулей чтения используют события из одной группы потребителей, как правило, во всех модулях могут произойти сбои. Дополнительные сведения см. в статье [Руководство разработчика для Центра Интернета вещей Azure](../iot-hub/iot-hub-devguide.md).

### <a name="add-a-consumer-group-to-your-iot-hub"></a>Добавление группы потребителей в Центр Интернета вещей

Группы объектов-получателей используются приложениями для извлечения данных из Центра Интернета вещей Azure. Чтобы надежно считывать данные из центра Интернета вещей, укажите выделенную группу потребителей, используемую только в этой среде "аналитика временных рядов".

Чтобы добавить группу объектов-получателей в центр Интернета вещей:

1. В [портал Azure](https://portal.azure.com)найдите и откройте центр Интернета вещей.

1. В разделе **Параметры**выберите **встроенные конечные точки**, а затем выберите конечную точку **события** .

   [![на странице "сборка — в конечных точках" нажмите кнопку события.](media/time-series-insights-how-to-add-an-event-source-iothub/1-iot-hub.png)](media/time-series-insights-how-to-add-an-event-source-iothub/1-iot-hub.png#lightbox)

1. В разделе **Группы потребителей** введите уникальное имя для группы объектов-получателей. Укажите это же имя при создании нового источника событий в среде службы "Аналитика временных рядов".

1. Щелкните **Сохранить**.

## <a name="add-a-new-event-source"></a>Добавление нового источника событий

1. Войдите на [портале Azure](https://portal.azure.com).

1. В меню слева выберите **Все ресурсы**. Выберите среду Time Series Insights.

1. В разделе **Топология окружения** выберите **Источники событий**, а затем щелкните **Добавить**.

   [![выберите источники событий, а затем нажмите кнопку Добавить.](media/time-series-insights-how-to-add-an-event-source-iothub/2-add-event-source.png)](media/time-series-insights-how-to-add-an-event-source-iothub/2-add-event-source.png#lightbox)

1. В области **Новый источник событий** в поле **Имя источника событий** введите имя, которое является уникальным для этой среды службы "Аналитика временных рядов". Например, введите **event-stream**.

1. Для **источника** выберите **Центр Интернета вещей**.

1. Выберите значение для параметра **Вариант импорта**:

   * Выберите **Использовать Центр Интернета вещей в доступных подписках**, если в одной из ваших подписок уже есть центр Интернета вещей. Этот вариант — самый простой подход.
   
     [![выбрать параметры на панели «Создание источника событий»](media/time-series-insights-how-to-add-an-event-source-iothub/3-select-an-import-option.png)](media/time-series-insights-how-to-add-an-event-source-iothub/3-select-an-import-option.png#lightbox)

    * В следующей таблице описаны обязательные свойства для варианта **Использовать Центр Интернета вещей в доступных подписках**:

       [![новой области источника событий — свойства, которые задаются в параметре использовать центр Интернета вещей из доступных подписок](media/time-series-insights-how-to-add-an-event-source-iothub/4-create-button.png)](media/time-series-insights-how-to-add-an-event-source-iothub/4-create-button.png#lightbox)

       | Свойство | Описание |
       | --- | --- |
       | Subscription | Подписка, к которой принадлежит нужный центр Интернета вещей. |
       | IoT hub name (Имя Центра Интернета вещей) | Имя выбранного центра Интернета вещей. |
       | IoT hub policy name (Имя политики Центра Интернета вещей) | Выберите политику общего доступа. Политику общего доступа можно найти на вкладке Параметры центра Интернета вещей. Каждая политика общего доступа имеет имя, разрешения, заданные пользователем, и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**. |
       | Ключ политики Центра Интернета вещей | Ключ указывается автоматически. |

    * Выберите **Указать параметры Центра Интернета вещей вручную**, если центр Интернета вещей не входит в вашу подписку или для него нужно указать дополнительные параметры.

      В следующей таблице описаны обязательные свойства при выборе варианта **Указать параметры Центра Интернета вещей вручную**:

       | Свойство | Описание |
       | --- | --- |
       | Идентификатор подписки | Подписка, к которой принадлежит нужный центр Интернета вещей. |
       | группа ресурсов. | Имя группы ресурсов, в которой создан центр Интернета вещей. |
       | IoT hub name (Имя Центра Интернета вещей) | Имя центра Интернета вещей. При создании центра Интернета вещей вы ввели имя для него. |
       | IoT hub policy name (Имя политики Центра Интернета вещей) | Политика общего доступа. Политику общего доступа можно создать на вкладке Параметры центра Интернета вещей. Каждая политика общего доступа имеет имя, разрешения, заданные пользователем, и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**. |
       | Ключ политики Центра Интернета вещей | Ключ общего доступа, используемый для аутентификации доступа к пространству имен Служебной шины Azure. Введите первичный или вторичный ключ здесь. |

    * Оба параметра имеют следующие параметры конфигурации:

       | Свойство | Описание |
       | --- | --- |
       | Группа потребителей Центра Интернета вещей | Группа объектов-получателей, которая считывает события из центра Интернета вещей. Мы настоятельно рекомендуем использовать выделенную группу объектов-получателей для источника событий. |
       | Формат сериализации событий | В настоящее время JSON — это единственный доступный формат сериализации. Сообщения событий должны быть в этом формате, иначе данные не удастся прочитать. |
       | Имя свойства метки времени | Чтобы определить это значение, необходимо иметь представление о формате данных сообщений, отправляемых в центр Интернета вещей. Это значение представляет собой **имя** определенного свойства события в данных сообщения, которое требуется использовать в качестве метки времени события. Для этого значения учитывается регистр. Если оставить значение пустым, в качестве метки времени события будет использоваться **время постановки события в очередь** в пределах источника событий. |


1. Добавьте имя отдельной группы объектов-получателей службы "Аналитика временных рядов", которое вы добавили в центр Интернета вещей.

1. Нажмите кнопку **Создать**.

1. После создания источника событий служба "Аналитика временных рядов" автоматически запустит потоковую передачу данных в среду.

## <a name="next-steps"></a>Дальнейшие действия

* [Определите политики доступа к данным](time-series-insights-data-access.md) для защиты данных.

* [Отправьте события](time-series-insights-send-events.md) в источник событий.

* Получите доступ к своей среде в [обозревателе службы "Аналитика временных рядов"](https://insights.timeseries.azure.com).
