---
title: Диагностика и устранение неполадок в среде Gen2 с помощью службы "аналитика временных рядов Azure" | Документация Майкрософт
description: Узнайте, как диагностировать и устранять неполадки в среде Gen2 "аналитика временных рядов Azure".
author: deepakpalled
ms.author: dpalled
manager: diviso
ms.workload: big-data
ms.service: time-series-insights
services: time-series-insights
ms.topic: conceptual
ms.date: 06/30/2020
ms.custom: seodec18
ms.openlocfilehash: 106600b608586175cbab1098cf0eb7ac6fad94fa
ms.sourcegitcommit: f5580dd1d1799de15646e195f0120b9f9255617b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2020
ms.locfileid: "91540308"
---
# <a name="diagnose-and-troubleshoot-an-azure-time-series-insights-gen2-environment"></a>Диагностика и устранение неполадок среды Gen2 "аналитика временных рядов Azure"

В этой статье перечислены некоторые распространенные проблемы, которые могут возникнуть при работе с средой Gen2 службы "аналитика временных рядов Azure". Здесь также описаны потенциальные причины и решения каждой проблемы.

## <a name="problem-i-cant-find-my-environment-in-the-gen2-explorer"></a>Проблема. не удается найти окружение в обозревателе Gen2

Эта проблема может возникнуть, если у вас нет разрешений на доступ к среде "аналитика временных рядов". Для просмотра такой среды пользователям необходима роль доступа на уровне читателя. Чтобы проверить текущие уровни доступа и предоставить дополнительный доступ, перейдите к разделу **политики доступа к данным** в ресурсе "аналитика временных рядов" в [портал Azure](https://portal.azure.com/).

  [![Проверка политик доступа к данным.](media/preview-troubleshoot/verify-data-access-policies.png)](media/preview-troubleshoot/verify-data-access-policies.png#lightbox)

## <a name="problem-no-data-is-seen-in-the-gen2-explorer"></a>Проблема. в обозревателе Gen2 данные не отображаются.

Существует несколько распространенных причин, по которым данные могут не отображаться в [обозревателе Gen2 "аналитика временных рядов Azure](https://insights.timeseries.azure.com/preview)".

- Ваш источник события может не получать данные.

    Убедитесь, что источник события, представляющий собой концентратор событий или центр Интернета вещей, получает данные из ваших тегов или экземпляров. Для этого перейдите к странице обзора вашего ресурса на портале Azure.

    [![Обзор метрик панели мониторинга.](media/preview-troubleshoot/verify-dashboard-metrics.png)](media/preview-troubleshoot/verify-dashboard-metrics.png#lightbox)

- Источник события не содержит данные в формате JSON.

    Среда службы "Аналитика временных рядов" поддерживает только данные в формате JSON. Примеры JSON см. в статье [поддерживаемые фигуры JSON](./how-to-shape-query-json.md).

- Для вашего ключа источника события отсутствует необходимое разрешение.

  * Для Центра Интернета вещей необходимо указать ключ с разрешением на **подключение службы**.

    [![Проверьте разрешения центра Интернета вещей.](media/preview-troubleshoot/verify-correct-permissions.png)](media/preview-troubleshoot/verify-correct-permissions.png#lightbox)

    * Политики **iothubowner** и **Service** работают, так как у них есть разрешение на **Подключение к службе** .

  * Для концентратора событий необходимо указать ключ с разрешением на **прослушивание**.
  
    [![Проверьте разрешения концентратора событий.](media/preview-troubleshoot/verify-eh-permissions.png)](media/preview-troubleshoot/verify-eh-permissions.png#lightbox)

    * Политики **чтения** и **управления** работают, так как они имеют разрешение на **прослушивание** .

- Указанная группа объектов-получателей не является уникальной для службы "Аналитика временных рядов".

    Во время регистрации центра Интернета вещей или концентратора событий нужно указать группу объектов-получателей, которая используется для чтения данных. Эта группа потребителей должна быть уникальной для каждой среды. Иначе базовый концентратор событий автоматически отключит один из модулей чтения в случайном порядке. Укажите уникальную группу получателей, из которой должна считывать данные среда службы "Аналитика временных рядов".

- Ваше свойство идентификатора временного ряда, указанное во время подготовки, неверно, отсутствует или имеет значение NULL.

    Эта проблема может возникнуть, если во время подготовки среды свойство идентификатора временного ряда настроено неправильно. Дополнительные сведения см. [в статье рекомендации по выбору идентификатора временных рядов](./time-series-insights-update-how-to-id.md). В настоящее время вы не можете обновить имеющуюся среду службы "Аналитика временных рядов", чтобы использовать другой идентификатор временного ряда.

## <a name="problem-some-data-shows-but-some-is-missing"></a>Проблема. Некоторые данные отображаются, но некоторые отсутствуют

Возможно, вы отправляете данные без идентификатора временного ряда.

- Эта проблема может возникнуть при отправке событий без поля идентификатора временного ряда в полезных данных. Дополнительные сведения см. в статье [поддерживаемые фигуры JSON](./how-to-shape-query-json.md).
- Эта проблема может возникнуть из-за регулирования вашей среды.

    > [!NOTE]
    > В настоящее время служба "Аналитика временных рядов" поддерживает максимальную скорость приема данных 6 Мбит/с.

## <a name="problem-data-was-showing-but-now-ingestion-has-stopped"></a>Проблема: данные были показаны, но теперь прием остановлен

- Возможно, ключ источника события был повторно создан, и среде Gen2 требуется новый ключ источника события.

Эта проблема возникает, когда ключ, указанный при создании источника события, больше не является допустимым. В концентраторе будут отображаться данные телеметрии, но не входящие сообщения, полученные в ходе анализа временных рядов. Если вы не уверены, был ли ключ создан повторно, можно выполнить поиск в журнале действий "Создание или обновление правил авторизации пространства имен" или выполнить поиск по запросу "Создание или обновление ресурса IotHub" для центра Интернета вещей. 

Чтобы обновить среду Gen2 "аналитика временных рядов" с помощью нового ключа, откройте ресурс-концентратор в портал Azure и скопируйте новый ключ. Перейдите к ресурсу TSI и щелкните источники событий. 

   [![Снимок экрана с вызываемым пунктом меню «ресурс с источниками событий».](media/preview-troubleshoot/update-hub-key-step-1.png)](media/preview-troubleshoot/update-hub-key-step-1.png#lightbox)

Выберите источники событий, которые были остановлены при приеме, вставьте новый ключ и нажмите кнопку Сохранить.

   [![На снимке экрана показан ресурс T S I, в котором введен ключ политики концентратора I o T.](media/preview-troubleshoot/update-hub-key-step-2.png)](media/preview-troubleshoot/update-hub-key-step-2.png#lightbox)

## <a name="problem-my-event-sources-timestamp-property-name-doesnt-work"></a>Проблема. имя свойства метки времени источника событий не работает

Убедитесь, что имя и значение соответствуют следующим правилам:

* В имени свойства метки времени учитывается регистр.
* Значение свойства timestamp, которое берется из источника события в виде строки JSON, имеет формат `yyyy-MM-ddTHH:mm:ss.FFFFFFFK` . Пример такой строки — `"2008-04-12T12:53Z"`.

Самый простой способ убедиться в том, что имя свойства метки времени захвачено и работает правильно, — использовать обозреватель Gen2 временных рядов Insights. В обозревателе Gen2 временных рядов Insights используйте диаграмму, чтобы выбрать период времени после того, как вы указали имя свойства метки времени. Щелкните выделение правой кнопкой мыши и выберите параметр **обзора событий**. Заголовок первого столбца — это имя вашего свойства метки времени. Рядом со словом `Timestamp` должен находиться аргумент `($ts)` вместо приведенных ниже вариантов:

* `(abc)` указывает на то, что служба "Аналитика временных рядов" считывает значения данных в виде строк.
* Значок **календаря** , указывающий, что Time Series Insights считывает значение данных как DateTime.
* `#` указывает, что служба "Аналитика временных рядов" считывает значения данных как целое число.

Если свойство timestamp не указано явно, то в качестве отметки времени по умолчанию используется центр Интернета вещей или время в очереди концентратора событий.

## <a name="problem-i-cant-view-data-from-my-warm-store-in-the-explorer"></a>Проблема. не удается просмотреть данные из "горячего" хранилища в проводнике

- Возможно, вы недавно подготовили горячее хранилище, и данные все еще передаются.
- Возможно, вы удалили горячее хранилище. в этом случае данные будут потеряны.

## <a name="problem-i-cant-view-or-edit-my-time-series-model"></a>Проблема. не удается просмотреть или изменить модель временных рядов

- Возможно, вы пытаетесь получить доступ к среде службы "Аналитика временных рядов" S1 или S2.

   Модели временных рядов поддерживаются только в средах с оплатой по мере использования. Дополнительные сведения о том, как получить доступ к среде S1 или S2 из обозревателя Gen2 временных рядов Insights, см. [в статье Визуализация данных в обозревателе](./time-series-insights-update-explorer.md).

   [![Нет событий в окружении.](media/preview-troubleshoot/troubleshoot-no-events.png)](media/preview-troubleshoot/troubleshoot-no-events.png#lightbox)

- Возможно, у вас нет прав на просмотр и изменение модели.

   Для изменения и просмотра модели временных рядов пользователям необходим доступ на уровне участника. Чтобы проверить текущие уровни доступа и предоставить дополнительный доступ, перейдите к разделу **политики доступа к данным** в ресурсе "аналитика временных рядов" в портал Azure.

## <a name="problem-all-my-instances-in-the-gen2-explorer-lack-a-parent"></a>Проблема. у всех моих экземпляров в обозревателе Gen2 отсутствует родитель

Эта проблема может возникать, если в вашей среде не определена иерархия модели временных рядов. Дополнительные сведения см. в статье о [работе с моделями временных рядов](/azure/time-series-insights/time-series-insights-overview).

  [![Экземпляры, не являющиеся родительскими, будут отображать предупреждение.](media/preview-troubleshoot/unparented-instances.png)](media/preview-troubleshoot/unparented-instances.png#lightbox)

## <a name="problem-power-bi-connector-shows-unable-to-connect"></a>Проблема. в соединителе Power BI отображается сообщение "не удается подключиться"

Эта проблема может возникать, если в Power BI Desktop не используется последняя версия соединителя Power BI.

[![На снимке экрана показано диалоговое окно "не удалось подключиться".](media/preview-troubleshoot/power-bi-unable-to-connect.png)](media/preview-troubleshoot/power-bi-unable-to-connect.png#lightbox)

* Проверьте версию Power BI Desktop и убедитесь, что вы используете версию 2020 июля. В противном случае обновите Power BI Desktop и запустите соединитель еще раз. 

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [работать с моделями временных рядов](/azure/time-series-insights/time-series-insights-overview).

- Дополнительные сведения о [поддерживаемых фигурах JSON](./how-to-shape-query-json.md).

- Ознакомьтесь с разрешениями по [планированию и ограничениям](./time-series-insights-update-plan.md) в службе "аналитика временных рядов Azure" Gen2.
