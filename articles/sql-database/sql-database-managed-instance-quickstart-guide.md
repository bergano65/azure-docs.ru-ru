---
title: Краткое руководство. Управляемый экземпляр Базы данных SQL Azure | Документация Майкрософт
description: Узнайте, как быстро приступить к работе с управляемым экземпляром Базы данных SQL Azure
services: sql-database
ms.service: sql-database
ms.subservice: managed-instance
ms.custom: ''
ms.devlang: ''
ms.topic: quickstart
author: jovanpop-msft
ms.author: jovanpop
ms.reviewer: carlr
manager: craigg
ms.date: 02/04/2019
ms.openlocfilehash: a70e83737c6b56aee3279375ec653f12810b13b4
ms.sourcegitcommit: 039263ff6271f318b471c4bf3dbc4b72659658ec
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2019
ms.locfileid: "55749820"
---
# <a name="getting-started-with-azure-sql-database-managed-instance"></a>Начало работы с управляемым экземпляром Базы данных SQL Azure

При развертывании [управляемого экземпляра](sql-database-managed-instance-index.yml) создается база данных, практически полностью совместимая с последним ядром СУБД локальной версии SQL Server (Enterprise Edition). Она предоставляет собственную реализацию [виртуальной сети (VNet)](../virtual-network/virtual-networks-overview.md), в которой устранены распространенные проблемы безопасности, и [бизнес-модель](https://azure.microsoft.com/pricing/details/sql-database/), подходящую для клиентов локальной версии SQL Server. В этом разделе описывается, как быстро создать и настроить управляемый экземпляр, а также как перенести базы данных.

## <a name="quickstart-overview"></a>Общие сведения о кратком руководстве

Следующие краткие руководств позволяют быстро создать управляемый экземпляр, настроить виртуальную машину или VPN-подключение типа "точка — сеть" для клиентского приложения и восстановить базу данных в новый управляемый экземпляр с помощью файла `.bak`:

- [Создание Управляемого экземпляра Базы данных SQL Azure](sql-database-managed-instance-get-started.md). На портале Azure вы настраиваете необходимые параметры (имя пользователя, пароль, число ядер, максимальный объем хранилища) и автоматически создаете сетевую среду Azure. Для этого вам не нужно иметь опыт работы с сетями или знать о требованиях к инфраструктуре. Вам нужен только [тип подписки](sql-database-managed-instance-resource-limits.md#supported-subscription-types), позволяющий создать управляемый экземпляр. Если вы хотите настроить или использовать собственную сеть, узнайте, как [настроить сетевую среду](#configure-network-environment) для управляемого экземпляра.
- Управляемый экземпляр создается в вашей виртуальной сети без общедоступной конечной точки. Для доступа клиентских приложений можно создать виртуальную машину в той же виртуальной сети (в другой подсети) или VPN-подключение типа "точка — сеть" к виртуальной сети для клиентского компьютера с помощью одного из этих кратких руководств.
  - Создайте [виртуальную машину Azure в управляемом экземпляре виртуальной сети](sql-database-managed-instance-configure-vm.md), чтобы обеспечить возможность подключения клиентского приложения, включая SQL Server Management Studio.
  - Настройте [VPN-подключение типа "точка — сеть" к управляемому экземпляру](sql-database-managed-instance-configure-p2s.md) для клиентского компьютера, на котором установлено ПО SQL Server Management Studio и подключаемые клиентские приложения. Это другой из двух вариантов подключения к управляемому экземпляру и его виртуальной сети.

  > [!NOTE]
  > Вы также можете использовать ExpressRoute или подключение типа "сеть — сеть" из локальной сети, но эти подходы не описаны в этих кратких руководствах.

Создав управляемый экземпляр и настроив доступ, вы можете начать переносить базы данных, размещенные на локальном экземпляре SQL Server или виртуальных машинах Azure. Перенос завершится ошибкой, если у исходной перемещаемой базы данных есть неподдерживаемые функции. Чтобы избежать сбоев и проверить совместимость, вы можете установить [Помощник по миграции данных (DMA)](https://www.microsoft.com/download/details.aspx?id=53595), который проанализирует ваши базы данных SQL Server и обнаружит любые проблемы, блокирующие перемещение в управляемый экземпляр, например наличие [файлового потока](https://docs.microsoft.com/sql/relational-databases/blob/filestream-sql-server) или нескольких файлов журнала. Если вы решите эти проблемы, ваши базы данных будут готовы к переносу в управляемый экземпляр. [Database Experimentation Assistant](https://blogs.msdn.microsoft.com/datamigration/2018/08/06/release-database-experimentation-assistant-dea-v2-6/) — еще один полезный инструмент, который может записывать рабочую нагрузку на SQL Server и воспроизводить ее в управляемом экземпляре. Так он позволяет определить, не возникнут ли какие-либо проблемы с производительностью в случае перемещения в управляемый экземпляр.

Убедившись в возможности переноса базы данных в управляемый экземпляр, вы можете использовать встроенную функцию исходного восстановления SQL Server, чтобы восстановить базу данных в управляемый экземпляр из файла `.bak`. См. дополнительные сведения о [восстановлении базы данных в управляемый экземпляр](sql-database-managed-instance-get-started-restore.md). В этом кратком руководстве описано, как восстановить базу данных из файла `.bak`, хранящегося в хранилище BLOB-объектов Azure, с помощью команды Transact-SQL `RESTORE`. 

> [!TIP]
> Сведения о создания резервной копии базы данных в хранилище BLOB-объектов Azure с помощью команды Transact-SQL `BACKUP` см. в статье [Резервное копирование в SQL Server по URL-адресу](https://docs.microsoft.com/sql/relational-databases/backup-restore/sql-server-backup-to-url).

Эти краткие руководства помогут вам быстро создавать, настраивать и восстанавливать базы данных из резервной копии в управляемый экземпляр. В некоторых сценариях вам может потребоваться настроить или автоматизировать развертывание управляемых экземпляров и необходимой сетевой среды. Эти сценарии описаны ниже.

## <a name="customizing-network-environment"></a>Настройка сетевой среды

Хотя виртуальная сеть и подсеть могут быть автоматически настроены при создании экземпляра с помощью портала Azure, вам может потребоваться создать виртуальную сеть или подсеть до начала создания управляемых экземпляров, чтобы настроить параметры виртуальной сети и подсети. Самый простой способ создать и настроить сетевую среду — использовать шаблон [Azure Resource Manager](sql-database-managed-instance-create-vnet-subnet.md), чтобы создать и настроить сеть и подсеть для управляемого экземпляра. Для этого просто нужно нажать кнопку развертывания Azure Resource Manager и заполнить форму параметрами. 

В качестве альтернативы можно также использовать этот [скрипт PowerShell](https://www.powershellmagazine.com/2018/07/23/configuring-azure-environment-to-set-up-azure-sql-database-managed-instance-preview/) для автоматизации создания сети.

Если у вас уже есть виртуальная сеть и подсеть, в которой вы хотите развернуть управляемый экземпляр, нужно убедиться, что они соответствуют [требованиям к сети](sql-database-managed-instance-connectivity-architecture.md#network-requirements). Чтобы убедиться, что подсеть настроена должным образом, воспользуйтесь этим [скриптом PowerShell](sql-database-managed-instance-configure-vnet-subnet.md). Скрипт проверяет сеть, уведомляет о проблемах, необходимых изменениях и предлагает внести требуемые изменения в виртуальную сеть или подсеть. Выполните этот скрипт, если не хотите вручную настраивать виртуальную сеть или подсеть. Его также можно выполнять после масштабной перенастройки сетевой инфраструктуры. Если вы хотите создать и настроить собственную сеть, см. статью [Архитектура подключения к управляемому экземпляру Базы данных SQL Azure](sql-database-managed-instance-connectivity-architecture.md) и [это руководство](https://medium.com/azure-sqldb-managed-instance/the-ultimate-guide-for-creating-and-configuring-azure-sql-managed-instance-environment-91ff58c0be01).

## <a name="automating-creation-of-a-managed-instance"></a>Автоматическое создание управляемого экземпляра

 Если вы не создавали сетевую среду, как описано на предыдущем шаге, портал Azure может сделать это за вас. Единственным недостатком является то, что сетевая среда будет настроена с некоторыми параметрами по умолчанию, которые невозможно впоследствии изменить. В качестве альтернативы можно использовать:

- [PowerShell](https://blogs.msdn.microsoft.com/sqlserverstorageengine/2018/06/27/quick-start-script-create-azure-sql-managed-instance-using-powershell/);
- [PowerShell с шаблоном Resource Manager](scripts/sql-managed-instance-create-powershell-azure-resource-manager-template.md);
- [Azure CLI](https://blogs.msdn.microsoft.com/sqlserverstorageengine/2018/11/14/create-azure-sql-managed-instance-using-azure-cli/).

## <a name="migrating-to-a-managed-instance-with-minimal-downtime"></a>Перенос в управляемый экземпляр с минимальным временем простоя

Эти краткие руководства позволяют быстро настроить управляемый экземпляр и переместить базы данных с помощью встроенной функции `RESTORE`. Но при использовании встроенной функции `RESTORE` вам придется подождать восстановления баз данных (и их копирования в хранилище BLOB-объектов Azure, если их там нет). Это приведет к некоторому простою приложения, особенно в случае больших баз данных. Для переноса рабочей базы данных используйте [Azure Database Migration Service (DMS)](https://docs.microsoft.com/azure/dms/tutorial-sql-server-to-managed-instance?toc=/azure/sql-database/toc.json), чтобы минимизировать время ее простоя. DMS выполняет постепенную принудительную отправку изменений, внесенных в базу данных-источник, в базу данных, восстанавливаемую в управляемом экземпляре. С ее помощью вы можете быстро перевести приложение с исходной базы данных на целевую с минимальным временем простоя.

## <a name="next-steps"></a>Дополнительная информация

- Ознакомьтесь с [кратким списком поддерживаемых функций Управляемого экземпляра](sql-database-features.md), а также [подробностями и известными проблемами](sql-database-managed-instance-transact-sql-information.md).
- Дополнительные сведения о [технических характеристиках Управляемого экземпляра](sql-database-managed-instance-resource-limits.md#instance-level-resource-limits). 
- Дополнительные инструкции см. в статье [Использование управляемого экземпляра в Базе данных SQL Azure](sql-database-howto-managed-instance.md). 
