---
title: Azure Stack управления доступом на границе | Документация Майкрософт
description: Описывает, как использовать портал Azure для управления общими папками на Azure Stackном крае.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: how-to
ms.date: 03/25/2019
ms.author: alkohli
ms.openlocfilehash: 1aceb9d2fb1d9b5890bc0859d432bc1c5e7e4db4
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "84339845"
---
# <a name="use-the-azure-portal-to-manage-shares-on-your-azure-stack-edge"></a>Использование портал Azure для управления общими папками на Azure Stackном крае

В этой статье описывается, как управлять общими папками на Azure Stack пограничных устройствах. Вы можете управлять Azure Stack ребром с помощью портал Azure или через локальный веб-интерфейс. С помощью портала Azure можно добавлять, удалять и обновлять общие папки или синхронизировать ключ хранилища для учетной записи хранения, связанной с общими папками.

## <a name="about-shares"></a>Сведения об общих папках

Чтобы передавать данные в Azure, необходимо создать общие папки на Azure Stackном крае. Общие папки, добавляемые на устройство Azure Stack погранично, могут быть локальными общими папками или общими папками, которые принудительно отправляют данные в облако.

 - **Локальные общие папки**: Используйте эти общие папки, если требуется, чтобы данные обрабатывались локально на устройстве.
 - **Общие папки**: Используйте эти общие папки, если вы хотите, чтобы данные устройства автоматически отправлялись в учетную запись хранения в облаке. К этим общим папкам применяются все облачные функции, такие как **Обновление** и **Синхронизация ключей хранилища**.

Вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
>
> * Добавление общей папки
> * удаление общей папки.
> * Обновление общих папок
> * Синхронизация ключа хранилища

## <a name="add-a-share"></a>Добавление общей папки

Чтобы создать общую папку, выполните следующие действия на портале Azure.

1. В портал Azure перейдите к ресурсу Azure Stackного периметра и перейдите в раздел **> шлюзы Общие ресурсы**. На панели команд щелкните **+ Добавление общего файлового ресурса**.

    ![Выбор команды "Добавление общего файлового ресурса"](media/azure-stack-edge-manage-shares/add-share-1.png)

2. В разделе **Добавление общего файлового ресурса** укажите параметры общей папки. Укажите уникальное имя для общей папки.
    
    Имена общих папок могут содержать только цифры, строчные буквы и дефисы. Имя общей папки может содержать от 3 до 63 знаков и начинаться с буквы или цифры. Перед каждым дефисом должен быть знак без дефиса.

3. Выберите **тип** для общей папки. Вы можете выбрать тип **SMB** или **NFS** (тип SMB задан по умолчанию). SMB является стандартным для клиентов Windows, а NFS используется для клиентов Linux. В зависимости от того, выбраны ли общие папки типа SMB или NFS, предложенные варианты могут немного отличаться.

4. Предоставьте **учетную запись хранения**, в которой будет храниться общая папка. При отсутствии контейнера он создается в учетной записи хранения с именем общей папки. Если контейнер уже существует, используется имеющийся контейнер.

5. В раскрывающем списке из блочного BLOB-объекта, страничного BLOB-объекта или файлов выберите **Служба хранилища**. Тип выбранной службы зависит от того, в каком формате необходимо хранить данные в Azure. Например, в этом экземпляре необходимо, чтобы данные хранились в Azure как блочные BLOB-объекты, поэтому мы выбираем **Блочный BLOB-объект**. При выборе **страничного BLOB-объекта** необходимо убедиться, что данные выровнены по размеру 512 байт. Используйте **страничный BLOB-объект** для VHD или VHDX, которые всегда выровнены по размеру 512 байт.

   > [!IMPORTANT]
   > Убедитесь, что используемая учетная запись хранения Azure не имеет установленных на ней политик неизменности, если она используется с Azure Stack пограничным или Шлюз Data Box устройством. Дополнительные сведения см. в статье [Настройка политик неизменности для хранилища BLOB-объектов и управление ими](https://docs.microsoft.com/azure/storage/blobs/storage-blob-immutability-policies-manage).

6. Этот шаг зависит от того, создается ли общая папка типа SMB или NFS.
   - **При создании общей папки SMB** в поле **Все привилегированные локальные пользователи** выберите **Создать** или **Использовать существующий**. При создании локального пользователя укажите **имя пользователя** и **пароль**, а затем подтвердите пароль. Таким образом вы предоставите разрешения локальному пользователю. Назначив разрешения здесь, вы сможете изменять их в проводнике.

      ![Добавление общей папки SMB](media/azure-stack-edge-manage-shares/add-smb-share.png)

        Если разрешить только операции чтения для данных этой общей папки, можно указать пользователей с правами только для чтения.
   - **При создании общей папки типа NFS** необходимо предоставить **IP-адреса разрешенных клиентов**, которые могут получать доступ к ресурсу.

      ![Добавление общей папки типа NFS](media/azure-stack-edge-manage-shares/add-nfs-share.png)

7. Для получения легкого доступа к общим папкам из модулей вычислений Edge используйте локальную точку подключения. Выберите **Использовать общую папку с пограничными вычислениями**, чтобы общая папка автоматически подключалась после создания. Этот параметр позволяет модулю Edge использовать вычисления с локальной точкой подключения.

8. Щелкните **Создать**, чтобы создать общую папку. Вы получите уведомление о том, что общая папка создается. После создания общей папки с указанными параметрами колонка **Общие папки** обновится, и в ней появится новая общая папка.

## <a name="add-a-local-share"></a>Добавление локальной общей папки

1. В портал Azure перейдите к ресурсу Azure Stackного периметра и перейдите в раздел **> шлюзы Общие ресурсы**. На панели команд щелкните **+ Добавление общего файлового ресурса**.

   ![Выбор команды "Добавление общего файлового ресурса"](media/azure-stack-edge-manage-shares/add-local-share-1.png)

2. В разделе **Добавление общего файлового ресурса** укажите параметры общей папки. Укажите уникальное имя для общей папки.
    
    Имена общих папок могут содержать только цифры, строчные буквы и дефисы. Имя общей папки может содержать от 3 до 63 знаков и начинаться с буквы или цифры. Перед каждым дефисом должен быть знак без дефиса.

3. Выберите **тип** для общей папки. Вы можете выбрать тип **SMB** или **NFS** (тип SMB задан по умолчанию). SMB является стандартным для клиентов Windows, а NFS используется для клиентов Linux. В зависимости от того, выбраны ли общие папки типа SMB или NFS, предложенные варианты могут немного отличаться.

4. Для получения легкого доступа к общим папкам из модулей вычислений Edge используйте локальную точку подключения. Чтобы модуль Edge мог использовать вычисление с локальной точкой подключения, выберите **Use the share with Edge compute** (Использование общей папки с вычислениями Edge).

5. Выберите **Configure as Edge local shares** (Настройка в качестве локальных общих папок Edge). Данные в локальных общих папках останутся локально на устройстве. Вы можете обрабатывать эти данные локально.

6. В поле **Все привилегированные локальные пользователи** выберите либо **Создать**, либо **Использовать существующую**.

7. Выберите **Создать**. 

   ![Создание локальной общей папки](media/azure-stack-edge-manage-shares/add-local-share-2.png)

    Вы получите уведомление о том, что создается общая папка. После создания общей папки с указанными параметрами колонка **Общие папки** обновится, и в ней появится новая общая папка.

   ![Просмотр обновлений колонки "Общие папки"](media/azure-stack-edge-manage-shares/add-local-share-3.png)
    
    Выберите локальную общую папку, чтобы просмотреть локальную точку подключения для модулей вычислений Edge для этого общего ресурса.

   ![Просмотр общих сведений локальной общей папки](media/azure-stack-edge-manage-shares/add-local-share-4.png)

## <a name="mount-a-share"></a>Подключение общей папки

Если вы создали общий ресурс до того, как вы настроили вычисление на Azure Stack пограничном устройстве, вам потребуется подключить общую папку. Для этого выполните следующие шаги.

1. В портал Azure перейдите к ресурсу Azure Stackного периметра и перейдите в раздел **> шлюзы Общие ресурсы**. В списке общих папок выберите ту, которую необходимо подключить. Для выбранной общей папки в столбце **Используется для вычислений** отобразится состояние **Отключено**.

   ![Выбор общей папки](media/azure-stack-edge-manage-shares/select-share-mount.png)

2. Выберите **Подключить**.

   ![Выбор параметра "Подключить"](media/azure-stack-edge-manage-shares/select-mount.png)

3. При появлении запроса на подтверждение нажмите кнопку **Да**. В этом случае общая папка будет подключена.

   ![Подтверждение подключения](media/azure-stack-edge-manage-shares/confirm-mount.png)

4. После подключения перейдите к списку общих папок. Вы увидите, что в столбце **Используется для вычислений** в качестве состояния общей папки отображается **Включено**.

   ![Общая папка подключена](media/azure-stack-edge-manage-shares/share-mounted.png)

5. Снова выберите общую папку, чтобы просмотреть ее локальную точку подключения. Модуль пограничных вычислений использует эту локальную точку подключения для общей папки.

   ![Локальная точка подключения для общей папки](media/azure-stack-edge-manage-shares/share-mountpoint.png)

## <a name="unmount-a-share"></a>Отключение общей папки

Чтобы отключить общую папку, выполните следующие действия на портале Azure.

1. В портал Azure перейдите к ресурсу Azure Stackного периметра и перейдите в раздел **> шлюзы Общие ресурсы**.

   ![Выбор общей папки](media/azure-stack-edge-manage-shares/select-share-unmount.png)

2. В списке общих папок выберите папку, которую требуется отключить. Убедитесь, что она не используется модулем. Если же общая папка используется модулем, это приведет к возникновению проблем с модулем. Выберите **Отключить**.

   ![Выбор параметра "Отключить"](media/azure-stack-edge-manage-shares/select-unmount.png)

3. При появлении запроса на подтверждение нажмите кнопку **Да**. В этом случае общая папка будет отключена.

   ![Подтверждение отключения](media/azure-stack-edge-manage-shares/confirm-unmount.png)

4. После отключения перейдите к списку общих папок. Вы увидите, что в столбце **Используется для вычислений** в качестве состояния общей папки отображается **Отключено**.

   ![Общая папка отключена](media/azure-stack-edge-manage-shares/share-unmounted.png)

## <a name="delete-a-share"></a>удаление общей папки.

Чтобы удалить общую папку, выполните следующие действия на портале Azure.

1. В списке общих папок выберите и щелкните папку, которую требуется удалить.

   ![Выбор общей папки](media/azure-stack-edge-manage-shares/delete-share-1.png)

2. Щелкните **Delete** (Удалить).

   ![Нажмите кнопку "Удалить"](media/azure-stack-edge-manage-shares/delete-share-2.png)

3. При запросе подтверждения нажмите кнопку **Да**.

   ![Подтверждение удаления](media/azure-stack-edge-manage-shares/delete-share-3.png)

Список общих папок обновляется с учетом удаления.

## <a name="refresh-shares"></a>Обновление общих папок

Возможность обновления позволяет обновить содержимое общей папки. При обновлении общей папки будет инициирован поиск всех объектов Azure, включая большие двоичные объекты и файлы, добавленные в облако с момента последнего обновления. Затем эти дополнительные файлы скачиваются для обновления содержимого общей папки на устройстве.

> [!IMPORTANT]
>
> - Вы не можете обновить локальные общие папки.
> - Разрешения и списки управления доступом (ACL) не сохраняются при операции обновления. 

Чтобы обновить общую папку, выполните следующие действия на портале Azure.

1. На портале Azure перейдите к разделу **Общие папки**. Выберите и щелкните общую папку, которую требуется обновить.

   ![Выбор общей папки](media/azure-stack-edge-manage-shares/refresh-share-1.png)

2. Нажмите кнопку **Обновить**.

   ![Нажатие кнопки обновления](media/azure-stack-edge-manage-shares/refresh-share-2.png)
 
3. При запросе подтверждения нажмите кнопку **Да**. Запустится задание обновления содержимого локальной общей папки.

   ![Подтверждение обновления](media/azure-stack-edge-manage-shares/refresh-share-3.png)

4. Во время обновления в контекстном меню недоступна функция обновления. Щелкните уведомление задания, чтобы просмотреть состояние задания обновления.

5. Время обновления зависит от количества файлов в контейнере Azure и на устройстве. После успешного обновления общей папки обновляется ее метка времени. Даже если во время обновления произошли частичные сбои, операция считается успешной и метка времени обновляется. Последние версии журналов ошибок также обновляются.

   ![Обновленная метка времени](media/azure-stack-edge-manage-shares/refresh-share-4.png)
 
Если возникает сбой, создается предупреждение. В этом предупреждении подробно описываются причина его возникновения и рекомендации для устранения проблем. Предупреждение также содержит ссылки на файл, содержащий всю сводку сбоев, включая файлы, которые не удалось обновить или удалить.

## <a name="sync-storage-keys"></a>Синхронизация ключей хранилища

Если ключи учетной записи хранения изменены, необходимо синхронизировать ключи доступа к хранилищу. Путем выполнения синхронизации можно получить последние ключи для учетной записи устройства.

Выполните следующие действия на портале Azure, чтобы синхронизировать ключ доступа к хранилищу.

1. В своем ресурсе перейдите к разделу **Обзор**. Из списка общих папок выберите и щелкните ту, которая связана с учетной записью хранения и которую необходимо синхронизировать.

    ![Выбор общей папки с соответствующей учетной записью хранения](media/azure-stack-edge-manage-shares/sync-storage-key-1.png)

2. Щелкните **Sync storage key** (Синхронизация ключа хранилища). Нажмите кнопку **ОК** в запросе на подтверждение.

     ![Выбор синхронизации ключа хранилища](media/azure-stack-edge-manage-shares/sync-storage-key-2.png)

3. После синхронизации закройте диалоговое окно.

>[!NOTE]
> Это действие достаточно выполнить один раз для каждой учетной записи хранения. Не нужно повторять это действие для всех общих папок, связанных с одной учетной записью.

## <a name="next-steps"></a>Дальнейшие шаги

- Узнайте, как [управлять пользователями с помощью портала Azure](azure-stack-edge-manage-users.md).
