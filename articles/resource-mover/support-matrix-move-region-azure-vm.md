---
title: Матрица поддержки для перемещения виртуальных машин Azure в другой регион с помощью перемещения ресурсов Azure
description: Ознакомьтесь с поддержкой перемещения виртуальных машин Azure между регионами с помощью перемещения ресурсов Azure.
author: rayne-wiselman
manager: evansma
ms.service: resource-move
ms.topic: how-to
ms.date: 09/07/2020
ms.author: raynew
ms.openlocfilehash: fa71cd502f730844e4f4398d41d06ada56fc2413
ms.sourcegitcommit: 80b9c8ef63cc75b226db5513ad81368b8ab28a28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2020
ms.locfileid: "90602291"
---
# <a name="support-for-moving-azure-vms-between-azure-regions"></a>Поддержка перемещения виртуальных машин Azure между регионами Azure

В этой статье приведены сведения о поддержке и предварительных требованиях при перемещении виртуальных машин и связанных сетевых ресурсов в регионах Azure с помощью перемещения ресурсов.

> [!IMPORTANT]
> Azure Resource Mover сейчас поддерживается в предварительной версии.


## <a name="windows-vm-support"></a>Поддержка виртуальных машин Windows

Перемещение ресурсов поддерживает виртуальные машины Azure под управлением этих операционных систем Windows.

**Операционная система** | **Сведения**
--- | ---
Windows Server 2019 | Поддерживается для основных серверных компонентов и сервера с возможностями рабочего стола.
Windows Server 2016  | Поддерживается для основных серверных компонентов и сервера с возможностями рабочего стола.
Windows Server 2012 R2 | Поддерживается.
Windows Server 2012 | Поддерживается.
Windows Server 2008 R2 (с пакетом обновления 1/2) | Поддерживается.<br/><br/> Для компьютеров под управлением Windows Server 2008 R2 с пакетом обновления 1 (SP1) или SP2 необходимо установить обновление программного [стека обслуживания Windows (SSU)](https://support.microsoft.com/help/4490628) и [SHA-2](https://support.microsoft.com/help/4474419).  SHA-1 не поддерживается с сентября 2019 г., а если подпись кода SHA-2 не включена, то расширение агента не будет устанавливаться и обновляться должным образом. Подробнее об [обновлении SHA-2 и требованиях](https://aka.ms/SHA-2KB).
Windows 10 (x64) | Поддерживается.
Windows 8.1 (x64) | Поддерживается.
Windows 8 (x64) | Поддерживается.
Windows 7 (x64) с пакетом обновления 1 (SP1) и выше | Установите обновление программного [стека обслуживания Windows (SSU)](https://support.microsoft.com/help/4490628) и [SHA-2](https://support.microsoft.com/help/4474419) на компьютерах под управлением Windows 7 с пакетом обновления 1 (SP1).  SHA-1 не поддерживается с 2019 сентября, а если подпись кода SHA-2 не включена, шаг "подготовка" не будет выполнен. Подробнее об [обновлении SHA-2 и требованиях](https://aka.ms/SHA-2KB).


## <a name="linux-vm-support"></a>Поддержка виртуальных машин Linux

Перемещение ресурсов поддерживает виртуальные машины Azure под управлением операционных систем Linux.

**Операционная система** | **Сведения**
--- | ---
Red Hat Enterprise Linux | 6.7, 6.8, 6.9, 6.10, 7.0, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6,[7.7](https://support.microsoft.com/help/4528026/update-rollup-41-for-azure-site-recovery), [8.0](https://support.microsoft.com/help/4531426/update-rollup-42-for-azure-site-recovery), 8.1
CentOS | 6.5, 6.6, 6.7, 6.8, 6.9, 6.10, 7.0, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 8.0, 8.1
Сервер Ubuntu 14.04 LTS | [Поддерживаемые версии ядра](#supported-ubuntu-kernel-versions)
Сервер Ubuntu 16.04 LTS | [Поддерживаемая версия ядра](#supported-ubuntu-kernel-versions)<br/><br/> Для серверов Ubuntu, использующих проверку подлинности и вход на основе пароля, а также пакет Cloud-init для настройки облачных виртуальных машин, может быть отключен вход на основе пароля при отработке отказа (в зависимости от конфигурации Cloud-init). Вход на основе пароля можно повторно включить на виртуальной машине, переустановив пароль в меню "Поддержка > устранение неполадок >" (для виртуальной машины, для которой выполнена отработка отказа в портал Azure.
Ubuntu 18.04 LTS Server | [Поддерживаемая версия ядра](#supported-ubuntu-kernel-versions).
Debian 7 | [Поддерживаемые версии ядра](#supported-debian-kernel-versions).
Debian 8 | [Поддерживаемые версии ядра](#supported-debian-kernel-versions).
SUSE Linux Enterprise Server 12 | SP1, SP2, SP3, SP4. [Поддерживаемые версии ядра](#supported-suse-linux-enterprise-server-12-kernel-versions)
SUSE Linux Enterprise Server 15 | 15 и 15 SP1. [(Поддерживаемые версии ядра)](#supported-suse-linux-enterprise-server-15-kernel-versions)
SUSE Linux Enterprise Server 11 | Пакет обновления 3 (SP3)
SUSE Linux Enterprise Server 11 | Пакет обновления 4 (SP4)
Oracle Linux | 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 6.10, 7.0, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, [7.7](https://support.microsoft.com/help/4531426/update-rollup-42-for-azure-site-recovery) <br/><br/> С ядром, совместимым с Red Hat, или с ядром Unbreakable Enterprise Kernel Release 3, 4 и 5 (UEK3, UEK4, UEK5)


### <a name="supported-ubuntu-kernel-versions"></a>Поддерживаемые версии ядра Ubuntu

**Релиз** | **Версия ядра** 
--- | --- 
14.04 LTS |  с 3.13.0-24-generic по 3.13.0-170-generic,<br/>3.16.0-25-generic to 3.16.0-77-generic,<br/>3.19.0-18-generic to 3.19.0-80-generic,<br/>4.2.0-18-generic to 4.2.0-42-generic,<br/>с 4.4.0-21-generic по 4.4.0-148-generic,<br/>с 4.15.0-1023-azure по 4.15.0-1045-azure 
16.04 LTS |  с 4.4.0-21-generic по 4.4.0-171-generic,<br/>с 4.8.0-34-generic по 4.8.0-58-generic<br/>с 4.10.0-14-generic по 4.10.0-42-generic,<br/>с 4.11.0-13-generic по 4.11.0-14-generic,<br/>с 4.13.0-16-generic по 4.13.0-45-generic,<br/>с 4.15.0-13-generic по 4.15.0-74-generic<br/>с 4.11.0-1009-azure по 4.11.0-1016-azure,<br/>с 4.13.0-1005-azure по 4.13.0-1018-azure. <br/>с 4.15.0-1012-azure по 4.15.0-1066-azure
18.04 LTS | с 4.15.0-20-generic по 4.15.0-74-generic </br> с 4.18.0-13-generic по 4.18.0-25-generic </br> с 5.0.0-15-generic по 5.0.0-37-generic </br> с 5.3.0-19-generic по 5.3.0-24-generic </br> с 4.15.0-1009-azure по 4.15.0-1037-azure </br> с 4.18.0-1006-azure по 4.18.0-1025-azure </br> с 5.0.0-1012-azure по 5.0.0-1028-azure </br> с 5.3.0-1007-azure по 5.3.0-1009-azure


### <a name="supported-debian-kernel-versions"></a>Поддерживаемые версии ядра Debian 

**Релиз** |  **Версия ядра** 
--- |  --- 
Debian 7 |  С 3.2.0-4-amd64 по 3.2.0-6-amd64, 3.16.0-0.bpo.4-amd64 
Debian 8 |  с 3.16.0-4-amd64 по 3.16.0-10-amd64, с 4.9.0-0.bpo.4-amd64 по 4.9.0-0.bpo.11-amd64 
Debian 8 |  с 3.16.0-4-amd64 по 3.16.0-10-amd64, с 4.9.0-0.bpo.4-amd64 по 4.9.0-0.bpo.9-amd64

### <a name="supported-suse-linux-enterprise-server-12-kernel-versions"></a>Поддерживаемые версии ядра SUSE Linux Enterprise Server 12 

**Релиз** | **Версия ядра** 
--- |  --- 
SUSE Linux Enterprise Server 12 (SP1, SP2, SP3, SP4) |  Поддерживаются все [ядра версии SUSE 12 SP1, SP2, SP3, SP4](https://www.suse.com/support/kb/doc/?id=000019587) .</br></br> с 4.4.138-4.7-azure по 4.4.180-4.31-azure,</br>с 4.12.14-6.3-azure по 4.12.14-6.34-azure  


### <a name="supported-suse-linux-enterprise-server-15-kernel-versions"></a>Поддерживаемые версии ядра SUSE Linux Enterprise Server 15

**Релиз** | **Версия ядра** |
--- |  --- |
SUSE Linux Enterprise Server 15 и 15 SP1 |  Поддерживаются все ядра для SUSE 15 и 15 ядер.</br></br> с 4.12.14-5.5-azure по 4.12.14-8.22-azure |

## <a name="supported-linux-file-systemguest-storage"></a>Поддерживаемая файловая система Linux или гостевое хранилище

* Файловые системы: ext3, ext4, XFS, BTRFS
* Диспетчер томов: LVM2
* Многопутевое программное обеспечение: Device Mapper


## <a name="supported-vm-compute-settings"></a>Поддерживаемые параметры вычислений виртуальной машины

**Параметр** | **Поддержка** | **Сведения**
--- | --- | ---
Размер | Любой размер виртуальной машины Azure с по крайней мере двумя ядрами ЦП и 1 ГБ ОЗУ | Проверьте [размеры виртуальных машин Azure](../virtual-machines/sizes-general.md).
Группы доступности | Сейчас не поддерживается | При добавлении виртуальной машины Azure с набором доступности для перемещения коллекции с параметрами по умолчанию процесс подготовки завершается ошибкой. Можно либо переместить виртуальную машину в зону доступности, либо переместить ее как виртуальную машину с одним экземпляром. Эти параметры можно изменить на странице Изменение свойств целевого объекта.
Зоны доступности | Поддерживается | Поддерживается в зависимости от поддержки целевого региона.
Образы из коллекции Azure (опубликованные корпорацией Майкрософт) | Поддерживается | Поддерживается, если виртуальная машина работает в поддерживаемой операционной системе.
Образы из коллекции Azure (опубликованные сторонними производителями)  | Поддерживается | Поддерживается, если виртуальная машина работает в поддерживаемой операционной системе.
Пользовательские образы (опубликованные сторонними производителями)| Поддерживается | Поддерживается, если виртуальная машина работает в поддерживаемой операционной системе.
Виртуальные машины, использующие Site Recovery | Не поддерживается | Перемещение ресурсов между регионами для виртуальных машин с помощью Site Recovery на серверной части. Если вы уже используете Site Recovery, отключите репликацию, а затем запустите процесс подготовки.
Политики RBAC | Не поддерживается | Политики управления доступом на основе ролей (RBAC) на виртуальных машинах не копируются на виртуальную машину в целевом регионе.
Модули | Не поддерживается | Расширения не копируются на виртуальную машину в целевом регионе. Установите их вручную после завершения перемещения.


## <a name="supported-vm-storage-settings"></a>Поддерживаемые параметры хранилища виртуальной машины

В этой таблице приведены сведения о поддержке диска Azure VM OS, диска данных и временного диска. Нужно следить за лимитом диска виртуальной машины и целевыми объектами виртуальных машин [Linux](../virtual-machines/linux/disk-scalability-targets.md) и [Windows](../virtual-machines/windows/disk-scalability-targets.md), чтобы избежать проблем с производительностью.

> [!NOTE]
> Размер целевой виртуальной машины должен быть больше или равен исходной виртуальной машине. Параметры, используемые для проверки: количество дисков данных, число сетевых карт, количество доступных ЦП, объем памяти в ГБ. Если не выдается сообщение об ошибке.


**Компонент** | **Поддержка** | **Сведения**
--- | --- | ---
Максимальный размер диска ОС | 2048 ГБ | [Узнайте больше](../virtual-machines/windows/managed-disks-overview.md) о дисках, используемых виртуальными машинами.
Временный диск | Не поддерживается | Временный диск всегда исключается из процесса подготовки.<br/><br/> Не сохраняйте долговременные данные на временном диске. [Подробнее](../virtual-machines/windows/managed-disks-overview.md#temporary-disk).
Максимальный размер диска с данными | 8192 ГБ для управляемых дисков
Минимальный размер диска данных |  2 ГБ для управляемых дисков |
Максимальное число дисков данных | До 64, зависимо от поддержки определенного размера виртуальной машины Azure. | [Узнайте больше](../virtual-machines/windows/sizes.md) о размерах виртуальных машин.
Скорость изменения данных на диске | Не более 10 Мбит/с на диск для хранилища класса Рremium. Не более 2 Мбит/с на диск для хранилища класса Standard. | Если средняя скорость изменения данных на диске постоянно превышает максимальную, подготовка не будет прервана.<br/><br/>  Однако если максимальное значение превышено, подготовка может быть продолжена, но можно увидеть немного отложенные точки восстановления.
Диск данных (стандартная учетная запись хранения) | Не поддерживается. | Измените тип хранилища на управляемый диск, а затем попытайтесь переместить виртуальную машину.
Диск данных (учетная запись хранения класса Premium) | Не поддерживается | Измените тип хранилища на управляемый диск, а затем попытайтесь переместить виртуальную машину.
Управляемый диск (стандартный) | Поддерживается  |
Управляемый диск (Premium) | Поддерживается |
SSD (цен. категория "Стандартный") | Поддерживается |
Поколение 2 (загрузка UEFI) | Поддерживается
Учетная запись хранения для диагностики загрузки | Не поддерживается | Включите его снова после перемещения виртуальной машины в целевой регион.

### <a name="limits-and-data-change-rates"></a>Ограничения и скорости изменения данных

В следующей таблице перечислены ограничения, основанные на наших тестах. Они не охватывают все возможные сочетания операций ввода-вывода в приложении. Фактические результаты зависят от набора операций ввода-вывода приложения. Существует два ограничения, которые следует учитывать: обработка данных на диске и обработка данных на виртуальной машине.

**Целевое расположение хранилища** | **Средний размер операций ввода-вывода исходного диска** |**Средняя скорость обработки данных исходного диска** | **Общий размер обработанных данных на исходном диске за день**
---|---|---|---
Хранилище уровня "Стандартный" | 8 КБ    | 2 МБ/с | 168 ГБ на диск
Диск P10 или P15 класса Premium | 8 КБ    | 2 МБ/с | 168 ГБ на диск
Диск P10 или P15 класса Premium | 16 КБ | 4 МБ/с |    336 ГБ на диск
Диск P10 или P15 класса Premium | 32 КБ или выше | 8 МБ/с | 672 ГБ на диск
Диск P20, P30, P40 или P50 класса Premium | 8 КБ    | 5 МБ/с | 421 ГБ на диск
Диск P20, P30, P40 или P50 класса Premium | 16 КБ или выше |20 МБ/с | 1684 ГБ на диск

## <a name="supported-vm-networking-settings"></a>Поддерживаемые параметры сети виртуальных машин

**Параметр** | **Поддержка** | **Сведения**
--- | --- | ---
Сетевая карта | Поддерживается | Укажите существующий ресурс в целевом регионе или создайте новый ресурс в процессе подготовки. 
Внутренняя подсистема балансировки нагрузки | Поддерживается | Укажите существующий ресурс в целевом регионе или создайте новый ресурс в процессе подготовки.  
Общедоступная подсистема балансировки нагрузки | Сейчас не поддерживается | Укажите существующий ресурс в целевом регионе или создайте новый ресурс в процессе подготовки.  
Общедоступный IP-адрес | Поддерживается | Укажите существующий ресурс в целевом регионе или создайте новый ресурс в процессе подготовки.  
Группа безопасности сети | Поддерживается | Укажите существующий ресурс в целевом регионе или создайте новый ресурс в процессе подготовки.  
Зарезервированный (статический) IP-адрес | Поддерживается | Сейчас это невозможно настроить. Значение по умолчанию равно исходному значению. <br/><br/> Если сетевая карта на исходной виртуальной машине имеет статический IP-адрес, а Целевая подсеть имеет тот же IP-адрес, она назначается целевой виртуальной машине.<br/><br/> Если у целевой подсети нет такого же IP-адреса, инициировать перемещение виртуальной машины завершится ошибкой.
Динамический IP-адрес | Поддерживается | Сейчас это невозможно настроить. Значение по умолчанию равно исходному значению.<br/><br/> Если сетевая карта в источнике имеет динамическую IP-адресацию, сетевая карта на целевой виртуальной машине также является динамической по умолчанию.
Конфигурации IP | Поддерживается | Сейчас это невозможно настроить. Значение по умолчанию равно исходному значению.

## <a name="outbound-access-requirements"></a>Требования к исходящему доступу

Для виртуальных машин Azure, которые требуется переместить, требуется исходящий доступ.


### <a name="url-access"></a>доступ по URL-адресу

 При использовании прокси-сервера или брандмауэра на основе URL-адресов для управления исходящими подключениями разрешите использование этих URL-адресов:

**имя**; | **Общедоступное облако Azure** | **Сведения** 
--- | --- | --- 
Память | `*.blob.core.windows.net`  | Позволяет записывать данные из виртуальной машины в учетную запись хранения кэша в исходном регионе. 
Azure Active Directory | `login.microsoftonline.com`  | Обеспечивает авторизацию и проверку подлинности URL-адресов службы Site Recovery. 
Репликация | `*.hypervrecoverymanager.windowsazure.com` | Позволяет виртуальной машине взаимодействовать со службой Site Recovery. 
Служебная шина | `*.servicebus.windows.net` | Позволяет виртуальной машине записывать данные мониторинга и диагностики службы Site Recovery. 

## <a name="nsg-rules"></a>Правила групп безопасности сети (NSG)
Если вы используете правила группы безопасности сети (NSG) для управления исходящими подключениями, создайте эти правила [тегов служб](../virtual-network/service-tags-overview.md) . Каждое правило должно разрешать исходящий доступ по протоколу HTTPS (443).
- Создайте правило тега хранилища для исходного региона.
- Создайте правило тега *азуреситерековери* , чтобы разрешить доступ к службе Site Recovery в любом регионе. Этот тег имеет зависимости от других тегов, поэтому необходимо создать правила для них:
    - *AzureActiveDirectory*
    - **EventHub*
    - *AzureKeyVault*
    - *GuestAndHybridManagement*
- Рекомендуется тестировать правила в нерабочей среде. [Ознакомьтесь с некоторыми примерами](../site-recovery/azure-to-azure-about-networking.md#outbound-connectivity-using-service-tags). 


## <a name="next-steps"></a>Дальнейшие действия

Попробуйте [переместить виртуальную машину Azure](tutorial-move-region-virtual-machines.md) в другой регион с помощью перемещения ресурсов.
