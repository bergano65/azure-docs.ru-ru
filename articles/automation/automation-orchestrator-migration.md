---
title: Миграция из Orchestrator в службу автоматизации Azure (бета-версия)
description: В этой статье описывается процесс миграции модулей runbook и пакетов интеграции из Orchestrator в службу автоматизации Azure.
services: automation
ms.subservice: process-automation
ms.date: 03/16/2018
ms.topic: conceptual
ms.openlocfilehash: b6778c4eab4dee382ec38d6218aa647e8aedc4cc
ms.sourcegitcommit: 0b80a5802343ea769a91f91a8cdbdf1b67a932d3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2020
ms.locfileid: "83836759"
---
# <a name="migrate-from-orchestrator-to-azure-automation-beta"></a>Миграция из Orchestrator в службу автоматизации Azure (бета-версия)

Модули runbook в [System Center 2012 — Orchestrator](https://technet.microsoft.com/library/hh237242.aspx) основаны на действиях из пакетов интеграции, которые созданы специально для Orchestrator, а модули runbook службы автоматизации Azure основаны на рабочих процессах Windows PowerShell. [Графические runbook](automation-runbook-types.md#graphical-runbooks) в службе автоматизации Azure имеют сходный вид с runbook для Orchestrator, а их действия представляют командлеты PowerShell, дочерние runbook и ресурсы. Кроме преобразования самих модулей runbook потребуется преобразовать пакеты интеграции и используемые в них действия в модули интеграции с командлетами Windows PowerShell. 

Решение [Service Management Automation](https://technet.microsoft.com/library/dn469260.aspx) (SMA) сохраняет и запускает модули runbook в локальном центре обработки данных, как и Orchestrator, и использует те же модули интеграции, что и служба автоматизации Azure. Преобразователь runbook преобразует модули runbook для Orchestrator в графические модули runbook, которые не поддерживаются в SMA. Вы можете установить модуль стандартных действий и модули интеграции System Center Orchestrator в SMA, но при этом придется [вручную пересоздать все модули runbook](https://technet.microsoft.com/library/dn469262.aspx).

## <a name="download-the-orchestrator-migration-toolkit"></a>Скачивание набора средств для миграции Orchestrator

Первым делом перед миграцией скачайте [набор средств для миграции System Center Orchestrator](https://www.microsoft.com/download/details.aspx?id=47323&WT.mc_id=rss_alldownloads_all). Этот набор средств содержит решения для преобразования модулей runbook Orchestrator в модули runbook службы автоматизации Azure.  

## <a name="import-the-standard-activities-module"></a>Импорт модуля стандартных действий

Импортируйте [модуль стандартных действий](https://docs.microsoft.com/system-center/orchestrator/standard-activities?view=sc-orch-2019) в службу автоматизации Azure. В него входят преобразованные версии стандартных действий Orchestrator, которые могут использоваться в преобразованных графических модулях runbook.

## <a name="import-orchestrator-integration-modules"></a>Импорт модулей интеграции Orchestrator

Корпорация Майкрософт предоставляет [пакеты интеграции](https://technet.microsoft.com/library/hh295851.aspx) для создания модулей Runbook для автоматизации компонентов System Center и других продуктов. Некоторые из этих пакетов в настоящее время основаны на OIT, но не могут быть преобразованы в модули интеграции ввиду известных проблем. Импортируйте [модули интеграции System Center Orchestrator](https://www.microsoft.com/download/details.aspx?id=49555) в службу автоматизации Azure для пакетов интеграции, используемых в модулях runbook с доступом к System Center. Эти пакеты включают преобразованные версии пакетов интеграции, которые можно импортировать в службу автоматизации Azure и в Service Management Automation.  

## <a name="convert-integration-packs"></a>Преобразование пакетов интеграции

Примените [преобразователь пакетов интеграции](https://docs.microsoft.com/system-center/orchestrator/orch-integration-toolkit/integration-pack-wizard?view=sc-orch-2019), чтобы преобразовать все пакеты интеграции, созданные при помощи [Orchestrator Integration Toolkit (OIT)](https://technet.microsoft.com/library/hh855853.aspx), в модули интеграции на основе PowerShell, которые вы сможете импортировать в службу автоматизации Azure или в Service Management Automation. При запуске преобразователя пакетов интеграции отобразится мастер, который позволяет выбрать OIP-файл пакета интеграции. После этого мастер выводит список действий, включенных в этот пакет интеграции, и позволяет выбрать действия для миграции. После завершения работы мастера создается модуль интеграции, содержащий соответствующий командлет для каждого действия в исходном пакете интеграции.

> [!NOTE]
> Вы не сможете с помощью преобразователя пакетов интеграции преобразовать пакеты интеграции, которые были созданы не через OIT. Кроме того, он пока не может преобразовывать некоторые пакеты интеграции, предоставляемые Майкрософт. Преобразованные версии этих пакетов интеграции предоставляются для скачивания отдельно, что позволит вам установить их в службе автоматизации Azure или в Service Management Automation.

### <a name="parameters"></a>Параметры

Все свойства действия в пакете интеграции преобразуются в параметры соответствующих командлетов в модуле интеграции.  У командлетов Windows PowerShell есть набор [общих параметров](https://technet.microsoft.com/library/hh847884.aspx) , который может использоваться со всеми командлетами. Например, параметр -Verbose позволяет выводить подробные сведения о выполнении командлета.  Ни один командлет не может иметь параметр с тем же именем, что и общий параметр. Если действие имеет свойство с тем же именем, что и у общего параметра, мастер предлагает ввести другое имя параметра.

### <a name="monitor-activities"></a>Действия Monitor

Модули Runbook для Monitor в Orchestrator начинаются с [действия Monitor](https://technet.microsoft.com/library/hh403827.aspx) и работают постоянно, пока они не будут вызваны определенным событием. Служба автоматизации Azure не поддерживает модули runbook мониторинга, поэтому никакие действия мониторинга в пакете интеграции не будут преобразованы. Вместо этого в модуле интеграции создается командлет-местозаполнитель действия Monitor.  Этот командлет не имеет функционального назначения, однако позволяет установить любой преобразованный модуль Runbook, который использует его. Этот модуль runbook не может выполняться в службе автоматизации Azure, но вы можете его установить для модификации.

Orchestrator содержит набор [стандартных действий](https://technet.microsoft.com/library/hh403832.aspx) , не включенных в пакет интеграции, которые, однако, используются во многих модулях Runbook.  Модуль стандартных действий представляет собой модуль интеграции, содержащий эквивалентный командлет для каждого из этих действий. Перед импортом любых преобразованных модулей Runbook, использующих стандартные действия, необходимо установить этот модуль интеграции службы автоматизации Azure.

В дополнение к поддержке преобразованных модулей Runbook командлеты в модуле стандартных действий могут использоваться любым пользователем, знакомым с Orchestrator, для построения новых модулей Runbook службы автоматизации Azure. В то время как функциональные возможности всех стандартных действий могут быть реализованы при помощи командлетов, они могут работать по-другому. Командлеты в преобразованном модуле стандартных действий работают точно так же и используют такие же параметры, как и соответствующие действия. Это может вам помочь при переходе на модули runbook службы автоматизации Azure.

## <a name="convert-orchestrator-runbooks"></a>Преобразование модулей runbook для Orchestrator

Преобразователь runbook для Orchestrator преобразует модули runbook для Orchestrator в [графические модули runbook](automation-runbook-types.md#graphical-runbooks), которые можно импортировать в службу автоматизации Azure. Преобразователь модулей runbook реализован как модуль PowerShell с командлетом `ConvertFrom-SCORunbook`, который и выполняет преобразование. После установки преобразователь создает ярлык сеанса PowerShell, который загружает этот командлет.   

Ниже описан базовый процесс преобразования модуля runbook и его импорта в службу автоматизации Azure. Сведения о применении командлета приводятся далее в этом разделе.

1. Экспортируйте один или несколько модулей Runbook в Orchestrator.
2. Получите модули интеграции для всех действий в модуле Runbook.
3. Преобразуйте модули Runbook Orchestrator в экспортированном файле.
4. Проверьте результаты преобразования по журналам и определите, нужно ли выполнить какие-либо задачи вручную.
5. Импортируйте преобразованные модули Runbook в службу автоматизации Azure.
6. Создайте все необходимые средства в службе автоматизации Azure.
7. Измените модули Runbook в службе автоматизации Azure, скорректировав все необходимые действия.

Для `ConvertFrom-SCORunbook` применяется следующий синтаксис:

```powershell
ConvertFrom-SCORunbook -RunbookPath <string> -Module <string[]> -OutputFolder <string>
```

* RunbookPath — путь к файлу экспорта, содержащему модули Runbook для преобразования.
* Модуль — список модулей интеграции, разделенных запятыми, с указанием действий, содержащихся в модулях Runbook.
* OutputFolder — путь к папке для создания преобразованных графических модулей Runbook.

Например, следующая команда преобразует модули Runbook в файл экспорта с именем **MyRunbooks.ois_export**.  В этих модулях используются пакеты интеграции Active Directory и Data Protection Manager.

```powershell
ConvertFrom-SCORunbook -RunbookPath "c:\runbooks\MyRunbooks.ois_export" -Module c:\ip\SystemCenter_IntegrationModule_ActiveDirectory.zip,c:\ip\SystemCenter_IntegrationModule_DPM.zip -OutputFolder "c:\runbooks"
```

### <a name="use-runbook-converter-log-files"></a>Использование файлов журнала преобразователя runbook

Преобразователь runbook создает указанные ниже файлы журналов в том же расположении, что и преобразованный модуль runbook.  Если такие файлы уже существуют, они будут перезаписаны данными последнего преобразования.

| Файл | Содержимое |
|:--- |:--- |
| Преобразователь модулей Runbook — Progress.log |Подробные шаги преобразования, включая сведения о каждом успешно преобразованном действии и предупреждения о каждом непреобразованном действии. |
| Преобразователь модулей Runbook — Summary.log |Результаты последнего преобразования, включая все предупреждения и дополнительные задачи, такие как создание переменной, необходимой для преобразованного модуля Runbook. |

### <a name="export-runbooks-from-orchestrator"></a>Экспорт модулей runbook из Orchestrator

Преобразователь модулей Runbook работает с файлом экспорта из Orchestrator, содержащим один или несколько модулей Runbook.  Для каждого модуля runbook для Orchestrator, указанного в файле экспорта, он создает соответствующий модуль runbook для службы автоматизации Azure.  

Чтобы экспортировать модуль Runbook из Orchestrator, щелкните имя модуля в конструкторе модулей Runbook правой кнопкой мыши и выберите команду **Экспорт**.  Чтобы экспортировать все модули Runbook в папке, щелкните имя папки правой кнопкой мыши и выберите команду **Экспорт**.

### <a name="convert-runbook-activities"></a>Преобразование действий runbook

Преобразователь модулей Runbook преобразует каждое действие в модуле Runbook Orchestrator в соответствующее действие в службе автоматизации Azure.  Для действий, которые не могут быть преобразованы: в модуле Runbook создается действие-заполнитель с текстом предупреждения.  После импорта преобразованного модуля Runbook в службу автоматизации Azure все эти действия необходимо заменить на допустимые действия, выполняющие необходимые функции.

Преобразуются все действия Orchestrator в модуле стандартных действий. В то же время некоторые стандартные действия Orchestrator не входят в этот модуль и не подвергаются преобразованию. Например, событие `Send Platform Event` не имеет эквивалента в службе автоматизации Azure, так как характерно только для Orchestrator.

[Действия отслеживания](https://technet.microsoft.com/library/hh403827.aspx) не преобразуются, поскольку не имеют эквивалента в службе автоматизации Azure. Исключениями являются действия мониторинга в преобразуемых пакетах интеграции, которые преобразуются в действие-заполнитель.

Любое действие преобразуемого пакета интеграции преобразуется в том случае, если вы указали путь к модулю интеграции с помощью параметра `modules`. Для пакетов интеграции System Center можно использовать модули интеграции System Center Orchestrator.

### <a name="manage-orchestrator-resources"></a>Управление ресурсами Orchestrator

Преобразователь модулей Runbook преобразует только модули Runbook, но не другие ресурсы Orchestrator, такие как счетчики, переменные или подключения.  Счетчики в службе автоматизации Azure не поддерживаются.  Переменные и подключения поддерживаются, но должны создаваться вручную. Файлы журналов покажут, нужны ли эти ресурсы вашему модулю runbook и какие ресурсы необходимо создать в службе автоматизации Azure для правильной работы каждого преобразованного модуля runbook.

Например, в модуле Runbook можно использовать переменную для заполнения определенного значения в действии.  Преобразованный модуль runbook преобразует действие и указывает в службе автоматизации Azure ресурс переменной с таким же именем, как у переменной в Orchestrator. Это действие заносится в файл **Runbook Converter - Summary.log**, который создается после преобразования. Прежде чем использовать этот модуль runbook, вам нужно вручную создать ресурс переменной в службе автоматизации Azure.

### <a name="work-with-orchestrator-input-parameters"></a>Работа с входными параметрами Orchestrator

Модули runbook в Orchestrator принимают входные параметры с помощью действия `Initialize Data`.  Если преобразуемый модуль Runbook включает такое действие, для каждого параметра этого действия в модуле Runbook в службе автоматизации Azure создается [входной параметр](automation-graphical-authoring-intro.md#handle-runbook-input) .  В преобразованном модуле Runbook создается действие [управления сценарием рабочего процесса](automation-graphical-authoring-intro.md#use-activities) , извлекающее и возвращающее каждый параметр. Результаты выполнения этого действия используются всеми действиями в модуле Runbook, использующими входной параметр.

Эта стратегия применяется потому, что максимально отражает функциональность модуля Runbook.  Действия в новых графических модулях Runbook не должны ссылаться на входные параметры непосредственно через источник входных данных модуля Runbook.

### <a name="invoke-runbook-activity"></a>Действие вызова модуля Runbook

Модули runbook в Orchestrator запускают другие модули runbook с помощью действия `Invoke Runbook`. Если преобразуемый модуль runbook содержит такое действие и включен параметр `Wait for completion`, то в преобразованном модуле runbook для него создается действие runbook.  Если параметр `Wait for completion` не включен, создается действие скрипта рабочего процесса, которое запускает модуль runbook с помощью командлета [Start-AzAutomationRunbook](https://docs.microsoft.com/powershell/module/az.automation/start-azautomationrunbook?view=azps-3.7.0). После импорта преобразованного модуля Runbook в службу автоматизации Azure измените это действие с учетом указанной в этом действии информации.

## <a name="create-orchestrator-assets"></a>Создание ресурсов Orchestrator

Преобразователь runbook не преобразует ресурсы Orchestrator. Вам нужно вручную создать все необходимые ресурсы Orchestrator в службе автоматизации Azure.

## <a name="configure-hybrid-runbook-worker"></a>Настройка гибридной рабочей роли Runbook

Orchestrator сохраняет модули runbook на сервере базы данных и запускает их на серверах Runbook. И те и другие серверы размещаются в локальном центре обработки данных. Модули runbook в службе автоматизации Azure хранятся в облаке Azure и могут выполняться в локальном центре обработки данных через [гибридную рабочую роль Runbook](automation-hybrid-runbook-worker.md). Настройте рабочую роль для выполнения модулей runbook, преобразованных из Orchestrator, так как они предназначены для выполнения на локальных серверах и доступа к локальным ресурсам.

## <a name="related-articles"></a>Связанные статьи

* Сведения об Orchestrator см. в статье [System Center 2012 — Orchestrator](https://technet.microsoft.com/library/hh237242.aspx).
* Дополнительные сведения об автоматизации управления службами см. в статье [Service Management Automation](https://technet.microsoft.com/library/dn469260.aspx).
* Сведения о действиях Orchestrator можно найти в статье [Стандартные действия](https://technet.microsoft.com/library/hh403832.aspx).
* Чтобы получить набор средств для миграции Orchestrator, воспользуйтесь страницей [скачивания набора средств для миграции System Center Orchestrator](https://www.microsoft.com/download/details.aspx?id=47323).
* Сведения о гибридной рабочей роли Runbook службы автоматизации см. в статье [Обзор гибридной рабочей роли Runbook](automation-hybrid-runbook-worker.md).