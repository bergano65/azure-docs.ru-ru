---
title: Краткое руководство. Создание Load Balancer (цен. категория "Стандартный") — портал Azure | Документация Майкрософт
titlesuffix: Azure Load Balancer
description: В этом кратком руководстве вы узнаете, как создать Load Balancer (цен. категория "Стандартный") с помощью портала Azure.
services: load-balancer
documentationcenter: na
author: KumudD
manager: twooley
Customer intent: I want to create a Standard Load Balancer so that I can load balance internet traffic to VMs.
ms.service: load-balancer
ms.devlang: na
ms.topic: quickstart
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/11/2019
ms.author: kumud
ms.custom: mvc
ms.openlocfilehash: 77e322e32d19433d9ce4629c2e04c8bbd7e17f3f
ms.sourcegitcommit: 5839af386c5a2ad46aaaeb90a13065ef94e61e74
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2019
ms.locfileid: "57858241"
---
# <a name="quickstart-create-a-standard-load-balancer-to-load-balance-vms-using-the-azure-portal"></a>Краткое руководство. Создание подсистемы балансировки нагрузки уровня "Стандартный" с помощью портала Azure для распределения нагрузки между виртуальными машинами

Балансировка нагрузки обеспечивает более высокий уровень доступности и масштабирования за счет распределения входящих запросов между несколькими виртуальными машинами. Вы можете использовать портал Azure для создания подсистемы балансировки нагрузки, чтобы распределять нагрузку виртуальных машин. В этом кратком руководстве показано, как распределять нагрузку между виртуальными машинами с помощью подсистемы балансировки нагрузки уровня "Стандартный".

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу. 

## <a name="sign-in-to-azure"></a>Вход в Azure

Войдите на портал Azure по адресу [https://portal.azure.com](https://portal.azure.com).

## <a name="create-a-standard-load-balancer"></a>Создание подсистемы балансировки нагрузки уровня "Стандартный"

В этом разделе вы создадите службу Load Balancer (цен. категория "Стандартный"), помогающую распределять нагрузку виртуальных машин. Подсистема балансировки нагрузки уровня "Стандартный" поддерживает только стандартные общедоступные IP-адреса. Вместе с подсистемой балансировки нагрузки уровня "Стандартный" необходимо также создать новый стандартный общедоступный IP-адрес, настроенный для него в качестве интерфейсного сервера (с именем *LoadBalancerFrontend* по умолчанию). 

1. Вверху слева выберите последовательно **Создать ресурс** > **Сети** > **Load Balancer**.
2. На вкладке **Основные сведения** страницы **Создание подсистемы балансировки нагрузки** введите или выберите следующие сведения, примите значения по умолчанию для остальных параметров и нажмите кнопку **Review + create** (Проверить и создать).

    | Параметр                 | Значение                                              |
    | ---                     | ---                                                |
    | Подписка               | Выберите свою подписку.    |    
    | Группа ресурсов         | Выберите **Создать** и в текстовом поле введите *myResourceGroupSLB*.|
    | ИМЯ                   | *myLoadBalancer*                                   |
    | Регион         | Выберите **Западная Европа**.                                        |
    | type          | Щелкните **Общедоступный**.                                        |
    | SKU           | Выберите **Стандартная**.                          |
    | Общедоступный IP-адрес | Выберите **Создать**. |
    | Имя общедоступного IP-адреса              | Введите *myPublicIP* в текстовом поле.   |
    |Зона доступности| Выберите **Zone redundant** (Избыточно в пределах зоны).    |
3. На вкладке **Отзыв и создание** выберите **Создать**.   

    ![Создание подсистемы балансировки нагрузки уровня "Стандартный"](./media/quickstart-load-balancer-standard-public-portal/create-standard-load-balancer.png)

## <a name="create-load-balancer-resources"></a>Создание ресурсов Load Balancer

В этом разделе описано, как настроить параметры Load Balancer для внутреннего пула адресов и пробы работоспособности, а также как указать правила балансировки нагрузки.

### <a name="create-a-backend-address-pool"></a>Создание внутреннего пула адресов

Для распределения трафика между виртуальными машинами, внутренний пул адресов содержит IP-адреса виртуальных сетевых карт, подключенных к Load Balancer. Создайте внутренний пул адресов *myBackendPool*, чтобы включить виртуальные машины для балансировки нагрузки интернет-трафика.

1. В меню слева щелкните **Все службы**, выберите **Все ресурсы**, а затем из списка ресурсов выберите **myLoadBalancer**.
2. В разделе **Параметры** выберите **Серверные пулы**, затем щелкните **Добавить**.
3. На странице **Добавление серверного пула** введите имя *myBackEndPool* для серверного пула и выберите **Добавить**.

### <a name="create-a-health-probe"></a>Создание пробы работоспособности

Чтобы Load Balancer мог следить за состоянием приложения, необходимо использовать пробу работоспособности. Проба работоспособности динамически добавляет или удаляет виртуальные машины из Load Balancer на основе их ответа на проверки работоспособности. Создайте зонд работоспособности *myHealthProbe*, чтобы отслеживать работоспособность виртуальных машин.

1. В меню слева щелкните **Все службы**, выберите **Все ресурсы**, а затем из списка ресурсов выберите **myLoadBalancer**.
2. В разделе **Параметры** выберите **Пробы работоспособности**, а затем щелкните **Добавить**.
    
    | Параметр | Значение |
    | ------- | ----- |
    | ИМЯ | Введите *myHealthProbe*. |
    | Протокол | Выберите **HTTP**. |
    | Порт | Введите *80*.|
    | Интервал | В качестве **интервала** между попытками выполнения пробы (в секундах) введите *15*. |
    | Пороговое значение сбоя | Выберите *2* в качестве значения **порога состояния неработоспособности** или количества последовательных сбоев пробы, после которых виртуальная машина будет считаться неработоспособной.|
    | Проверка работоспособности | Выберите *myHealthProbe*. |
4. Нажмите кнопку **ОК**.

### <a name="create-a-load-balancer-rule"></a>Создание правила подсистемы балансировки нагрузки
Правило подсистемы балансировки нагрузки позволяет определить распределение трафика между виртуальными машинами. Вы определяете конфигурацию внешнего IP-адреса для входящего трафика и пул внутренних IP-адресов для приема трафика, а также требуемый порт источника и назначения. Создайте правило Load Balancer *myLoadBalancerRuleWeb* для прослушивания порта 80 в интерфейсном сервере *FrontendLoadBalancer* и отправки трафика со сбалансированной нагрузкой во внутренний пул адресов *myBackEndPool*, также используя порт 80. 

1. В меню слева щелкните **Все службы**, выберите **Все ресурсы**, а затем из списка ресурсов выберите **myLoadBalancer**.
2. В разделе **Параметры** выберите **Правила балансировки нагрузки**, а затем щелкните **Добавить**.
3. Для настройки правила балансировки нагрузки используйте следующие значения:
    
    | Параметр | Значение |
    | ------- | ----- |
    | ИМЯ | Введите *myHTTPRule*. |
    | Протокол | Выберите **TCP**. |
    | Порт | Введите *80*.|
    | Серверный порт | Введите *80*. |
    | Серверный пул | Выберите *myBackendPool*.|
    | Проверка работоспособности | Выберите *myHealthProbe*. |
4. Сохраните остальные значения по умолчанию и нажмите кнопку **ОК**.
4. Нажмите кнопку **ОК**.

## <a name="create-backend-servers"></a>Создание внутренних серверов

В этом разделе вы создаете виртуальную сеть, две виртуальные машины внутреннего пула Load Balancer, а затем устанавливаете службы IIS на виртуальных машинах для проверки Load Balancer.

### <a name="create-a-virtual-network"></a>Создать виртуальную сеть
1. Вверху с левой стороны экрана последовательно выберите **Создать ресурс** > **Сети** > **Виртуальная сеть**.

1. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    | ИМЯ | Введите *myVNet*. |
    | Пространство адресов | Введите *10.1.0.0/16*. |
    | Подписка | Выберите свою подписку.|
    | Группа ресурсов | Выберите существующий ресурс *myResourceGroupSLB*. |
    | Расположение | Выберите **Западная Европа**.|
    | Имя подсети | Введите *myBackendSubnet*. |
    | Диапазон адреса подсети | Введите *10.1.0.0/24*. |
1. Сохраните остальные значения по умолчанию и нажмите кнопку **Создать**.

### <a name="create-virtual-machines"></a>Создание виртуальных машин
Load Balancer (цен. категория "Стандартный") поддерживает только виртуальные машины с IP-адресами категории "Стандартный" во внутреннем пуле. В этом разделе вы создадите две виртуальные машины (*myVM1* и *myVM2*) с общедоступным IP-адресом категории "Стандартный" в двух различных зонах (*зона 1* и *зона 2*), которые добавляются в созданный ранее внутренний пул Load Balancer (цен. категория "Стандартный").

1. В верхней левой части портала выберите **Создать ресурс** > **Вычисления** > **Windows Server 2016 Datacenter**. 
   
1. В разделе **Создание виртуальной машины** введите или выберите следующие значения на вкладке **Основные сведения**:
   - **Подписка** > **Группа ресурсов**. Выберите **myResourceGroupSLB**.
   - **Сведения об экземпляре** > **Имя виртуальной машины**. Введите *myVM1*.
   - **Сведения об экземпляре** > **Регион**, затем выберите **Западная Европа**.
   - **Сведения об экземпляре** > **Параметры доступности**, затем выберите **Зоны доступности**. 
   - **Сведения об экземпляре** > **Зона доступности**, затем выберите **1**.
  
1. Выберите вкладку **Сеть** или **Далее: диски**, затем **Далее: сеть**. 
   
   - Выберите следующее:
       - **Виртуальная сеть**: *myVnet*.
       - **Подсеть**: *MyBackendSubnet*.
       - Выберите **Общедоступный IP-адрес**, затем — **Создать**, в окне **Создать общедоступный IP-адрес** для **SKU** выберите **Стандартный**, а для **Зона доступности** — **Избыточное между зонами**, а затем нажмите кнопку **OK**.
   - Чтобы создать группу безопасности сети (NSG) типа брандмауэра, в разделе **Группа безопасности сети** выберите **Дополнительно**. 
       1. В поле **Настройка группы безопасности сети** выберите **Создать новый**. 
       1. Введите *myNetworkSecurityGroup* и нажмите кнопку **ОК**.
   - Выполните следующие действия, чтобы сделать виртуальную машину частью внутреннего пула Load Balancer.
        - В разделе **Балансировка нагрузки** для параметра **Настроить эту виртуальную машину для работы с существующим решением по балансировке нагрузки?** выберите **Да**.
        - В разделе **Параметры балансировки нагрузки** для **параметров балансировки нагрузки** выберите **Балансировщик нагрузки Azure**.
        - Для параметра **Выберите подсистему балансировки нагрузки** выберите *myLoadBalancer*. 
1. Выберите вкладку **Управление** или **Далее** > **Управление**. В разделе **Мониторинг** задайте **Выкл.** для параметра **Диагностика загрузки**. 
1. Выберите **Review + create** (Просмотреть и создать).   
1. Проверьте параметры, а затем нажмите кнопку **Создать**.
1. Выполните следующие действия, чтобы создать вторую виртуальную машину *myVM2* с общедоступным IP-адресом номера SKU (цен. категория "Стандартный") с именем *myVM2-ip*, а также, чтобы создать параметр **Зона доступности**, установленным на **2**, и остальные параметры, как у *myVM1*. 

### <a name="create-nsg-rule"></a>Создание правила группы безопасности сети

В этом разделе описано, как создать правило группы безопасности сети, чтобы разрешить входящие подключения по протоколу HTTP.

1. В меню слева щелкните **Все службы**, выберите **Все ресурсы**, а затем в списке ресурсов выберите группу **myNetworkSecurityGroup**, расположенную в группе ресурсов **myResourceGroupSLB**.
2. В разделе **Параметры** выберите **Правила безопасности для входящего трафика**, а затем щелкните **Добавить**.
3. Введите (выберите) следующие значения для правила безопасности для входящего трафика с именем *myHTTPRule*, чтобы разрешить входящие подключения HTTP через порт 80:
    - *Service Tag* — для **источника**;
    - *Internet* — для **тега службы источника**;
    - *80* — для **диапазонов портов назначения**;
    - *TCP* — для **протокола**;
    - *Разрешить* — для **действия**;
    - *100* — для значения **приоритета**;
    - *myHTTPRule* — для имени;
    - *Разрешить HTTP* — для описания.
4. Нажмите кнопку **ОК**.
 
### <a name="install-iis"></a>Установка служб IIS

1. В меню слева щелкните **Все службы**, выберите **Все ресурсы**, а затем в списке ресурсов выберите виртуальную машину **myVM1**, расположенную в группе ресурсов *myResourceGroupSLB*.
2. На странице **обзора** щелкните **Подключить**, чтобы подключиться по протоколу RDP к виртуальной машине.
3. Войдите в виртуальную машину с именем пользователя *azureuser*.
4. На рабочем столе сервера перейдите к **Средства администрирования Windows**>**Диспетчер сервера**.
5. В диспетчере сервера выберите **Добавить роли и компоненты**.
6. В **мастере добавления ролей и компонентов** введите следующие значения.
    - На странице **Выбор типа установки** выберите **Установка ролей или компонентов**.
    - На странице **Выбор целевого сервера** выберите **myVM1**.
    - На странице **Выберите роль сервера** щелкните **Веб-сервер (IIS)**.
    - Следуйте инструкциям, чтобы выполнить оставшиеся шаги мастера. 
7. Выполните шаги 1–6 для виртуальной машины *myVM2*.

## <a name="test-the-load-balancer"></a>Тестирование Load Balancer
1. Найдите общедоступный IP-адрес для подсистемы балансировки нагрузки на экране **обзора**. В меню слева щелкните **Все службы**, выберите **Все ресурсы**, а затем — **myPublicIP**.

2. Скопируйте общедоступный IP-адрес и вставьте его в адресную строку браузера. В браузере отобразится страница по умолчанию веб-сервера IIS.

      ![Веб-сервер IIS](./media/load-balancer-standard-public-portal/9-load-balancer-test.png)

Чтобы увидеть, как Load Balancer распределяет трафик между тремя виртуальными машинами, на которых выполняется приложение, принудительно обновите веб-браузер.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если больше нет необходимости в Load Balancer и всех связанных ресурсах, их можно удалить. Для этого выберите группу ресурсов (*myResouceGroupSLB*), содержащую Load Balancer, и щелкните **Удалить**.

## <a name="next-steps"></a>Дополнительная информация

Из этого краткого руководства вы узнали, как создать Load Balancer (цен. категория "Стандартный"), подключить к ней виртуальные машины, настроить правило трафика Load Balancer, пробу работоспособности, а также протестировать Load Balancer. Чтобы узнать больше об Azure Load Balancer, ознакомьтесь с другими руководствами по этой службе.

> [!div class="nextstepaction"]
> [Руководства по Azure Load Balancer](tutorial-load-balancer-standard-public-zone-redundant-portal.md)
