---
title: Основные понятия Azure Load Balancer
description: Обзор основных понятий для Azure Load Balancer
services: load-balancer
documentationcenter: na
author: asudbring
ms.service: load-balancer
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/13/2020
ms.author: allensu
ms.openlocfilehash: 61620a8497765c4d8f90a3d616bd2f4b932f8dcc
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91629035"
---
# <a name="azure-load-balancer-algorithm"></a>Алгоритм Azure Load Balancer

Load Balancer предоставляет указанные ниже возможности для приложений TCP и UDP.

## <a name="load-balancing-algorithm"></a>Алгоритм балансировки нагрузки.

Вы можете создать правило балансировки нагрузки, чтобы распределять входящий трафик внешнего интерфейса между экземплярами внутреннего пула. Azure Load Balancer использует алгоритм хэширования для распределения входящих потоков (не байтов). Он заменяет заголовки в потоках к экземплярам внутреннего пула. Сервер может получать новые потоки, когда в результате проверки работоспособности получается работоспособная серверная конечная точка.

По умолчанию Load Balancer использует хэш с пятью кортежами.

Хэш включает перечисленные ниже компоненты.

- **Исходный IP-адрес**
- **Исходный порт**
- **Конечный IP-адрес**
- **Порт назначения**
- **Номер протокола IP для сопоставления потоков на доступные серверы**

Сопоставление с исходным IP-адресом создается с помощью хэша с двумя или тремя кортежами. Пакеты из одного потока всегда поступают на один и тот же экземпляр за внешним интерфейсом с балансировкой нагрузки.

Если клиент запускает новый поток с того же исходного IP-адреса, меняется исходный порт. В результате использование хэша с пятью кортежами может привести к тому, что трафик перейдет к другой конечной точке серверной части.
Дополнительные сведения см. в разделе [Настройка режима распределения для Azure Load Balancer](./load-balancer-distribution-mode.md).

На представленном ниже рисунке показано распределение на основе хэша.

![Распространение на основе хэша](./media/load-balancer-overview/load-balancer-distribution.png)

*Рисунок. Распространение на основе хэша*

## <a name="application-independence-and-transparency"></a>Прозрачность и независимость от приложения

Load Balancer не взаимодействует напрямую с протоколом TCP или UDP или уровнем приложения. Поддерживается любой сценарий приложения TCP или UDP. Load Balancer не берет на себя роль источника и (или) назначения для потоков, а также не взаимодействует с полезными данными потока. Load Balancer не предоставляет никаких функций шлюза на уровне приложения Подтверждения протокола всегда происходят непосредственно между клиентом и экземпляром пула серверной части. Ответом на входящий поток всегда является ответ от виртуальной машины. Когда поток поступает в виртуальную машину, исходный IP-адрес источника также сохраняется.

- За каждую конечную точку отвечает определенная виртуальная машина. Например, подтверждение TCP выполняется между клиентом и выбранной серверной виртуальной машиной. Ответ на запрос к внешнему интерфейсу — это ответ, созданный серверной виртуальной машиной. При успешной проверке связи с внешним интерфейсом вы подтверждаете сквозное соединение по крайней мере с одной серверной виртуальной машиной.
- Полезные данные приложения прозрачны для Load Balancer. Поддерживается любое приложение UDP или TCP.
- Так как Load Balancer не взаимодействует с полезными данными TCP и обеспечивают разгрузку TLS, вы можете создавать сложные сценарии с шифрованием. Использование Load Balancer значительно повышает масштаб для приложений TLS, завершая подключение TLS на самой виртуальной машине. Например, емкости ключей в сеансах TLS ограничиваются только типом и числом виртуальных машин, добавленных в серверный пул.

## <a name="limitations"></a><a name = "limitations"></a>Ограничения

- Правило подсистемы балансировки нагрузки не может охватывать две виртуальные сети.  Внешние интерфейсы и их внутренние экземпляры должны быть расположены в одной виртуальной сети.  

- Подсистема балансировки нагрузки обеспечивает балансировку нагрузки и перенаправление портов для конкретных протоколов TCP или UDP. Правила балансировки нагрузки и правила NAT для входящего трафика поддерживают TCP и UDP, но не другие протоколы IP, включая ICMP.

- Перенаправление исходящего потока от внутренней виртуальной машины к внешнему интерфейсу внутреннего экземпляра Load Balancer завершится сбоем.

- Перенаправление фрагментов IP-адресов не поддерживается в правилах балансировки нагрузки. В правилах балансировки нагрузки не поддерживается фрагментация IP-пакетов UDP и TCP. Для перенаправления существующих IP-фрагментов можно использовать правила балансировки нагрузки портов с высоким уровнем доступности. Дополнительные сведения см. в разделе [Обзор портов высокой доступности](load-balancer-ha-ports-overview.md).

## <a name="next-steps"></a>Дальнейшие действия

- Чтобы приступить к работе с подсистемой балансировки нагрузки, создайте ее, создайте виртуальные машины с установленным пользовательским расширением IIS и распределяйте нагрузку веб-приложения между виртуальными машинами, как описано в статье [Краткое руководство. Создание Load Balancer (цен. категория "Стандартный") с помощью Azure CLI для распределения нагрузки между виртуальными машинами](quickstart-load-balancer-standard-public-portal.md).
- Ознакомьтесь со сведениями об [исходящих подключениях Azure Load Balancer](load-balancer-outbound-connections.md).
- [Дополнительные сведения об Azure Load Balancer](load-balancer-overview.md).
- Дополнительные сведения о [пробах работоспособности](load-balancer-custom-probe-overview.md).
- [Metrics and health diagnostics for Standard Load Balancer](load-balancer-standard-diagnostics.md) (Метрики и проверки работоспособности Load Balancer уровня "Стандартный")
- Узнайте больше о [группах безопасности сети](../virtual-network/security-overview.md).
