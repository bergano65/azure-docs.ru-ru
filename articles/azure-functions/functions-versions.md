---
title: Обзор версий среды выполнения для решения "Функции Azure"
description: Решение "Функции Azure" поддерживает разные версии среды выполнения. В этой статье приводятся различия между ними и рекомендации по выбору подходящей для вас версии.
services: functions
documentationcenter: ''
author: ggailey777
manager: jeconnoc
ms.service: azure-functions
ms.topic: conceptual
ms.date: 10/03/2018
ms.author: glenga
ms.openlocfilehash: 6988fb547b07f81891efea3caad8bf34f4c8a476
ms.sourcegitcommit: c174d408a5522b58160e17a87d2b6ef4482a6694
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "58889759"
---
# <a name="azure-functions-runtime-versions-overview"></a>Обзор версий среды выполнения для решения "Функции Azure"

 Есть два основных номера версии среды выполнения функций Azure: 1.x и 2.x. Текущая версия, где работают новые функции и создаются улучшения, — это 2.x, хотя обе они поддерживаются для производственной эксплуатации.  Ниже подробно рассматриваются некоторые различия между ними, а именно создание каждой версии и обновление версии 1.x до версии 2.x.

> [!NOTE]
> Содержимое в этой статье относится к облачной службе "Функции Azure". Сведения о выполнении Функций Azure в локальной среде см. в статье [Обзор среды выполнения Функций Azure (предварительная версия)](functions-runtime-overview.md).

## <a name="cross-platform-development"></a>Кроссплатформенная разработка

Среда выполнения версии 2.x выполняется на .NET Core 2, что позволяет выполнять ее на всех платформах, поддерживаемых .NET Core, включая macOS и Linux. Выполнение в .NET Core позволяет реализовать сценарии кроссплатформенной разработки и размещения.

Для сравнения, среда выполнения версии 1.x поддерживает разработку и размещение только на портале Azure или на компьютерах Windows.

## <a name="languages"></a>Languages

В среде выполнения 2.x используется новая модель расширяемости языка. В версии 2.x все функции в приложении-функции должны использовать один язык. Язык функций для приложения-функции выбирается один раз при создании приложения.

Экспериментальные языки Функций Azure версии 1.x не будут обновляться для применения новой модели, поэтому они не поддерживаются в версии 2.x. В следующей таблице перечислены языки программирования, которые в настоящее время поддерживаются для каждой версии среды выполнения.

[!INCLUDE [functions-supported-languages](../../includes/functions-supported-languages.md)]

Дополнительные сведения см. в [списке поддерживаемых языков](supported-languages.md).

## <a name="creating-1x-apps"></a>Работают в версии 1.x

По умолчанию, созданные на портале Azure приложения-функции настраиваются на версию 2.x. По возможности следует использовать именно эту версию среды выполнения, где будут создаваться новые функции системы. Но если нужно, вы еще может выполнять приложения-функции в среде выполнения версии 1.x. Версию среды выполнения следует менять только после создания приложения-функции, но до добавления в него функций. Чтобы узнать, как закрепить версию 1.x для среды выполнения, изучите статью [Выбор целевых версий среды выполнения Функций Azure](set-runtime-version.md#view-and-update-the-current-runtime-version).

## <a name="migrating-from-1x-to-2x"></a>Миграция с версии 1.x на 2.x

Вы можете перенести существующее приложение, написанное для среды выполнения версии 1.x, на новую версию 2.x. Большинство изменений, которые нужно внести в этом случае, связаны с языковой средой выполнения, например с различиями API C# между версиями для .NET Framework 4.7 и .NET Core 2. Также нужно убедиться, что код и библиотеки совместимы с выбранными языковыми средами выполнения. И наконец, обязательно обратите внимание на все изменения в триггерах, привязках и функциях, указанные ниже. Чтобы миграция прошла идеально, создайте новое приложение-функцию для версии 2.x и портируйте код существующей функции версии 1.x в новое приложение.  

### <a name="changes-in-triggers-and-bindings"></a>Изменения в триггерах и привязках

Для версии 2.x вам потребуется установить расширения для конкретных триггеров и привязок, которые используются функциями вашего приложения. Единственное исключение — триггеры HTTP и таймера, для которых не требуется расширение.  Для получения дополнительной информации ознакомьтесь с разделом [Регистрация расширений привязки](./functions-bindings-register.md).

Также при смене версий были внесены некоторые изменения в `function.json` или атрибуты функций. Например, свойство `path` для концентратора событий теперь имеет атрибут `eventHubName`. Для получения ссылок на документацию для каждой привязки см. [таблицу существующих привязок](#bindings).

### <a name="changes-in-features-and-functionality"></a>Изменения в функциях и возможностях

Некоторые возможности в новой версии удалены, обновлены или заменены. В этом разделе описаны изменения, которые вы заметите в версии 2.x после использования версии 1.x.

В версии 2.x внесены следующие изменения.

* Ключи для вызова конечных точек HTTP всегда хранятся в зашифрованном виде в хранилище BLOB-объектов Azure. В версии 1.x эти ключи по умолчанию хранились в хранилище файлов Azure. При обновлении приложения с версии 1.x до версии 2.x выполняется сброс существующих секретных данных, которые находятся в хранилище файлов.

* Среда выполнения версии 2.x не имеет встроенной поддержки для поставщиков веб-перехватчиков. Это изменение внесено для повышения производительности. Вы по-прежнему можете использовать HTTP-триггеры как конечные точки для веб-перехватчиков.

* Файл конфигурации узла (host.json) должен быть пустым или содержать строку `"version": "2.0"`.

* Чтобы улучшить мониторинг, панель веб-заданий на портале с параметром [`AzureWebJobsDashboard`](functions-app-settings.md#azurewebjobsdashboard) замерена Azure Application Insights с параметром [`APPINSIGHTS_INSTRUMENTATIONKEY`](functions-app-settings.md#appinsights_instrumentationkey). Дополнительные сведения см. в разделе [Мониторинг функций Azure](functions-monitoring.md).

* Все функции в приложении-функции должны использовать один язык. При создании приложения-функции необходимо выбрать для приложения стек среды выполнения. Стек среды выполнения указан значением [`FUNCTIONS_WORKER_RUNTIME`](functions-app-settings.md#functions_worker_runtime) в параметрах приложения. Это требование добавлено для уменьшения занимаемого места и ускорения запуска. При локальной разработке также необходимо включить этот параметр в [файл local.settings.json](functions-run-local.md#local-settings-file).

* По умолчанию для функций в плане службы приложений устанавливается время ожидания 30 минут. Вы можете вручную снять это ограничение, изменив параметр [functionTimeout](functions-host-json.md#functiontimeout) в файле host.json.

* Регулирование параллельной обработки HTTP по умолчанию применяется для функций плана потребления, по умолчанию допуская не более 100 одновременных запросов на один экземпляр. Этот параметр можно изменить в параметре [`maxConcurrentRequests`](functions-host-json.md#http) файла host.json.

* Из-за [ограничений .NET Core](https://github.com/Azure/azure-functions-host/issues/3414) удалена поддержка функций в виде скриптов F# (.fsx). Скомпилированные функции F# (.fs) по-прежнему поддерживаются.

* Для веб-перехватчиков триггера сетки событий формат URL-адреса изменен на `https://{app}/runtime/webhooks/{triggerName}`.

### <a name="migrating-a-locally-developed-application"></a>Миграция локально разработанного приложения

Возможно, у вас есть существующие проекты приложений-функций, локально разработанные для среды выполнения версии 1.x. Чтобы обновить их до версии 2.x, создайте локальный проект приложения-функции для версии 2.x и портируйте существующий код в новое приложение. Вы также можете обновить существующий проект и код "на месте", без создания нового проекта. Но в этом случае может потребоваться вручную применить ряд других улучшений, которые различают версии 1.x и 2.x. Например, в C# объект отладки изменен с `TraceWriter` на `ILogger`. Создавая новый проект версии 2.x, вы сразу получаете обновленные функции, основанные на самых свежих шаблонах для версии 2.x.

#### <a name="visual-studio-runtime-versions"></a>Версии среды выполнения Visual Studio

В Visual Studio вы выбираете версию среды выполнения при создании проекта. Средства Функций Azure для Visual Studio поддерживают обе основные версии среды выполнения. При отладке и публикации правильная версия применяется автоматически на основе настроек проекта. Параметры версии определяются в файле `.csproj` в следующих свойствах:

##### <a name="version-1x"></a>Версия 1.x

```xml
<TargetFramework>net461</TargetFramework>
<AzureFunctionsVersion>v1</AzureFunctionsVersion>
```

##### <a name="version-2x"></a>Версия 2.x

```xml
<TargetFramework>netcoreapp2.2</TargetFramework>
<AzureFunctionsVersion>v2</AzureFunctionsVersion>
```

При отладке или публикации проекта используется правильная версия среды выполнения.

#### <a name="vs-code-and-azure-functions-core-tools"></a>Основные инструменты VS Code и Функций Azure

[Основные инструменты службы функции Azure](functions-run-local.md) используются для разработки из командной строки, а также в [расширении Функций Azure](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions) для Visual Studio Code. Чтобы вести разработку для версии 2.x, установите версию 2.x основных инструментов. Разработка для версии 1.x требует наличия версии 1.x основных инструментов. Дополнительные сведения см. в разделе [Установка основных инструментов Функций Azure](functions-run-local.md#install-the-azure-functions-core-tools).

Для разработки в Visual Studio Code следует также изменить параметры пользователя, чтобы `azureFunctions.projectRuntime` соответствовал версии установленных инструментов.  Этот параметр также обновляет шаблоны и языки, используемые при создании приложения-функции.

### <a name="changing-version-of-apps-in-azure"></a>Изменение версии приложений в Azure

Версия среды выполнения для Функций Azure, используемая опубликованными в Azure приложениями, зависит от параметра приложения [`FUNCTIONS_EXTENSION_VERSION`](functions-app-settings.md#functions_extension_version). Значение `~2` обозначает среду выполнения версии 2.x, а `~1` — среду выполнения версии 1.x. Не изменяйте этот параметр без веских причин, поскольку это потребует и других изменений в параметрах приложения и коде функций. Дополнительные сведения о рекомендациях по миграции приложения-функции на другую версию среды выполнения см. в статье [Выбор целевых версий среды выполнения Функций Azure](set-runtime-version.md).

## <a name="bindings"></a>Привязки

В среде выполнения версии 2.x используется новая [модель расширяемости привязок](https://github.com/Azure/azure-webjobs-sdk-extensions/wiki/Binding-Extensions-Overview), которая обеспечивает следующие преимущества:

* Поддержка сторонних расширений привязок.

* Разделение среды выполнения и привязок. Это изменение позволяет отдельно управлять версиями расширений привязок и выпускать эти расширения. Например, можно выполнить обновление до версии расширения на основе более новой версии базового пакета SDK.

* Менее ресурсоемкая среда выполнения, где в среде выполнения известны только используемые привязки и только они загружаются в нее.

За исключением триггеров HTTP и таймера, все привязки теперь необходимо вручную добавлять в проект приложения-функции или регистрировать на портале. Для получения дополнительной информации ознакомьтесь с разделом [Регистрация расширений привязки](./functions-bindings-expressions-patterns.md).

В следующей таблице перечислены поддерживаемые привязки для каждой версии среды выполнения.

[!INCLUDE [Full bindings table](../../includes/functions-bindings.md)]

[!INCLUDE [Timeout Duration section](../../includes/functions-timeout-duration.md)]

## <a name="next-steps"></a>Дальнейшие действия

Для получения дополнительных сведений см. следующие ресурсы:

* [Как программировать и тестировать функции Azure в локальной среде](functions-run-local.md)
* [Выбор целевых версий среды выполнения Функций Azure](set-runtime-version.md)
* [Заметки о выпуске](https://github.com/Azure/azure-functions-host/releases)
