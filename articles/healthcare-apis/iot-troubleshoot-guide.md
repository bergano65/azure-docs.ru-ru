---
title: Соединитель Azure IoT для FHIR (Предварительная версия) — руководство по устранению неполадок и инструкции
description: Как устранить неполадки с общим соединителем Azure IoT для FHIR (Предварительная версия) сообщения об ошибках и их копирование
services: healthcare-apis
author: msjasteppe
ms.service: healthcare-apis
ms.subservice: iomt
ms.topic: troubleshooting
ms.date: 11/13/2020
ms.author: jasteppe
ms.openlocfilehash: 403b6656a47f56508682dcda2438a85d513fbfb1
ms.sourcegitcommit: 9826fb9575dcc1d49f16dd8c7794c7b471bd3109
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/14/2020
ms.locfileid: "94630504"
---
# <a name="azure-iot-connector-for-fhir-preview-troubleshooting-guide"></a>Руководство по устранению неполадок в соединителе Azure IoT для FHIR (Предварительная версия)

В этой статье приводятся инструкции по устранению неполадок в стандартном соединителе Azure IoT для быстрого взаимодействия с ресурсами в области здравоохранения (FHIR&#174;) * сообщения об ошибках и условия.  

Вы также узнаете, как создавать копии соединителя Azure IoT для сопоставления преобразования FHIR JSON (например, Device и FHIR).  

Для редактирования и архивации можно использовать копии JSON сопоставления преобразования за пределами портал Azure.  

> [!TIP]
> Если вы откроете запрос в службу [технической поддержки Azure](https://azure.microsoft.com/support/create-ticket/) для соединителя Azure IOT для FHIR, обязательно включите копии формата JSON сопоставления преобразования, чтобы помочь в процессе устранения неполадок.

## <a name="device-and-fhir-conversion-mapping-json-template-validations-for-azure-iot-connector-for-fhir-preview"></a>Преобразование шаблонов JSON для сопоставления устройств и FHIR для соединителя Azure IoT для FHIR (Предварительная версия)
В этом разделе вы узнаете о процессе проверки того, что соединитель Azure IoT для FHIR выполняет проверку шаблонов JSON сопоставления устройств и FHIR, прежде чем разрешить их сохранение для использования.  Эти элементы необходимы в формате JSON сопоставления устройства и преобразования FHIR.

**Сопоставление устройств**

|Элемент|Обязательно|
|:-------|:------|
|TypeName|Верно|
|типематчекспрессион|Верно|
|девицеидекспрессион|Верно|
|тиместампекспрессион|Верно|
|Values []. ValueName|Верно|
|Values []. ValueExpression|Верно|

> [!NOTE]
> Values []. ValueName и значения []. ValueExpression
>
> Эти элементы необходимы только в том случае, если в массиве есть запись значения, но не сопоставлено значений. Используется, если отправляемая телеметрии является событием. Например, когда устройство носимого пользователем Иомт будет размещено или удалено. Элементы не имеют значений, кроме имени, которое соединитель Azure IoT для FHIR соответствует и выдает. При преобразовании FHIR соединитель Azure IoT для FHIR сопоставляет его с концепцией кода, основанной на семантическом типе. фактические значения не заполняются.

**Сопоставление FHIR**

|Элемент|Обязательно|
|:------|:-------|
|TypeName|Верно|

> [!NOTE]
> Это единственный обязательный элемент сопоставления FHIR, проверенный в данный момент.

## <a name="error-messages-and-fixes-for-azure-iot-connector-for-fhir-preview"></a>Сообщения об ошибках и исправления для соединителя Azure IoT для FHIR (Предварительная версия)

|Сообщение|Отображаем|Условие|Fix| 
|-------|---------|---------|---|
|Недопустимое имя сопоставления, имя сопоставления должно быть Device или FHIR.|API|Указанный тип сопоставления не является устройством или FHIR.|Используйте один из двух поддерживаемых типов сопоставления (например, Device или FHIR).|
|Проверка завершена с ошибкой. Необходимые сведения отсутствуют или являются недопустимыми.|API и портал Azure|При попытке сохранить в сопоставлении преобразования отсутствует необходимая информация или элемент.|Добавьте недостающие сведения о сопоставлении преобразования или элемент и попытайтесь сохранить сопоставление преобразования еще раз.|
|Повторное создание параметров ключа не определено.|API|Запрос на повторное создание ключа.|Включить параметры в запрос ключа повторного создания.|
|Достигнуто максимальное число экземпляров соединителя IoT, которые могут быть подготовлены в этой подписке.|API и портал Azure|Достигнута квота на использование соединителя Azure IoT для подписки FHIR (по умолчанию — (2) на подписку).|Удалите один из существующих экземпляров соединителя Azure IoT для FHIR.  Используйте другую подписку, которая не достигла квоты подписки.  Запросите увеличение квоты подписки.|
|Перемещение ресурса не поддерживается для ресурса API Azure с включенным соединителем IoT для FHIR.|API и портал Azure|Попытка выполнить операцию перемещения в ресурсе Azure API для FHIR, который содержит один или несколько экземпляров соединителя Azure IoT для FHIR.|Удалите существующие экземпляры соединителя Azure IoT для FHIR, чтобы выполнить операцию перемещения.|
|Соединитель IoT не подготовлен.|API|Попытка использовать дочерние службы (подключения & сопоставления), если родительский объект (соединитель Azure IoT для FHIR) не был подготовлен.|Подготавливает соединитель Azure IoT для FHIR.|
|Запрос не поддерживается.|API|Конкретный запрос API не поддерживается.|Используйте правильный запрос API.|
|Учетная запись не существует.|API|Попытка добавить соединитель Azure IoT для FHIR и API Azure для ресурса FHIR не существует.|Создайте API Azure для ресурса FHIR и повторите операцию.|
|Версия FHIR ресурсов API Azure для FHIR не поддерживается для соединителя IoT.|API|Попытка использовать соединитель Azure IoT для FHIR с несовместимой версией ресурса API Azure для FHIR.|Создайте новый API Azure для ресурса FHIR (версия R4) или используйте существующий API Azure для ресурса FHIR (версия R4).

## <a name="why-is-my-azure-iot-connector-for-fhir-preview-data-not-showing-up-in-azure-api-for-fhir"></a>Почему мой соединитель Azure IoT для FHIR (Предварительная версия) не отображается в API Azure для FHIR?

|Возможные проблемы|Исправления|
|----------------|-----|
|Данные все еще обрабатываются.|Данные егрессед в API Azure для FHIR в пакетах (каждые 15 минут).  Возможно, данные все еще обрабатываются и требуется дополнительное время, чтобы данные сохранялись в API Azure для FHIR.|
|Преобразование JSON сопоставления устройств не настроено.|Настройка и сохранение согласования преобразования устройств JSON сопоставления.|
|Формат JSON сопоставления преобразования FHIR не настроен.|Настройка и сохранение согласования FHIR сопоставления преобразования JSON.|
|Сообщение устройства не содержит ожидаемое выражение, определенное в сопоставлении устройств.|Убедитесь, что выражения JsonPath, определенные в сопоставлении устройств, соответствуют маркерам, определенным в сообщении устройства.|
|Ресурс устройства не был создан в API Azure для FHIR (тип разрешения: только поиск) *.|Создайте допустимый ресурс устройства в API Azure для FHIR. Убедитесь, что ресурс устройства содержит идентификатор, соответствующий идентификатору устройства, указанному во входящем сообщении.|
|Ресурс пациента не был создан в API Azure для FHIR (тип разрешения: только Уточняющий запрос) *.|Создайте допустимый ресурс пациента в API Azure для FHIR.|
|Ссылка на Device. пациент не задана, или недопустимая ссылка (тип разрешения: только Уточняющий запрос) *.|Убедитесь, что ресурс устройства содержит действительную [ссылку](https://www.hl7.org/fhir/device-definitions.html#Device.patient) на ресурс пациента.| 

* [Краткое руководство. Развертывание соединителя Azure IOT (Предварительная версия) с помощью портал Azure](iot-fhir-portal-quickstart.md#create-new-azure-iot-connector-for-fhir-preview) для функционального описания соединителя Azure IOT для типов разрешения FHIR (например: Lookup или CREATE).

## <a name="use-metrics-to-troubleshoot-issues-in-azure-iot-connector-for-fhir-preview"></a>Использование метрик для устранения неполадок соединителя Azure IoT для FHIR (Предварительная версия)

Соединитель Azure IoT для FHIR создает несколько метрик для получения ценных сведений о процессе потока данных. Одна из поддерживаемых метрик называется *всего ошибок* , что позволяет получить количество всех ошибок, возникающих в экземпляре соединителя Azure IOT для FHIR.

Каждая ошибка регистрируется с помощью ряда связанных свойств. Каждое свойство предоставляет различные аспекты ошибки, которые могут помочь в выявлении и устранении неполадок. В этом разделе перечислены различные свойства, захваченные для каждой ошибки в метрике *общего числа ошибок* , и возможные значения этих свойств.

> [!NOTE]
> Можно переходить к общей метрике *ошибок* для экземпляра соединителя Azure IOT для FHIR (Предварительная версия), как описано на [странице метрики соединителя Azure IOT для FHIR (Предварительная версия)](iot-metrics-display.md).

Щелкните диаграмму *Общее количество ошибок* , а затем нажмите кнопку *Добавить фильтр* , чтобы выполнить срез и кость метрики ошибок с помощью любого из перечисленных ниже свойств.

### <a name="the-operation-performed-by-the-azure-iot-connector-for-fhir-preview"></a>Операция, выполняемая соединителем Azure IoT для FHIR (Предварительная версия)

Это свойство представляет операцию, выполняемую соединителем IoT при возникновении ошибки. Операция обычно представляет стадию потока данных при обработке сообщения устройства. Ниже приведен список возможных значений для этого свойства.

> [!NOTE]
> Дополнительные сведения о различных стадиях потока данных в соединителе Azure IoT можно узнать [здесь](iot-data-flow.md): FHIR (Предварительная версия).

|Стадия потока данных|Описание|
|---------------|-----------|
|Настройка|Операция, относящаяся к настройке экземпляра соединителя IoT|
|Нормализация|Стадия потока данных, в которой данные устройства нормализованы|
|Группирование|Стадия потока данных, где группируются Нормализованные данные|
|фхирконверсион|Стадия потока данных, в которой сгруппированные Нормализованные данные преобразуются в ресурс FHIR|
|Неизвестно|При возникновении ошибки тип операции неизвестен|

### <a name="the-severity-of-the-error"></a>Серьезность ошибки

Это свойство представляет серьезность возникшей ошибки. Ниже приведен список возможных значений для этого свойства.

|Статус|Описание|
|---------------|-----------|
|Предупреждение|В процессе потока данных существует небольшая проблема, но обработка сообщения устройства не останавливается.|
|Ошибка|Обработка определенного сообщения устройства вызвала ошибку, и другие сообщения могут продолжать выполняться должным образом|
|Критически важно|Существует ошибка на уровне системы в соединителе IoT, и ожидающие обработки сообщения отсутствуют|

### <a name="the-type-of-the-error"></a>Тип ошибки

Это свойство указывает категорию для данной ошибки, которая, по сути, представляет логическую группу для аналогичного типа ошибок. Ниже приведен список возможных значений для этого свойства.

|Тип ошибки|Описание|
|----------|-----------|
|девицетемплатиррор|Ошибки, связанные с шаблонами сопоставления устройств|
|девицемессажееррор|Произошли ошибки при обработке определенного сообщения устройства|
|фхиртемплатиррор|Ошибки, связанные с шаблонами сопоставления FHIR|
|фхирконверсионеррор|Произошли ошибки при преобразовании сообщения в ресурс FHIR|
|фхирресаурцееррор|Ошибки, связанные с существующими ресурсами на сервере FHIR, на которые ссылается соединитель IoT|
|фхирсервереррор|Ошибки, возникающие при взаимодействии с сервером FHIR|
|GeneralError|Все другие типы ошибок|

### <a name="the-name-of-the-error"></a>Имя ошибки

Это свойство предоставляет имя для конкретной ошибки. Ниже приведен список всех имен ошибок с описанием и соответствующими типами ошибок, серьезностью и стадиями потока данных.

|Имя ошибки|Описание|Типы ошибок|Серьезность ошибки|Этапы потока данных|
|----------|-----------|-------------|--------------|------------------|
|мултиплересаурцефаундексцептион|Произошла ошибка при обнаружении нескольких ресурсов пациента или устройств на сервере FHIR для соответствующих идентификаторов, имеющихся в сообщении устройства|фхирресаурцееррор|Ошибка|фхирконверсион|
|TemplateNotFoundException|Шаблон сопоставления устройства или FHIR не настроен с помощью экземпляра соединителя IoT.|Девицетемплатиррор, Фхиртемплатиррор|Критически важно|Нормализация, Фхирконверсион|
|коррелатиониднотдефинедексцептион|Идентификатор корреляции не указан в шаблоне сопоставления устройств. Коррелатиониднотдефинедексцептион — это условная ошибка, которая возникает, только если наблюдение FHIR должно группировать измерения устройств с помощью идентификатора корреляции, но он настроен неправильно.|девицемессажееррор|Ошибка|Нормализация|
|патиентдевицемисматчексцептион|Эта ошибка возникает, когда ресурс устройства на сервере FHIR имеет ссылку на ресурс пациента, который не совпадает с идентификатором пациента, присутствующим в сообщении.|фхирресаурцееррор|Ошибка|фхирконверсионеррор|
|патиентнотфаундексцептион|Ресурс FHIR устройства, связанный с идентификатором устройства, присутствующим в сообщении устройства, не ссылается на ресурс FHIR. Примечание. Эта ошибка возникает, только если экземпляр соединителя IoT настроен с типом разрешения " *Уточняющий запрос* "|фхирконверсионеррор|Ошибка|фхирконверсион|
|девиценотфаундексцептион|На сервере FHIR не существует ресурса устройства, связанного с идентификатором устройства, присутствующим в сообщении устройства|девицемессажееррор|Ошибка|Нормализация|
|патиентидентитинотдефинедексцептион|Эта ошибка возникает, когда выражение для анализа идентификатора пациента из сообщения устройства не настроено в шаблоне сопоставления устройства или идентификатор пациента отсутствует в сообщении устройства. Примечание. Эта ошибка возникает только в том случае, если для типа разрешения соединителя IoT задано значение " *создать* ".|девицетемплатиррор|Критически важно|Нормализация|
|девицеидентитинотдефинедексцептион|Эта ошибка возникает, когда не настроено выражение для анализа идентификатора устройства из сообщения устройства в шаблоне сопоставления устройств или идентификатор устройства отсутствует в сообщении устройства|девицетемплатиррор|Критически важно|Нормализация|
|NotSupportedException|Произошла ошибка при получении сообщения устройства с неподдерживаемым форматом|девицемессажееррор|Ошибка|Нормализация|

## <a name="creating-copies-of-the-azure-iot-connector-for-fhir-preview-conversion-mapping-json"></a>Создание копий соединителя Azure IoT для преобразования FHIR (Предварительная версия) JSON сопоставления

Копирование соединителя Azure IoT для файлов сопоставления FHIR может оказаться полезным для редактирования и архивации за пределами веб-сайта портал Azure.

При открытии запроса в службу поддержки для помощи в устранении неполадок необходимо предоставить службе технической поддержки Azure сведения о копировании файлов сопоставления.

> [!NOTE]
> В настоящее время JSON — это единственный поддерживаемый формат для файлов сопоставления устройств и FHIR.

> [!TIP]
> Узнайте больше о соединителе Azure IoT для FHIR [устройств и преобразования FHIR](./iot-mapping-templates.md) в формате JSON.

1. Выберите **"соединитель IOT (Предварительная версия)"** в левой нижней части панели мониторинга ресурсов API Azure для FHIR в разделе **"надстройки"** .

   :::image type="content" source="media/iot-troubleshoot/map-files-main-with-box.png" alt-text="Connector1 IoT" lightbox="media/iot-troubleshoot/map-files-main-with-box.png":::

2. Выберите **соединитель** , из которого будет скопировано преобразование JSON сопоставления преобразования.

   :::image type="content" source="media/iot-troubleshoot/map-files-select-connector-with-box.png" alt-text="Connector2 IoT" lightbox="media/iot-troubleshoot/map-files-select-connector-with-box.png":::

> [!NOTE]
> Этот процесс также может использоваться для копирования и сохранения содержимого JSON **"Configure FHIR Mapping"** .

3. Выберите **"настроить сопоставление устройств"**.

    :::image type="content" source="media/iot-troubleshoot/map-files-select-device-with-box.png" alt-text="Connector3 IoT" lightbox="media/iot-troubleshoot/map-files-select-device-with-box.png":::

4. Выберите содержимое JSON и выполните операцию копирования (например, нажмите клавиши Ctrl + c). 

   :::image type="content" source="media/iot-troubleshoot/map-files-select-device-json-with-box.png" alt-text="Connector4 IoT" lightbox="media/iot-troubleshoot/map-files-select-device-json-with-box.png":::

5. Выполните операцию вставки (например, выберите CTRL + v) в новый файл в редакторе (например, Visual Studio Code, Notepad) и сохраните файл с расширением *. JSON.

> [!TIP]
> Если вы откроете запрос в службу [технической поддержки Azure](https://azure.microsoft.com/support/create-ticket/) для соединителя Azure IOT для FHIR, обязательно включите копии формата JSON сопоставления преобразования, чтобы помочь в процессе устранения неполадок.

## <a name="next-steps"></a>Дальнейшие действия

Ознакомьтесь с часто задаваемыми вопросами о соединителе Azure IoT для FHIR.

>[!div class="nextstepaction"]
>[Вопросы и ответы о соединителе Azure IoT для FHIR](fhir-faq.md)

* В портал Azure соединитель Azure IoT для FHIR называется соединителем IoT (Предварительная версия). FHIR является охраняемым товарным знаком HL7 и используется с разрешением HL7.