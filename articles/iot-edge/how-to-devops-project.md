---
title: Конвейер CI/CD с Azure DevOps Projects — Azure IoT Edge | Документация Майкрософт
description: Azure DevOps Projects упрощает начало работы с Azure. В этой статье вы узнаете, как запустить необходимое приложение Azure IoT Edge за несколько быстрых шагов.
author: shizn
manager: ''
ms.author: xshi
ms.date: 01/22/2019
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.custom: seodec18
ms.openlocfilehash: 57279a4e92b1f42505003f12d41c8203aa5603d4
ms.sourcegitcommit: b4755b3262c5b7d546e598c0a034a7c0d1e261ec
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2019
ms.locfileid: "54881875"
---
# <a name="create-a-cicd-pipeline-for-iot-edge-with-azure-devops-projects-preview"></a>Создание конвейера CI/CD для IoT Edge с помощью Azure DevOps Projects (предварительная версия)

Настройте непрерывную интеграцию (CI) и непрерывную доставку (CD) для приложения IoT Edge с помощью DevOps Projects. DevOps Projects упрощает начальную настройку конвейера сборки и выпуска в Azure Pipelines.

Если у вас нет активной подписки Azure, перед началом работы создайте [бесплатную учетную запись](https://azure.microsoft.com/free).

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

DevOps Projects создает конвейер CI/CD в Azure DevOps. Вы можете создать новую организацию Azure DevOps или использовать существующую. DevOps Projects также создает ресурсы Azure в требуемой подписке Azure.

1. Войдите на [портал Microsoft Azure](https://portal.azure.com).

1. Выберите **Создать ресурс** в области слева и выполните поиск по запросу **DevOps Projects**.  

1.  Нажмите кнопку **Создать**.

## <a name="create-a-new-application-pipeline"></a>Конвейер создания приложения 

1. Модули Azure IoT Edge могут быть написаны на языках [C#](tutorial-csharp-module.md), [Node.js](tutorial-node-module.md), [Python](tutorial-python-module.md), [C](tutorial-c-module.md) и [Java](tutorial-java-module.md). Выберите необходимый язык для запуска нового приложения: **.NET**, **Node.js**, **Python**, **C** или **Java**. Нажмите кнопку **Далее**, чтобы продолжить.

   ![Выбор языка для создания приложения](./media/how-to-devops-project/select-language.png)

2. Выберите **Простой Интернет вещей (предварительная версия)** как исполняющую среду, а затем щелкните **Далее**.

   ![Выбор платформы "Простой Интернет вещей"](media/how-to-devops-project/select-iot.png)

3. Выберите **IoT Edge** как службу Azure, которая развертывает приложение, а затем щелкните **Далее**.

   ![Выбор службы IoT Edge](media/how-to-devops-project/select-iot-edge.png)

4. Создайте новую бесплатную организацию Azure DevOps или выберите существующую.

   1. Задайте имя проекта. 

   2. Выберите свою организацию Azure DevOps. Если у вас нет существующей организации, выберите **Дополнительные параметры**, чтобы создать организацию. 

   3. Выберите подписку Azure.

   4. Используйте имя Центра Интернета вещей, созданное на основе имени проекта, или укажите собственное.

   5. Выберите **Дополнительные параметры** для настройки ресурсов Azure, создаваемых компонентом DevOps Projects от вашего имени.

   6. Нажмите кнопку **Готово** для завершения создания проекта. 

   ![Выбор имени приложения и его создание](media/how-to-devops-project/select-devops.png)

Через несколько минут панель мониторинга DevOps Projects отобразится на портале Azure. Выберите имя проекта, чтобы просмотреть ход выполнения. Вам может потребоваться обновить страницу. Пример приложения IoT Edge настраивается в репозитории в организации Azure DevOps, после чего выполняется его сборка и оно развертывается на устройство IoT Edge. Эта панель мониторинга позволяет просматривать репозиторий кода, конвейер CI/CD и приложение в Azure.

   ![Просмотр приложения на портале DevOps](./media/how-to-devops-project/devops-portal.png)


## <a name="commit-code-changes-and-execute-cicd"></a>Фиксация изменений, внесенных в код, и выполнение CI/CD

DevOps Projects создает репозиторий Git для проекта в Azure Repos. В этом разделе вы просмотрите репозиторий и внесете изменения в код приложения.

1. Чтобы перейти в репозиторий, созданный для проекта, выберите **Репозитории** в меню панели мониторинга проекта.  

   ![Просмотр репозитория, созданного в Azure Repos](./media/how-to-devops-project/view-repositories.png)

2. Ниже приведены инструкции по внесению изменений в код с использованием веб-браузера. Если вы хотите клонировать репозиторий локально, выберите **Клонировать** в верхней правой части окна. Клонируйте репозиторий Git в Visual Studio Code или в другом предпочитаемом инструменте разработки, используя предоставленный URL-адрес. 

3. Репозиторий уже содержит код для модуля **SampleModule**, основанного на языке приложения, выбранного в процессе создания. Откройте файл **modules/SampleModule/module.json**.

   ![Открытие файла module.json в Azure Repos](./media/how-to-devops-project/open-module-json.png)

4. Выберите **Изменить** и внесите изменения в параметр `"version"` в разделе `"tag"`. Например,можно указать значение `"version": "${BUILD_BUILDID}"`, чтобы использовать [переменные сборки Azure DevOps](https://docs.microsoft.com/azure/devops/pipelines/build/variables?view=vsts#build-variables) как часть тега образа модуля Azure IoT Edge.

   ![Изменение версии для принятия переменных сборки](media/how-to-devops-project/update-module-json.png)

5. Выберите **Зафиксировать** и сохраните изменения.

6. В браузере вернитесь на панель мониторинга DevOps Projects на портале Azure. Теперь вы должны увидеть, что сборка выполняется. С помощью конвейера CI/CD выполняется автоматическая сборка и развертывание внесенных изменений.

    ![Просмотр состояния выполнения](media/how-to-devops-project/ci-cd-in-progress.png)

## <a name="examine-the-cicd-pipeline"></a>Изучение конвейера CI/CD

В предыдущих разделах в Azure DevOps Projects был автоматически настроен полный конвейер CI/CD для приложения IoT Edge. Затем вы проверили конвейер сборки, зафиксировав изменения в одном из файлов. Теперь изучите и настройте конвейер нужным образом. Выполните следующие действия, чтобы ознакомиться с конвейерами сборки и выпуска Azure DevOps.

1. Чтобы просмотреть конвейеры сборки в проекте DevOps, выберите **Конвейеры сборки** в меню на панели мониторинга проекта. По ссылке откроется вкладка браузера, содержащая сведения о конвейере сборки Azure DevOps для нового проекта.

   ![Просмотр конвейеров сборки в Azure Pipelines](./media/how-to-devops-project/view-build-pipelines.png)

2. Выберите **Изменить**

    ![Изменение конвейера сборки](media/how-to-devops-project/click-edit-button.png)

3. На открывшейся панели можно просмотреть задачи, возникающие во время выполнения конвейера сборки. Конвейеры сборки выполняют различные задачи, такие как получение источников из репозитория Git, сборка образов модуля IoT Edge, отправка модулей IoT Edge в реестр контейнеров и публикация полученных файлов, используемых для развертывания. Дополнительные сведения о задачах Azure IoT Edge в Azure DevOps см. в статье [Непрерывная интеграция и непрерывное развертывание в Azure IoT Edge](how-to-ci-cd.md#configure-continuous-integration).

4. Выберите заголовок **Конвейер** в верхней части конвейера сборки, чтобы открыть сведения о конвейере. Замените имя конвейера сборки более описательным.

   ![Изменение сведений о конвейере](./media/how-to-devops-project/edit-build-pipeline.png)

5. Выберите **Сохранить и поместить в очередь**, а затем щелкните **Сохранить**.

6. В меню для своего конвейера сборки выберите **Триггеры**. DevOps Projects автоматически создает триггер CI, а каждая фиксация в репозитории запускает новую сборку.  При желании выберите включение или исключение ветвей из процесса непрерывной интеграции.

7. Щелкните **Период удержания**. В зависимости от сценария можно указать политики для хранения или удаления определенного количества сборок.

8. Выберите **Журнал**. Панель журнала содержит журнал аудита последних изменений сборки. Azure Pipelines отслеживает все изменения, внесенные в конвейер сборки, и позволяет сравнивать версии.

9. Завершив изучение конвейера сборки, перейдите к соответствующему конвейеру выпуска. Выберите **Выпуски** в разделе **Конвейеры**, а затем выберите **Изменить**, чтобы просмотреть сведения о конвейере.

    ![Просмотр конвейера выпуска](media/how-to-devops-project/release-pipeline.png)

10. В разделе **Артефакты** выберите **Удалить**. Источник, просматриваемый этим артефактом, представляет собой выходные данные конвейера сборки, который вы изучали на предыдущих этапах. 

11. Рядом со значком **Удалить** выберите элемент **Триггер непрерывного развертывания**, который выглядит как молния. В этом конвейере выпуска активирован триггер, выполняющий развертывание каждый раз, когда становится доступным новый артефакт сборки. При желании можно отключить триггер, чтобы выполнить развертывание вручную.  

12. В меню для конвейера выпуска выберите **Задачи**, а затем выберите этап **dev** в раскрывающемся списке. В DevOps Projects создается этап выпуска, который создает центр Интернета вещей, создает устройство IoT Edge в этом центре, развертывает пример модуля из конвейера сборки и подготавливает виртуальную машину для запуска в качестве устройства IoT Edge. Чтобы узнать больше о задачах Azure IoT Edge для непрерывного развертывания, ознакомьтесь с [этим разделом](how-to-ci-cd.md#configure-continuous-deployment).

   ![Просмотр задач непрерывного развертывания](media/how-to-devops-project/dev-release.png)

13. В области справа выберите **Просмотреть выпуски**. В этом представлении можно просмотреть журнал выпусков.

14. Выберите имя выпуска, чтобы просмотреть дополнительные сведения о нем.


## <a name="clean-up-resources"></a>Очистка ресурсов

Ненужную Службу приложений Azure и связанные ресурсы можно удалить. Для этого воспользуйтесь функцией **Удалить** на панели мониторинга DevOps Projects.

## <a name="next-steps"></a>Дополнительная информация
* Дополнительные сведения о задачах Azure IoT Edge в Azure DevOps см. в статье [Непрерывная интеграция и непрерывное развертывание в Azure IoT Edge](how-to-ci-cd.md).
* Основные сведения о развертывании IoT Edge см. в статье [Understand IoT Edge deployments for single devices or at scale](module-deployment-monitoring.md) (Основные сведения о развертываниях IoT Edge для отдельных устройств или в требуемом масштабе).
* Ознакомьтесь со статьей [Развертывание и мониторинг модулей IoT Edge в нужном масштабе (предварительная версия)](how-to-deploy-monitor.md), чтобы узнать, как создавать, обновлять или удалять развертывание.
