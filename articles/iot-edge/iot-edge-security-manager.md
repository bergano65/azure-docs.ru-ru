---
title: Защита устройств и ПО с помощью диспетчера безопасности Azure IoT Edge | Документация Майкрософт
description: Управляет состоянием безопасности устройства IoT Edge и целостностью служб безопасности.
services: iot-edge
keywords: безопасность, безопасный элемент, анклава, TEE, IoT Edge
author: eustacea
manager: philmea
ms.author: eustacea
ms.date: 08/30/2019
ms.topic: conceptual
ms.service: iot-edge
ms.openlocfilehash: 90cb7cf0a30ea0ebfe00454288de25ddf6e58d52
ms.sourcegitcommit: 12d902e78d6617f7e78c062bd9d47564b5ff2208
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/24/2019
ms.locfileid: "74457530"
---
# <a name="azure-iot-edge-security-manager"></a>Диспетчер безопасности Azure IoT Edge

Диспетчер безопасности Azure IoT Edge — это хорошо ограниченное ядро обеспечения ​​безопасности для защиты устройства IoT Edge и всех его компонентов путем абстрагирования защищенного кремниевого оборудования. Это Фокальная точка для усиления безопасности и обеспечивает интеграцию технологии с производителями оборудования (OEM).

![Диспетчер безопасности Azure IoT Edge](media/edge-security-manager/iot-edge-security-manager.png)

Диспетчер безопасности IoT Edge предназначен для защиты целостности устройства IoT Edge и всех встроенных программных операций. Диспетчер безопасности переходит в состояние доверия с базового аппаратного корня оборудования доверия (если доступно) для начальной загрузки среды выполнения IoT Edge и наблюдения за выполняемыми операциями.  По сути, диспетчер безопасности IoT Edge — это программное обеспечение, работающее вместе с безопасным оборудованием с микросхемами (где это доступно) и позволяющее обеспечить максимально возможные гарантии безопасности.  

В задачи диспетчера безопасности IoT Edge входят (это не исчерпывающий список):

* Безопасная и измеренная начальная загрузка устройства Azure IoT Edge.
* Подготовка удостоверения устройства и передача доверия, где это применимо.
* Размещение и защита компонентов облачных служб для устройства, например службы подготовки устройств.
* Безопасная подготовка модулей IoT Edge с уникальными идентификаторами.
* Хранение корня доверия оборудования с помощью нотариальных служб.
* Мониторинг целостности операций IoT Edge во время выполнения.

Диспетчер безопасности IoT Edge состоит из трех компонентов:

* управляющая программа безопасности IoT Edge;
* уровень абстракции платформы аппаратного модуля безопасности (HSM);
* необязательный, но очень рекомендуемый корень доверия кремниевого оборудования или HSM.

## <a name="the-iot-edge-security-daemon"></a>Управляющая программа безопасности IoT Edge

Управляющая программа IoT Edge безопасности отвечает за логические операции IoT Edge диспетчера безопасности. Он представляет значительную часть доверенной вычислительной базы IoT Edge устройства. 

### <a name="design-principles"></a>Принципы проектирования

Управляющая программа безопасности IoT Edge придерживается двух основных принципов: максимальное увеличение операционной целостности, минимизация раздувания и обновления.

#### <a name="maximize-operational-integrity"></a>Максимальное увеличение операционной целостности

Управляющая программа IoT Edge безопасности работает с наибольшей целостностью в пределах возможностей защиты любого корня доверенного оборудования. При правильной интеграции корень доверия оборудования проверяет и отслеживает управляющую программу безопасности в статическом состоянии и во время выполнения, чтобы противостоять незаконному изменению.

Физический доступ всегда является угрозой для устройств Интернета вещей. Корень доверия оборудования играет важную роль в защите целостности управляющей программы безопасности IoT Edge.  Корень оборудования доверительных отношений бывают двух видов:

* безопасные элементы для защиты конфиденциальной информации, такой как секреты и криптографические ключи;
* безопасные внутренние зоны для защиты секретов, например ключей, и уязвимых рабочих нагрузок, таких как выставление счетов и ценообразование.

Существует два вида сред выполнения для использования аппаратного корня доверия.

* Стандартная или широкая среда выполнения (РИ), использующая безопасные элементы для защиты конфиденциальной информации.
* Доверенная среда выполнения (TEE), которая основывается на использовании защищенной технологии анклава для защиты конфиденциальной информации и обеспечивает защиту при выполнении программного обеспечения.

Для устройств, использующих Secure енклавес в качестве аппаратного корня доверия, конфиденциальная логика внутри управляющей программы IoT Edge безопасности должна находиться внутри анклава.  Неконфиденциальные части управляющей программы безопасности могут находиться за пределами TEE.  В любом случае исходные производители (ОДМ) и изготовители оборудования (OEM) должны расширять доверие с АППАРАТного модуля безопасности, чтобы измерять и защищать целостность управляющей программы IoT Edgeной защиты при загрузке и во время выполнения.

#### <a name="minimize-bloat-and-churn"></a>Минимизация раздувания и обновления

Другой основной принцип управляющей программы безопасности IoT Edge заключается в минимизации обновлений.  Для высшего уровня доверия управляющая программа безопасности IoT Edge может тесно соединяться с корнем доверия оборудования устройства и работать как собственный код.  Часто эти типы реализации могут обновлять программное обеспечение управляющей программы через корень оборудования защищенных путей обновления доверия (в отличие от ОС, предоставляемых механизмами обновления), что может быть непростой задачей в некоторых сценариях.  Хотя для устройств IoT рекомендуется обновлять систему безопасности, чрезмерные требования к обновлениям или большие полезные данные обновления могут расширить область угроз различными способами.  К примерам относятся пропуски обновлений, чтобы увеличить операционную доступность, или корень доверия устройства, слишком ограниченный, чтобы обрабатывать объемные полезные данные обновления.  Таким образом, конструкция управляющей программы IoT Edgeной безопасности является краткой, чтобы свести к небольшому размеру и надежную вычислительную базу, а также сократить требования к обновлениям.

### <a name="architecture-of-iot-edge-security-daemon"></a>Архитектура управляющей программы безопасности IoT Edge

![Управляющая программа безопасности Azure IoT Edge](media/edge-security-manager/iot-edge-security-daemon.png)

Управляющая программа IoT Edge безопасности использует преимущества любого доступного аппаратного корня технологии доверия для усиления безопасности.  Это также позволяет выполнять операции разделения в мире между стандартной или многофункциональной средой выполнения (РИ) и доверенной средой выполнения (TEE), когда аппаратные технологии предлагают доверенные среды выполнения. Интерфейсы для конкретных ролей позволяют основным компонентам IoT Edge гарантировать целостность IoT Edge устройства и его операций.

#### <a name="cloud-interface"></a>Облачный интерфейс

Облачный интерфейс позволяет управляющей программе IoT Edgeного управления получать доступ к облачным службам, таким как дополнения к облаку, в безопасность устройств, например обновление системы безопасности.  Например, управляющая программа IoT Edge безопасности в настоящее время использует этот интерфейс для доступа к [службе подготовки устройств](https://docs.microsoft.com/azure/iot-dps/) центра Интернета вещей Azure для управления жизненным циклом удостоверений устройств.  

#### <a name="management-api"></a>API управления

Управляющая программа IoT Edge Security предоставляет API управления, который вызывается агентом IoT Edge при создании, запуске, остановке или удалении модуля IoT Edge. Управляющая программа сохраняет регистрацию для всех активных модулей. Эти регистрации сопоставляют идентификатор модуля с некоторыми его свойствами. Примерами этих свойств являются идентификатор процесса (pid), выполняющегося в контейнере, или хэш содержимого контейнера Docker.

Эти свойства используются API рабочей нагрузки (описан ниже) для проверки того, что вызывающий объект имеет право выполнять действие.

API управления — это привилегированный API, вызываемый только из агента IoT Edge.  Так как управляющая программа безопасности IoT Edge обеспечивает начальную загрузку и запускает агент IoT Edge, она может создать неявную регистрацию для агента IoT Edge после того, как подтвердит, что агент IoT Edge не был незаконно изменен. Тот же процесс аттестации, который использует API рабочей нагрузки, также ограничен доступом к API управления только агентом IoT Edge.

#### <a name="container-api"></a>API контейнера

API контейнера взаимодействует с системой контейнеров, используемой для управления модулями, например значок Кита или DOCKER.

#### <a name="workload-api"></a>API рабочей нагрузки

API рабочей нагрузки доступен для всех модулей. Он обеспечивает подтверждение подлинности в виде маркера с корнем HSM или сертификата X509, а также соответствующего пакета доверия с модулем. Пакет доверия содержит сертификаты ЦС для всех других серверов, которым должны доверять модули.

Управляющая программа IoT Edge безопасности использует процесс аттестации для защиты этого API. Когда модуль вызывает этот API, управляющая программа пытается найти регистрацию для удостоверения. В случае обнаружения она использует свойства регистрации для измерения модуля. Если результат процесса измерения соответствует регистрации, создается подтверждение удостоверения. Соответствующие сертификаты ЦС (пакет доверия) возвращаются в модуль.  Модуль использует этот сертификат для подключения к Центру Интернета вещей, другим модулям или запуска сервера. Когда срок действия подписанного маркера или сертификата приближается к истечению, ответственность за запрос нового сертификата отвечает модуль. 

### <a name="integration-and-maintenance"></a>Интеграция и обслуживание

Корпорация Майкрософт поддерживает основную базу кода для управляющей программы безопасности [IoT Edge на GitHub](https://github.com/Azure/iotedge/tree/master/edgelet).

#### <a name="installation-and-updates"></a>Установка и обновления

Установкой и обновлением управляющей программы безопасности IoT Edge управляет система управления пакетами операционной системы. Устройства IoT Edge с корнем доверия оборудования должны обеспечить дополнительное улучшение целостности управляющей программы, управляя жизненным циклом устройства с помощью систем управления загрузкой и обновлением. Производители устройств должны исследовать эти возможности на основе соответствующих возможностей устройства.

#### <a name="versioning"></a>Управление версиями

Среда выполнения IoT Edge отслеживает и сообщает версию управляющей программы безопасности IoT Edge. Версия сообщается как атрибут *среда выполнения.платформа.версия* передаваемого свойства модуля агента IoT Edge.

### <a name="hardware-security-module-platform-abstraction-layer-hsm-pal"></a>Уровень абстракции платформы аппаратного модуля безопасности (HSM)

Уровень абстракции платформы HSM абстрагирует все корни доверия оборудования, чтобы избавить разработчика или пользователя IoT Edge от сложностей.  Она включает в себя сочетание программного интерфейса (API) и процедур обмена данными между доменами, например обмен данными между стандартной средой выполнения и безопасным анклава.  Фактическая реализация уровня абстракции платформы HSM зависит от конкретного используемого защищенного оборудования. Его существование позволяет использовать практически любое безопасное оборудование с микросхемами.

## <a name="secure-silicon-root-of-trust-hardware"></a>Корень доверия надежного кремниевого оборудования

Надежное кремниевое оборудование необходимо для закрепления доверия внутри аппаратного устройства IoT Edge.  Существует большое количество надежного кремниевого оборудования, включая доверенный платформенный модуль (TPM), встроенные защищенные элементы (eSM), ARM Trustzone, Intel SGX, а также настраиваемые технологии надежного кремниевого оборудования.  Использование безопасного корневого корня доверия на устройствах рекомендуется при наличии угроз, связанных с физическим доступом устройств IoT.

## <a name="iot-edge-security-manager-integration-and-maintenance"></a>Интеграция и обслуживание диспетчера безопасности IoT Edge

Цель диспетчера безопасности IoT Edge — определить и изолировать компоненты, которые повышают безопасность и обеспечивают целостность платформы Azure IoT Edge. Третьи стороны, например изготовители, должны применять пользовательские функции безопасности, доступные для оборудования их устройств.  Изучите следующий раздел со ссылками, демонстрирующими усиление защиты диспетчера безопасности Интернета вещей Azure с помощью доверенного платформенного модуля (TPM) на платформах Linux и Windows. В этих примерах используется программное обеспечение или виртуальные модули TPM, но они непосредственно применяются к дискретным устройствам TPM.  

## <a name="next-steps"></a>Дополнительная информация

Просмотрите блог, посвященный [обеспечению безопасности интеллектуальной границы](https://azure.microsoft.com/blog/securing-the-intelligent-edge/).

Перейдите к созданию и подготовке устройства IoT Edge с помощью [виртуального доверенного платформенного модуля на виртуальной машине Linux](how-to-auto-provision-simulated-device-linux.md).

Перейдите к созданию и подготовке устройства IoT Edge с помощью [имитированного доверенного платформенного модуля в Windows](how-to-auto-provision-simulated-device-windows.md).
