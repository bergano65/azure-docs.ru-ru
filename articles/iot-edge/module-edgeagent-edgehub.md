---
title: Свойства агента и модуля концентратора двойников-Azure IoT Edge
description: Обзор определенных свойств и их значений для двойников модулей EdgeAgent и EdgeHub
author: kgremban
manager: philmea
ms.author: kgremban
ms.date: 08/31/2020
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: fa7a56bcad067176d8f9805b418cca45ad144579
ms.sourcegitcommit: d103a93e7ef2dde1298f04e307920378a87e982a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2020
ms.locfileid: "91978702"
---
# <a name="properties-of-the-iot-edge-agent-and-iot-edge-hub-module-twins"></a>Свойства двойников модулей агента IoT Edge и центра IoT Edge

Агент IoT Edge и центр IoT Edge — это два модуля, которые составляют среду выполнения IoT Edge. Дополнительные сведения о обязанности каждого модуля среды выполнения см. в разделе [понимание среды выполнения Azure IOT EDGE и ее архитектуры](iot-edge-runtime.md).

В этой статье представлены требуемые и отображаемые в отчете свойства двойников модулей для среды выполнения. Дополнительные сведения о развертывании модулей на IoT Edge устройствах см. [в статье Развертывание модулей и установка маршрутов в IOT Edge](module-composition.md).

Двойника модуля включает:

* **Требуемые свойства**. Серверная часть решения может задавать требуемые свойства, и модуль может их читать. Модуль также может получать уведомления об изменениях в нужных свойствах. Требуемые свойства используются совместно с сообщаемыми свойствами для синхронизации конфигурации или условий модуля.

* **Сообщаемые свойства**. Модуль может задавать сообщаемые свойства, а Серверная часть решения может считывать и запрашивать их. Сообщаемые свойства используются вместе с требуемыми свойствами для синхронизации конфигурации или условий модуля.

## <a name="edgeagent-desired-properties"></a>Требуемые свойства EdgeAgent

Двойник модуля для агента IoT Edge называется `$edgeAgent`. Он координирует взаимодействие между агентом IoT Edge, выполняющимся на устройстве, и Центром Интернета вещей. Требуемые свойства задаются при применении манифеста развертывания на конкретном устройстве в ходе развертывания на одно устройство или несколько.

| Свойство | Описание | Обязательно |
| -------- | ----------- | -------- |
| schemaVersion | Значение "1,0" или "1,1". Версия 1,1 была введена в IoT Edge версии 1.0.10, и рекомендуется. | Да |
| runtime.type | Должно быть "docker". | Да |
| runtime.settings.minDockerVersion | Задайте минимальную версию Docker, которая требуется для этого манифеста развертывания. | Да |
| runtime.settings.loggingOptions | Переведенные в строку JSON, содержащую параметры ведения журнала для контейнера агента IoT Edge. [Параметры ведения журнала Docker](https://docs.docker.com/engine/admin/logging/overview/) | нет |
| runtime.settings.registryCredentials<br>.{registryId}.username | Имя пользователя для реестра контейнеров. Для Реестра контейнеров Azure именем пользователя обычно является имя реестра.<br><br> Учетные данные реестра необходимы для любых частных образов модулей. | нет |
| runtime.settings.registryCredentials<br>.{registryId}.password | Пароль для реестра контейнеров. | нет |
| runtime.settings.registryCredentials<br>.{registryId}.address | Адрес для реестра контейнеров. Для Реестра контейнеров Azure адрес обычно имеет вид *{имя реестра}.azurecr.io*. | нет |  
| systemModules.edgeAgent.type | Должно быть "docker". | Да |
| systemModules.edgeAgent.settings.image | Универсальный код ресурса (URI) образа агента IoT Edge. В настоящее время агент IoT Edge не может обновить себя. | Да |
| systemModules.edgeAgent.settings<br>.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера агента IoT Edge. [Параметры создания Docker](https://docs.docker.com/engine/api/v1.32/#operation/ContainerCreate) | нет |
| systemModules.edgeAgent.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Центр Интернета вещей задает свойство при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |
| systemModules.edgeHub.type | Должно быть "docker". | Да |
| systemModules.edgeHub.status | Должно быть "running". | Да |
| systemModules.edgeHub.restartPolicy | Должно быть "always". | Да |
| Системмодулес. edgeHub. Стартупордер | Целочисленное значение, для которого модуль находится в порядке запуска. 0 — первое и максимальное целое число (4294967295). Если значение не указано, по умолчанию используется максимальное целое число.  | нет |
| systemModules.edgeHub.settings.image | Универсальный код ресурса (URI) образа центра IoT Edge. | Да |
| systemModules.edgeHub.settings<br>.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера центра IoT Edge. [Параметры создания Docker](https://docs.docker.com/engine/api/v1.32/#operation/ContainerCreate) | нет |
| systemModules.edgeHub.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Центр Интернета вещей задает свойство при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |
| modules.{ИД_модуля}.version | Определяемая пользователем строка, представляющая версию этого модуля. | Да |
| modules.{ИД_модуля}.type | Должно быть "docker". | Да |
| modules.{Ид_модуля}.status | {"running" \| "stopped"} | Да |
| modules.{ИД_модуля}.restartPolicy | {"никогда" \| "on-Failure" \| — неработоспособное состояние " \| всегда" | Да |
| модуле. {moduleId}. Стартупордер | Целочисленное значение, для которого модуль находится в порядке запуска. 0 — первое и максимальное целое число (4294967295). Если значение не указано, по умолчанию используется максимальное целое число.  | нет |
| модуле. {moduleId}. Имажепуллполици | {"on-Create" \| "Never"} | нет |
| модуле. {moduleId}. env | Список переменных среды для передачи в модуль. Принимает формат `"<name>": {"value": "<value>"}` | нет |
| modules.{ИД_модуля}.settings.image | Универсальный код ресурса (URI) для образа модуля. | Да |
| modules.{ИД_модуля}.settings.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера модуля. [Параметры создания Docker](https://docs.docker.com/engine/api/v1.32/#operation/ContainerCreate) | нет |
| modules.{ИД_модуля}.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Центр Интернета вещей задает свойство при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |

## <a name="edgeagent-reported-properties"></a>Отображаемые в отчете свойства EdgeAgent

Сообщаемые свойства агента IoT Edge включают в себя три основных элемента информации:

1. состояние применения последних требуемых свойств;
2. состояние модулей, запущенных на устройстве, зарегистрированное агентом IoT Edge;
3. копия требуемых свойств, выполняемых в данное время на устройстве.

Копия текущих требуемых свойств полезна для того, чтобы определить, применено ли устройство к последнему развертыванию или по-прежнему выполняется предыдущий манифест развертывания.

> [!NOTE]
> Сообщаемые свойства агента IoT Edge полезны, так как к ним можно выполнять запросы с помощью [языка запросов Центра Интернета вещей](../iot-hub/iot-hub-devguide-query-language.md), чтобы узнать состояние развертывания в масштабе. Дополнительные сведения об использовании свойств агента IoT Edge, чтобы узнать состояние развертывания, см. в статье [Общие сведения об автоматических развертываниях IoT Edge для отдельных устройств или в требуемом масштабе](module-deployment-monitoring.md).

Следующая таблица не включает сведения, которые копируются из требуемых свойств.

| Свойство | Описание |
| -------- | ----------- |
| lastDesiredVersion | Это целое число относится к последней версии требуемых свойств, обрабатываемых агентом IoT Edge. |
| lastDesiredStatus.code | Этот код состояния ссылается на последние требуемые свойства, наблюдаемые агентом IoT Edge. Допустимые значения: `200` — успех, `400` — недопустимая конфигурация,`412` — недопустимая версия схемы, `417` — нужные свойства пусты, `500` — сбой. |
| lastDesiredStatus.description | Текстовое описание состояния. |
| deviceHealth | Имеет значение `healthy`, если состояние среды выполнения всех модулей имеет значение `running` или `stopped`, в противном случае — `unhealthy`. |
| configurationHealth.{ИД_развертывания}.health | Имеет значение `healthy`, если состояние среды выполнения всех модулей, установленное развертыванием {ИД_развертывания}, имеет значение `running` или `stopped`, в противном случае — `unhealthy`. |
| runtime.platform.OS | Сообщает ОС, выполняющуюся на устройстве. |
| runtime.platform.architecture | Сообщает архитектуру ЦП на устройстве. |
| systemModules.edgeAgent.runtimeStatus | Состояние агента IoT Edge: {"running" \| "unhealthy"} |
| systemModules.edgeAgent.statusDescription | Текстовое описание сообщаемого состояния агента IoT Edge. |
| systemModules.edgeHub.runtimeStatus | Состояние центра IoT Edge: { "running" \| "stopped" \| "failed" \| "backoff" \| "unhealthy" } |
| systemModules.edgeHub.statusDescription | Текстовое описание состояния центра IoT Edge, если он неработоспособен. |
| systemModules.edgeHub.exitCode | Код выхода, сообщаемый контейнером концентратора IoT Edge, если контейнер завершает работу |
| systemModules.edgeHub.startTimeUtc | Время последнего запуска центра IoT Edge. |
| systemModules.edgeHub.lastExitTimeUtc | Время последнего выхода центра IoT Edge. |
| systemModules.edgeHub.lastRestartTimeUtc | Время последнего перезапуска центра IoT Edge. |
| systemModules.edgeHub.restartCount | Количество раз, когда этот модуль был перезагружен в рамках политики перезапуска. |
| modules.{ИД_модуля}.runtimeStatus | Состояние модуля: { "running" \| "stopped" \| "failed" \| "backoff" \| "unhealthy" } |
| modules.{ИД_модуля}.statusDescription | Текстовое описание состояния модуля, если он неработоспособен. |
| modules.{ИД_модуля}.exitCode | Код выхода, сообщаемый контейнером модуля при выходе из контейнера |
| modules.{ИД_модуля}.startTimeUtc | Время последнего запуска модуля. |
| modules.{ИД_модуля}.lastExitTimeUtc | Время последнего завершения работы модуля. |
| modules.{ИД_модуля}.lastRestartTimeUtc | Время последнего перезапуска модуля. |
| modules.{ИД_модуля}.restartCount | Количество раз, когда этот модуль был перезагружен в рамках политики перезапуска. |

## <a name="edgehub-desired-properties"></a>Требуемые свойства EdgeHub

Двойник модуля центра IoT Edge называется `$edgeHub`. Он координирует взаимодействие между центром IoT Edge, выполняющимся на устройстве, и Центром Интернета вещей. Требуемые свойства задаются при применении манифеста развертывания на конкретном устройстве в ходе развертывания на одно устройство или несколько.

| Свойство | Описание | Требуется в манифесте развертывания |
| -------- | ----------- | -------- |
| schemaVersion | Значение "1,0" или "1,1". Версия 1,1 была введена в IoT Edge версии 1.0.10, и рекомендуется. | Да |
| routes.{имя_маршрута} | Строка, представляющая маршрут центра IoT Edge. Дополнительные сведения см. в разделе [объявление маршрутов](module-composition.md#declare-routes). | Элемент `routes` может присутствовать, но быть пустым. |
| storeAndForwardConfiguration.timeToLiveSecs | Время в секундах, в течение которого центр IoT Edge хранит сообщения при отключении от конечных точек маршрутизации, будь то центр Интернета вещей или локальный модуль. Значением может быть любое положительное целое число. | Да |

## <a name="edgehub-reported-properties"></a>Отображаемые в отчете свойства EdgeHub

| Свойство | Описание |
| -------- | ----------- |
| lastDesiredVersion | Это целое число относится к последней версии требуемых свойств, обрабатываемых центром IoT Edge. |
| lastDesiredStatus.code | Код состояния, ссылающийся на последние требуемые свойства, отображаемые центром IoT Edge. Допустимые значения: `200` — успех, `400` — недопустимая конфигурация, `500` — сбой. |
| lastDesiredStatus.description | Текстовое описание состояния. |
| clients.{идентификатор устройства или модуля}.status | Состояние подключения этого устройства или модуля. Возможные значения {"connected" \| "disconnected"}. В отключенном состоянии могут находиться только удостоверения модуля. Подчиненные устройства, подключающиеся к центру IoT Edge, отображаются только при подключении. |
| clients.{идентификатор устройства или модуля}.lastConnectTime | Время последнего подключения устройства или модуля. |
| clients.{идентификатор устройства или модуля}.lastDisconnectTime | Время последнего отключения устройства или модуля. |

## <a name="next-steps"></a>Дальнейшие действия

Сведения о том, как использовать эти свойства для создания манифестов развертывания, см. в статье [Сведения об использовании, настройке и повторном использовании модулей Azure IoT Edge (предварительная версия)](module-composition.md).
