---
title: Учебник по выполнению отработки аварийного восстановления виртуальной машины Azure с помощью Azure Site Recovery
description: В этом учебнике описано, как выполнить отработку аварийного восстановления виртуальной машины Azure в другой регион с помощью Site Recovery.
services: site-recovery
ms.topic: tutorial
ms.date: 11/05/2020
ms.custom: mvc
ms.openlocfilehash: c7cd1898f27f3b7255009efb40f6bcc8938dbf9e
ms.sourcegitcommit: 0ce1ccdb34ad60321a647c691b0cff3b9d7a39c8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/05/2020
ms.locfileid: "93395656"
---
# <a name="tutorial-run-a-disaster-recovery-drill-for-azure-vms"></a>Руководство по выполнению отработки аварийного восстановления для виртуальной машины Azure

Сведения о запуске отработки аварийного восстановления в другом регионе для репликации виртуальных машин Azure с помощью [Azure Site Recovery](site-recovery-overview.md). Работая с этой статьей, вы выполните следующие задачи:

> [!div class="checklist"]
> * Проверка необходимых условий
> * Проверка параметров виртуальной машины перед выполнением отработки.
> * Запуск тестовой отработки отказа
> * Очистка после выполнения отработки.


> [!NOTE]
> В этом учебнике представлен минимальный набор шагов для выполнения отработки аварийного восстановления. Если вы хотите выполнить отработку с полным тестированием инфраструктуры, см. статьи о [сети](azure-to-azure-about-networking.md), [автоматизации](azure-to-azure-powershell.md) и [об устранении неполадок](azure-to-azure-troubleshoot-errors.md) виртуальной машины Azure.

## <a name="prerequisites"></a>Обязательные условия

Перед началом работы с этим учебником необходимо включить аварийное восстановление для одной или нескольких виртуальных машин Azure. Для этого [завершите работу с первым учебником](azure-to-azure-tutorial-enable-replication.md) из этой серии.

## <a name="verify-vm-settings"></a>Проверка параметров виртуальной машины

1. В хранилище выберите **Реплицированные элементы** и выберите виртуальную машину.

    ![Параметр открытия страницы аварийного восстановления в разделе свойств виртуальной машины](./media/azure-to-azure-tutorial-dr-drill/vm-settings.png)

2. На странице **Обзор** проверьте защиту и работоспособность виртуальной машины.
3. При выполнении тестовой отработки отказа необходимо выбрать виртуальную сеть Azure в целевом регионе. В этой сети размещается виртуальная машина Azure, созданная после отработки отказа. 

    - При работе с этим учебником необходимо выбрать имеющуюся сеть во время выполнения тестовой отработки отказа.
    - Мы рекомендуем выбрать непроизводственную сеть для отработки, чтобы IP-адреса и сетевые компоненты оставались доступными в рабочих сетях.
   - Вы также можете предварительно настроить параметры сети, которые будут использоваться для тестовой отработки отказа. Детализированные параметры, которые можно назначить для каждой сетевой карты, включают в себя подсеть, частный IP-адрес, общедоступный IP-адрес, подсистему балансировки нагрузки и группу безопасности сети. Мы не будем использовать этот метод, но вы можете ознакомиться с [этой статьей](azure-to-azure-customize-networking.md#customize-failover-and-test-failover-networking-configurations) для получения дополнительных сведений.


## <a name="run-a-test-failover"></a>Запуск тестовой отработки отказа


1. На странице **Обзор** выберите **Тестовая отработка отказа**.

    
    ![Кнопка "Тестовая отработка отказа" для реплицированного элемента](./media/azure-to-azure-tutorial-dr-drill/test-failover-button.png)

2. В разделе **Тестовая отработка отказа** выберите точку восстановления. Виртуальная машина Azure в целевом регионе создается с использованием данных из этой точки восстановления.
  
   - **Последняя обработанная**. Используется последняя точка восстановления, обработанная Site Recovery. Для нее отображается метка времени. Этот вариант не требует времени на обработку данных, обеспечивая низкий показатель целевого времени восстановления (RTO).
   -  **Latest**: обрабатываются все данные, отправленные в службу Site Recovery, чтобы создать точку восстановления для каждой виртуальной машины, прежде чем выполнять в нее отработку отказа. Этот вариант обеспечивает самое низкое значение целевой точки восстановления (RPO), так как все данные реплицированы в службу Site Recovery до момента активации отработки отказа.
   - **Последняя с согласованием приложений**. Отработка отказа виртуальных машин выполняется до последней точки восстановления с согласованным состоянием приложений. Для нее отображается метка времени.
   - **Пользовательский**. Отработка отказа выполняется до определенной точки восстановления. Пользовательский параметр доступен только при отработке отказа на одной виртуальной машине без использования плана восстановления.

3. В **виртуальной сети Azure** выберите целевую сеть, в которой следует разместить виртуальные машины Azure, созданные после отработки отказа. Если возможно, вместо сети, созданной при включении репликации, выберите непроизводственную сеть.

    ![Страница параметров тестовой отработки отказа](./media/azure-to-azure-tutorial-dr-drill/test-failover-settings.png)    

4. Нажмите кнопку **ОК**, чтобы начать отработку отказа.
5. Отслеживайте тестовую отработку отказа в разделе уведомлений.

    ![Уведомление о ходе выполнения](./media/azure-to-azure-tutorial-dr-drill/notification-start-test-failover.png) ![Уведомления об успешном выполнении](./media/azure-to-azure-tutorial-dr-drill/notification-finish-test-failover.png)     


5. После завершения отработки отказа виртуальная машина Azure, созданная в целевом регионе, появится на портале Azure в разделе **Виртуальные машины**. Убедитесь, что виртуальная машина запущена, имеет соответствующий размер и подключена к выбранной сети.

## <a name="clean-up-resources"></a>Очистка ресурсов

1. На странице **Основные компоненты** выберите **Очистить тестовую отработку отказа**.

    ![Кнопка для запуска процесса очистки](./media/azure-to-azure-tutorial-dr-drill/select-cleanup.png)

2. При необходимости в разделе **Очистка тестовой отработки отказа** > **Примечания** можно записать и сохранить ваши наблюдения касательно тестовой отработки отказа. 
3. Чтобы удалить виртуальные машины, созданные во время тестовой отработки отказа, выберите **Testing is complete** (Тестирование завершено).

    ![Страница с параметрами очистки](./media/azure-to-azure-tutorial-dr-drill/cleanup-failover.png)

4. Ход выполнения можно отслеживать в разделе уведомлений.

    ![Уведомление о ходе выполнения очистки](./media/azure-to-azure-tutorial-dr-drill/notification-start-cleanup.png) ![Уведомление об успешном завершении очистки](./media/azure-to-azure-tutorial-dr-drill/notification-finish-cleanup.png)

## <a name="next-steps"></a>Дальнейшие действия

При работе с этим учебником вы выполнили аварийное восстановление, чтобы убедиться, что отработка отказа работает правильно. Теперь вы можете выполнить полную отработку отказа.

> [!div class="nextstepaction"]
> [Запуск отработки отказа в рабочей среде](azure-to-azure-tutorial-failover-failback.md)
