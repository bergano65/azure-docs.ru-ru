---
title: Управление правилами брандмауэра. портал Azure — гибкий сервер в базе данных Azure для PostgreSQL
description: Создание правил брандмауэра для базы данных Azure для PostgreSQL-гибкого сервера и управление ими с помощью портал Azure
author: ambhatna
ms.author: ambhatna
ms.service: postgresql
ms.topic: how-to
ms.date: 09/22/2020
ms.openlocfilehash: 8c107b88f964d8e657d6833fc3a2e8425d9053ce
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90936923"
---
# <a name="create-and-manage-firewall-rules-for-azure-database-for-postgresql---flexible-server-using-the-azure-portal"></a>Создание правил брандмауэра для базы данных Azure для PostgreSQL-гибкого сервера и управление ими с помощью портал Azure

> [!IMPORTANT]
> База данных Azure для PostgreSQL — гибкий сервер в настоящее время находится в общедоступной предварительной версии.

База данных Azure для PostgreSQL — гибкий сервер поддерживает два типа взаимоисключающих методов сетевого подключения для подключения к гибкому серверу. Эти два варианта указаны ниже:

* Открытый доступ (разрешенные IP-адреса)
* Закрытый доступ (интеграция виртуальной сети)

В этой статье мы рассмотрим создание сервера PostgreSQL с **общим доступом (разрешенные IP-адреса)** с помощью портал Azure и предоставит общие сведения об управлении правилами брандмауэра после создания гибкого сервера. При наличии *общего доступа (разрешенных IP-адресов)* подключения к серверу PostgreSQL ограничиваются только РАЗРЕШЕННЫМИ IP-адресами. IP-адреса клиентов должны быть разрешены в правилах брандмауэра. Дополнительные сведения см. в разделе [общий доступ (разрешенные IP-адреса)](./concepts-networking.md#public-access-allowed-ip-addresses). Правила брандмауэра могут быть определены во время создания сервера (рекомендуется), но их также можно добавить позже. В этой статье мы рассмотрим, как создавать правила брандмауэра и управлять ими с помощью общего доступа (разрешенные IP-адреса).

## <a name="create-a-firewall-rule-when-creating-a-server"></a>Создание правила брандмауэра при создании сервера

1. Выберите **Создать ресурс** (+) в левом верхнем углу страницы портала.
2. Выберите **Базы данных** > **База данных Azure для PostgreSQL**. Можно также ввести **PostgreSQL** в поле поиска, чтобы найти службу.
3. Выберите вариант развертывания **Гибкий сервер**.
4. Заполните форму " **основные** ".
5. Перейдите на вкладку " **сети** ", чтобы настроить способ подключения к серверу.
6. В поле **способ подключения**выберите *общий доступ (разрешенные IP-адреса)*. Чтобы создать **правила брандмауэра**, укажите имя правила брандмауэра и один IP-адрес или диапазон адресов. Если вы хотите ограничить правило одним IP-адресом, введите тот же адрес в поле Начальный IP-адрес и конечный IP-адрес. Открытие брандмауэра позволяет администраторам, пользователям и приложениям получать доступ к любой базе данных на сервере PostgreSQL, к которой у них есть действительные учетные данные.
   > [!Note]
   > База данных Azure для PostgreSQL — гибкий сервер создает брандмауэр на уровне сервера. Он не позволяет внешним приложениям и инструментам подключаться к серверу и к любой базе данных на сервере, если не создано правило, открывающее брандмауэр для определенных IP-адресов.
7. Щелкните элемент **Проверка и создание**, чтобы проверить конфигурацию гибкого сервера.
8.  Щелкните **Создать**, чтобы подготовить сервер. Подготовка может занять несколько минут.

## <a name="create-a-firewall-rule-after-server-is-created"></a>Создание правила брандмауэра после создания сервера

1. На [портал Azure](https://portal.azure.com/)выберите сервер базы данных Azure для PostgreSQL-гибкого сервера, на котором необходимо добавить правила брандмауэра.
2. На странице гибкого сервера в разделе **Параметры** заголовка щелкните **сеть** , чтобы открыть страницу сеть для гибкого сервера.

   <!--![Azure portal - click Connection Security](./media/howto-manage-firewall-portal/1-connection-security.png)-->

3. Щелкните **Добавить IP-адрес текущего клиента** в правилах брандмауэра. Автоматически будет создано правило брандмауэра с общедоступным IP-адресом компьютера, определенным системой Azure.

   <!--![Azure portal - click Add My IP](./media/howto-manage-firewall-portal/2-add-my-ip.png)-->

4. Проверьте IP-адрес перед сохранением конфигурации. В некоторых случаях IP-адрес, определенный порталом Azure, может отличаться от IP-адреса, используемого для доступа к Интернету и серверам Azure. Поэтому может потребоваться изменить начальный IP-адрес и конечный IP-адрес, чтобы функция правила была ожидаемой.

   Для проверки IP-адреса можно использовать поисковую подсистему или другое средство в Интернете. Например, выполните поиск текста "какой у меня IP-адрес".

   <!--![Bing search for What is my IP](./media/howto-manage-firewall-portal/3-what-is-my-ip.png)-->

5. Добавьте дополнительные адресные пространства. В правилах брандмауэра для базы данных Azure для PostgreSQL-гибкого сервера можно указать один IP-адрес или диапазон адресов. Если вы хотите ограничить правило одним IP-адресом, введите тот же адрес в поле Начальный IP-адрес и конечный IP-адрес. Открытие брандмауэра позволяет администраторам, пользователям и приложениям получать доступ к любой базе данных на сервере PostgreSQL, к которой у них есть действительные учетные данные.

   <!--![Azure portal - firewall rules](./media/howto-manage-firewall-portal/4-specify-addresses.png)-->

6. Нажмите кнопку **сохранить** на панели инструментов, чтобы сохранить это правило брандмауэра. Дождитесь подтверждения успешного обновления правил брандмауэра.

   <!--![Azure portal - click Save](./media/howto-manage-firewall-portal/5-save-firewall-rule.png)-->

## <a name="connecting-from-azure"></a>Подключение из Azure

Вы можете включить ресурсы или приложения, развернутые в Azure, для подключения к гибкому серверу. Сюда входят веб-приложения, размещенные в службе приложений Azure, работающие на виртуальной машине Azure, шлюз управления данными фабрики данных Azure и многие другие. 

Когда приложение в Azure пытается подключиться к серверу, брандмауэр проверяет, разрешены ли подключения Azure. Чтобы включить этот параметр, выберите параметр **Разрешить общий доступ из служб Azure и ресурсов в Azure к этому серверу** на портале на вкладке **Сетевые подключения** и нажмите кнопку **сохранить**.

Ресурсы не обязательно должны находиться в одной виртуальной сети (VNet) или группе ресурсов для правила брандмауэра, чтобы включить эти подключения. Если попытка подключения не разрешена, запрос не достигает базы данных Azure для PostgreSQL-гибкого сервера.

> [!IMPORTANT]
> Этот параметр позволяет настроить брандмауэр так, чтобы разрешить все подключения из Azure, включая подключения из подписок других клиентов. При выборе этого параметра убедитесь, что используемое имя для входа и разрешения пользователя предоставляют доступ только авторизованным пользователям.
>
> Для безопасного доступа к гибкому серверу рекомендуется выбрать **частный доступ (интеграция с виртуальной сетью)** .
>
## <a name="manage-existing-firewall-rules-through-the-azure-portal"></a>Управление существующими правилами брандмауэра с помощью портал Azure

Чтобы управлять правилами брандмауэра, повторите следующие шаги.

- Чтобы добавить текущий компьютер, щелкните + **Добавить текущий IP-адрес клиента** в правилах брандмауэра. Щелкните **Сохранить** , чтобы сохранить изменения.
- Чтобы добавить дополнительные IP-адреса, введите имя правила, начальный IP-адрес и конечный IP-адрес. Щелкните **Сохранить** , чтобы сохранить изменения.
- Чтобы изменить существующее правило, измените значения во всех полях в данном правиле. Щелкните **Сохранить** , чтобы сохранить изменения.
- Чтобы удалить имеющееся правило, щелкните многоточие [...], а затем щелкните **Удалить**. Щелкните **Сохранить** , чтобы сохранить изменения.

## <a name="next-steps"></a>Дальнейшие действия
- Дополнительные сведения о работе [в сети в базе данных Azure для PostgreSQL-гибкого сервера](./concepts-networking.md)
- Дополнительные сведения о [базе данных Azure для PostgreSQL. правила брандмауэра для гибких серверов](./concepts-networking.md#public-access-allowed-ip-addresses)
- [Создание правил брандмауэра базы данных Azure для PostgreSQL и управление ими с помощью Azure CLI](./how-to-manage-firewall-cli.md).