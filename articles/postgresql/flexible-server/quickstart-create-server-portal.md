---
title: Краткое руководство. Создание гибкого сервера Базы данных Azure для PostgreSQL с помощью портала Azure
description: Краткое руководство по созданию гибкого сервера Базы данных Azure для PostgreSQL и управлению им с помощью пользовательского интерфейса портала Azure.
author: lfittl-msft
ms.author: lufittl
ms.service: postgresql
ms.custom: mvc
ms.topic: quickstart
ms.date: 09/22/2020
ms.openlocfilehash: 25c3f875717c9c064af0ce27bdab735db67d2f5d
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90945137"
---
# <a name="quickstart-create-an-azure-database-for-postgresql---flexible-server-in-the-azure-portal"></a>Краткое руководство. Создание гибкого сервера Базы данных Azure для PostgreSQL с помощью портала Azure

> [!IMPORTANT]
> Гибкий сервер Базы данных Azure для PostgreSQL предоставляется в режиме предварительной версии

База данных Azure для PostgreSQL — это управляемая служба, с помощью которой можно запускать и масштабировать базы данных PostgreSQL высокой доступности, а также управлять ими в облаке. Из этого краткого руководства вы узнаете, как за 5 минут создать гибкий сервер Базы данных Azure для PostgreSQL с помощью портала Azure.

Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/) Azure, прежде чем начинать работу.

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Откройте веб-браузер и перейдите на [портал](https://portal.azure.com/). Введите свои учетные данные для входа на портал. Панель мониторинга службы является представлением по умолчанию.

## <a name="create-an-azure-database-for-postgresql-server"></a>Создание сервера Базы данных Azure для PostgreSQL

Сервер службы "База данных Azure для PostgreSQL" создается с настроенным набором [вычислительных ресурсов и ресурсов хранения](./concepts-compute-storage.md). Он создается в [группе ресурсов Azure](https://docs.microsoft.com/azure/azure-resource-manager/management/overview).

Чтобы создать базу данных Azure для сервера PostgreSQL, выполните такие действия:

1. Выберите **Создать ресурс** (+) в левом верхнем углу страницы портала.

2. Выберите **Базы данных** > **База данных Azure для PostgreSQL**.

    :::image type="content" source="./media/quickstart-create-database-portal/1-create-database.png" alt-text="База данных Azure для PostgreSQL в меню":::

3. Выберите вариант развертывания **Гибкий сервер**.

   :::image type="content" source="./media/quickstart-create-database-portal/2-select-deployment-option.png" alt-text="Выбор варианта развертывания "Гибкий сервер Базы данных Azure для PostgreSQL"":::

4. Заполните форму **Основные данные** , указав следующую информацию:

    :::image type="content" source="./media/quickstart-create-database-portal/3-create-basics.png" alt-text="Создание сервера":::

    Параметр|Рекомендуемое значение|Описание
    ---|---|---
    Подписка|Имя вашей подписки|Подписка Azure, которую вы хотите использовать для сервера. Если у вас есть несколько подписок, выберите ту, через которую вы предпочитаете оплачивать этот ресурс.
    Группа ресурсов|*myresourcegroup*| Новое имя группы ресурсов или уже имеющееся из подписки.
    Имя сервера |*mydemoserver*|Уникальное имя, идентифицирующее базу данных Azure для сервера PostgreSQL. Имя домена *postgres.database.azure.com* добавляется к указанному имени сервера. Сервер может содержать только строчные буквы, цифры и знак дефиса (-). Его длина должна составлять от 3 до 63 символов.
    Имя администратора |*myadmin*| Собственная учетная запись входа, используемая при подключении к серверу. Не используйте для имени учетной записи администратора такие варианты: **azure_superuser**, **azure_pg_admin**, **admin**, **administrator**, **root**, **guest** или **public**. Оно не может начинаться с **pg_** .
    Пароль |Ваш пароль| Новый пароль для учетной записи администратора сервера. Пароль должен содержать от 8 до 128 символов. Пароль должен содержать символы из таких трех категорий: прописные латинские буквы, строчные латинские буквы, цифры (0–9) и небуквенно-цифровые символы (!, $, #, % и т. д.).
    Расположение|Ближайший к пользователям регион| Ближайшее к пользователям расположение.
    Версия|Последний основной номер версии| Последний основной номер версии PostgreSQL, если нет особых требований.
    Вычисления и хранилище | **Общего назначения**, **4 виртуальных ядра**, **512 ГБ**, **7 дней** | Конфигурации вычислительных ресурсов, хранилища и резервного копирования для нового сервера. Щелкните **Настройка сервера**. *Общего назначения*, *4 виртуальных ядра*, *512 ГБ* и *7 дней* — это значения по умолчанию для параметров **Уровень вычислений**, **Виртуальное ядро**, **Хранилище** и **Срок хранения резервных копий**. Вы можете оставить эти ползунки как есть или же настроить их. Щелкните **ОК**, чтобы сохранить ценовую категорию. На следующем снимке экрана показаны выбранные параметры.

    :::image type="content" source="./media/quickstart-create-database-portal/4-pricing-tier.png" alt-text="Область "Ценовая категория"":::
    
5. Настройка параметров сети

    На вкладке "Сеть" можно выбрать способ доступа к серверу. База данных Azure для PostgreSQL создает брандмауэр на уровне сервера. Он не позволяет внешним приложениям и инструментам подключаться к серверу и к любой базе данных на сервере, если не создано правило, открывающее брандмауэр для определенных IP-адресов. Мы рекомендуем сделать сервер общедоступным:

    :::image type="content" source="./media/quickstart-create-database-portal/5-networking.png" alt-text="Область "Сеть"":::

    Затем разрешите доступ к ней только с IP-адреса вашего клиента:

    :::image type="content" source="./media/quickstart-create-database-portal/6-add-client-ip.png" alt-text="Выбор функции "Добавить текущий IP-адрес клиента"":::

6. Выберите **Просмотр и создание** , чтобы просмотреть выбранные элементы. Щелкните **Создать**, чтобы подготовить сервер. Это может занять несколько минут.

7. На панели инструментов щелкните значок **Уведомления** (колокольчик), чтобы отслеживать процесс развертывания. По завершении развертывания можно выбрать **Закрепить на панели мониторинга**. После этого на панели мониторинга на портале Azure отобразится плитка, которая будет служить ярлыком страницы **Обзор** для этого сервера. Если выбрать **Перейти к ресурсу**, откроется страница сервера **Обзор**.

    :::image type="content" source="./media/quickstart-create-database-portal/7-notifications.png" alt-text="Область "Уведомления"":::

   По умолчанию на сервере создается база данных **postgres**. База данных [postgres](https://www.postgresql.org/docs/12/static/app-initdb.html) — это база данных по умолчанию, предназначенная для использования пользователями, служебными программами и сторонними приложениями. (Другая база данных по умолчанию — **azure_maintenance**. Ее функция заключается в отделении процессов управляемой службы от действий пользователей. У вас нет доступа к этой базе данных.)

    > [!NOTE]
    > Подключения к базе данных Azure для сервера PostgreSQL выполняются через порт 5432. При попытке подключиться из корпоративной сети исходящий трафик через порт 5432 может блокироваться сетевым брандмауэром. В таком случае вы не сможете подключиться к серверу. Для этого ваш ИТ-отдел должен открыть порт 5432.
    >

## <a name="get-the-connection-information"></a>Получение сведений о подключении

При создании базы данных Azure для сервера PostgreSQL создается база данных по умолчанию с именем **postgres**. Чтобы подключиться к серверу базы данных, вам потребуются учетные данные администратора для входа и полное имя сервера. Скорее всего, вы уже записали эти значения раньше. Если вы не сделали этого, имя сервера и данные для входа можно легко найти на странице **Обзор** сервера на портале.

Откройте страницу сервера **Обзор**. Запишите значения **имени сервера** и **имени для входа администратора сервера**. Наведите указатель на каждое поле. Справа от текста отобразится символ копирования. Щелкните его, чтобы скопировать нужные значения.

 :::image type="content" source="./media/quickstart-create-database-portal/8-server-name.png" alt-text="Страница "Обзор" сервера":::

## <a name="connect-to-the-postgresql-database-using-psql"></a>Подключение к базе данных PostgreSQL с помощью psql

К базе данных Azure для сервера PostgreSQL можно подключиться с помощью нескольких приложений. Если на клиентском компьютере установлено PostgreSQL, вы можете использовать локальный экземпляр [psql](https://www.postgresql.org/docs/current/static/app-psql.html), чтобы подключиться к серверу Azure PostgreSQL. Теперь подключимся к серверу Azure PostgreSQL с помощью служебной программы командной строки psql.

1. Чтобы подключиться к серверу базы данных Azure для PostgreSQL, выполните следующую команду psql:

   ```bash
   psql --host=<servername> --port=<port> --username=<user> --dbname=<dbname>
   ```

   Например, следующая команда устанавливает подключение к базе данных по умолчанию **postgres** на сервере PostgreSQL **mydemoserver.postgres.database.azure.com**, используя учетные данные для доступа. Введите `<server_admin_password>`, указанный при появлении запроса на ввод пароля.
  
   ```bash
   psql --host=mydemoserver.postgres.database.azure.com --port=5432 --username=myadmin --dbname=postgres
   ```

   После подключения служебная программа psql отображает запрос postgres в поле, где вы вводите команды sql. Возможно, в первоначальных выходных данных подключения отобразится предупреждение, так как используемая версия psql может отличаться от версии сервера службы "База данных Azure для PostgreSQL".

   Пример выходных данных psql:

   ```bash
   psql (11.3, server 12.1)
   WARNING: psql major version 11, server major version 12.
            Some psql features might not work.
   SSL connection (protocol: TLSv1.2, cipher: ECDHE-RSA-AES256-GCM-SHA384, bits: 256, compression: off)
   Type "help" for help.

   postgres=>
   ```

   > [!TIP]
   > Если в брандмауэре не настроено разрешение IP-адресов клиента, возникает следующая ошибка:
   >
   > "psql: FATAL: no pg_hba.conf entry for host `<IP address>`, user "myadmin", database "postgres", SSL on FATAL: необходимо SSL-подключение". Укажите параметры SSL и повторите попытку.
   >
   > Убедитесь, что IP-адрес клиента разрешен на предыдущем шаге правил брандмауэра.

2. Создайте пустую базу данных с именем mypgsqldb. Для этого в командной строке введите следующую команду:

    ```bash
    CREATE DATABASE mypgsqldb;
    ```

3. Чтобы подключиться к созданной базе данных **mypgsqldb**, выполните в командной строке следующую команду:

    ```bash
    \c mypgsqldb
    ```

4. Введите `\q` и нажмите клавишу ВВОД, чтобы выйти из psql.

Вы подключились к серверу службы "База данных Azure для PostgreSQL" через psql и создали пустую пользовательскую базу данных.

## <a name="clean-up-resources"></a>Очистка ресурсов

Удалить ресурсы, созданные в ходе работы с этим руководством, можно с помощью одного из двух способов. Вы можете удалить группу ресурсов Azure, которая содержит все связанные ресурсы. Чтобы сохранить другие ресурсы, удалите только ресурс сервера.

> [!TIP]
> Другие краткие руководства в этой коллекции созданы на основе этого документа. Если вы планируете продолжать работу с этими краткими руководствами, не удаляйте созданные ресурсы, а если нет — удалите все созданные в ходе работы с ним ресурсы, выполнив приведенные ниже действия на портале.

Чтобы удалить группу ресурсов, в том числе только что созданный сервер, сделайте следующее:

1. Найдите группу ресурсов на портале. В меню слева выберите **Группы ресурсов**. Затем выберите имя группы ресурсов (например, **myresourcegroup**).

2. На странице группы ресурсов щелкните **Удалить**. Затем введите имя своей группы ресурсов, например **myresourcegroup**, в текстовое поле, чтобы подтвердить удаление. Выберите команду **Удалить**.

Чтобы удалить только что созданный сервер, сделайте следующее:

1. Найдите сервер на портале, если от еще не открыт. В меню слева выберите **Все ресурсы**. Затем найдите созданный сервер.

2. На странице **Обзор** выберите **Удалить**.

    :::image type="content" source="./media/quickstart-create-database-portal/9-delete.png" alt-text="Кнопка "Удалить"":::

3. Подтвердите имя сервера, которое нужно удалить, чтобы появилась нужная база данных. Введите имя сервера в текстовое поле (например, **mydemoserver**). Выберите команду **Удалить**.

## <a name="next-steps"></a>Дальнейшие действия
> [!div class="nextstepaction"]
> [Развертывание приложения Django с помощью Службы приложений и PostgreSQL](tutorial-django-app-service-postgres.md)
