---
title: Параметры вычислений и хранилища — база данных Azure для PostgreSQL — гибкий сервер
description: В этой статье описываются варианты вычислений и хранения в базе данных Azure для PostgreSQL-гибкого сервера.
author: lfittl-msft
ms.author: lufittl
ms.service: postgresql
ms.topic: conceptual
ms.date: 09/22/2020
ms.openlocfilehash: ca60c44d1e167367e2c138af1e7bfd4ba1a69417
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91710079"
---
# <a name="compute-and-storage-options-in-azure-database-for-postgresql---flexible-server"></a>Варианты вычислений и хранения в базе данных Azure для PostgreSQL-гибкого сервера

> [!IMPORTANT]
> Гибкий сервер Базы данных Azure для PostgreSQL предоставляется в режиме предварительной версии

Вы можете создать сервер базы данных Azure для PostgreSQL в одной из трех разных ценовых категорий: "Пакетная", "общего назначения" и "оптимизировано для памяти". Ценовые категории различаются объемом вычислительных ресурсов в виртуальных ядрах, которые можно подготовить, объемом памяти на виртуальное ядро и технологиями хранения данных. Все ресурсы настраиваются на уровне сервера PostgreSQL. У сервера может быть одна или несколько баз данных.

| Ресурс или уровень | **Накапливаемыми ресурсами** | **Общего назначения** | **Оптимизированная для памяти** |
|:---|:----------|:--------------------|:---------------------|
| Виртуальные ядра | 1, 2 | 2, 4, 8, 16, 32, 48, 64 | 2, 4, 8, 16, 32, 48, 64 |
| Объем памяти на виртуальное ядро | Переменная | 4 ГБ | от 6,75 до 8 ГБ |
| Объем памяти | 32 ГБ до 16 ТБ | 32 ГБ до 16 ТБ | 32 ГБ до 16 ТБ |
| Срок хранения резервной копии | От 7 до 35 дней | От 7 до 35 дней | От 7 до 35 дней |

Чтобы выбрать ценовую категорию, в качестве отправной точки используйте следующую таблицу.

| Ценовая категория | Целевые рабочие нагрузки |
|:-------------|:-----------------|
| Накапливаемыми ресурсами | Лучше всего подходит для рабочих нагрузок, которые не требуют непрерывной полной загрузки ЦП. |
| Общего назначения | Для решения большинства бизнес-задач требуются сбалансированные вычислительные ресурсы и память с масштабируемой пропускной способностью операций ввода-вывода. К примерам относятся серверы для размещения мобильных и веб-приложений, а также других корпоративных приложений.|
| С оптимизацией для операций в памяти | Рабочие нагрузки с высокой производительностью базы данных, требующие эффективной обработки данных в памяти для быстрого выполнения транзакций и повышения уровня параллелизма. К примерам относятся серверы для обработки данных в режиме реального времени, а также аналитические или транзакционные приложения с высоким уровнем производительности.|

После создания сервера уровень вычислений, количество виртуальных ядер и размер хранилища могут быть изменены в течение нескольких секунд. Вы также можете независимо настраивать срок хранения резервных копий. Дополнительные сведения см. в разделе [масштабирование ресурсов](#scale-resources) .

## <a name="compute-tiers-vcores-and-server-types"></a>Уровни вычислений, виртуальных ядер и типы серверов

Ресурсы для вычислений можно выбрать на основе уровня, виртуальных ядер и объема памяти. Виртуальных ядер представляет логический ЦП базового оборудования.

Ниже приведены подробные спецификации доступных типов серверов.

| Имя SKU             | Виртуальные ядра | Размер памяти | Максимальное число поддерживаемых операций ввода-вывода | Максимальная поддерживаемая пропускная способность ввода-вывода |
|----------------------|--------|-------------|--------------------|-----------------------------|
| **Накапливаемыми ресурсами**        |        |             |                    |                             |
| B1ms                 | 1      | 2 гиб       | 640                | 15 MiB/с                  |
| B2s                  | 2      | 4 гиб       | 1280               | 15 MiB/с                  |
| **Общего назначения**  |        |             |                    |                             |
| D2s_v3               | 2      | 8 гиб       | 3200               | 48 MiB/с                  |
| D4s_v3               | 4      | 16 гиб      | 6400               | 96 MiB/с                  |
| D8s_v3               | 8      | 32 ГиБ      | 12800              | 192 MiB/с                 |
| D16s_v3              | 16     | 64 ГиБ      | 18000              | 384 MiB/с                 |
| D32s_v3              | 32     | 128 ГиБ     | 18000              | 750 МиБ/с                 |
| D48s_v3              | 48     | 192 ГиБ     | 18000              | 750 МиБ/с                 |
| D64s_v3              | 64     | 256 Гиб     | 18000              | 750 МиБ/с                 |
| **Оптимизированная для памяти** |        |             |                    |                             |
| E2s_v3               | 2      | 16 гиб      | 3200               | 48 MiB/с                  |
| E4s_v3               | 4      | 32 ГиБ      | 6400               | 96 MiB/с                  |
| E8s_v3               | 8      | 64 ГиБ      | 12800              | 192 MiB/с                 |
| E16s_v3              | 16     | 128 ГиБ     | 18000              | 384 MiB/с                 |
| E32s_v3              | 32     | 256 Гиб     | 18000              | 750 МиБ/с                 |
| E48s_v3              | 48     | 384 гиб     | 18000              | 750 МиБ/с                 |
| E64s_v3              | 64     | 432 ГиБ     | 18000              | 750 МиБ/с                 |

## <a name="storage"></a>Память

Хранилище, которое вы подготавливаете, определяет объем доступной емкости хранилища для сервера службы "База данных Azure для PostgreSQL". Хранилище используется для файлов базы данных, временных файлов, журналов транзакций и журналов сервера PostgreSQL. Общий объем хранилища, который вы подготовили, также определяет доступную производительность операций ввода-вывода для сервера.

Хранилище доступно в следующих фиксированных размерах:

| Размер диска | Количество операций ввода-вывода в секунду |
|:---|:---|
| 32 ГиБ | Подготовлено 120, до 3 500 |
| 64 ГиБ | Подготовлено 240, до 3 500 |
| 128 ГиБ | Подготовлено 500, до 3 500 |
| 256 Гиб | Подготовлено 1100, до 3 500 |
| 512 ГиБ | Подготовлено 2300, до 3 500 |
| 1 ТиБ | 5 000 |
| 2 ТиБ | 7500 |
| 4 ТиБ | 7500 |
| 8 ТиБ | 16 000 |
| 16 ТиБ | 18 000 |

Обратите внимание, что операции ввода-вывода также ограничены типом виртуальной машины. Несмотря на то, что можно выбрать любой размер хранилища независимо от типа сервера, вы не сможете использовать все операции ввода-вывода, предоставляемые хранилищем, особенно при выборе сервера с небольшим количеством виртуальных ядер.

Вы можете добавить дополнительную емкость во время и после создания сервера.

>[!NOTE]
> Масштаб хранилища можно масштабировать, а не уменьшать.

Вы можете отслеживать показатель операций ввода-вывода на портале Azure или с помощью команд Azure CLI. Соответствующие метрики для мониторинга — это [предел хранилища, процент использования хранилища, используемый объем хранилища и процент операций ввода-вывода](concepts-monitoring.md).

### <a name="maximum-iops-for-your-configuration"></a>Максимальное число операций ввода-вывода в секунду для вашей конфигурации

|Имя SKU            |Размер хранилища в гиб                       |32 |64 |128 |256 |512  |1024|2048|4096|8192 |16 384|
|--------------------|------------------------------------------|---|---|----|----|-----|-----|-----|-----|------|------|
|                    |Максимальное значение IOPS                              |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|**Накапливаемыми ресурсами**       |                                          |   |   |    |    |     |     |     |     |      |      |
|B1ms                |640 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                                  |120|240|500 |640 *|640 * |640 * |640 * |640 * |640 *  |640 *  |
|B2s                 |1280 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                                 |120|240|500 |1100|1280 *|1280 *|1280 *|1280 *|1280 * |1280 * |
|**Общего назначения** |                                          |   |   |    |    |     |     |     |     |      |      |
|D2s_v3              |3200 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                                 |120|240|500 |1100|2300 |3200 *|3200 *|3200 *|3200 * |3200 * |
|D4s_v3              |6 400 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                                |120|240|500 |1100|2300 |5000 |6400 *|6400 *|6400 * |6400 * |
|D8s_v3              |12 800 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |12800 *|12800 *|
|D16s_v3             |18 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D32s_v3             |18 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D48s_v3             |18 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|D64s_v3             |18 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|**Оптимизированная для памяти**|                                          |   |   |    |    |     |     |     |     |      |      |
|E2s_v3              |3200 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                                 |120|240|500 |1100|2300 |3200 *|3200 *|3200 *|3200 * |3200 * |
|E4s_v3              |6 400 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                                |120|240|500 |1100|2300 |5000 |6400 *|6400 *|6400 * |6400 * |
|E8s_v3              |12 800 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |12800 *|12800 *|
|E16s_v3             |18 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E32s_v3             |18 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E48s_v3             |18 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |
|E64s_v3             |18 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА                               |120|240|500 |1100|2300 |5000 |7500 |7500 |16000 |18000 |

При пометке операции \* ввода-вывода в секунду ограничиваются выбранным типом виртуальной машины. В противном случае операции ввода-вывода ограничиваются выбранным размером хранилища.

### <a name="maximum-io-bandwidth-mibsec-for-your-configuration"></a>Максимальная пропускная способность ввода-вывода (MiB/с) для конфигурации

|Имя SKU            |Размер хранилища, гиб                             |32 |64 |128 |256 |512  |1024|2048|4096|8192 |16 384|
|--------------------|----------------------------------------------|---|---|----|----|-----|-----|-----|-----|------|------|
|                    |**Пропускная способность хранилища, MiB/с**                |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|**Накапливаемыми ресурсами**       |                                              |   |   |    |    |     |     |     |     |      |      |
|B1ms                |10 MiB/с                                    |штук|штук|штук |штук |штук  |штук  |штук  |штук  |штук   |штук   |
|B2s                 |15 MiB/с                                    |15|15|15 |15 |15  |15  |15  |15  |15   |15   |
|**Общего назначения** |                                              |   |   |    |    |     |     |     |     |      |      |
|D2s_v3              |48 MiB/с                                    |25 |48 *|48 * |48 * |48 *  |48 *  |48 *  |48 *  |48 *   |48 *   |
|D4s_v3              |96 MiB/с                                    |25 |50 |96 * |96 * |96 *  |96 *  |96 *  |96 *  |96 *   |96 *   |
|D8s_v3              |192 MiB/с                                   |25 |50 |100 |125 |150  |192 * |192 * |192 * |192 *  |192 *  |
|D16s_v3             |384 MiB/с                                   |25 |50 |100 |125 |150  |200  |250  |250  |384 *  |384 *  |
|D32s_v3             |750 МиБ/с                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|D48s_v3             |750 МиБ/с                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|D64s_v3             |750 МиБ/с                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|**Оптимизированная для памяти**|                                              |   |   |    |    |     |     |     |     |      |      |
|E2s_v3              |48 MiB/с                                    |25 |48 *|48 * |48 * |48 *  |48 *  |48 *  |48 *  |48 *   |48 *   |
|E4s_v3              |96 MiB/с                                    |25 |50 |96 * |96 * |96 *  |96 *  |96 *  |96 *  |96 *   |96 *   |
|E8s_v3              |192 MiB/с                                   |25 |50 |100 |125 |150  |192 * |192 * |192 * |192 *  |192 *  |
|E16s_v3             |384 MiB/с                                   |25 |50 |100 |125 |150  |200  |250  |250  |384 *  |384 *  |
|E32s_v3             |750 МиБ/с                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|E48s_v3             |750 МиБ/с                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |
|E64s_v3             |750 МиБ/с                                   |25 |50 |100 |125 |150  |200  |250  |250  |500   |750   |

При пометке с помощью \* пропускной способности ввода-вывода ограничивается выбранным типом виртуальной машины. В противном случае пропускная способность ввода-вывода ограничена выбранным размером хранилища.

### <a name="reaching-the-storage-limit"></a>Достигнут размер хранилища

При достижении предельного размера хранилища сервер начинает возвращать ошибки и предотвращает дальнейшие изменения. Это также может вызвать проблемы с другими операционными операциями, такими как резервное копирование и WAL архивация.

Рекомендуется активно отслеживать используемое дисковое пространство, а также увеличивать размер диска перед любой ситуацией нехватки памяти. Вы можете настроить оповещение, уведомляющее о том, что при недостатке дискового пространства в хранилище сервера можно избежать проблем, связанных с недостатком диска. Дополнительные сведения см. в статье о том, [как настроить оповещение](howto-alert-on-metrics.md).

### <a name="storage-auto-grow"></a>Автоматическое увеличение размера хранилища

Автоматическое увеличение хранилища еще не доступно для гибкого сервера.

## <a name="backup"></a>Резервное копирование

В службе автоматически создаются резервные копии сервера. Можно выбрать срок хранения в диапазоне от 7 до 35 дней. Дополнительные сведения о резервном копировании см. в [статье основные понятия](concepts-backup-restore.md).

## <a name="scale-resources"></a>Масштабирование ресурсов

После создания сервера можно независимо изменить виртуальных ядер, уровень вычислений, объем хранилища и срок хранения резервных копий. Число виртуальных ядер можно увеличивать или уменьшать. Срок хранения резервных копий можно увеличивать и уменьшать в диапазоне от 7 до 35 дней. Размер хранилища можно только увеличить. Масштабирование ресурсов можно выполнить с помощью портала или Azure CLI.

> [!NOTE]
> Размер хранилища можно только увеличить. Вы не сможете вернуться к меньшему размеру хранилища после увеличения.

При изменении числа виртуальных ядер или уровня вычислений сервер перезагружается, чтобы новый тип сервера вступил в силу. Во время перехода системы на новый сервер нельзя будет установить новые подключения, а для всех незафиксированных транзакций будет выполнен откат. Длительность этого промежутка может быть разной, но, как правило, он составляет меньше минуты. Масштабирование хранилища выполняется аналогичным образом, а также требует короткого перезапуска.

Изменение срока хранения резервной копии — это операция в сети.

## <a name="pricing"></a>Цены

Наиболее актуальные сведения о стоимости см. в статье [Цены на Базу данных Azure для PostgreSQL](https://azure.microsoft.com/pricing/details/PostgreSQL/). Расходы на вашу конфигурацию можно посмотреть на [портале Azure](https://portal.azure.com/#create/Microsoft.PostgreSQLServer). На вкладке **Ценовая категория** отображается ежемесячная стоимость выбранных параметров. Если у вас нет подписки Azure, для расчета цены можно воспользоваться калькулятором цен Azure. На сайте с [калькулятором цен Azure](https://azure.microsoft.com/pricing/calculator/) нажмите кнопку **Добавить элементы**, разверните категорию **Базы данных** и выберите **База данных Azure для PostgreSQL**, чтобы настроить параметры.

## <a name="next-steps"></a>Дальнейшие шаги

- [Руководство по проектированию службы "База данных Azure для PostgreSQL" с помощью портала Azure](how-to-manage-server-portal.md).
- Дополнительные сведения см. в статье [Ограничения в базе данных Azure для PostgreSQL](concepts-limits.md).
