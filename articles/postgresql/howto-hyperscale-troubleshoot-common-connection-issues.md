---
title: Устранение неполадок подключения к базе данных Azure для PostgreSQL — масштабирование (Цитус)
description: Узнайте, как устранять проблемы с подключением к базе данных Azure для PostgreSQL-Scale (Цитус)
keywords: подключение postgresql,строка подключения,проблемы с подключением, временная ошибка,ошибка подключения
author: jonels-msft
ms.author: jonels
ms.service: postgresql
ms.topic: conceptual
ms.date: 10/8/2019
ms.openlocfilehash: b812b730cebba4dbf0735f49f544e53bf7f8787c
ms.sourcegitcommit: 4c3d6c2657ae714f4a042f2c078cf1b0ad20b3a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2019
ms.locfileid: "72952151"
---
# <a name="troubleshoot-connection-issues-to-azure-database-for-postgresql---hyperscale-citus"></a>Устранение неполадок подключения к базе данных Azure для PostgreSQL — масштабирование (Цитус)

Проблемы с подключением могут быть вызваны несколькими причинами:

* Настройки брандмауэра
* Время ожидания подключения.
* Неверные данные для входа
* Достигнуто предельное число подключений для группы серверов
* Проблемы с инфраструктурой службы.
* Обслуживание службы
* Узел координатор отработки отказа на новое оборудование

Как правило, проблемы с подключением к масштабированию можно классифицировать следующим образом:

* временные ошибки (кратковременные или возникающие периодически);
* постоянные или регулярно возникающие ошибки.

## <a name="troubleshoot-transient-errors"></a>Устранение временных ошибок

Временные ошибки возникают по ряду причин. Наиболее распространенный — обслуживание системы, ошибка с оборудованием или программным обеспечением, а также обновление узла координатора Виртуальное ядро.

Включение высокого уровня доступности для узлов групп серверов масштабирования может автоматически устранить проблемы этих типов. Тем не менее, приложение должно быть готово к потере подключения. Кроме того, для устранения других событий может потребоваться больше времени, например, если большая транзакция вызывает длительное восстановление.

### <a name="steps-to-resolve-transient-connectivity-issues"></a>Порядок устранения временных проблем подключения

1. Проверьте [панель мониторинга службы Microsoft Azure](https://azure.microsoft.com/status) на наличие известных сбоев, произошедших в течение времени, когда приложение сообщает об ошибках.
2. Приложения, подключающиеся к облачной службе, такой как "масштабирование" (Цитус), должны ждать временных ошибок и корректно реагировать на них. Например, приложения должны реализовать логику повторных попыток для обработки этих ошибок вместо того, чтобы отображая их как ошибки приложений пользователям.
3. По мере того как группа серверов приближается к ограничениям ресурсов, ошибки могут показаться временными проблемами подключения. Может помочь увеличение объема ОЗУ узла или Добавление рабочих узлов и перераспределения данных.
4. Если проблемы с подключением будут продолжены или более 60 секунд или несколько раз в день, отправьте запрос в службу поддержки Azure, выбрав **получить поддержку** на сайте [поддержки Azure](https://azure.microsoft.com/support/options) .

## <a name="troubleshoot-persistent-errors"></a>Устранение постоянных ошибок

Если приложению постоянно не удается подключиться к Цитус, наиболее распространенные причины — неправильное конфигурирование брандмауэра или ошибка пользователя.

* Конфигурация брандмауэра узла координатора. Убедитесь, что брандмауэр сервера перемасштабирования настроен для разрешения подключений от клиента, включая прокси-серверы и шлюзы.
* Конфигурация брандмауэра клиента. брандмауэр на клиенте должен разрешать подключения к серверу базы данных. Некоторые брандмауэры должны разрешать не только приложения по имени, но и IP-адреса и порты сервера.
* Ошибка пользователя: дважды проверьте строку подключения. Возможно, у вас есть недопустимые параметры, например имя сервера, или забыли суффикс *\@ServerName* в имени пользователя.

### <a name="steps-to-resolve-persistent-connectivity-issues"></a>Порядок устранения постоянных проблем подключения

1. Настройте [правила брандмауэра](howto-hyperscale-manage-firewall-using-portal.md) , разрешив предоставление IP-адреса клиенту. Для временных целей тестирования настройте правило брандмауэра, используя 0.0.0.0 как начало диапазона IP-адресов и 255.255.255.255 как завершение. Это правило открывает сервер для всех IP-адресов. Если правило устраняет проблему с подключением, удалите его и создайте правило брандмауэра для соответствующего ограниченного IP-адреса или диапазона адресов.
2. На всех брандмауэрах между клиентом и Интернетом убедитесь, что порт 5432 открыт для исходящих соединений.
3. Проверьте строку подключения и другие параметры подключения.
4. Проверьте работоспособность службы на панели мониторинга.

## <a name="next-steps"></a>Дальнейшие действия

* Основные сведения о [правилах брандмауэра в базе данных Azure для PostgreSQL — масштабирование (Цитус)](concepts-hyperscale-firewall-rules.md)
* См. раздел [Управление правилами брандмауэра для базы данных Azure для PostgreSQL-Scale (Цитус)](howto-hyperscale-manage-firewall-using-portal.md) .
