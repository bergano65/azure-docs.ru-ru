---
title: Ценовые категории для базы данных Azure для PostgreSQL — один сервер
description: В этой статье описываются ценовые категории для базы данных Azure для PostgreSQL-Single Server.
author: jan-eng
ms.author: janeng
ms.service: postgresql
ms.topic: conceptual
ms.date: 07/31/2019
ms.openlocfilehash: 376620459a0ab2f0f170b0743c0ab51a51bca9c4
ms.sourcegitcommit: 800f961318021ce920ecd423ff427e69cbe43a54
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/31/2019
ms.locfileid: "68698956"
---
# <a name="pricing-tiers-in-azure-database-for-postgresql---single-server"></a>Ценовые категории в базе данных Azure для PostgreSQL — один сервер

Вы можете создать сервер службы "База данных Azure для PostgreSQL" в одной из трех ценовых категорий: "Базовый", "Общего назначения" и "Оптимизированная для операций в памяти". Ценовые категории различаются объемом вычислительных ресурсов в виртуальных ядрах, которые можно подготовить, объемом памяти на виртуальное ядро и технологиями хранения данных. Все ресурсы настраиваются на уровне сервера PostgreSQL. У сервера может быть одна или несколько баз данных.

|    | **базовая;** | **Общего назначения** | **С оптимизацией для операций в памяти** |
|:---|:----------|:--------------------|:---------------------|
| Поколение вычислительных ресурсов | Поколение 4, поколение 5 | Поколение 4, поколение 5 | Поколение 5 |
| Виртуальные ядра | 1, 2 | 2, 4, 8, 16, 32, 64 |2, 4, 8, 16, 32 |
| Объем памяти на виртуальное ядро | 2 ГБ | 5 ГБ | 10 GB |
| Размер хранилища | От 5 ГБ до 1 ТБ | От 5 ГБ до 4 ТБ | От 5 ГБ до 4 ТБ |
| Тип хранилища | Служба хранилища Azure класса Standard | Хранилище Azure класса Premium | Хранилище Azure класса Premium |
| Срок хранения резервной копии | От 7 до 35 дней | От 7 до 35 дней | От 7 до 35 дней |

Чтобы выбрать ценовую категорию, в качестве отправной точки используйте следующую таблицу.

| Ценовая категория | Целевые рабочие нагрузки |
|:-------------|:-----------------|
| Стандартная | Рабочие нагрузки с невысокими вычислительными потребностями и производительностью операций ввода-вывода. В качестве примера можно привести серверы, используемые для разработки или тестирования, или небольшие редко используемые приложения. |
| Общего назначения | Для решения большинства бизнес-задач требуются сбалансированные вычислительные ресурсы и память с масштабируемой пропускной способностью операций ввода-вывода. К примерам относятся серверы для размещения мобильных и веб-приложений, а также других корпоративных приложений.|
| Оптимизировано для памяти | Рабочие нагрузки с высокой производительностью базы данных, требующие эффективной обработки данных в памяти для быстрого выполнения транзакций и повышения уровня параллелизма. К примерам относятся серверы для обработки данных в режиме реального времени, а также аналитические или транзакционные приложения с высоким уровнем производительности.|

После создания сервера количество виртуальных ядер, поколение оборудования и ценовую категорию (кроме переключения на категорию "Базовый" и с нее) можно увеличить и уменьшить в считаные секунды. Кроме того, можно независимо друг от друга увеличивать и уменьшать объем хранилища и срок хранения резервных копий без простоя приложения. После создания сервера невозможно изменить тип хранилища резервных копий. Дополнительные сведения см. в разделе [Масштабирование ресурсов](#scale-resources).

## <a name="compute-generations-and-vcores"></a>Поколения вычислительных ресурсов и виртуальные ядра

Вычислительные ресурсы поставляются в виде виртуальных ядер, которые представляют собой логические ЦП основного оборудования. Восточный Китай 1, Северный Китай 1, центральный регион US DoD и восточный регион US DoD используют логические процессоры 4-го поколения, основанные на процессорах Intel 2673 v3 (Haswell) с тактовой частотой 2,4 ГГц. Во всех остальных регионах используются логические процессоры объемом 5, основанные на процессорах Intel 2673 V4 (Broadwell) с тактовой частотой 2,3 ГГц.

## <a name="storage"></a>Служба хранилища

Хранилище, которое вы подготавливаете, определяет объем доступной емкости хранилища для сервера службы "База данных Azure для PostgreSQL". Хранилище используется для файлов базы данных, временных файлов, журналов транзакций и журналов сервера PostgreSQL. Общий объем хранилища, который вы подготовили, также определяет доступную производительность операций ввода-вывода для сервера.

|    | **базовая;** | **Общего назначения** | **С оптимизацией для операций в памяти** |
|:---|:----------|:--------------------|:---------------------|
| Тип хранилища | Служба хранилища Azure класса Standard | Хранилище Azure класса Premium | Хранилище Azure класса Premium |
| Размер хранилища | От 5 ГБ до 1 ТБ | От 5 ГБ до 4 ТБ | От 5 ГБ до 4 ТБ |
| Шаг приращения хранилища | 1 ГБ | 1 ГБ | 1 ГБ |
| Операций ввода-вывода в сек. | Переменная |3 операции ввода-вывода в секунду на ГБ<br/>Минимум 100 операций ввода-вывода в секунду<br/>Макс. 6000 операций ввода-вывода в секунду | 3 операции ввода-вывода в секунду на ГБ<br/>Минимум 100 операций ввода-вывода в секунду<br/>Макс. 6000 операций ввода-вывода в секунду |

Можно добавить дополнительную емкость хранилища во время и после создания сервера, а также разрешить системе автоматически увеличивать размер хранилища в зависимости от объема используемой рабочей нагрузки. 

>[!NOTE]
> Масштаб хранилища можно масштабировать, а не уменьшать.

Для ценовой категории "Базовый" фиксированное число операций ввода-вывода в секунду не гарантируется. В категориях "Общего назначения" и "С оптимизацией для операций в памяти" показатель операций ввода-вывода в секунду соотносится с подготовленным размером хранилища как 3 к 1.

Вы можете отслеживать показатель операций ввода-вывода на портале Azure или с помощью команд Azure CLI. Следует отслеживать такие метрики, как [размер хранилища, процентное соотношение для хранилища, используемое хранилище и процент операций ввода-вывода данных](concepts-monitoring.md).

### <a name="large-storage-preview"></a>Большой объем хранилища (Предварительная версия)

Мы увеличивая ограничения хранилища в наших общего назначения и оптимизированных для памяти уровнях. Недавно созданные серверы, которые явно подготовились к предварительной версии, могут подготавливать до 16 ТБ хранилища. Масштаб операций ввода-вывода в секунду соотношение 3:1 до 20 000 операций ввода/вывода. Как и в текущем общедоступном хранилище, можно добавить дополнительную емкость хранилища после создания сервера и позволить системе автоматически увеличивать хранилище на основе потребления рабочей нагрузки.

|              | **Общего назначения** | **С оптимизацией для операций в памяти** |
|:-------------|:--------------------|:---------------------|
| Тип хранилища | Хранилище Azure класса Premium | Хранилище Azure класса Premium |
| Размер хранилища | 32 ГБ до 16 ТБ| 32 – 16 ТБ |
| Шаг приращения хранилища | 1 ГБ | 1 ГБ |
| Операций ввода-вывода в сек. | 3 операции ввода-вывода в секунду на ГБ<br/>Минимум 100 операций ввода-вывода в секунду<br/>Макс. 20 000 операций ввода-вывода | 3 операции ввода-вывода в секунду на ГБ<br/>Минимум 100 операций ввода-вывода в секунду<br/>Макс. 20 000 операций ввода-вывода |

> [!IMPORTANT]
> В настоящее время большая память находится в общедоступной предварительной версии в следующих регионах: Восточная часть США, восток США 2, Центральная часть США, Запад США, Северная Европа, Западная Европа, южная часть Соединенного Королевства, западная часть Соединенного Королевства, Юго-Восточная Азия, Восточная Азия, Восточная Япония, Западная Япония, Центральная Корея, Южная Корея, Восточная Австралия, юго-восток Австралии.
>
> В настоящее время просмотр больших объемов хранилища не поддерживает:
>
> * Входящие подключения через конечные точки службы виртуальной сети
> * Географически избыточные резервные копии
> * Реплики чтения

### <a name="reaching-the-storage-limit"></a>Достигнут размер хранилища

Серверы с подготовленным хранилищем объемом менее 100 ГБ помечаются как доступные только для чтения, если объем свободного хранилища меньше 512 МБ или 5% от размера подготовленного хранилища. Серверы с более чем 100 ГБ подготовленного хранилища помечаются как доступные только для чтения, если объем свободного хранилища меньше 5 ГБ.

Например, если подготовлено 110 ГБ хранилища и фактическое использование превышает 105 ГБ, сервер помечается как доступный только для чтения. Кроме того, если вы подготовили 5 ГБ хранилища, сервер помечается как доступная только для чтения, если объем свободного хранилища превысит 512 МБ.

Если сервер помечен как доступный только для чтения, все существующие сеансы отключаются и выполняется откат всех незафиксированных транзакций. Какие-либо последующие операции записи и фиксации транзакций не выполняются. Все запросы на чтение продолжат обрабатываться без перерыва.  

Можно увеличить объем подготовленного хранилища для сервера или запустить новый сеанс в режиме чтения и записи и удалить данные, чтобы освободить хранилище. Команда `SET SESSION CHARACTERISTICS AS TRANSACTION READ WRITE;` задает режим записи для чтения для текущего сеанса. Во избежание повреждения данных не выполняйте какие-либо операции записи, пока сервер находится в состоянии "только для чтения".

Рекомендуется включить автоматическое увеличение размера хранилища или настроить оповещение, чтобы уведомлять вас о приближении хранилища сервера к пороговому значению, чтобы избежать появления в состоянии "только для чтения". Дополнительные сведения см. в статье о том, [как настроить оповещение](howto-alert-on-metric.md).

### <a name="storage-auto-grow"></a>Автоматическое увеличение размера хранилища

Автоматическое увеличение хранилища не дописывает сервера на работу с хранилищем и становится доступно только для чтения. Если автоматическое увеличение размера хранилища включено, хранилище автоматически растет, не влияя на рабочую нагрузку. Для серверов с подготовленным хранилищем объемом менее 100 ГБ размер подготовленного хранилища увеличивается на 5 ГБ, как только объем свободного хранилища превысит 1 ГБ или 10% подготовленного хранилища. Для серверов с более чем 100 ГБ подготовленного хранилища размер подготовленного хранилища увеличивается на 5%, если объем свободного пространства превышает 5% от подготовленного объема хранилища. Применяются максимальные ограничения хранилища, указанные выше.

Например, если подготовлено 1000 ГБ хранилища и фактическое использование превышает 950 ГБ, размер хранилища сервера увеличится до 1050 ГБ. Кроме того, если вы подготовили 10 ГБ хранилища, размер хранилища увеличится до 15 ГБ, если менее 1 ГБ хранилища свободны.

Помните, что хранилище можно масштабировать только вверх, а не вниз.

## <a name="backup"></a>Архивация

В службе автоматически создаются резервные копии сервера. Минимальный срок хранения резервных копий составляет семь дней. Можно увеличить срок вплоть до 35 дней. Срок хранения можно изменить в любой момент времени существования сервера. Вы можете выбрать локально избыточное или геоизбыточное резервное копирование. Геоизбыточные резервные копии хранятся в [регионе, географически связанном](https://docs.microsoft.com/azure/best-practices-availability-paired-regions) с тем, в котором создан сервер. Эта избыточность обеспечивает защиту сервера в случае аварии. Также вы можете восстановить сервер в любом регионе Azure, в котором доступна служба с геоизбыточным резервным копированием. После создания сервера нельзя изменить один вариант хранилища резервных копий на другой.

## <a name="scale-resources"></a>Масштабирование ресурсов

После создания сервера можно независимо друг от друга изменять количество виртуальных ядер, поколение оборудования, ценовую категорию (кроме переключения на категорию "Базовый" и с нее), объем хранилища и срок хранения резервных копий. После создания сервера невозможно изменить тип хранилища резервных копий. Число виртуальных ядер можно увеличивать или уменьшать. Срок хранения резервных копий можно увеличивать и уменьшать в диапазоне от 7 до 35 дней. Размер хранилища можно только увеличить. Масштабирование ресурсов можно выполнить с помощью портала или Azure CLI. Пример масштабирования с помощью CLI см. в статье [Мониторинг и масштабирование сервера базы данных Azure для PostgreSQL с помощью Azure CLI](scripts/sample-scale-server-up-or-down.md).

При изменении количества виртуальных ядер, поколения оборудования или ценовой категории создается копия сервера-источника с новым распределением вычислительных ресурсов. После того как новый сервер заработает, подключения переключатся на него. Во время перехода системы на новый сервер нельзя будет установить новые подключения, а для всех незафиксированных транзакций будет выполнен откат. Длительность этого промежутка может быть разной, но, как правило, он составляет меньше минуты.

Масштабирование хранилища и изменение срока хранения резервных копий — это полностью интерактивные операции. Они не останавливают работу приложения и не влияют на нее. Так как количество операций ввода-вывода в секунду возрастает по мере увеличения размера подготовленного хранилища, вы можете увеличивать количество доступных операций ввода-вывода на сервере путем масштабирования хранилища.

## <a name="pricing"></a>Цены

Наиболее актуальные сведения о стоимости см. в статье [Цены на Базу данных Azure для PostgreSQL](https://azure.microsoft.com/pricing/details/PostgreSQL/). Расходы на вашу конфигурацию можно посмотреть на [портале Azure](https://portal.azure.com/#create/Microsoft.PostgreSQLServer). На вкладке **Ценовая категория** отображается ежемесячная стоимость выбранных параметров. Если у вас нет подписки Azure, для расчета цены можно воспользоваться калькулятором цен Azure. На сайте с [калькулятором цен Azure](https://azure.microsoft.com/pricing/calculator/) нажмите кнопку **Добавить элементы**, разверните категорию **Базы данных** и выберите **База данных Azure для PostgreSQL**, чтобы настроить параметры.

## <a name="next-steps"></a>Следующие шаги

- [Руководство по проектированию службы "База данных Azure для PostgreSQL" с помощью портала Azure](tutorial-design-database-using-azure-portal.md).
- Дополнительные сведения см. в статье [Ограничения в базе данных Azure для PostgreSQL](concepts-limits.md). 
- Дополнительные сведения см. в статье [Создание реплик чтения и управление ими с помощью портала Azure](howto-read-replicas-portal.md).
