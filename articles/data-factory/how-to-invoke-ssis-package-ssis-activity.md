---
title: Запуск пакета служб SSIS с действием "выполнение пакета служб SSIS"
description: В этой статье описывается, как выполнить пакет SQL Server Integration Services (SSIS) в конвейере фабрики данных Azure с помощью действия "выполнение пакета служб SSIS".
services: data-factory
documentationcenter: ''
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: ''
ms.devlang: powershell
ms.topic: conceptual
ms.author: sawinark
author: swinarko
ms.reviewer: douglasl
manager: mflasko
ms.custom: seo-lt-2019, devx-track-azurepowershell
ms.date: 07/20/2020
ms.openlocfilehash: 901693c512ddfcf5d3c4dafaec71b1606b5dc5f1
ms.sourcegitcommit: 656c0c38cf550327a9ee10cc936029378bc7b5a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2020
ms.locfileid: "89077855"
---
# <a name="run-an-ssis-package-with-the-execute-ssis-package-activity-in-azure-data-factory"></a>Запуск пакета Integration Services с помощью действия выполнения пакета SSIS в Фабрике данных Azure

[!INCLUDE[appliesto-adf-xxx-md](includes/appliesto-adf-xxx-md.md)]

В этой статье описывается, как выполнить пакет SQL Server Integration Services (SSIS) в конвейере фабрики данных Azure с помощью действия "выполнение пакета служб SSIS". 

## <a name="prerequisites"></a>Предварительные требования

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

Создайте среду выполнения интеграции Azure SSIS (IR), если у вас ее еще нет, следуя пошаговым инструкциям в [руководстве по подготовке Azure-SSIS IR](tutorial-create-azure-ssis-runtime-portal.md).

## <a name="run-a-package-in-the-azure-portal"></a>Запуск пакета в портале Azure
В этом разделе вы используете пользовательский интерфейс фабрики данных (UI) или приложение для создания конвейера фабрики данных с действием выполнить пакет служб SSIS, которое выполняет пакет служб SSIS.

### <a name="create-a-pipeline-with-an-execute-ssis-package-activity"></a>Создание конвейера с действием "Выполнить пакет SSIS"
На этом шаге вы используете пользовательский интерфейс или приложение фабрики данных для создания конвейера. Добавьте действие выполнения пакета SSIS в конвейер и настройте его для запуска пакета Integration Services. 

1. На странице Обзор или Домашняя страница фабрики данных в портал Azure выберите плитку " **дизайнер & Monitor** ", чтобы запустить пользовательский интерфейс или приложение фабрики данных на отдельной вкладке. 

   ![Домашняя страница фабрики данных](./media/how-to-invoke-ssis-package-stored-procedure-activity/data-factory-home-page.png)

   На странице **Начало работы** выберите **Create pipeline** (Создать конвейер). 

   ![Страница "Начало работы"](./media/how-to-invoke-ssis-package-stored-procedure-activity/get-started-page.png)

1. На панели элементов **действия** разверните узел **Общие**. Затем перетащите действие **выполнить пакет служб SSIS** в область конструктора конвейера. 

   ![Перетаскивание действия выполнения пакета SSIS в область конструктора](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-designer.png) 

   Выберите объект действия "выполнить пакет служб SSIS", чтобы настроить **Общие**вкладки, **Параметры**, **Параметры служб SSIS**, **Диспетчеры соединений**и **переопределения свойств** .

#### <a name="general-tab"></a>Вкладка «Общее»

На вкладке **Общие** действия выполнение пакета служб SSIS выполните следующие действия.

![Настройка свойств на вкладке "Общие"](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-general.png)

   1. В поле **имя**введите имя действия выполнить пакет служб SSIS.

   1. В поле **Описание**введите описание действия выполнить пакет служб SSIS.

   1. В поле **время ожидания**введите максимальное количество времени, в течение которого может выполняться действие "выполнение пакета служб SSIS". Значение по умолчанию — 7 дней, формат — D. чч: мм: СС.

   1. В поле **повторить**введите максимальное число повторных попыток для действия "выполнение пакета служб SSIS".

   1. В поле **интервал повтора**введите количество секунд между повторными попытками для действия выполнение пакета служб SSIS. Значение по умолчанию — 30 секунд.

   1. Установите флажок **безопасные выходные данные** , чтобы выбрать, следует ли исключить из ведения журнала выходные данные действия выполнение пакета служб SSIS.

   1. Установите флажок **безопасный ввод** , чтобы выбрать, следует ли исключить входные данные действия выполнить пакет служб SSIS из журнала.

#### <a name="settings-tab"></a>Вкладка "Параметры"

На вкладке **Параметры** действия выполнение пакета служб SSIS выполните следующие действия.

![Автоматическая установка свойств на вкладке "Параметры"](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-settings.png)

   1. Для **Azure-SSIS IR**выберите назначенную Azure-SSIS IR, чтобы выполнить действие выполнение пакета служб SSIS.

   1. В поле **Описание**введите описание действия выполнить пакет служб SSIS.

   1. Установите флажок **Проверка подлинности Windows** , чтобы выбрать, следует ли использовать проверку подлинности Windows для доступа к хранилищам данных, таким как серверы SQL Server или файловые ресурсы в локальной среде или файлы Azure.
   
      Если этот флажок установлен, введите значения учетных данных выполнения пакета в полях **домен**, **имя пользователя**и **пароль** . Например, для доступа к службе "файлы Azure" домен имеет `Azure` имя пользователя, `<storage account name>` а пароль — `<storage account key>` .

      Кроме того, в качестве значений можно использовать секреты, хранящиеся в Azure Key Vault. Для этого установите флажок **хранилище ключей Azure** рядом с ним. Выберите или измените существующую связанную службу хранилища ключей или создайте новую. Затем выберите имя секрета и версию для своего значения. При создании или изменении связанной службы хранилища ключей можно выбрать или изменить существующее хранилище ключей или создать новое. Не забудьте предоставить управляемой идентификации фабрики данных доступ к хранилищу ключей, если это еще не сделано. Вы также можете ввести секрет непосредственно в следующем формате: `<key vault linked service name>/<secret name>/<secret version>` .
      
   1. Установите флажок **32-разрядная среда выполнения** , чтобы указать, требуется ли для пакета выполнение 32-разрядной среды выполнения.

   1. В качестве **расположения пакета**выберите **SSISDB**, **Файловая система (пакет)**, **Файловая система (проект)**, **Внедренный пакет**или **хранилище пакетов**. 

##### <a name="package-location-ssisdb"></a>Расположение пакета: SSISDB

**SSISDB** , так как расположение пакета выбирается автоматически, если Azure-SSIS IR был подготовлен с помощью каталога SSIS (SSISDB), размещенного на сервере базы данных SQL Azure или управляемый экземпляр, или вы можете выбрать его самостоятельно. Если он выбран, выполните следующие действия.

   1. Если Azure-SSIS IR работает, а флажок **записи вручную** снят, найдите и выберите существующие папки, проекты, пакеты и среды из SSISDB. Выберите **Обновить** , чтобы получить только что добавленные папки, проекты, пакеты или среды из SSISDB, чтобы они были доступны для обзора и выбора. Чтобы просмотреть и выбрать среды для выполнения пакета, необходимо заранее настроить проекты, чтобы добавить эти среды в качестве ссылок из тех же папок в SSISDB. Дополнительные сведения см. в разделе [Создание и сопоставьте среды SSIS](https://docs.microsoft.com/sql/integration-services/packages/deploy-integration-services-ssis-projects-and-packages).

   1. Для **уровня ведения журнала** выберите предопределенную область ведения журнала для выполнения пакета. Установите флажок **настроено** , если хотите вместо этого ввести настраиваемое имя журнала. 

   1. Если Azure-SSIS IR не запущена или флажок **записи вручную** установлен, введите путь к пакету и среде из SSISDB непосредственно в следующих форматах: `<folder name>/<project name>/<package name>.dtsx` и `<folder name>/<environment name>` .

      ![Установка свойств на вкладке "Параметры" вручную](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-settings2.png)

##### <a name="package-location-file-system-package"></a>Расположение пакета: файловая система (пакет)

**Файловая система (пакет)** , как и расположение пакета, выбирается автоматически, если Azure-SSIS IR была подготовлена без SSISDB, или вы можете выбрать ее самостоятельно. Если он выбран, выполните следующие действия.

![Задание свойств на вкладке «Параметры» — файловая система (пакет)](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-settings3.png)
   
   1. Укажите, какой пакет следует запустить, указав UNC-путь к файлу пакета (с помощью `.dtsx` ) в поле **путь к пакету** . Чтобы просмотреть и выбрать пакет, выберите **Обзор хранилища файлов** или введите путь вручную. Например, если пакет хранится в службе файлов Azure, путь к нему будет иметь значение `\\<storage account name>.file.core.windows.net\<file share name>\<package name>.dtsx` . 
   
   1. Если пакет настроен в отдельном файле, необходимо также указать UNC-путь к файлу конфигурации (с `.dtsConfig` ) в поле **путь конфигурации** . Чтобы просмотреть и выбрать конфигурацию, выберите **Обзор хранилища файлов** или введите путь вручную. Например, если вы храните конфигурацию в службе файлов Azure, ее путь к папке — `\\<storage account name>.file.core.windows.net\<file share name>\<configuration name>.dtsConfig` .

   1. Укажите учетные данные для доступа к пакету и файлам конфигурации. Если ранее были введены значения учетных данных для выполнения пакета (для **проверки подлинности Windows**), их можно повторно использовать, установив флажок **учетные данные выполнения пакета** . В противном случае введите значения учетных данных для доступа к пакету в полях **домен**, **имя пользователя**и **пароль** . Например, если вы храните пакет и конфигурацию в службе "файлы Azure", домен имеет значение `Azure` , имя пользователя — `<storage account name>` , а пароль — `<storage account key>` . 

      Кроме того, в качестве значений можно использовать секреты, хранящиеся в Azure Key Vault. Для этого установите флажок **хранилище ключей Azure** рядом с ним. Выберите или измените существующую связанную службу хранилища ключей или создайте новую. Затем выберите имя секрета и версию для своего значения. При создании или изменении связанной службы хранилища ключей можно выбрать или изменить существующее хранилище ключей или создать новое. Не забудьте предоставить управляемой идентификации фабрики данных доступ к хранилищу ключей, если это еще не сделано. Вы также можете ввести секрет непосредственно в следующем формате: `<key vault linked service name>/<secret name>/<secret version>` . 

      Эти учетные данные также используются для доступа к дочерним пакетам в задаче «Выполнение пакета», на которые ссылается собственный путь и другие конфигурации, указанные в пакетах. 

   1. Если вы использовали уровень защиты **EncryptAllWithPassword** или **EncryptSensitiveWithPassword** при создании пакета с помощью SQL Server Data Tools (SSDT), введите значение пароля в поле **пароль шифрования** . Кроме того, можно использовать секрет, хранящийся в Azure Key Vault в качестве значения (см. выше).
      
      Если вы использовали уровень защиты **EncryptSensitiveWithUserKey** , повторно введите конфиденциальные значения в файлах конфигурации или на вкладках **Параметры служб SSIS**, **Диспетчеры соединений**или **переопределения свойств** (см. ниже).
      
      Если вы использовали уровень защиты **EncryptAllWithUserKey** , он не поддерживается. Необходимо перенастроить пакет для использования другого уровня защиты с помощью SSDT или `dtutil` служебной программы командной строки. 

   1. Для **уровня ведения журнала** выберите предопределенную область ведения журнала для выполнения пакета. Установите флажок **настроено** , если хотите вместо этого ввести настраиваемое имя журнала. 
   
   1. Если вы хотите регистрировать выполнение пакета, не используя стандартные регистраторы, которые можно указать в пакете, укажите папку журнала, указав UNC-путь в поле **путь к журналу** . Чтобы просмотреть и выбрать папку журнала, выберите **Обзор хранилища файлов** или введите путь вручную. Например, если вы храните журналы в службе файлов Azure, ваш путь к журналу будет иметь значение `\\<storage account name>.file.core.windows.net\<file share name>\<log folder name>` . В этом пути создается вложенная папка для каждого выполняемого пакета, названная после идентификатора запуска действия "выполнение пакета служб SSIS" и в котором файлы журнала создаются каждые пять минут. 
   
   1. Укажите учетные данные для доступа к папке журнала. Если вы ранее указали значения для учетных данных для доступа к пакету (см. выше), их можно повторно использовать, установив флажок **учетные данные для доступа к пакету** . В противном случае введите значения учетных данных для доступа к журналу в полях **домен**, **имя пользователя**и **пароль** . Например, если вы храните журналы в службе файлов Azure, домен имеет значение `Azure` , имя пользователя — `<storage account name>` , а пароль — `<storage account key>` . Кроме того, можно использовать секреты, хранящиеся в Azure Key Vault, как их значения (см. выше).
   
Для всех перечисленных UNC-путей полное имя файла должно содержать менее 260 символов. Имя каталога должно содержать менее 248 символов.

##### <a name="package-location-file-system-project"></a>Расположение пакета: файловая система (проект)

Если в качестве расположения пакета выбрана **Файловая система (проект)** , выполните следующие действия.

![Задание свойств на вкладке «Параметры» — файловая система (проект)](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-settings4.png)

   1. Укажите путь в формате UNC к файлу проекта (с `.ispac` ) в поле **путь к проекту** и файл пакета (с `.dtsx` ) из проекта в поле **имя пакета** . Чтобы просмотреть и выбрать проект, выберите **Обзор хранилища файлов** или введите путь вручную. Например, если вы храните проект в службе файлов Azure, путь к нему будет иметь значение `\\<storage account name>.file.core.windows.net\<file share name>\<project name>.ispac` .

   1. Укажите учетные данные для доступа к файлам проекта и пакета. Если ранее были введены значения учетных данных для выполнения пакета (для **проверки подлинности Windows**), их можно повторно использовать, установив флажок **учетные данные выполнения пакета** . В противном случае введите значения учетных данных для доступа к пакету в полях **домен**, **имя пользователя**и **пароль** . Например, если вы храните проект и пакет в службе файлов Azure, домен имеет значение `Azure` , имя пользователя — `<storage account name>` , а пароль — `<storage account key>` . 

      Кроме того, в качестве значений можно использовать секреты, хранящиеся в Azure Key Vault. Для этого установите флажок **хранилище ключей Azure** рядом с ним. Выберите или измените существующую связанную службу хранилища ключей или создайте новую. Затем выберите имя секрета и версию для своего значения. При создании или изменении связанной службы хранилища ключей можно выбрать или изменить существующее хранилище ключей или создать новое. Не забудьте предоставить управляемой идентификации фабрики данных доступ к хранилищу ключей, если это еще не сделано. Вы также можете ввести секрет непосредственно в следующем формате: `<key vault linked service name>/<secret name>/<secret version>` . 

      Эти учетные данные также используются для доступа к дочерним пакетам в задаче «Выполнение пакета», на которые ссылается один и тот же проект. 

   1. Если вы использовали уровень защиты **EncryptAllWithPassword** или **EncryptSensitiveWithPassword** при создании пакета через SSDT, введите значение пароля в поле **пароль шифрования** . Кроме того, можно использовать секрет, хранящийся в Azure Key Vault в качестве значения (см. выше).
      
      Если вы использовали уровень защиты **EncryptSensitiveWithUserKey** , повторно введите конфиденциальные значения на вкладках **Параметры служб SSIS**, **Диспетчеры соединений**или **переопределения свойств** (см. ниже).
      
      Если вы использовали уровень защиты **EncryptAllWithUserKey** , он не поддерживается. Необходимо перенастроить пакет для использования другого уровня защиты с помощью SSDT или `dtutil` служебной программы командной строки. 

   1. Для **уровня ведения журнала** выберите предопределенную область ведения журнала для выполнения пакета. Установите флажок **настроено** , если хотите вместо этого ввести настраиваемое имя журнала. 
   
   1. Если вы хотите регистрировать выполнение пакета, не используя стандартные регистраторы, которые можно указать в пакете, укажите папку журнала, указав UNC-путь в поле **путь к журналу** . Чтобы просмотреть и выбрать папку журнала, выберите **Обзор хранилища файлов** или введите путь вручную. Например, если вы храните журналы в службе файлов Azure, ваш путь к журналу будет иметь значение `\\<storage account name>.file.core.windows.net\<file share name>\<log folder name>` . В этом пути создается вложенная папка для каждого выполняемого пакета, названная после идентификатора запуска действия "выполнение пакета служб SSIS" и в котором файлы журнала создаются каждые пять минут. 
   
   1. Укажите учетные данные для доступа к папке журнала. Если вы ранее указали значения для учетных данных для доступа к пакету (см. выше), их можно повторно использовать, установив флажок **учетные данные для доступа к пакету** . В противном случае введите значения учетных данных для доступа к журналу в полях **домен**, **имя пользователя**и **пароль** . Например, если вы храните журналы в службе файлов Azure, домен имеет значение `Azure` , имя пользователя — `<storage account name>` , а пароль — `<storage account key>` . Кроме того, можно использовать секреты, хранящиеся в Azure Key Vault, как их значения (см. выше).
   
Для всех перечисленных UNC-путей полное имя файла должно содержать менее 260 символов. Имя каталога должно содержать менее 248 символов.

##### <a name="package-location-embedded-package"></a>Расположение пакета: внедренный пакет

При выборе в качестве расположения пакета **внедренного пакета** выполните следующие действия.

![Задание свойств на вкладке «Параметры» — встроенный пакет](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-settings5.png)

   1. Перетащите файл пакета (с `.dtsx` ) или **отправьте** его из папки с файлами в предоставленное поле. Пакет будет автоматически сжат и внедрен в полезные данные действия. После внедрения можно **загрузить** пакет позже для редактирования. Можно также **параметризовать** внедренный пакет, назначив его параметру конвейера, который может использоваться в нескольких действиях, таким образом, оптимизируя размер полезных данных конвейера. Внедрение файлов проекта (с `.ispac` ) в настоящее время не поддерживается, поэтому нельзя использовать параметры служб SSIS и диспетчеры соединений с областью действия уровня проекта во внедренных пакетах.
   
   1. Если встроенный пакет не зашифрован и в нем обнаружено использование задачи «Выполнение пакета» (EPT), то флажок « **выполнение пакета** » будет автоматически установлен, а дочерние пакеты, на которые ссылается путь к файловой системе, будут добавлены автоматически, поэтому их также можно внедрить.
   
      Если мы не можем обнаружить использование EPT, необходимо вручную установить флажок " **выполнить задачу пакета** " и добавить дочерние пакеты, на которые ссылается путь файловой системы, по одному, чтобы их также можно было внедрить. Если дочерние пакеты хранятся в базе данных SQL Server (MSDB), их нельзя внедрить, поэтому необходимо убедиться, что Azure-SSIS IR может получить доступ к базе MSDB для их получения с помощью SQL Serverных ссылок. Внедрение файлов проекта (с `.ispac` ) в настоящее время не поддерживается, поэтому нельзя использовать ссылки на основе проекта для дочерних пакетов.
   
   1. Если вы использовали уровень защиты **EncryptAllWithPassword** или **EncryptSensitiveWithPassword** при создании пакета через SSDT, введите значение пароля в поле **пароль шифрования** . 
   
      Кроме того, в качестве значения можно использовать секрет, хранящийся в Azure Key Vault. Для этого установите флажок **хранилище ключей Azure** рядом с ним. Выберите или измените существующую связанную службу хранилища ключей или создайте новую. Затем выберите имя секрета и версию для своего значения. При создании или изменении связанной службы хранилища ключей можно выбрать или изменить существующее хранилище ключей или создать новое. Не забудьте предоставить управляемой идентификации фабрики данных доступ к хранилищу ключей, если это еще не сделано. Вы также можете ввести секрет непосредственно в следующем формате: `<key vault linked service name>/<secret name>/<secret version>` .
      
      Если вы использовали уровень защиты **EncryptSensitiveWithUserKey** , повторно введите конфиденциальные значения в файлах конфигурации или на вкладках **Параметры служб SSIS**, **Диспетчеры соединений**или **переопределения свойств** (см. ниже).
      
      Если вы использовали уровень защиты **EncryptAllWithUserKey** , он не поддерживается. Необходимо перенастроить пакет для использования другого уровня защиты с помощью SSDT или `dtutil` служебной программы командной строки.

   1. Для **уровня ведения журнала** выберите предопределенную область ведения журнала для выполнения пакета. Установите флажок **настроено** , если хотите вместо этого ввести настраиваемое имя журнала. 
   
   1. Если вы хотите регистрировать выполнение пакета, не используя стандартные регистраторы, которые можно указать в пакете, укажите папку журнала, указав UNC-путь в поле **путь к журналу** . Чтобы просмотреть и выбрать папку журнала, выберите **Обзор хранилища файлов** или введите путь вручную. Например, если вы храните журналы в службе файлов Azure, ваш путь к журналу будет иметь значение `\\<storage account name>.file.core.windows.net\<file share name>\<log folder name>` . В этом пути создается вложенная папка для каждого выполняемого пакета, названная после идентификатора запуска действия "выполнение пакета служб SSIS" и в котором файлы журнала создаются каждые пять минут. 
   
   1. Укажите учетные данные для доступа к папке журнала, введя их значения в полях **домен**, **имя пользователя**и **пароль** . Например, если вы храните журналы в службе файлов Azure, домен имеет значение `Azure` , имя пользователя — `<storage account name>` , а пароль — `<storage account key>` . Кроме того, можно использовать секреты, хранящиеся в Azure Key Vault, как их значения (см. выше).
   
Для всех перечисленных UNC-путей полное имя файла должно содержать менее 260 символов. Имя каталога должно содержать менее 248 символов.

##### <a name="package-location-package-store"></a>Расположение пакета: хранилище пакетов

Если в качестве расположения пакета выбрано **хранилище пакетов** , выполните следующие действия.

![Задание свойств на вкладке "Параметры" — хранилище пакетов](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-settings6.png)
   
   1. В качестве **имени хранилища пакетов**выберите существующее хранилище пакетов, присоединенное к Azure-SSIS IR.

   1. Укажите для запуска пакет, указав его путь (без `.dtsx` ) в выбранном хранилище пакетов в поле **путь к пакету** . Если выбранное хранилище пакетов находится поверх файлов файловой системы или Azure, можно просмотреть и выбрать пакет, выбрав пункт **Обзор хранилища файлов**. в противном случае можно ввести путь в формате `<folder name>\<package name>` . Вы также можете импортировать новые пакеты в выбранное хранилище пакетов с помощью SQL Server Management Studio (SSMS), аналогичного [устаревшему хранилищу пакетов служб SSIS](https://docs.microsoft.com/sql/integration-services/service/package-management-ssis-service?view=sql-server-2017). Дополнительные сведения см. в статье [Управление пакетами SSIS с помощью хранилищ пакетов Azure-SSIS IR](https://docs.microsoft.com/azure/data-factory/azure-ssis-integration-runtime-package-store).

   1. При настройке пакета в отдельном файле необходимо указать UNC-путь к файлу конфигурации (с `.dtsConfig` ) в поле **путь конфигурации** . Чтобы просмотреть и выбрать конфигурацию, выберите **Обзор хранилища файлов** или введите путь вручную. Например, если вы храните конфигурацию в службе файлов Azure, ее путь к папке — `\\<storage account name>.file.core.windows.net\<file share name>\<configuration name>.dtsConfig` .

   1. Установите флажок **учетные данные для доступа к конфигурации** , чтобы выбрать, следует ли указывать учетные данные для доступа к файлу конфигурации отдельно. Это необходимо, если выбранное хранилище пакетов находится поверх SQL Server базы данных (MSDB), размещенной в Управляемый экземпляр SQL Azure, или файл конфигурации также не хранится.
   
      Если ранее были введены значения учетных данных для выполнения пакета (для **проверки подлинности Windows**), их можно повторно использовать, установив флажок **учетные данные выполнения пакета** . В противном случае введите значения для учетных данных доступа к конфигурации в полях **домен**, **имя пользователя**и **пароль** . Например, если вы храните конфигурацию в службе файлов Azure, домен имеет значение `Azure` , имя пользователя — `<storage account name>` , а пароль — `<storage account key>` . 

      Кроме того, в качестве значений можно использовать секреты, хранящиеся в Azure Key Vault. Для этого установите флажок **хранилище ключей Azure** рядом с ним. Выберите или измените существующую связанную службу хранилища ключей или создайте новую. Затем выберите имя секрета и версию для своего значения. При создании или изменении связанной службы хранилища ключей можно выбрать или изменить существующее хранилище ключей или создать новое. Не забудьте предоставить управляемой идентификации фабрики данных доступ к хранилищу ключей, если это еще не сделано. Вы также можете ввести секрет непосредственно в следующем формате: `<key vault linked service name>/<secret name>/<secret version>` .

   1. Если вы использовали уровень защиты **EncryptAllWithPassword** или **EncryptSensitiveWithPassword** при создании пакета через SSDT, введите значение пароля в поле **пароль шифрования** . Кроме того, можно использовать секрет, хранящийся в Azure Key Vault в качестве значения (см. выше).
      
      Если вы использовали уровень защиты **EncryptSensitiveWithUserKey** , повторно введите конфиденциальные значения в файлах конфигурации или на вкладках **Параметры служб SSIS**, **Диспетчеры соединений**или **переопределения свойств** (см. ниже).
      
      Если вы использовали уровень защиты **EncryptAllWithUserKey** , он не поддерживается. Необходимо перенастроить пакет для использования другого уровня защиты с помощью SSDT или `dtutil` служебной программы командной строки. 

   1. Для **уровня ведения журнала** выберите предопределенную область ведения журнала для выполнения пакета. Установите флажок **настроено** , если хотите вместо этого ввести настраиваемое имя журнала. 
   
   1. Если вы хотите регистрировать выполнение пакета, не используя стандартные регистраторы, которые можно указать в пакете, укажите папку журнала, указав UNC-путь в поле **путь к журналу** . Чтобы просмотреть и выбрать папку журнала, выберите **Обзор хранилища файлов** или введите путь вручную. Например, если вы храните журналы в службе файлов Azure, ваш путь к журналу будет иметь значение `\\<storage account name>.file.core.windows.net\<file share name>\<log folder name>` . В этом пути создается вложенная папка для каждого выполняемого пакета, названная после идентификатора запуска действия "выполнение пакета служб SSIS" и в котором файлы журнала создаются каждые пять минут. 
   
   1. Укажите учетные данные для доступа к папке журнала, введя их значения в полях **домен**, **имя пользователя**и **пароль** . Например, если вы храните журналы в службе файлов Azure, домен имеет значение `Azure` , имя пользователя — `<storage account name>` , а пароль — `<storage account key>` . Кроме того, можно использовать секреты, хранящиеся в Azure Key Vault, как их значения (см. выше).
   
Для всех перечисленных UNC-путей полное имя файла должно содержать менее 260 символов. Имя каталога должно содержать менее 248 символов.

#### <a name="ssis-parameters-tab"></a>Вкладка "Параметры служб SSIS"

На вкладке **Параметры служб SSIS** действия выполнение пакета служб SSIS выполните следующие действия.

![Установка свойств на вкладке SSIS Parameters (Параметры SSIS)](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-ssis-parameters.png)

   1. Если Azure-SSIS IR выполняется, в качестве расположения пакета выбирается **SSISDB** , а флажок **записи вручную** на вкладке " **Параметры** " снят, существующие параметры служб SSIS в выбранном проекте и пакете из SSISDB отображаются для назначения им значений. В противном случае их можно ввести один за другим, чтобы присвоить им значения вручную. Убедитесь, что они существуют и правильно введены для успешной выполнения пакета. 
   
   1. Если вы использовали уровень защиты **EncryptSensitiveWithUserKey** при создании пакета через SSDT, **Файловая система (пакет)**, **Файловая система (проект)**, **Внедренный пакет**или **хранилище пакетов** выбраны в качестве расположения пакета, также необходимо повторно ввести конфиденциальные параметры, чтобы присвоить им значения на этой вкладке. 
   
При назначении значений параметрам можно добавлять динамическое содержимое с помощью выражений, функций, системных переменных фабрики данных и параметров конвейера фабрики данных или переменных.

Кроме того, в качестве значений можно использовать секреты, хранящиеся в Azure Key Vault. Для этого установите флажок **хранилище ключей Azure** рядом с ним. Выберите или измените существующую связанную службу хранилища ключей или создайте новую. Затем выберите имя секрета и версию для своего значения. При создании или изменении связанной службы хранилища ключей можно выбрать или изменить существующее хранилище ключей или создать новое. Не забудьте предоставить управляемой идентификации фабрики данных доступ к хранилищу ключей, если это еще не сделано. Вы также можете ввести секрет непосредственно в следующем формате: `<key vault linked service name>/<secret name>/<secret version>` . 

#### <a name="connection-managers-tab"></a>Вкладка "Диспетчеры подключений"

На вкладке **Диспетчеры соединений** действия выполнение пакета служб SSIS выполните следующие действия.

![Установка свойств на вкладке Connection Managers (Диспетчеры подключений)](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-connection-managers.png)

   1. Если Azure-SSIS IR выполняется, в качестве расположения пакета выбирается **SSISDB** , а флажок **записи вручную** на вкладке " **Параметры** " снят, существующие диспетчеры соединений в выбранном проекте и пакет из SSISDB отображаются для присвоения значений их свойствам. В противном случае их можно ввести один за другим, чтобы присвоить значения их свойствам вручную. Убедитесь, что они существуют и правильно введены для успешной выполнения пакета. 
   
      Чтобы получить правильные имена **области**, **имени**и **свойств** для любого диспетчера соединений, откройте пакет, содержащий его в SSDT. После открытия пакета выберите соответствующий диспетчер соединений, чтобы отобразить имена и значения всех его свойств в окне **Свойства** SSDT. С помощью этих сведений можно переопределить значения всех свойств диспетчера соединений во время выполнения. 

      ![Получение свойств диспетчера соединений из SSDT](media/how-to-invoke-ssis-package-ssis-activity/ssdt-connection-manager-properties.png)

      Например, без изменения исходного пакета в SSDT можно преобразовать локальные и локальные потоки данных, работающие на SQL Server, в потоки данных из локальной среды в облако, работающие в среде SSIS IR в ADF путем переопределения значений свойств **коннектбипрокси**, **ConnectionString**и **коннектусингманажедидентити** в существующих диспетчерах соединений во время выполнения.
      
      Эти переопределения времени выполнения могут включать локально размещаемый IR-файл (шир) в качестве прокси для служб SSIS IR при доступе к данным в локальной среде. см. раздел [Настройка Шир в качестве прокси-сервера для служб SSIS IR](https://docs.microsoft.com/azure/data-factory/self-hosted-integration-runtime-proxy-ssis), а также подключения к базе данных SQL Azure и управляемый экземпляр с помощью последнего драйвера мсоледбскл, который, в свою очередь, Azure Active Directory обеспечивает проверку [подлинности AAD с](https://docs.microsoft.com/sql/integration-services/connection-manager/ole-db-connection-manager?view=sql-server-ver15#managed-identities-for-azure-resources-authentication)управляемым удостоверением ADF

      ![Задание свойств из SSDT на вкладке Диспетчеры соединений](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-connection-managers2.png)
   
   1. Если вы использовали уровень защиты **EncryptSensitiveWithUserKey** при создании пакета через SSDT, **Файловая система (пакет)**, **Файловая система (проект)**, **Внедренный пакет**или **хранилище пакетов** выбраны в качестве расположения пакета, также необходимо повторно ввести конфиденциальные свойства диспетчера подключений, чтобы назначить им значения на этой вкладке. 

При назначении значений свойствам диспетчера соединений можно добавить динамическое содержимое с помощью выражений, функций, системных переменных фабрики данных и параметров конвейера фабрики данных или переменных. 

Кроме того, в качестве значений можно использовать секреты, хранящиеся в Azure Key Vault. Для этого установите флажок **хранилище ключей Azure** рядом с ним. Выберите или измените существующую связанную службу хранилища ключей или создайте новую. Затем выберите имя секрета и версию для своего значения. При создании или изменении связанной службы хранилища ключей можно выбрать или изменить существующее хранилище ключей или создать новое. Не забудьте предоставить управляемой идентификации фабрики данных доступ к хранилищу ключей, если это еще не сделано. Вы также можете ввести секрет непосредственно в следующем формате: `<key vault linked service name>/<secret name>/<secret version>` . 

#### <a name="property-overrides-tab"></a>Вкладка "переопределения свойств"

На вкладке **переопределения свойств** действия выполнение пакета служб SSIS выполните следующие действия.

![Установка свойств на вкладке Property Overrides (Переопределения свойств)](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-property-overrides.png)

   1. Введите пути существующих свойств в выбранном пакете по одному, чтобы назначить значения для них вручную. Убедитесь, что они существуют и правильно введены для успешной выполнения пакета. Например, чтобы переопределить значение пользовательской переменной, введите ее путь в следующем формате: `\Package.Variables[User::<variable name>].Value` . 

      Чтобы получить правильный **путь к свойству** для любого свойства пакета, откройте пакет, содержащий его в SSDT. После открытия пакета выберите его свойство поток управления и **конфигурации** в окне **свойства** SSDT. Затем нажмите кнопку с многоточием (**...**) рядом со свойством **конфигурации** , чтобы открыть **Организатор конфигураций пакетов** , который обычно используется для [создания конфигураций пакетов в модели развертывания пакетов](https://docs.microsoft.com/sql/integration-services/packages/legacy-package-deployment-ssis#create-package-configurations). 

      ![Получение свойств пакета из свойства SSDT-Configurations](media/how-to-invoke-ssis-package-ssis-activity/ssdt-package-properties.png)

      На странице **Организатор конфигураций пакетов**установите флажок **Включить конфигурации пакетов** и нажмите кнопку **Добавить...** , чтобы открыть **Мастер настройки пакета**. 
      
      В **мастере настройки пакета**выберите элемент **XML-файл конфигурации** в раскрывающемся меню **тип конфигурации** и нажмите кнопку **указать параметры конфигурации напрямую** , введите имя файла конфигурации и нажмите кнопку **Далее >** . 

      ![Получение свойств пакета из SSDT — Организатор конфигураций](media/how-to-invoke-ssis-package-ssis-activity/ssdt-package-properties2.png)

      Наконец, выберите Свойства пакета, путь к которым требуется и нажмите кнопку **далее >** .  Теперь можно увидеть, скопировать & Вставьте нужные пути свойств пакета и сохраните их в файле конфигурации. С помощью этих сведений можно переопределить значения любых свойств пакета во время выполнения. 

      ![Получение свойств пакета из SSDT — мастер настройки](media/how-to-invoke-ssis-package-ssis-activity/ssdt-package-properties3.png)
   
   1. Если вы использовали уровень защиты **EncryptSensitiveWithUserKey** при создании пакета через SSDT, **Файловая система (пакет)**, **Файловая система (проект)**, **Внедренный пакет**или **хранилище пакетов** выбраны в качестве расположения пакета, также необходимо повторно ввести конфиденциальные свойства пакета, чтобы назначить им значения на этой вкладке. 
   
При назначении значений свойствам пакета можно добавить динамическое содержимое с помощью выражений, функций, системных переменных фабрики данных и параметров конвейера фабрики данных или переменных.

Значения, назначенные в файлах конфигурации и на вкладке **Параметры служб SSIS** , можно переопределить с помощью вкладок **Диспетчеры соединений** или **переопределения свойств** . Значения, назначенные на вкладке **Диспетчеры соединений** , также можно переопределить с помощью вкладки **переопределения свойств** .

Чтобы проверить конфигурацию конвейера, на панели инструментов выберите **проверить** . Чтобы закрыть **отчет о проверке конвейера**, выберите **>>** .

Чтобы опубликовать конвейер в фабрике данных, выберите **опубликовать все**. 

### <a name="run-the-pipeline"></a>Запуск конвейера
На этом шаге вы активируете выполнение конвейера. 

1. Чтобы запустить конвейер, выберите **триггер** на панели инструментов и щелкните **Активировать сейчас**. 

   ![Trigger Now (Активировать сейчас)](./media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-trigger.png)

2. На странице **Запуск конвейера** нажмите кнопку **Готово**. 

### <a name="monitor-the-pipeline"></a>Мониторинг конвейера

1. Перейдите на вкладку **Мониторинг** слева. Вы увидите выполнение конвейера и его состояние, а также другие сведения, например время **запуска запуска** . Чтобы обновить список, нажмите кнопку **Обновить**.

   ![Запуски конвейера](./media/how-to-invoke-ssis-package-stored-procedure-activity/pipeline-runs.png)

2. Выберите ссылку **View Activity Runs** (Просмотр запусков действий) в столбце **Действия**. Вы увидите, что выполняется только одно действие, так как конвейер содержит только одно действие. Это действие выполнение пакета служб SSIS.

   ![Выполнение действия](./media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-runs.png)

3. Выполните следующий запрос к базе данных SSISDB на сервере SQL Server, чтобы убедиться, что пакет выполнен. 

   ```sql
   select * from catalog.executions
   ```

   ![Проверка выполнения пакета](./media/how-to-invoke-ssis-package-stored-procedure-activity/verify-package-executions.png)

4. Можно также получить идентификатор выполнения SSISDB из выходных данных выполнения действия конвейера и использовать идентификатор для проверки более полных журналов выполнения и сообщений об ошибках в SQL Server Management Studio.

   ![Получите идентификатор выполнения.](media/how-to-invoke-ssis-package-ssis-activity/get-execution-id.png)

### <a name="schedule-the-pipeline-with-a-trigger"></a>Запуск конвейера по расписанию с помощью триггера

Вы также можете создать запланированный триггер для конвейера, чтобы конвейер выполнялся по расписанию, например ежечасно или ежедневно. Пример см. в разделе [Запуск конвейера по расписанию](quickstart-create-data-factory-portal.md#trigger-the-pipeline-on-a-schedule).

## <a name="run-a-package-with-powershell"></a>Выполнение пакета с помощью PowerShell
В этом разделе используется Azure PowerShell для создания конвейера фабрики данных с действием выполнить пакет служб SSIS, которое выполняет пакет служб SSIS. 

Чтобы установить модули Azure PowerShell, выполните пошаговые инструкции из [этой статьи](/powershell/azure/install-az-ps).

### <a name="create-a-data-factory-with-azure-ssis-ir"></a>Создание фабрики данных с Azure-SSIS IR
Вы можете использовать существующую фабрику данных, уже имеющую Azure-SSIS IR подготовлена, или создать новую фабрику данных с Azure-SSIS IR. Выполните пошаговые инструкции из [руководства Развертывание пакетов служб SSIS в Azure с помощью PowerShell](https://docs.microsoft.com/azure/data-factory/tutorial-deploy-ssis-packages-azure-powershell).

### <a name="create-a-pipeline-with-an-execute-ssis-package-activity"></a>Создание конвейера с действием "Выполнить пакет SSIS" 
На этом этапе создается конвейер с действием "Выполнить пакет SSIS". Это действие запускает пакет SSIS. 

1. Создайте JSON-файл с именем `RunSSISPackagePipeline.json` в `C:\ADF\RunSSISPackage` папке с содержимым, аналогичным приведенному в следующем примере.

   > [!IMPORTANT]
   > Перед сохранением файла замените имена объектов, описания и пути, значения свойств или параметров, пароли и другие значения переменных. 
    
   ```json
   {
       "name": "RunSSISPackagePipeline",
       "properties": {
           "activities": [{
               "name": "MySSISActivity",
               "description": "My SSIS package/activity description",
               "type": "ExecuteSSISPackage",
               "typeProperties": {
                   "connectVia": {
                       "referenceName": "MyAzureSSISIR",
                       "type": "IntegrationRuntimeReference"
                   },
                   "executionCredential": {
                       "domain": "MyExecutionDomain",
                       "username": "MyExecutionUsername",
                       "password": {
                           "type": "SecureString",
                           "value": "MyExecutionPassword"
                       }
                   },
                   "runtime": "x64",
                   "loggingLevel": "Basic",
                   "packageLocation": {
                       "type": "SSISDB",
                       "packagePath": "MyFolder/MyProject/MyPackage.dtsx"
                   },
                   "environmentPath": "MyFolder/MyEnvironment",
                   "projectParameters": {
                       "project_param_1": {
                           "value": "123"
                       },
                       "project_param_2": {
                           "value": {
                               "value": "@pipeline().parameters.MyProjectParameter",
                               "type": "Expression"
                           }
                       }
                   },
                   "packageParameters": {
                       "package_param_1": {
                           "value": "345"
                       },
                       "package_param_2": {
                           "value": {
                               "type": "AzureKeyVaultSecret",
                               "store": {
                                   "referenceName": "myAKV",
                                   "type": "LinkedServiceReference"
                               },
                               "secretName": "MyPackageParameter"
                           }
                       }
                   },
                   "projectConnectionManagers": {
                       "MyAdonetCM": {
                           "username": {
                               "value": "MyConnectionUsername"
                           },
                           "password": {
                               "value": {
                                   "type": "SecureString",
                                   "value": "MyConnectionPassword"
                               }
                           }
                       }
                   },
                   "packageConnectionManagers": {
                       "MyOledbCM": {
                           "username": {
                               "value": {
                                   "value": "@pipeline().parameters.MyConnectionUsername",
                                   "type": "Expression"
                               }
                           },
                           "password": {
                               "value": {
                                   "type": "AzureKeyVaultSecret",
                                   "store": {
                                       "referenceName": "myAKV",
                                       "type": "LinkedServiceReference"
                                   },
                                   "secretName": "MyConnectionPassword",
                                   "secretVersion": "MyConnectionPasswordVersion"
                               }
                           }
                       }
                   },
                   "propertyOverrides": {
                       "\\Package.MaxConcurrentExecutables": {
                           "value": 8,
                           "isSensitive": false
                       }
                   }
               },
               "policy": {
                   "timeout": "0.01:00:00",
                   "retry": 0,
                   "retryIntervalInSeconds": 30
               }
           }]
       }
   }
   ```

   Для выполнения пакетов, хранящихся в файловой системе или службе файлов Azure, введите значения свойств пакета и расположения журнала следующим образом:

   ```json
   {
       {
           {
               {
                   "packageLocation": {
                       "type": "File",
                       "packagePath": "//MyStorageAccount.file.core.windows.net/MyFileShare/MyPackage.dtsx",
                       "typeProperties": {
                           "packagePassword": {
                               "type": "SecureString",
                               "value": "MyEncryptionPassword"
                           },
                           "accessCredential": {
                               "domain": "Azure",
                               "username": "MyStorageAccount",
                               "password": {
                                   "type": "SecureString",
                                   "value": "MyAccountKey"
                               }
                           }
                       }
                   },
                   "logLocation": {
                       "type": "File",
                       "logPath": "//MyStorageAccount.file.core.windows.net/MyFileShare/MyLogFolder",
                       "typeProperties": {
                           "accessCredential": {
                               "domain": "Azure",
                               "username": "MyStorageAccount",
                               "password": {
                                   "type": "AzureKeyVaultSecret",
                                   "store": {
                                       "referenceName": "myAKV",
                                       "type": "LinkedServiceReference"
                                   },
                                   "secretName": "MyAccountKey"
                               }
                           }
                       }
                   }
               }
           }
       }
   }
   ```

   Для выполнения пакетов в проектах, хранящихся в файловой системе или службе файлов Azure, введите значения свойств расположения пакета следующим образом:

   ```json
   {
       {
           {
               {
                   "packageLocation": {
                       "type": "File",
                       "packagePath": "//MyStorageAccount.file.core.windows.net/MyFileShare/MyProject.ispac:MyPackage.dtsx",
                       "typeProperties": {
                           "packagePassword": {
                               "type": "SecureString",
                               "value": "MyEncryptionPassword"
                           },
                           "accessCredential": {
                               "domain": "Azure",
                               "userName": "MyStorageAccount",
                               "password": {
                                   "type": "SecureString",
                                   "value": "MyAccountKey"
                               }
                           }
                       }
                   }
               }
           }
       }
   }
   ```

   Чтобы выполнить внедренные пакеты, введите значения свойств расположения пакета следующим образом:

   ```json
   {
       {
           {
               {
                   "packageLocation": {
                       "type": "InlinePackage",
                       "typeProperties": {
                           "packagePassword": {
                               "type": "SecureString",
                               "value": "MyEncryptionPassword"
                           },
                           "packageName": "MyPackage.dtsx",
                           "packageContent":"My compressed/uncompressed package content",
                           "packageLastModifiedDate": "YYYY-MM-DDTHH:MM:SSZ UTC-/+HH:MM"
                       }
                   }
               }
           }
       }
   }
   ```

   Чтобы выполнить пакеты, хранящиеся в хранилищах пакетов, введите значения свойств пакета и расположения конфигурации следующим образом:

   ```json
   {
       {
           {
               {
                   "packageLocation": {
                       "type": "PackageStore",
                       "packagePath": "myPackageStore/MyFolder/MyPackage",
                       "typeProperties": {
                           "packagePassword": {
                               "type": "SecureString",
                               "value": "MyEncryptionPassword"
                           },
                           "accessCredential": {
                               "domain": "Azure",
                               "username": "MyStorageAccount",
                               "password": {
                                   "type": "SecureString",
                                   "value": "MyAccountKey"
                               }
                           },
                           "configurationPath": "//MyStorageAccount.file.core.windows.net/MyFileShare/MyConfiguration.dtsConfig",
                           "configurationAccessCredential": {
                               "domain": "Azure",
                               "userName": "MyStorageAccount",
                               "password": {
                                   "type": "AzureKeyVaultSecret",
                                   "store": {
                                       "referenceName": "myAKV",
                                       "type": "LinkedServiceReference"
                                   },
                                   "secretName": "MyAccountKey"
                               }
                           }
                       }
                   }
               }
           }
       }
   }
   ```

2. В Azure PowerShell перейдите в папку `C:\ADF\RunSSISPackage`.

3. Чтобы создать конвейер **RunSSISPackagePipeline**, выполните командлет **Set-AzDataFactoryV2Pipeline** .

   ```powershell
   $DFPipeLine = Set-AzDataFactoryV2Pipeline -DataFactoryName $DataFactory.DataFactoryName `
                                                  -ResourceGroupName $ResGrp.ResourceGroupName `
                                                  -Name "RunSSISPackagePipeline"
                                                  -DefinitionFile ".\RunSSISPackagePipeline.json"
   ```

   Ниже приведен пример выходных данных:

   ```
   PipelineName      : Adfv2QuickStartPipeline
   ResourceGroupName : <resourceGroupName>
   DataFactoryName   : <dataFactoryName>
   Activities        : {CopyFromBlobToBlob}
   Parameters        : {[inputPath, Microsoft.Azure.Management.DataFactory.Models.ParameterSpecification], [outputPath, Microsoft.Azure.Management.DataFactory.Models.ParameterSpecification]}
   ```

### <a name="run-the-pipeline"></a>Запуск конвейера
Используйте командлет **Invoke-AzDataFactoryV2Pipeline** для запуска конвейера. Командлет позволяет получить идентификатор выполнения конвейера для дальнейшего мониторинга.

```powershell
$RunId = Invoke-AzDataFactoryV2Pipeline -DataFactoryName $DataFactory.DataFactoryName `
                                             -ResourceGroupName $ResGrp.ResourceGroupName `
                                             -PipelineName $DFPipeLine.Name
```

### <a name="monitor-the-pipeline"></a>Мониторинг конвейера

Запустите приведенный ниже скрипт PowerShell, чтобы проверять состояние выполнения, пока не закончится копирование данных. Скопируйте или вставьте следующий скрипт в окно PowerShell и нажмите клавишу ВВОД. 

```powershell
while ($True) {
    $Run = Get-AzDataFactoryV2PipelineRun -ResourceGroupName $ResGrp.ResourceGroupName `
                                               -DataFactoryName $DataFactory.DataFactoryName `
                                               -PipelineRunId $RunId

    if ($Run) {
        if ($run.Status -ne 'InProgress') {
            Write-Output ("Pipeline run finished. The status is: " +  $Run.Status)
            $Run
            break
        }
        Write-Output  "Pipeline is running...status: InProgress"
    }

    Start-Sleep -Seconds 10
}   
```

Вы также можете отслеживать конвейер с помощью портал Azure. Пошаговые инструкции см. в разделе [Мониторинг конвейера](quickstart-create-data-factory-resource-manager-template.md#monitor-the-pipeline).

### <a name="schedule-the-pipeline-with-a-trigger"></a>Запуск конвейера по расписанию с помощью триггера
На предыдущем шаге вы запустили конвейер по запросу. Можно также создать триггер расписания для запуска конвейера по расписанию, например ежечасно или ежедневно.

1. Создайте файл JSON с именем `MyTrigger.json` в `C:\ADF\RunSSISPackage` папке со следующим содержимым: 
        
   ```json
   {
       "properties": {
           "name": "MyTrigger",
           "type": "ScheduleTrigger",
           "typeProperties": {
               "recurrence": {
                   "frequency": "Hour",
                   "interval": 1,
                   "startTime": "2017-12-07T00:00:00-08:00",
                   "endTime": "2017-12-08T00:00:00-08:00"
               }
           },
           "pipelines": [{
               "pipelineReference": {
                   "type": "PipelineReference",
                   "referenceName": "RunSSISPackagePipeline"
               },
               "parameters": {}
           }]
       }
   }    
   ```
    
1. В Azure PowerShell перейдите в папку `C:\ADF\RunSSISPackage`.
1. Выполните командлет **Set-AzDataFactoryV2Trigger** , который создает триггер. 

   ```powershell
   Set-AzDataFactoryV2Trigger -ResourceGroupName $ResGrp.ResourceGroupName `
                                   -DataFactoryName $DataFactory.DataFactoryName `
                                   -Name "MyTrigger" -DefinitionFile ".\MyTrigger.json"
   ```
1. По умолчанию триггер находится в остановленном состоянии. Запустите триггер, выполнив командлет **Start-AzDataFactoryV2Trigger** . 

   ```powershell
   Start-AzDataFactoryV2Trigger -ResourceGroupName $ResGrp.ResourceGroupName `
                                     -DataFactoryName $DataFactory.DataFactoryName `
                                     -Name "MyTrigger" 
   ```
1. Убедитесь, что триггер запущен, выполнив командлет **Get-AzDataFactoryV2Trigger** . 

   ```powershell
   Get-AzDataFactoryV2Trigger -ResourceGroupName $ResourceGroupName `
                                   -DataFactoryName $DataFactoryName `
                                   -Name "MyTrigger"     
   ```    
1. Через час выполните следующую команду. Например, если текущее время 15:25 (UTC), запустите команду в 16:00 (UTC). 
    
   ```powershell
   Get-AzDataFactoryV2TriggerRun -ResourceGroupName $ResourceGroupName `
                                      -DataFactoryName $DataFactoryName `
                                      -TriggerName "MyTrigger" `
                                      -TriggerRunStartedAfter "2017-12-06" `
                                      -TriggerRunStartedBefore "2017-12-09"
   ```

   Выполните следующий запрос к базе данных SSISDB на сервере SQL Server, чтобы убедиться, что пакет выполнен. 

   ```sql
   select * from catalog.executions
   ```

## <a name="next-steps"></a>Дальнейшие действия
См. в следующей записи блога:
- [Модернизировать и расширьте рабочие процессы ETL/ELT с помощью действий SSIS в конвейерах фабрики данных Azure](https://techcommunity.microsoft.com/t5/SQL-Server-Integration-Services/Modernize-and-Extend-Your-ETL-ELT-Workflows-with-SSIS-Activities/ba-p/388370)
