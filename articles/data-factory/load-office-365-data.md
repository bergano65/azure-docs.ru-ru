---
title: Загрузка данных из Office 365 с помощью Фабрики данных Azure
description: Использование Фабрики данных Azure для копирования данных из Office 365
services: data-factory
documentationcenter: ''
author: linda33wj
manager: craigg
ms.reviewer: douglasl
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.date: 10/22/2018
ms.author: jingwang
ms.openlocfilehash: 0c938caef81063409d3c8d6632cd7e8df99f1ea1
ms.sourcegitcommit: 609d4bdb0467fd0af40e14a86eb40b9d03669ea1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2019
ms.locfileid: "73672619"
---
# <a name="load-data-from-office-365-by-using-azure-data-factory"></a>Загрузка данных из Office 365 с помощью Фабрики данных Azure

В этой статье показано, как использовать Фабрику данных для _загрузки данных из Office 365 в хранилище BLOB-объектов Azure_. Эти шаги применяются и для копирования данных в Azure Data Lake 1-го и 2-го поколения. Общие сведения о копировании данных из Office 365 см. в статье [о соединителе Office 365](connector-office-365.md).

## <a name="create-a-data-factory"></a>Создать фабрику данных

1. В меню слева выберите **Создать ресурс** > **Аналитика** > **Фабрика данных**. 
   
   ![Выбор фабрики данных в области "Создать"](./media/quickstart-create-data-factory-portal/new-azure-data-factory-menu.png)

2. В полях на странице **Новая фабрика данных** задайте значения, как показано на следующем изображении:
      
   ![Страница "Новая фабрика данных"](./media/load-office-365-data/new-azure-data-factory.png)
 
    * **Имя.** Введите глобальное уникальное имя фабрики данных Azure. Если появляется сообщение об ошибке "имя фабрики данных *LoadFromOffice365Demo* недоступно", введите другое имя для фабрики данных. Например, вы можете использовать имя _**ваше_имя**_ **LoadFromOffice365Demo**. Попробуйте создать фабрику данных еще раз. Правила именования для артефактов службы "Фабрика данных" см. в [этой](naming-rules.md) статье.
    * **Подписка.** Выберите подписку Azure, в рамках которой нужно создать фабрику данных. 
    * **Группа ресурсов.** Выберите имеющуюся группу ресурсов из раскрывающегося списка или щелкните параметр **Create new** (Создать) и введите имя группы ресурсов. Сведения о группах ресурсов см. в статье, где описывается [использование групп ресурсов для управления ресурсами Azure](../azure-resource-manager/resource-group-overview.md).  
    * **Версия.** Выберите **V2 (предварительная версия)** .
    * **Расположение.** Выберите расположение фабрики данных. В раскрывающемся списке отображаются только поддерживаемые расположения. Хранилища данных, используемые в фабрике данных, могут находиться в других расположениях и регионах. К этим хранилищам относятся Azure Data Lake Store, служба хранилища Azure, база данных SQL Azure и т. д.

3. Нажмите кнопку **Создать**.
4. После создания перейдите к фабрике данных. Вы увидите домашнюю страницу **фабрики данных**, как показано на следующем изображении:
   
   ![Домашняя страница фабрики данных](./media/load-office-365-data/data-factory-home-page.png)

5. Выберите плитку **Создание и мониторинг**, чтобы открыть на отдельной вкладке приложение интеграции данных.

## <a name="create-a-pipeline"></a>Создание конвейера

1. На странице "Начало работы" выберите **Create pipeline** (Создать конвейер).
 
    ![Создание конвейера](./media/load-office-365-data/create-pipeline-entry.png)

2. На вкладке **Общие** для конвейера введите "CopyPipeline" в качестве **имени** конвейера.

3. На панели элементов "Действия" разверните категорию Move & Transform (Переместить и преобразовать) и перетащите действие **Копирование** из панели элементов в область конструктора конвейера. В качестве имени действия укажите CopyFromOffice365ToBlob.

### <a name="configure-source"></a>Настройка источника

1. Перейдите в конвейере на вкладку **Источник** и нажмите кнопку **+ Создать**, чтобы создать исходный набор данных. 

2. В окне Новый набор данных выберите **Office 365**и нажмите кнопку **продолжить**.
 
3. Теперь вы используете вкладку Конфигурация действия копирования. Нажмите кнопку " **изменить** " рядом с набором данных Office 365, чтобы продолжить настройку данных.

    ![Общая настройка набора данных Office 365](./media/load-office-365-data/transition-to-edit-dataset.png)
 
4. Откроется новая вкладка для набора данных Office 365. На **вкладке Общие** в нижней части окно свойств введите "SourceOffice365Dataset" в поле "имя".
 
5. Перейдите на вкладку **Подключение** в окне "Свойства". Щелкните **+ Создать** рядом с текстовым полем "Связанная служба".

6. В окне Новая связанная служба введите "Office365LinkedService" в качестве имени, введите идентификатор субъекта-службы и ключ субъекта-службы, а затем проверьте подключение и щелкните **создать** , чтобы развернуть связанную службу.

    ![Новая связанная служба Office 365](./media/load-office-365-data/new-office-365-linked-service.png)
 
7. После создания связанной службы снова откроются параметры набора данных. Рядом с полем **Таблица**щелкните стрелку вниз, чтобы развернуть список доступных наборов данных Office 365, и выберите "BasicDataSet_v0. Message_v0 "из раскрывающегося списка:

    ![Настройка таблицы набора данных Office 365](./media/load-office-365-data/edit-dataset.png)

8. Теперь вернитесь на **вкладку источник** > **конвейера** , чтобы продолжить настройку дополнительных свойств для извлечения данных Office 365.  Область пользователя и фильтр области пользователя — это необязательные предикаты, которые можно определить, чтобы ограничить данные, которые необходимо извлечь из Office 365. Сведения о настройке этих параметров см. в разделе [Свойства набора данных Office 365](https://docs.microsoft.com/azure/data-factory/connector-office-365#dataset-properties) .

9. Вам необходимо выбрать один из фильтров даты и указать время начала и время окончания.

10. Перейдите на вкладку **Импорт схемы** , чтобы импортировать схему для набора данных сообщения.

    ![Настройка схемы набора данных Office 365](./media/load-office-365-data/edit-source-properties.png)

### <a name="configure-sink"></a>Настройка приемника

1. Перейдите на вкладку конвейера **Приемник** и выберите **+ Создать**, чтобы создать целевой набор данных.
 
2. В окне Новый набор данных обратите внимание, что при копировании из Office 365 выбираются только поддерживаемые назначения. Выберите **хранилище BLOB-объектов Azure**, выберите двоичный формат и нажмите кнопку **продолжить**.  В этом руководстве вы скопируете данные Office 365 в хранилище BLOB-объектов Azure.

3. Нажмите кнопку " **изменить** " рядом с набором данных хранилища BLOB-объектов Azure, чтобы продолжить настройку данных.

4. Перейдите на вкладку **Общие** в окне свойств и введите OutputBlobDataset в поле "Имя".

5. Перейдите на вкладку **Подключение** в окне "Свойства". Рядом с текстовым полем "Связанная служба" нажмите кнопку **+ Создать**.

6. В окне Новая связанная служба введите "AzureStorageLinkedService" в качестве имени, выберите "субъект-служба" в раскрывающемся списке методов проверки подлинности, укажите конечную точку службы, клиента, идентификатор субъекта-службы и ключ субъекта-службы, а затем нажмите кнопку Сохранить в. Разверните связанную службу.  Дополнительные сведения о настройке проверки подлинности субъекта-службы для хранилища BLOB-объектов Azure см. [здесь](connector-azure-blob-storage.md#service-principal-authentication).

    ![Новая связанная служба больших двоичных объектов](./media/load-office-365-data/configure-blob-linked-service.png)


## <a name="validate-the-pipeline"></a>Проверка конвейера

Чтобы проверить параметры конвейера, на панели инструментов выберите **Проверить**.

Чтобы отобразить код JSON, соответствующий конвейеру, щелкните "Код" в правом верхнем углу.

## <a name="publish-the-pipeline"></a>Публикация конвейера

В верхней части панели инструментов щелкните **Опубликовать все**. Это действие опубликует созданные сущности (наборы данных и конвейеры) в фабрике данных.

![Публикация изменений](./media/load-office-365-data/publish-changes.png) 

## <a name="trigger-the-pipeline-manually"></a>активация конвейера вручную;

Выберите **Добавить триггер** на панели инструментов, а затем **Trigger Now** (Запустить сейчас). На странице Pipeline Run (Запуск конвейера) нажмите кнопку **Готово**. 

## <a name="monitor-the-pipeline"></a>Мониторинг конвейера

Перейдите на вкладку **Мониторинг** слева. Вы увидите выполнение конвейера, которое вы только что активировали вручную. Ссылки в столбце **действий** позволят вам просмотреть подробные сведения о действиях и (или) повторно выполнить конвейер.

![Мониторинг конвейера](./media/load-office-365-data/pipeline-status.png) 

Чтобы просмотреть запуски действий, связанные с этим запуском конвейера, щелкните ссылку **View Activity Runs** (Просмотр запусков действий) в столбце "Действия". В нашем примере определено только одно действие, поэтому в списке вы увидите только одну запись. Чтобы получить дополнительные сведения об операции копирования, выберите ссылку **сведения** (значок очков) в столбце действия.

![Мониторинг действий](./media/load-office-365-data/activity-status.png) 

Если вы впервые запрашиваете данные для этого контекста (сочетание, к которому обращается таблица данных, какая целевая учетная запись представляет собой данные, в которую они загружаются, и какой пользователь удостоверений делает запрос на доступ к данным), вы увидите действие копирования. состояние **выполняется**, и только если щелкнуть ссылку "сведения" в разделе "действия", состояние будет отображаться как **рекуесетингконсент**.  Участник группы одобрения доступа к данным должен утвердить запрос в Privileged Access Management до того, как можно будет продолжить извлечение данных.

_Состояние RequesetingConsent (Запрос на получение согласия):_ 
![Сведения о выполнении действия — запрос на получение согласия](./media/load-office-365-data/activity-details-request-consent.png) 

_Состояние ExtractingData (Извлечение данных):_

![Сведения о выполнении действия — извлечение данных](./media/load-office-365-data/activity-details-extract-data.png) 

После предоставления согласия извлечение данных будет продолжено, и через некоторое время выполнение конвейера будет отображаться как выполненное.

![Отслеживание конвейера — успешно](./media/load-office-365-data/pipeline-monitoring-succeeded.png) 

Теперь перейдите в целевое хранилище BLOB-объектов Azure и убедитесь, что данные Office 365 были извлечены в двоичном формате.

## <a name="next-steps"></a>Дополнительная информация

Перейдите к следующей статье, чтобы узнать о поддержке хранилища данных SQL Azure: 

> [!div class="nextstepaction"]
>[Соединитель Office 365](connector-office-365.md)