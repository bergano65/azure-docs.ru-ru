---
title: Выполнение пакетов SQL Server Integration Services (SSIS) с помощью служебной программы dtexec с поддержкой Azure | Документация Майкрософт
description: Узнайте, как выполнять пакеты SQL Server Integration Services (SSIS) с помощью служебной программы dtexec с поддержкой Azure.
services: data-factory
documentationcenter: ''
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.topic: conceptual
ms.date: 09/21/2019
author: swinarko
ms.author: sawinark
ms.reviewer: douglasl
manager: craigg
ms.openlocfilehash: 472792351b8b7ab96e055bacd64141840ce7a630
ms.sourcegitcommit: b4f201a633775fee96c7e13e176946f6e0e5dd85
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/18/2019
ms.locfileid: "72596948"
---
# <a name="run-sql-server-integration-services-packages-with-the-azure-enabled-dtexec-utility"></a>Выполнение пакетов SQL Server Integration Services с помощью служебной программы dtexec с поддержкой Azure
В этой статье описывается программа командной строки dtexec (Азуредтексек) с поддержкой Azure. Он используется для запуска пакетов SQL Server Integration Services (SSIS) на Azure-SSIS Integration Runtime (IR) в фабрике данных Azure.

Традиционная служебная программа dtexec поставляется с SQL Server. Дополнительные сведения см. в разделе [dtexec Utility](https://docs.microsoft.com/sql/integration-services/packages/dtexec-utility?view=sql-server-2017). Они часто вызываются сторонними оркестрации или планировщиками, такими как Активебатч и Control-M, для запуска пакетов служб SSIS в локальной среде. 

Современная служебная программа Азуредтексек поставляется со средством SQL Server Management Studio (SSMS). Он также может вызываться сторонними оркестрации или планировщиками для выполнения пакетов служб SSIS в Azure. Она упрощает работу и сдвиг пакетов служб SSIS в облако. Если после миграции вы хотите использовать сторонние оркестрации или планировщики в повседневной работе, они теперь могут вызывать Азуредтексек вместо dtexec.

Азуредтексек запускает пакеты в виде выполнения действий пакета служб SSIS в конвейерах фабрики данных. Дополнительные сведения см. в статье [Запуск пакетов служб SSIS в качестве действий фабрики данных Azure](https://docs.microsoft.com/azure/data-factory/how-to-invoke-ssis-package-ssis-activity). 

Азуредтексек можно настроить с помощью среды SSMS, чтобы использовать приложение Azure Active Directory (Azure AD), которое создает конвейеры в фабрике данных. Кроме того, его можно настроить для доступа к файловым системам, файловым ресурсам или файлам Azure, где хранятся пакеты. В зависимости от значений, которые вы присваиваете параметрам вызова, Азуредтексек создает и выполняет уникальный конвейер фабрики данных с действием выполнить пакет служб SSIS. Вызов Азуредтексек с теми же значениями параметров перезапускает существующий конвейер.

## <a name="prerequisites"></a>Технические условия
Чтобы использовать Азуредтексек, скачайте и установите последнюю версию SSMS, которая имеет версию 18,3 или более позднюю. Скачайте его с [этого веб-сайта](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-2017).

## <a name="configure-the-azuredtexec-utility"></a>Настройка служебной программы Азуредтексек
При установке SSMS на локальном компьютере также устанавливаются Азуредтексек. Чтобы настроить параметры, запустите SSMS с параметром **Запуск от имени администратора** . Затем выберите **инструменты**  > **перенести в Azure**  > **настроить dtexec с поддержкой Azure**.

![Настройка меню dtexec с поддержкой Azure](media/how-to-invoke-ssis-package-azure-enabled-dtexec/ssms-azure-enabled-dtexec-menu.png)

Это действие открывает окно **азуредтексекконфиг** , которое необходимо открыть с правами администратора для записи в файл *азуредтексек. Settings* . Если вы не выполняли SSMS от имени администратора, откроется окно контроля учетных записей (UAC). Введите пароль администратора для повышения привилегий.

![Настройка параметров dtexec, поддерживающих Azure](media/how-to-invoke-ssis-package-azure-enabled-dtexec/ssms-azure-enabled-dtexec-settings.png)

В окне **азуредтексекконфиг** введите параметры конфигурации следующим образом:

- **ApplicationId**: введите уникальный идентификатор создаваемого приложения Azure AD с правильными разрешениями для создания конвейеров в фабрике данных. Дополнительные сведения см. в статье [Создание приложения Azure AD и субъекта-службы с помощью портал Azure](https://docs.microsoft.com/azure/active-directory/develop/howto-create-service-principal-portal).
- **AuthenticationKey**: введите ключ проверки подлинности для приложения Azure AD.
- **TenantId**: введите уникальный идентификатор клиента Azure AD, в котором создано приложение Azure AD.
- **SubscriptionId**: введите уникальный идентификатор подписки Azure, под которой была создана фабрика данных.
- **ResourceGroup**: введите имя группы ресурсов Azure, в которой была создана фабрика данных.
- **Фактическое**значение. Введите имя фабрики данных, в которой будут формироваться уникальные конвейеры с действием "выполнение пакета SSIS" в них на основе значений параметров, предоставленных при вызове азуредтексек.
- **Ирнаме**. введите имя Azure-SSIS IR в фабрике данных, в которой будут выполняться пакеты, указанные в пути в формате UNC, при вызове азуредтексек.
- **Паккажеакцессдомаин**. Введите учетные данные домена, чтобы получить доступ к пакетам по UNC-пути, указанному при вызове азуредтексек.
- **Паккажеакцессусернаме**. Введите учетные данные имени пользователя, чтобы получить доступ к пакетам по UNC-пути, указанному при вызове азуредтексек.
- **Паккажеакцесспассворд**. Введите учетные данные пароля для доступа к пакетам по UNC-пути, указанному при вызове азуредтексек.
- **LogPath**: введите UNC-путь к папке журнала, в которую записываются файлы журнала, выполняемые в Azure-SSIS IR пакета.
- **LogLevel**. Введите выбранную область ведения журнала из стандартных **значений NULL**, **Basic**, **verbose**или **производительности** для выполнения пакета на Azure-SSIS IR.
- **Логакцессдомаин**. Введите учетные данные домена для доступа к папке журнала по его UNC-пути при записи файлов журнала, что требуется, если указан параметр **logPath** , а **LogLevel** имеет **значение NULL**.
- **Логакцессусернаме**. Введите учетные данные имени пользователя, чтобы получить доступ к папке журнала по UNC-пути при записи файлов журнала, что требуется, если указан параметр **logPath** , а **LogLevel** имеет **значение NULL**.
- **Логакцесспассворд**. Введите учетные данные пароля для доступа к папке журнала по его UNC-пути при записи файлов журнала, что требуется, если указан параметр **logPath** , а **LogLevel** имеет **значение NULL**.
- **Пипелиненамехашстрлен**: Введите длину хэш-строк, которые будут формироваться из значений параметров, которые вы задаете при вызове азуредтексек. Строки используются для формирования уникальных имен конвейеров фабрики данных, которые запускают пакеты на Azure-SSIS IR. Обычно достаточно длины в 32 символов.

Чтобы сохранить пакеты и файлы журналов в файловых системах или локальных файловых ресурсах в локальной среде, присоедините Azure-SSIS IR к виртуальной сети, подключенной к локальной сети, чтобы она могла получать пакеты и записывать файлы журналов. Дополнительные сведения см. в статье [Присоединение Azure-SSIS IR к виртуальной сети](https://docs.microsoft.com/azure/data-factory/join-azure-ssis-integration-runtime-virtual-network).

Чтобы избежать отображения конфиденциальных значений, записанных в файл *азуредтексек. Settings* в виде обычного текста, мы будем кодировать их в строки кодировки Base64. При вызове Азуредтексек все строки в кодировке Base64 декодируются обратно в исходные значения. Вы можете дополнительно защитить файл *азуредтексек. Settings* , ограничив учетные записи, которые имеют доступ к нему.

## <a name="invoke-the-azuredtexec-utility"></a>Вызов служебной программы Азуредтексек
Вы можете вызвать Азуредтексек в командной строке и указать соответствующие значения для конкретных параметров в сценарии варианта использования.

Программа устанавливается в `{SSMS Folder}\Common7\IDE\CommonExtensions\Microsoft\SSIS\150\Binn`. Можно добавить путь к переменной среды PATH, чтобы он вызывался из любого места.

```dos
> cd "C:\Program Files (x86)\Microsoft SQL Server Management Studio 18\Common7\IDE\CommonExtensions\Microsoft\SSIS\150\Binn"
> AzureDTExec.exe  ^
  /F \\MyStorageAccount.file.core.windows.net\MyFileShare\MyPackage.dtsx  ^
  /Conf \\MyStorageAccount.file.core.windows.net\MyFileShare\MyConfig.dtsConfig  ^
  /Conn "MyConnectionManager;Data Source=MyDatabaseServer.database.windows.net;User ID=MyAdminUsername;Password=MyAdminPassword;Initial Catalog=MyDatabase"  ^
  /Set \package.variables[MyVariable].Value;MyValue  ^
  /De MyEncryptionPassword
```

Вызов Азуредтексек предлагает аналогичные параметры, такие как вызов dtexec. Дополнительные сведения см. в разделе [dtexec Utility](https://docs.microsoft.com/sql/integration-services/packages/dtexec-utility?view=sql-server-2017). В настоящее время поддерживаются следующие параметры:

- **/F [ILE]** : Загрузка пакета, хранящегося в файловой системе, общей папке или службе файлов Azure. В качестве значения этого параметра можно указать UNC-путь к файлу пакета в файловой системе, общей папке или службе файлов Azure с расширением DTSX. Если указанный UNC-путь содержит пробелы, заключите весь путь в кавычки.
- **/Conf [igFile]** : определяет файл конфигурации, из которого извлекаются значения. С помощью этого параметра можно задать конфигурацию времени выполнения для пакета, отличающуюся от указанной во время разработки. Можно сохранить различные параметры в XML-файле конфигурации, а затем загрузить их перед выполнением пакета. Дополнительные сведения см. в разделе [конфигурации пакетов служб SSIS](https://docs.microsoft.com/sql/integration-services/packages/package-configurations?view=sql-server-2017). Чтобы указать значение этого параметра, используйте UNC-путь к файлу конфигурации в файловой системе, общей папке или службе файлов Azure с расширением dtsConfig. Если указанный UNC-путь содержит пробелы, заключите весь путь в кавычки.
- **/Conn [ection]** : Указывает строки подключения для существующих диспетчеров соединений в пакете. С помощью этого параметра можно задать строки подключения времени выполнения для существующих диспетчеров соединений в пакете, которые отличаются от указанных во время разработки. Укажите значение для этого параметра следующим образом: `connection_manager_name_or_id;connection_string [[;connection_manager_name_or_id;connection_string]...]`.
- **/Set**: переопределяет конфигурацию параметра, переменной, свойства, контейнера, регистратора, перечислителя foreach или соединения в пакете. Этот параметр можно указать несколько раз. Укажите значение для этого параметра следующим образом: `property_path;value`. Например, `\package.variables[counter].Value;1` переопределяет значение переменной `counter` как 1. Мастер **настройки пакета** можно использовать для поиска, копирования и вставки значения `property_path` для элементов в пакете, значение которых необходимо переопределить. Дополнительные сведения см. в разделе [Мастер настройки пакета](https://docs.microsoft.com/sql/integration-services/package-configuration-wizard-ui-reference?view=sql-server-2014).
- **/De [шифрование]** : задает пароль расшифровки для пакета, настроенного на уровне защиты **EncryptAllWithPassword** /**EncryptSensitiveWithPassword** .

> [!NOTE]
> При вызове Азуредтексек с новыми значениями параметров создается новый конвейер, за исключением параметра **/de [нарий]** .

## <a name="next-steps"></a>Дальнейшие действия

После того как уникальные конвейеры с действием выполнение пакета служб SSIS в них создаются и запускаются после вызова Азуредтексек, их можно отслеживать на портале фабрики данных. Дополнительные сведения см. в статье [выполнение пакетов служб SSIS в качестве действий фабрики данных](https://docs.microsoft.com/azure/data-factory/how-to-invoke-ssis-package-ssis-activity).

> [!WARNING]
> Созданный конвейер должен использоваться только Азуредтексек. Его свойства или параметры могут измениться в будущем, поэтому не изменяйте их и не используйте повторно для других целей. Изменения могут нарушить Азуредтексек. Если это происходит, удалите конвейер. Азуредтексек создает новый конвейер при следующем вызове.
