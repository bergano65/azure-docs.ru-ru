---
title: Анализ видео и звуковых файлов
titleSuffix: Azure Media Services
description: Узнайте, как анализировать аудио и видео содержимое с помощью Аудиоанализерпресет и Видеоанализерпресет в службах мультимедиа Azure.
services: media-services
documentationcenter: ''
author: IngridAtMicrosoft
manager: femila
editor: ''
ms.service: media-services
ms.workload: ''
ms.topic: conceptual
ms.date: 10/21/2020
ms.author: inhenkel
ms.openlocfilehash: c00af3a128685dfbd2435b65fe4d00107ca22ba4
ms.sourcegitcommit: c2dd51aeaec24cd18f2e4e77d268de5bcc89e4a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2020
ms.locfileid: "94744363"
---
# <a name="analyze-video-and-audio-files-with-azure-media-services"></a>Анализ видео и звуковых файлов с помощью служб мультимедиа Azure

[!INCLUDE [regulation](../video-indexer/includes/regulation.md)]

[!INCLUDE [media services api v3 logo](./includes/v3-hr.md)]

Службы мультимедиа Azure V3 позволяют извлекать ценные сведения из видео и звуковых файлов с помощью индексатора видео. В этой статье описываются предустановки анализатора Media Services v3, используемые для извлечения этих ценных сведений. Если вам нужны более подробные аналитические сведения, используйте непосредственно Индексатор видео. Чтобы узнать, когда использовать индексатор видео и предварительные установки анализатора служб мультимедиа, ознакомьтесь с [документом сравнения](../video-indexer/compare-video-indexer-with-media-services-presets.md).

Существует два режима установки "базовый" и "Стандартный" для анализатора аудио. См. Описание различий в таблице ниже.

Чтобы проанализировать содержимое с помощью предварительных наборов служб мультимедиа версии 3, создайте **Преобразование** и отправьте **Задание** , которое использует один из следующих предустановок: [видеоанализерпресет](/rest/api/media/transforms/createorupdate#videoanalyzerpreset) или **аудиоанализерпресет**. Учебник, демонстрирующий использование **видеоанализерпресет**, см. в статье [Анализ видео с помощью служб мультимедиа Azure](analyze-videos-tutorial-with-api.md).

> [!NOTE]
> При использовании предустановок видео или анализатора аудио используйте портал Azure, чтобы настроить учетную запись на 10 зарезервированных единиц мультимедиа S3, хотя это не является обязательным. Для предустановок звука можно использовать S1 или S2. Дополнительные сведения см. в [этой статье](media-reserved-units-cli-how-to.md).

## <a name="compliance-privacy-and-security"></a>Соответствие требованиям, конфиденциальность и безопасность

Хотим напомнить, что при использовании Индексатора видео вы должны соблюдать все применимые законы, и не имеете права использовать Индексатор видео или любые другие службы Azure каким либо способом, который нарушает права других лиц или может нанести им вред. Перед отправкой любого видеосодержимого, включая любые биометрические данные, в службу "Индексатор видео" для обработки и хранения данных необходимо иметь все необходимые права, включая все возможные разрешения, от отдельных пользователей, содержащихся в видеосодержимом. Чтобы узнать о соответствии требованиям, конфиденциальности и безопасности в Индексаторе видео, см. [Условия Microsoft Cognitive Services](https://azure.microsoft.com/support/legal/cognitive-services-compliance-and-privacy/). Обязательства Майкрософт по обеспечению конфиденциальности и обработке ваших данных см. в [Заявлении о конфиденциальности](https://privacy.microsoft.com/PrivacyStatement), [Условиях использования веб-служб](https://www.microsoft.com/licensing/product-licensing/products) ("OST") и [Приложение к обработке данных](https://www.microsoftvolumelicensing.com/DocumentSearch.aspx?Mode=3&DocumentTypeId=67) ("DPA"). Дополнительные сведения о конфиденциальности, включая хранение данных, их удаление или уничтожение, доступны в OST и [здесь](../video-indexer/faq.md). Используя Индексатор видео, обязуетесь соблюдать Условия Cognitive Services, OST, DPA и Заявление о конфиденциальности.

## <a name="built-in-presets"></a>Встроенные предустановки

Сейчас Службы мультимедиа поддерживают следующие встроенные предустановки анализатора:  

|**Имя предустановленной конфигурации**|**Сценарий**|**Сведения**|
|---|---|---|
|[AudioAnalyzerPreset](/rest/api/media/transforms/createorupdate#audioanalyzerpreset)|Анализ стандартного звука|Эта предустановка применяет предопределенный набор операций анализа на основе ИИ, включая транскрибирование речи. В настоящее время она поддерживает обработку содержимого с одной звуковой дорожкой, содержащей речь на одном языке. Можно указать язык для полезных данных аудио во входных данных. Для этого используется формат BCP-47 "тег языка — регион". Поддерживаемые языки: Английский (EN-US и EN-GB), Испанский (ES-ES и es-MX), французский (' fr-FR '), итальянский (' ИТ-IT '), японский (' ja-JP '), португальский ("PT-BR"), китайский (' zh-CN '), немецкий (' de-DE '), арабский (' ar-EG ' и ' AR-SY '), Русский (' ru-RU '), хинди (' hi-IN ') и Корейский (' ko-KR ').<br/><br/> Если язык не указан или имеет значение null, автоматическое обнаружение языка выбирает первый обнаруженный язык и переходит к выбранному языку на время его существования. Функция автоматического определения языка сейчас поддерживается для таких языков: английский, китайский, французский, немецкий, итальянский, японский, испанский, русский и португальский. Он не поддерживает динамическое переключение между языками после обнаружения первого языка. Автоматическое распознавание языка лучше всего работает с аудиозаписями с четко различимой речью. Если при автоматическом обнаружении языка не удается найти язык, то запись переключается обратно на английский.|
|[AudioAnalyzerPreset](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#audioanalyzerpreset)|Анализ аудио Basic|В этом режиме выполняется расшифровка речи в текст и создание файла подзаголовка и подписи ВТТ. Выходные данные этого режима включают в себя JSON файл Insights, включающий только ключевые слова, транскрипцию и сведения о времени. Автоматическое определение языка и диаризатион динамика не включены в этот режим. Список поддерживаемых языков доступен [здесь](https://go.microsoft.com/fwlink/?linkid=2109463) .|
|[VideoAnalyzerPreset](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#videoanalyzerpreset)|Анализ аудио и видео|Извлекает из аудио и видео аналитические данные (подробные метаданные) и выдает файл в формате JSON. Можно указать, если нужно извлекать аналитические данные только для аудио при обработке видеофайла. Дополнительные сведения см. в статье [Руководство. Анализ видео с помощью Служб мультимедиа Azure](analyze-videos-tutorial-with-api.md).|
|[фацедетекторпресет](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#facedetectorpreset)|Обнаружение лиц, имеющихся в видео|Описывает параметры, используемые при анализе видео для обнаружения всех имеющихся лиц.|

### <a name="audioanalyzerpreset-standard-mode"></a>Аудиоанализерпресет стандартный режим

Эта предустановка позволяет извлечь из аудио- и видеофайлов множество аналитических сведений об аудио.

Выходные данные включают в себя JSON-файл (со всеми сведениями) и VTT-файл расшифровки аудиозаписи. Эта предустановка принимает свойство, которое указывает язык входного файла в виде строки [BCP47](https://tools.ietf.org/html/bcp47). Аналитические сведения об аудиофайле включают в себя:

* **Запись звука**: транскрипция слов с метками времени. Поддерживается несколько языков.
* **Индексирование докладчика**: сопоставление динамиков и соответствующих произносимых слов.
* **Анализ тональностиности речи**. выходные данные анализа тональности, выполненные для транскрипции звука.
* **Ключевые слова**: ключевые слова, извлекаемые из транскрипции звука.

### <a name="audioanalyzerpreset-basic-mode"></a>Базовый режим Аудиоанализерпресет

Эта предустановка позволяет извлечь из аудио- и видеофайлов множество аналитических сведений об аудио.

Выходные данные включают JSON-файл и файл ВТТ для записи звука. Эта предустановка принимает свойство, которое указывает язык входного файла в виде строки [BCP47](https://tools.ietf.org/html/bcp47). Выходные данные включают:

* **Запись звука**: транскрипция слов с метками времени. Поддерживается несколько языков, но автоматическое определение языка и диаризатион докладчика не включены.
* **Ключевые слова**: ключевые слова, извлекаемые из транскрипции звука.

### <a name="videoanalyzerpreset"></a>VideoAnalyzerPreset

Эта предустановка позволяет извлечь из видеофайлов множество аналитических сведений об аудио и видео. Выходные данные включают в себя JSON-файл (со всеми сведениями), VTT-файл расшифровки аудиозаписи и коллекцию эскизов видео. Эта предустановка также принимает строку [​​BCP47](https://tools.ietf.org/html/bcp47) (представляющую язык видео) как свойство. Сведения о видеосодержимом включают в себя все сведения об аудиосодержимом, упомянутые выше, и следующие дополнительные элементы:

* **Отслеживание лиц**: время, в течение которого лица отображаются в видео. У каждой грани есть идентификатор лица и соответствующая коллекция эскизов.
* **Визуальный текст**: текст, обнаруженный с помощью оптического распознавания символов. Текст имеет отметку времени, а также используется для извлечения ключевых слов (в дополнение к звуковой расшифровке).
* **Опорные кадры**: коллекция опорных кадров, извлеченных из видео.
* **Визуальное руководство по содержимому**: часть видео, отмеченных как взрослая или носящих непристойный характер по сути.
* **Аннотация**: результат аннотирования видео на основе предварительно определенной объектной модели.

## <a name="insightsjson-elements"></a>Элементы insights.json

Выходные данные включают JSON-файл (insights.js) со всеми аналитическими данными, найденными в видео или аудио. JSON может содержать следующие элементы:

### <a name="transcript"></a>transcript

|Имя|Описание|
|---|---|
|идентификатор|Идентификатор строки.|
|текст|Сама расшифровка аудиозаписи.|
|язык|Язык расшифровки аудиозаписи. Предназначен для поддержки расшифровки, где каждая строка может быть написана на другом языке.|
|instances|Список диапазонов времени, в которых появилась эта строка. Если экземпляр является расшифровкой, будет отображаться только один экземпляр.|

Пример.

```json
"transcript": [
{
    "id": 0,
    "text": "Hi I'm Doug from office.",
    "language": "en-US",
    "instances": [
    {
        "start": "00:00:00.5100000",
        "end": "00:00:02.7200000"
    }
    ]
},
{
    "id": 1,
    "text": "I have a guest. It's Michelle.",
    "language": "en-US",
    "instances": [
    {
        "start": "00:00:02.7200000",
        "end": "00:00:03.9600000"
    }
    ]
}
] 
```

### <a name="ocr"></a>ocr

|Имя|Описание|
|---|---|
|идентификатор|Идентификатор строки OCR.|
|текст|Текст OCR.|
|confidence|Достоверность распознавания.|
|язык|Язык OCR.|
|instances|Список диапазонов времени, где появилось это OCR (одно и то же OCR может появляться несколько раз).|

```json
"ocr": [
    {
      "id": 0,
      "text": "LIVE FROM NEW YORK",
      "confidence": 0.91,
      "language": "en-US",
      "instances": [
        {
          "start": "00:00:26",
          "end": "00:00:52"
        }
      ]
    },
    {
      "id": 1,
      "text": "NOTICIAS EN VIVO",
      "confidence": 0.9,
      "language": "es-ES",
      "instances": [
        {
          "start": "00:00:26",
          "end": "00:00:28"
        },
        {
          "start": "00:00:32",
          "end": "00:00:38"
        }
      ]
    }
  ],
```

### <a name="faces"></a>faces

|Имя|Описание|
|---|---|
|идентификатор|Идентификатор лица.|
|name|Обозначение лица. Это может быть "Unknown #0", идентифицированный знаменитости или пользователь, обученный пользователем.|
|confidence|Достоверности идентификации лица.|
|description;|Текстовое описание знаменитости. |
|thumbnailId|Идентификатор эскиза лица.|
|knownPersonId|Внутренний идентификатор (если это известное лицо).|
|referenceId|Идентификатор Bing (если это знаменитости Bing).|
|referenceType|В настоящее время только Bing.|
|title|Название (если это знаменитости, например «Генеральный директор корпорации Майкрософт»).|
|imageurl|URL-адрес изображения, если это знаменитости.|
|instances|Экземпляры, в которых лицо появлялось в заданном диапазоне времени. У каждого экземпляра также есть thumbnailsId. |

```json
"faces": [{
    "id": 2002,
    "name": "Xam 007",
    "confidence": 0.93844,
    "description": null,
    "thumbnailId": "00000000-aee4-4be2-a4d5-d01817c07955",
    "knownPersonId": "8340004b-5cf5-4611-9cc4-3b13cca10634",
    "referenceId": null,
    "title": null,
    "imageUrl": null,
    "instances": [{
        "thumbnailsIds": ["00000000-9f68-4bb2-ab27-3b4d9f2d998e",
        "cef03f24-b0c7-4145-94d4-a84f81bb588c"],
        "adjustedStart": "00:00:07.2400000",
        "adjustedEnd": "00:00:45.6780000",
        "start": "00:00:07.2400000",
        "end": "00:00:45.6780000"
    },
    {
        "thumbnailsIds": ["00000000-51e5-4260-91a5-890fa05c68b0"],
        "adjustedStart": "00:10:23.9570000",
        "adjustedEnd": "00:10:39.2390000",
        "start": "00:10:23.9570000",
        "end": "00:10:39.2390000"
    }]
}]
```

### <a name="shots"></a>shots

|Имя|Описание|
|---|---|
|идентификатор|Идентификатор снимка.|
|keyframes|Список ключевых кадров в снимке (каждый из них имеет идентификатор и список временных интервалов экземпляров). Экземпляры ключевых кадров имеют поле thumbnailId с идентификатором эскиза keyFrame.|
|instances|Список временных интервалов этого снимка (снимки имеют только один экземпляр).|

```json
"Shots": [
    {
      "id": 0,
      "keyFrames": [
        {
          "id": 0,
          "instances": [
            {
                "thumbnailId": "00000000-0000-0000-0000-000000000000",
              "start": "00: 00: 00.1670000",
              "end": "00: 00: 00.2000000"
            }
          ]
        }
      ],
      "instances": [
        {
            "thumbnailId": "00000000-0000-0000-0000-000000000000",  
          "start": "00: 00: 00.2000000",
          "end": "00: 00: 05.0330000"
        }
      ]
    },
    {
      "id": 1,
      "keyFrames": [
        {
          "id": 1,
          "instances": [
            {
                "thumbnailId": "00000000-0000-0000-0000-000000000000",      
              "start": "00: 00: 05.2670000",
              "end": "00: 00: 05.3000000"
            }
          ]
        }
      ],
      "instances": [
        {
      "thumbnailId": "00000000-0000-0000-0000-000000000000",
          "start": "00: 00: 05.2670000",
          "end": "00: 00: 10.3000000"
        }
      ]
    }
  ]
```

### <a name="statistics"></a>статистика

|Имя|Описание|
|---|---|
|CorrespondenceCount|Количество соответствий в видео.|
|WordCount|Число слов каждого говорящего.|
|SpeakerNumberOfFragments|Число фрагментов в видео на определенного говорящего.|
|SpeakerLongestMonolog|Самый длинный монолог говорящего. Если докладчик находится в monologе. Паузы в начале и конце монолога удаляются.|
|SpeakerTalkToListenRatio|Результат вычисления основан на длительности монолога говорящего (без учета пауз между монологами), деленной на общее время видео. Значение времени округляется до трех знаков после запятой.|


### <a name="sentiments"></a>sentiments

Тональность агрегируется по полю sensimentType (позитивная/нейтральная/негативная). Например, 0–0,1 0,2–0,1.

|Имя|Описание|
|---|---|
|идентификатор|Идентификатор тональности.|
|averageScore |Среднее значение всех оценок всех экземпляров этого типа тональности — позитивная/нейтральная/негативная.|
|instances|Список диапазонов времени, в которых появилась эта тональность.|
|sentimentType |Может иметь значение Positive, Neutral или Negative.|

```json
"sentiments": [
{
    "id": 0,
    "averageScore": 0.87,
    "sentimentType": "Positive",
    "instances": [
    {
        "start": "00:00:23",
        "end": "00:00:41"
    }
    ]
}, {
    "id": 1,
    "averageScore": 0.11,
    "sentimentType": "Positive",
    "instances": [
    {
        "start": "00:00:13",
        "end": "00:00:21"
    }
    ]
}
]
```

### <a name="labels"></a>метки;

|Имя|Описание|
|---|---|
|идентификатор|Идентификатор метки.|
|name|Название метки (например, "Компьютер", "Телевизор").|
|язык|Язык метки (при наличии перевода). BCP-47|
|instances|Список диапазонов времени, где появилась эта метка (метка может появляться несколько раз). У каждого экземпляра есть поле достоверности. |

```json
"labels": [
    {
      "id": 0,
      "name": "person",
      "language": "en-US",
      "instances": [
        {
          "confidence": 1.0,
          "start": "00: 00: 00.0000000",
          "end": "00: 00: 25.6000000"
        },
        {
          "confidence": 1.0,
          "start": "00: 01: 33.8670000",
          "end": "00: 01: 39.2000000"
        }
      ]
    },
    {
      "name": "indoor",
      "language": "en-US",
      "id": 1,
      "instances": [
        {
          "confidence": 1.0,
          "start": "00: 00: 06.4000000",
          "end": "00: 00: 07.4670000"
        },
        {
          "confidence": 1.0,
          "start": "00: 00: 09.6000000",
          "end": "00: 00: 10.6670000"
        },
        {
          "confidence": 1.0,
          "start": "00: 00: 11.7330000",
          "end": "00: 00: 20.2670000"
        },
        {
          "confidence": 1.0,
          "start": "00: 00: 21.3330000",
          "end": "00: 00: 25.6000000"
        }
      ]
    }
  ] 
```

### <a name="keywords"></a>keywords

|Имя|Описание|
|---|---|
|идентификатор|Идентификатор ключевого слова.|
|текст|Идентификатор текста.|
|confidence|Достоверность распознавания ключевого слова.|
|язык|Язык ключевого слова (при наличии перевода).|
|instances|Список диапазонов времени, где появилось это ключевое слово (ключевое слово может появляться несколько раз).|

```json
"keywords": [
{
    "id": 0,
    "text": "office",
    "confidence": 1.6666666666666667,
    "language": "en-US",
    "instances": [
    {
        "start": "00:00:00.5100000",
        "end": "00:00:02.7200000"
    },
    {
        "start": "00:00:03.9600000",
        "end": "00:00:12.2700000"
    }
    ]
},
{
    "id": 1,
    "text": "icons",
    "confidence": 1.4,
    "language": "en-US",
    "instances": [
    {
        "start": "00:00:03.9600000",
        "end": "00:00:12.2700000"
    },
    {
        "start": "00:00:13.9900000",
        "end": "00:00:15.6100000"
    }
    ]
}
] 
```

#### <a name="visualcontentmoderation"></a>visualContentModeration

Блок visualContentModeration содержит диапазоны времени, в которых Индексатор видео, вероятно, обнаружил содержимое для взрослых. Если Висуалконтентмодератион является пустым, то не обнаружено содержимого для взрослых.

Видео, в которых обнаружено содержимое для взрослых или содержимое непристойного характера, могут быть доступны только для закрытого просмотра. Пользователи могут отправить запрос на проверку содержимого, в этом случае `IsAdult` атрибут будет содержать результат проверки человека.

|Имя|Описание|
|---|---|
|идентификатор|Идентификатор модерации визуального контента.|
|adultScore|Результат оценки содержимого для взрослых (от Content Moderator).|
|racyScore|Результат оценки содержимого непристойного характера (от Content Moderator).|
|instances|Список диапазонов времени, где применяется модерация контента.|

```json
"VisualContentModeration": [
{
    "id": 0,
    "adultScore": 0.00069,
    "racyScore": 0.91129,
    "instances": [
    {
        "start": "00:00:25.4840000",
        "end": "00:00:25.5260000"
    }
    ]
},
{
    "id": 1,
    "adultScore": 0.99231,
    "racyScore": 0.99912,
    "instances": [
    {
        "start": "00:00:35.5360000",
        "end": "00:00:35.5780000"
    }
    ]
}
] 
```
## <a name="next-steps"></a>Дальнейшие действия

[Руководство. Анализ видео с помощью Служб мультимедиа Azure](analyze-videos-tutorial-with-api.md)
