---
title: Диагностика транзакций Azure Application Insights | Документация Майкрософт
description: Сведения о полной диагностике транзакций в Application Insights.
services: application-insights
documentationcenter: .net
author: mrbullwinkle
manager: carmonm
ms.service: application-insights
ms.workload: TBD
ms.tgt_pltfrm: ibiza
ms.topic: conceptual
ms.date: 01/19/2018
ms.reviewer: sdash
ms.author: mbullwin
ms.openlocfilehash: c6c44525018e2115f1df8ed2d3f15432b95490c6
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "60783712"
---
# <a name="unified-cross-component-transaction-diagnostics"></a>Единый интерфейс диагностики транзакций между компонентами

Единый интерфейс диагностики автоматически сопоставляет серверные данные телеметрии со всех отслеживаемых службой Application Insights компонентов в одном представлении. Количество ресурсов с отдельными ключами инструментирования не имеет значения. Application Insights определяет базовые связи и позволяет легко диагностировать компоненты приложения, зависимости или исключения, вызвавшие замедление или сбой выполнения транзакции.

## <a name="what-is-a-component"></a>Что такое компонент?

Компоненты — это независимо развертываемые части распределенного приложения или приложения для микрослужб. Разработчики и операционные команды могут просматривать данные телеметрии, созданные компонентами приложения, на уровне кода.

* Компоненты отличаются от наблюдаемых внешних зависимостей, таких как база данных SQL или концентратор событий, к которым команды или организации могут не иметь доступа (код или данные телеметрии).
* Компоненты выполняются на любом количестве экземпляров серверов, ролей или контейнеров.
* К компонентам могут относиться отдельные ключи инструментирования Application Insights (даже из разных подписок) или разные роли, относящиеся к одному такому ключу. В новом интерфейсе отображаются сведения обо всех компонентах, независимо от способа их настройки.

> [!NOTE]
> * **Отсутствуют связи со связанным элементом?** Все связанные данные телеметрии находятся в [верхних](#cross-component-transaction-chart) и [нижних](#all-telemetry-with-this-operation-id) разделах слева. 

## <a name="transaction-diagnostics-experience"></a>Интерфейс диагностики транзакций
Это представление состоит из четырех основных частей: список результатов, диаграмма транзакций между компонентами, последовательный список данных телеметрии, связанных с этой операцией, и область сведений, в которой слева отображается любой выбранный элемент телеметрии.

![Основные части](media/transaction-diagnostics/4partsCrossComponent.png)

## <a name="cross-component-transaction-chart"></a>Диаграмма транзакций между компонентами

Эта диаграмма содержит временную шкалу с горизонтальными линиями длительности запросов и зависимостей между компонентами. На ней также помечены все собранные исключения.

* Верхняя строка этой диаграммы представляет точку входа (входящий запрос к первому компоненту, вызванному в этой транзакции). Длительность — это общее время, необходимое, чтобы завершить транзакцию.
* Все вызовы к внешним зависимостям — это простые несворачиваемые строки со значками, представляющими тип зависимости.
* Сворачиваемые строки представляют вызовы к другим компонентам. Каждая строка соответствует определенной операции, вызванной в компоненте.
* По умолчанию справа отображается выбранный запрос, зависимость или исключение.
* Щелкните любую строку, чтобы просмотреть [сведения из нее в области справа](#details-of-the-selected-telemetry). 

> [!NOTE]
> Вызовы к другим компонентам отображаются в виде двух строк: одна представляет исходящий вызов (зависимость) из компонента вызывающей стороны, а другая — входящий запрос в вызываемом компоненте. Разницу между ними можно определить по значку и стилю линий длительности.

## <a name="all-telemetry-with-this-operation-id"></a>Все данные телеметрии с идентификатором этой операции

В этом разделе показано представление неструктурированного списка во временной последовательности всех данных телеметрии, связанных с этой транзакцией. Здесь также показаны пользовательские события и трассировки, которые не отображаются на диаграмме транзакций. Вы можете отфильтровать этот список, чтобы отображались данные телеметрии, созданные с помощью определенного компонента или вызова. Выберите любой элемент телеметрии, чтобы просмотреть соответствующие [сведения в области справа](#details-of-the-selected-telemetry).

![Временная последовательность всех данных телеметрии](media/transaction-diagnostics/allTelemetryDrawerOpened.png)

## <a name="details-of-the-selected-telemetry"></a>Подробные сведения о выбранном элементе телеметрии

В этой свертываемой области отображаются сведения о любом выбранном элементе в виде диаграммы транзакций или списка. Если щелкнуть "Показать все", отобразятся все собранные стандартные атрибуты. Все настраиваемые атрибуты отдельно перечислены под стандартным набором. Щелкните "..." ниже в окне трассировки стека, чтобы получить возможность скопировать трассировку. Щелкните Open profiler traces (Открыть трассировки профилировщика) или Open debug snapshot (Открыть моментальный снимок отладки), чтобы просмотреть данные диагностики на уровне кода в соответствующих областях.

![Сведения об исключении](media/transaction-diagnostics/exceptiondetail.png)

## <a name="search-results"></a>Результаты поиска

В этой свертываемой области отображаются другие результаты, которые соответствуют условиям фильтра. Щелкните любой результат, чтобы обновить соответствующие сведения в 3 разделах, перечисленных выше. Мы пытаемся найти образцы, в которых вероятнее всего содержатся сведения, доступные из всех компонентов даже в том случае, если выборка действует в одном из них. Они отображаются в виде "предложенных" примеров.

![Результаты поиска](media/transaction-diagnostics/searchResults.png)

## <a name="profiler-and-snapshot-debugger"></a>Profiler и Snapshot Debugger

[Application Insights Profiler](../../azure-monitor/app/profiler.md) и [Snapshot Debugger](snapshot-debugger.md) упрощают диагностику проблем производительности и ошибок на уровне кода. Эти средства позволяют легко просматривать трассировки профилировщика и моментальные снимки из любого компонента.

Если не удалось получить Profiler работает, обратитесь в службу **serviceprofilerhelp\@microsoft.com**

Если не удалось получить рабочий отладчик моментальных снимков, обратитесь в службу **snapshothelp\@microsoft.com**

![Интеграция профилировщика](media/transaction-diagnostics/profilerTraces.png)

## <a name="faq"></a>Часто задаваемые вопросы

*На диаграмме отображается один компонент, а остальные показаны как внешние зависимости без каких-либо сведений о том, что с ними случилось.*

Возможные причины:

* Эти другие компоненты не инструментированы с помощью Application Insights.
* В них используется не последняя стабильная версия пакета SDK Application Insights.
* Если это отдельные ресурсы Application Insights, возможно, отсутствуют необходимые права доступа к их данным телеметрии.

Если вы имеете доступ и компоненты инструментированы с помощью последних версий пакетов SDK Application Insights, сообщите об этом через канал обратной связи в верхнем правом углу.

*Строки зависимостей повторяются. Так и должно быть?*

Сейчас исходящий вызов зависимости отображается отдельно от входящего запроса. Как правило, эти два вызова выглядят одинаково. Единственное различие заключается в значении длительности, которое зависит от кругового пути в сети. Разницу между ними можно определить по значку и стилю линий длительности. Если такое представление данных слишком трудное, отправьте нам свой отзыв!

*Что происходит, если часы разных экземпляров компонентов рассинхронизированы?*

Временные шкалы на диаграмме транзакций приводятся в соответствие. Вы можете просмотреть точные метки времени в области сведений или с помощью Analytics.

*Почему в новом интерфейсе отсутствует большинство запросов связанных элементов?*

Это сделано специально. Все связанные элементы компонентов уже доступны в левой части (верхние и нижние разделы). В левой части нового интерфейса отсутствуют два связанных элемента: все данные телеметрии, полученные в течение пяти минут до или после этого события, и временная шкала пользователя.
