---
title: Непрерывный мониторинг конвейера выпуска DevOps с помощью Azure Pipelines и Azure Application Insights | Документация Майкрософт
description: Содержит инструкции для быстрой настройки непрерывного мониторинга с помощью Application Insights
ms.service: azure-monitor
ms.subservice: application-insights
ms.topic: conceptual
author: mrbullwinkle
ms.author: mbullwin
ms.date: 07/16/2019
ms.openlocfilehash: c891cc7564a60dfd665d84d569e266332d255fa9
ms.sourcegitcommit: 1bd2207c69a0c45076848a094292735faa012d22
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2019
ms.locfileid: "72677517"
---
# <a name="add-continuous-monitoring-to-your-release-pipeline"></a>Добавление постоянного мониторинга к конвейеру выпуска

Azure Pipelines интегрируется с Application Insights Azure, чтобы обеспечить непрерывный мониторинг конвейера выпуска DevOps на протяжении всего жизненного цикла разработки программного обеспечения. 

Благодаря непрерывному мониторингу конвейеры выпуска могут включать данные мониторинга из Application Insights и других ресурсов Azure. Когда конвейер выпуска обнаруживает Application Insightsное оповещение, конвейер может выполнить откат развертывания, пока не будет устранено предупреждение. Если все проверки пройдены, развертывания могут автоматически протестировать все возможности рабочей среды, не требуя вмешательства вручную. 

## <a name="configure-continuous-monitoring"></a>Настройка непрерывного мониторинга

1. В [Azure DevOps](https://dev.azure.com)выберите организацию и проект.
   
1. В меню слева страницы проекта выберите **конвейеры**  > **выпуски**. 
   
1. Раскройте стрелку рядом с полем **создать** и выберите **Новый конвейер выпуска**. Если у вас еще нет конвейера, на появившейся странице выберите **создать конвейер** .
   
1. На панели **Выбор шаблона** найдите и выберите **развертывание службы приложений Azure с непрерывным мониторингом**, а затем нажмите кнопку **Применить**. 

   ![Новый конвейер выпуска Azure Pipelines](media/continuous-monitoring/001.png)

1. В поле **этап 1** выберите гиперссылку, чтобы **просмотреть задачи этапа.**

   ![Просмотр задач этапа](media/continuous-monitoring/002.png)

1. В области конфигурации **этап 1** заполните следующие поля: 

    | Параметр        | Value |
   | ------------- |:-----|
   | **Название этапа**      | Укажите имя этапа или оставьте его на **этапе 1**. |
   | **Подписка Azure.** | Раскрывающийся список и выберите связанную подписку Azure, которую хотите использовать.|
   | **Тип приложения** | Раскрывающийся список и выберите тип приложения. |
   | **Имя службы приложений** | Введите имя службы приложений Azure. |
   | **Имя группы ресурсов для Application Insights**    | Раскрывающийся список и выберите группу ресурсов, которую вы хотите использовать. |
   | **Имя ресурса Application Insights** | Раскрывающийся список и выберите ресурс Application Insights для выбранной группы ресурсов.

1. Чтобы сохранить конвейер со стандартными параметрами правил генерации оповещений, выберите **сохранить** в верхнем правом углу окна Azure DevOps. Введите описательный комментарий и нажмите кнопку **ОК**.

## <a name="modify-alert-rules"></a>Изменение правил генерации оповещений

Не заполнено. шаблон **развертывания службы приложений Azure с непрерывным мониторингом** имеет четыре правила генерации оповещений: **доступность**, **неудачные запросы**, **время ответа сервера**и **исключения сервера**. Можно добавить дополнительные правила или изменить параметры правил в соответствии с потребностями уровня обслуживания. 

Чтобы изменить параметры правила генерации оповещений, выполните следующие действия.

1. В левой области страницы конвейер выпуска выберите **настроить Application Insights оповещения**.

1. В области **оповещения Azure Monitor** нажмите кнопку с многоточием **...** рядом с полем **Правила оповещений**.
   
1. В диалоговом окне **правила генерации оповещений** щелкните значок раскрывающегося списка рядом с правилом оповещения, например **доступность**. 
   
1. Измените **пороговое значение** и другие параметры в соответствии с вашими требованиями.
   
   ![Изменить оповещение](media/continuous-monitoring/003.png)
   
1. Нажмите кнопку **ОК**, а затем выберите **сохранить** в верхнем правом углу окна Azure DevOps. Введите описательный комментарий и нажмите кнопку **ОК**.

## <a name="add-deployment-conditions"></a>Добавление условий развертывания

При добавлении шлюзов развертывания в конвейер выпусков предупреждение, которое превышает установленные пороговые значения, предотвращает нежелательное повышение выпуска. После устранения этого предупреждения развертывание может быть продолжено автоматически.

Чтобы добавить шлюзы развертывания, выполните следующие действия.

1. На главной странице конвейера в разделе **этапы**выберите **условия до** или **после развертывания** условия, в зависимости от того, на каком этапе требуется непрерывный шлюз мониторинга.
   
   ![Условия перед развертыванием](media/continuous-monitoring/004.png)
   
1. В области Конфигурация **условий перед развертыванием** установите для параметра **шлюз** значение **включено**.
   
1. Рядом с полем **шлюз развертывания**выберите **Добавить**.
   
1. В раскрывающемся меню выберите **запрос Azure Monitor оповещения** . Этот параметр позволяет получить доступ к предупреждениям Azure Monitor и Application Insights.
   
   ![Предупреждения Azure Monitor запросов](media/continuous-monitoring/005.png)
   
1. В разделе **параметры оценки**введите нужные значения параметров, например **время между повторным вычислением шлюзов** и **временем ожидания, по истечении которого шлюз завершается сбоем**. 

## <a name="view-release-logs"></a>Просмотр журналов выпусков

Поведение шлюза развертывания и другие шаги выпуска можно просмотреть в журналах выпусков. Чтобы открыть журналы, выполните следующие действия.

1. В меню слева на странице конвейера выберите **выпуски** . 
   
1. Выберите любой выпуск. 
   
1. В разделе **этапы**выберите любой этап, чтобы просмотреть сводку по выпуску. 
   
1. Чтобы просмотреть журналы, выберите **Просмотреть журналы** в сводке по выпуску, выберите гиперссылку **успешно** или **неудачно** на любом этапе или наведите указатель на любую стадию и выберите **журналы**. 
   
   ![Просмотр журналов выпусков](media/continuous-monitoring/006.png)

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о Azure Pipelines см. в [документации по Azure pipelines](https://docs.microsoft.com/azure/devops/pipelines).
