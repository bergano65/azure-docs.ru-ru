---
title: Управление рабочими областями Log Analytics в Azure Monitor | Документация Майкрософт
description: Вы можете управлять рабочими областями Log Analytics в Azure Monitor с помощью различных задач администрирования, применяемых к пользователям, учетным записям, рабочим областям и учетным записям Azure.
services: log-analytics
documentationcenter: ''
author: mgoedtel
manager: carmonm
editor: ''
ms.assetid: d0e5162d-584b-428c-8e8b-4dcaa746e783
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.topic: conceptual
ms.date: 02/07/2019
ms.author: magoedte
ms.openlocfilehash: 66cef8369a314a76cf619e436cd25d6bdf628c45
ms.sourcegitcommit: 2d0fb4f3fc8086d61e2d8e506d5c2b930ba525a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/18/2019
ms.locfileid: "58076315"
---
# <a name="manage-log-data-and-workspaces-in-azure-monitor"></a>Управление данными журнала и рабочими областями в Azure Monitor
Azure Monitor хранит данные журнала в рабочей области Log Analytics, которая является контейнером, который содержит сведения о данных и конфигурации. Чтобы управлять доступом к данным журнала, используйте разные задачи администрирования, связанные с рабочими областями. Вы или другие члены организации могут использовать несколько рабочих областей для управления различными наборами данных, собранными из всех частей ИТ-инфраструктуры.

В этой статье объясняется, как для управления доступом к журналам и Администрирование рабочих областей, которые содержат их. 

## <a name="create-a-workspace"></a>Создание рабочей области
Чтобы создать рабочую область Log Analytics, вам потребуется:

1. Создать подписку Azure.
2. Выбрать имя рабочей области.
3. Связать рабочую область с одной из своих подписок и групп ресурсов.
4. Выбрать географическое расположение.

См. в следующих статьях, Дополнительные сведения о создании рабочей области:

- [Создание рабочей области Log Analytics на портале Azure](../learn/quick-create-workspace.md)
- [Создание рабочей области Log Analytics с помощью Azure CLI 2.0](../learn/quick-create-workspace-cli.md)
- [Создание рабочей области Log Analytics с помощью Azure PowerShell](../learn/quick-create-workspace-posh.md)

## <a name="determine-the-number-of-workspaces-you-need"></a>Определение необходимого количества рабочих областей
Рабочая область Log Analytics — это ресурс Azure и контейнер, где данные собираются, группируются, анализируются и представляются в Azure Monitor. В одной подписке Azure у вас может быть несколько рабочих областей, и вы можете иметь к ним доступ, а также легко создавать запросы между областями. В этом разделе описывается, в каких ситуациях может пригодиться создание более чем одной рабочей области.

Рабочая область Log Analytics предоставляет следующие преимущества:

* Географическое расположение для хранения данных.
* Изоляция данных для определения прав доступа другого пользователя в режиме ориентированные на рабочей области. Не является значимым при работе в режиме ориентированные на ресурс.
* Область действия для настройки параметров, например [ценовой](https://docs.microsoft.com/azure/azure-monitor/platform/manage-cost-storage#changing-pricing-tier), [хранения](https://docs.microsoft.com/azure/azure-monitor/platform/manage-cost-storage#change-the-data-retention-period) и [ограниченного выделения данных](https://docs.microsoft.com/azure/azure-monitor/platform/manage-cost-storage#daily-cap).
* Расходы, связанные с приеме и хранении данных вносятся в ресурсе рабочей области.

В контексте потребления рекомендуется создавать минимальное число рабочих областей. Это упростит и ускорит процессы администрирования и выполнения запросов. Но даже с учетом указанного вы можете создать большее число рабочих областей в следующих ситуациях:

* Вы являетесь глобальной компанией, и по причинам конфиденциальности или в соответствии с нормативными требованиями вам необходимо хранить данные журнала в определенных регионах.
* Вы используете Azure и хотите избежать расходов на передачу исходящих данных, создав рабочую область в том же регионе, где находятся ресурсы Azure, которыми она управляет.
* Вы являетесь поставщиком управляемой службы, и вам необходимо хранить данные службы Log Analytics по каждому клиенту отдельно от данных других клиентов.
* Вы управляете несколькими клиентами и хотите, чтобы каждый клиент / отдел или бизнес-группа см. в разделе свои собственные данные, но не данные от других, и нет необходимости бизнеса для консолидированных перекрестного клиента / отдел или бизнес-группа представления.».

При использовании агентов Windows для сбора данных [каждый агент можно настроить таким образом, чтобы он отправлял отчеты в одну или несколько рабочих областей](../../azure-monitor/platform/agent-windows.md).

При использовании System Center Operations Manager, каждую группу управления Operations Manager можно подключить только к одной рабочей области. Microsoft Monitoring Agent можно установить на компьютеры под управлением Operations Manager и настроить его таким образом, чтобы он отправлял отчеты и в Operations Manager, и в другую рабочую область Log Analytics.

После определения архитектура рабочей области следует применить эту политику на ресурсы Azure с помощью ["Политика Azure"](../../governance/policy/overview.md). Это может обеспечить это встроенные определение, которое будет автоматически применяться ко всем ресурсам Azure. Например можно задать политику, которая гарантирует отправку всех своих журналов диагностики всех ресурсов Azure в определенном регионе для определенной рабочей области.

## <a name="view-workspace-details"></a>Просмотр сведений о рабочей области
При анализе данных в рабочую область Log Analytics из **Azure Monitor** меню на портале Azure, создание и управление рабочими областями в **рабочих областей Log Analytics** меню.
 

1. Войдите на [портал Azure](https://portal.azure.com) и щелкните **Все службы**. В списке ресурсов введите **Log Analytics**. Как только вы начнете вводить символы, список отфильтруется соответствующим образом. Выберите рабочие области **Log Analytics**.  

    ![Портал Azure](media/manage-access/azure-portal-01.png)  

3. Выберите рабочую область в списке.

4. На странице рабочей области отображаются сведения о рабочей области, Приступая к работе, конфигурации и ссылки на дополнительные сведения.  

    ![Сведения о рабочей области](./media/manage-access/workspace-overview-page.png)  


## <a name="workspace-permissions-and-scope"></a>Разрешения для рабочей области и области
Данные, которые пользователь имеет доступ к зависит от нескольких факторов, которые перечислены в следующей таблице. Каждый описан в следующих разделах.

| Коэффициент | ОПИСАНИЕ |
|:---|:---|
| [Режим доступа](#access-modes) | Метод, который пользователь использует для доступа к рабочей области.  Определяет область данных, доступных и режим управления доступа, который применяется. |
| [Режим управления доступом](#access-control-mode) | Установка на рабочую область, которая определяет, применены ли разрешения на уровне рабочей области или ресурсов. |
| [Разрешения](#manage-accounts-and-users) | Разрешения, установленные для отдельных страниц или групп пользователей для рабочей области или ресурса. Определяет, какие данные он будет иметь доступ к. |
| [RBAC на уровне таблицы](#table-level-rbac) | Необязательный детализированные разрешения, к которым применяется ко всем пользователям независимо от их режима доступа и режим управления доступом. Определяет, какие типы данных, имеет доступ пользователь. |



## <a name="access-modes"></a>Режимы доступа
_Режим доступа к_ определяет область данных, они могут получить доступ и рассматриваются как пользователь получает доступ к рабочей области Log Analytics. 

**Ориентированные на рабочей области**: В этом режиме пользователь может просматривать все журналы в них нет разрешений на рабочую область. Запросы в этом режиме относятся ко всем данным во всех таблицах в рабочей области. Это режим доступа, используемый для журналов можно получить с рабочей областью в качестве области, например при выборе **журналы** из **Azure Monitor** меню на портале Azure.

**Ориентированные на ресурс**: При доступе к рабочей области для определенного ресурса, например при выборе **журналы** из меню ресурсов на портале Azure, вы можете просматривать журналы только этого ресурса во всех таблицах, имеющих доступ к. Запросы в этом режиме ограничиваются только данные, связанные с этим ресурсом. Этот режим также позволяет управления детальный доступ на основе ролей (RBAC). 

> [!NOTE]
> Журналы доступны для запросов, ориентированных на ресурс только в том случае, если они были должным образом связаны с соответствующим ресурсом. В настоящее время следующие ресурсы имеют ограничения. 
> - Компьютеры за пределами Azure
> - Service Fabric
> - Application Insights
> - Контейнеры
> - Пользовательские журналы, созданные API сборщика данных HTTP
>
> Вы можете проверить, если журналы должным образом связанных с их ресурсов, выполнив запрос и просмотр записей вас интересует. Если неверный идентификатор ресурса находится в [_ResourceId](log-standard-properties.md#_resourceid) свойства, а затем данных доступен для запросов, ориентированных на ресурс.

### <a name="comparing-access-modes"></a>Сравнение режимов доступа

В следующей таблице перечислены режимы доступа:

| | Ориентированные на рабочей области | Ориентированные на ресурс |
|:---|:---|:---|
| Для кого предназначено каждой модели? | Центр администрирования. Администраторы, которые необходимо настроить сбор данных и пользователей нуждающихся в доступе на различных ресурсов. В настоящее время необходимо для пользователей, имеющих доступ к ресурсам за пределами Azure в журналах. | Группы приложений. Администраторы отслеживаемых ресурсов Azure. |
| Просмотр журналов, что требует пользователя? | Разрешения в рабочую область. См. в разделе **разрешения рабочего пространства** в [управление учетными записями и пользователями](#manage-accounts-and-users). | Доступ к ресурсу для чтения. См. в разделе **разрешения на ресурсы** в [управление учетными записями и пользователями](#manage-accounts-and-users). Разрешения могут быть унаследованной (например FROM содержащей ее группы ресурсов) или напрямую назначенной к ресурсу. Будет автоматически назначается разрешение в журналы для ресурса. |
| Что такое область разрешений. | Рабочая область. Пользователи, имеющие доступ к рабочей области можно запросить все журналы в этой рабочей области из таблиц, которые они имеют разрешения на. См. в разделе [таблицы управления доступом](#table-access-control) | Ресурсов Azure. Пользователь может запросить журналы для ресурсов они доступны из любой рабочей области, но не удается запросить журналы для других ресурсов. |
| Как можно пользователя доступ к журналам? | Запуск **журналы** из **Azure Monitor** меню или **рабочих областей Log Analytics**. | Запуск **журналы** меню для ресурсов Azure. |


## <a name="access-control-mode"></a>Режим управления доступом
_Режим управления доступа_ это параметр для каждого рабочие области, определяющий способ определения разрешений для этой рабочей области.

**Требуются разрешения рабочей области**:  Этот режим элемента управления не поддерживает детализированные RBAC. Для пользователя для доступа к рабочей области они должны быть предоставлены разрешения для рабочей области или для отдельных таблиц. 

Если пользователь обращается к рабочей области в режиме ориентированные на рабочей области, они будут иметь доступ ко всем данным таблицы, которые им был предоставлен доступ к. Если пользователь обращается к рабочей области в режиме ориентированные на ресурс, они будут иметь доступ к данным только для этого ресурса, в каких таблицах, которые им был предоставлен доступ к.

Это параметр по умолчанию для всех рабочих областей, созданных до марта 2019 г.

**Использование ресурсов или рабочей области разрешений**: Этот режим управления позволяет детализированные RBAC. Пользователям предоставляется доступ к только данные, связанные с ресурсами, их можно просматривать с помощью разрешений Azure, ресурсы, которые они могут `read` разрешение. 

Когда пользователь обращается к рабочей области в режиме ориентированные на рабочей области, разрешения рабочей области, продолжают действовать. Когда пользователь обращается к рабочей области в режиме ориентированные на ресурс, будет проверен только ресурс разрешения и разрешения для рабочей области будет игнорироваться. Включите RBAC для пользователя, удалив их из рабочей области разрешений и позволяя их разрешения ресурсов для распознавания.

Это параметр по умолчанию для всех рабочих областей, созданных после марта 2019 г.

> [!NOTE]
> Если у пользователя есть только разрешения ресурсов в рабочую область, они будут только возможность доступа к рабочей области с помощью [ориентированных ресурсов режим](#access-modes).


### <a name="define-access-control-mode-in-azure-portal"></a>Определить режим управления доступом на портале Azure
Вы можете просмотреть текущий режим элемента управления доступа к рабочей области на **Обзор** страницы для рабочей области в **рабочей области Log Analytics** меню.

![Режим управления доступа к рабочей области представления](media/manage-access/view-access-control-mode.png)

Этот параметр можно изменить на **свойства** страницы для рабочей области. Изменять этот параметр будет отключен, если у вас нет разрешений для настройки рабочей области.

![Изменение режима доступа к рабочей области](media/manage-access/change-access-control-mode.png)

### <a name="define-access-control-mode-in-azure-portal"></a>Определить режим управления доступом на портале Azure
Вы можете просмотреть текущий режим элемента управления доступа к рабочей области на **Обзор** страницы для рабочей области в **рабочей области Log Analytics** меню.

![Режим управления доступа к рабочей области представления](media/manage-access/view-access-control-mode.png)

Этот параметр можно изменить на **свойства** страницы для рабочей области. Изменять этот параметр будет отключен, если у вас нет разрешений для настройки рабочей области.

![Изменение режима доступа к рабочей области](media/manage-access/change-access-control-mode.png)

### <a name="define-access-control-mode-in-powershell"></a>Определение режима контроля доступа в PowerShell

Для проверки элемента управления режим доступа для всех рабочих областей в подписке, используйте следующую команду:

```PowerShell
Get-AzResource -ResourceType Microsoft.OperationalInsights/workspaces -ExpandProperties | foreach {$_.Name + ": " + $_.Properties.features.enableLogAccessUsingOnlyResourcePermissions} 
```

Чтобы задать режим контроля доступа для конкретной рабочей области, используйте следующий сценарий:

```PowerShell
$WSName = "my-workspace"
$Workspace = Get-AzResource -Name $WSName -ExpandProperties
if ($Workspace.Properties.features.enableLogAccessUsingOnlyResourcePermissions -eq $null) 
    { $Workspace.Properties.features | Add-Member enableLogAccessUsingOnlyResourcePermissions $true -Force }
else 
    { $Workspace.Properties.features.enableLogAccessUsingOnlyResourcePermissions = $true }
Set-AzResource -ResourceId $Workspace.ResourceId -Properties $Workspace.Properties -Force
```

Используйте следующий сценарий, чтобы задать режим контроля доступа для всех рабочих областей в подписке

```PowerShell
Get-AzResource -ResourceType Microsoft.OperationalInsights/workspaces -ExpandProperties | foreach {
if ($_.Properties.features.enableLogAccessUsingOnlyResourcePermissions -eq $null) 
    { $_.Properties.features | Add-Member enableLogAccessUsingOnlyResourcePermissions $true -Force }
else 
    { $_.Properties.features.enableLogAccessUsingOnlyResourcePermissions = $true }
Set-AzResource -ResourceId $_.ResourceId -Properties $_.Properties -Force
```

### <a name="define-access-mode-in-resource-manager-template"></a>Определить режим доступа в шаблоне Resource Manager
Чтобы настроить режим доступа в шаблоне Azure Resource Manager, установите **enableLogAccessUsingOnlyResourcePermissions** компонентов флаг в рабочей области для одного из следующих значений.

- **False**: Задайте рабочую область, ориентированных на рабочей области разрешений. Это параметр по умолчанию, если флаг не установлен.
- **Значение true,**: Задайте рабочую область, ориентированных на ресурс разрешения.


## <a name="manage-accounts-and-users"></a>Управление учетными записями и пользователями
Разрешения для рабочей области, которые применяются к конкретному пользователю определяются их режима доступа и [режим управления доступа](#access-control-mode) рабочей области. **Разрешения для рабочей области** применяются, когда пользователь получает доступ к рабочей области с помощью **ориентированных на рабочей области** в [ориентированных на рабочей области режим](#access-modes). **Разрешения на ресурсы** применяются, когда пользователь получает доступ к рабочей области с **использование ресурсов или рабочей области разрешений** [режим управления доступа](#access-control-mode) с помощью [ориентированных ресурсов режим ](#access-modes).

### <a name="workspace-permissions"></a>Разрешения для рабочей области
Каждая рабочая область может включать учетных записей, каждая из которых может иметь доступ к нескольким рабочим областям. Управление доступом осуществляется через [управление доступом на основе ролей Azure](../../role-based-access-control/role-assignments-portal.md). 


Разрешения Azure также требуются для следующих действий:

| Действие                                                          | Требуются разрешения Azure | Примечания |
|-----------------------------------------------------------------|--------------------------|-------|
| Добавление и удаление решений для мониторинга                        | `Microsoft.Resources/deployments/*` <br> `Microsoft.OperationalInsights/*` <br> `Microsoft.OperationsManagement/*` <br> `Microsoft.Automation/*` <br> `Microsoft.Resources/deployments/*/write` | Эти разрешения нужно предоставить на уровне группы ресурсов или подписки. |
| Изменение ценовой категории                                       | `Microsoft.OperationalInsights/workspaces/*/write` | |
| Просмотр данных на плитках *службы архивации* и *службы Site Recovery* | Администратор или соадминистратор | Имеет доступ к ресурсам, развернутым с использованием классической модели развертывания |
| Создание рабочей области на портале Azure                        | `Microsoft.Resources/deployments/*` <br> `Microsoft.OperationalInsights/workspaces/*` ||


#### <a name="manage-access-to-log-analytics-workspace-using-azure-permissions"></a>Управление доступом к рабочей области Log Analytics, используя разрешения Azure 
Чтобы предоставить доступ к рабочей области Log Analytics с помощью разрешений Azure, следуйте указаниям в статье [Использование назначений ролей для управления доступом к ресурсам в подписке Azure](../../role-based-access-control/role-assignments-portal.md).

В Azure доступны две встроенные роли пользователя для рабочих областей Log Analytics:
- читатель Log Analytics;
- участник Log Analytics.

Членам роли *Читатель Log Analytics* доступны следующие действия:
- просмотр и поиск всех данных мониторинга; 
- просмотр параметров мониторинга, в том числе просмотр конфигурации диагностики Azure на всех ресурсах Azure.

Роль читателя Log Analytics включает следующие действия Azure:

| type    | Разрешение | ОПИСАНИЕ |
| ------- | ---------- | ----------- |
| Действие | `*/read`   | Возможность просматривать все ресурсы Azure и их конфигурацию. Включает просмотр следующих данных: <br> состояние расширения виртуальной машины; <br> конфигурация диагностики Azure на ресурсах; <br> все свойства и параметры всех ресурсов. |
| Действие | `Microsoft.OperationalInsights/workspaces/analytics/query/action` | Возможность выполнять запросы поиска по журналам версии 2. |
| Действие | `Microsoft.OperationalInsights/workspaces/search/action` | Возможность выполнять запросы поиска по журналам версии 1. |
| Действие | `Microsoft.Support/*` | Возможность создавать обращения в службу поддержки. |
|Запрет действия | `Microsoft.OperationalInsights/workspaces/sharedKeys/read` | Запрет на чтение ключа рабочей области, необходимого для использования API сбора данных и для установки агентов. Это предотвращает добавление новых ресурсов в рабочую область |


Членам роли *Участник Log Analytics* доступны следующие действия:
- чтение всех данных мониторинга, доступных для роли читателя Log Analytics;  
- создание и настройка учетных записей службы автоматизации;  
- Добавление и удаление решений по управлению    
    > [!NOTE] 
    > Чтобы выполнять последние два действия, нужно предоставить разрешение на уровне группы ресурсов или подписки.  

- чтение ключей учетной записи хранения;   
- настройка сбора журналов из службы хранилища Azure;  
- изменение параметров мониторинга ресурсов Azure, в том числе:
  - добавление расширения виртуальных машин на виртуальные машины;
  - настройка диагностики Azure на всех ресурсах Azure.

> [!NOTE] 
> Можно добавить расширение виртуальной машины на виртуальную машину, чтобы получить полный контроль над ней.

Роль участника Log Analytics включает следующие действия Azure:

| Разрешение | ОПИСАНИЕ |
| ---------- | ----------- |
| `*/read`     | Возможность просматривать все ресурсы и конфигурацию ресурсов. Включает просмотр следующих данных: <br> состояние расширения виртуальной машины; <br> конфигурация диагностики Azure на ресурсах; <br> все свойства и параметры всех ресурсов. |
| `Microsoft.Automation/automationAccounts/*` | Возможность создания и настройки учетных записей службы автоматизации Azure, в том числе добавление и изменение модулей Runbook. |
| `Microsoft.ClassicCompute/virtualMachines/extensions/*` <br> `Microsoft.Compute/virtualMachines/extensions/*` | Добавление, обновление и удаление расширений виртуальных машин, в том числе расширения Microsoft Monitoring Agent и агента OMS для расширения Linux. |
| `Microsoft.ClassicStorage/storageAccounts/listKeys/action` <br> `Microsoft.Storage/storageAccounts/listKeys/action` | Просмотр ключа учетной записи хранения. Эта возможность необходима для настройки в Log Analytics чтения журналов из учетных записей хранения Azure. |
| `Microsoft.Insights/alertRules/*` | Добавление, обновление и удаление правил генерации оповещений. |
| `Microsoft.Insights/diagnosticSettings/*` | Добавление, обновление и удаление параметров диагностики в ресурсах Azure. |
| `Microsoft.OperationalInsights/*` | Добавление, обновление и удаление конфигурации рабочих областей Log Analytics. |
| `Microsoft.OperationsManagement/*` | Добавление и удаление решений по управлению. |
| `Microsoft.Resources/deployments/*` | Создание и удаление развертываний. Требуется для добавления и удаления решений, рабочих областей и учетных записей службы автоматизации. |
| `Microsoft.Resources/subscriptions/resourcegroups/deployments/*` | Создание и удаление развертываний. Требуется для добавления и удаления решений, рабочих областей и учетных записей службы автоматизации. |

Чтобы добавить пользователей в роль или удалить их из нее, требуются разрешения `Microsoft.Authorization/*/Delete` и `Microsoft.Authorization/*/Write`.

С помощью этих ролей можно предоставлять пользователям доступ к различным областям:
- Подписка — доступ ко всем рабочим областям в подписке.
- Группа ресурсов — доступ ко всем рабочим областям в группе ресурсов.
- Ресурс — доступ к только указанной рабочей области.

Следует выполнять назначения на уровне ресурсов (рабочей области), чтобы обеспечить точное управление доступом.  Используйте [пользовательские роли](../../role-based-access-control/custom-roles.md) для создания ролей с определенными разрешениями.

### <a name="resource-permissions"></a>Разрешения на ресурсы 
Когда из рабочей области с помощью ориентированных ресурсов access входит запросов пользователей, они будет иметь следующие разрешения ресурса:

| Разрешение | ОПИСАНИЕ |
| ---------- | ----------- |
| `Microsoft.Insights/logs/<tableName>/read`<br><br>Примеры:<br>`Microsoft.Insights/logs/*/read`<br>`Microsoft.Insights/logs/Heartbeat/read` | Возможность просматривать все данные журнала для ресурса.  |


Это разрешение обычно предоставляется из роли, которая включает  _\*/чтение или_ _\*_ разрешений, таких как встроенная [чтения](../../role-based-access-control/built-in-roles.md#reader) и [ Участник](../../role-based-access-control/built-in-roles.md#contributor) ролей. Обратите внимание, что пользовательские роли, которые содержат определенные действия или выделенные встроенные роли могут не включать это разрешение.

См. в разделе [определение управления доступом по таблицам](#defining-per-table-access-control) ниже, если вы хотите создать разные средства управления доступом для разных таблиц.


## <a name="table-level-rbac"></a>RBAC на уровне таблицы
**RBAC на уровне таблицы** позволяет обеспечивают более детальный контроль к данным в рабочей области Log Analytics, а также другие разрешения. Этот элемент управления можно задать определенные типы данных, доступных только для определенного набора пользователей.

Реализация управления доступом на таблице с [Azure пользовательские роли](../../role-based-access-control/custom-roles.md) чтобы предоставить или запретить доступ к конкретным [таблиц](../log-query/log-query-overview.md#how-azure-monitor-log-data-is-organized) в рабочей области. Эти роли применяются к рабочим областям, ориентированных на рабочей области или ориентированных ресурсов [режима управления доступа к](#access-control-modes) независимо от пользователя [режим доступа к](#access-mode).

Создание [пользовательской роли](../../role-based-access-control/custom-roles.md) со следующими действиями для определения доступа к таблице контроля доступа.

- Чтобы предоставить доступ к таблице, включите ее в **действия** раздел определения роли.
- Чтобы запретить доступ к таблице, включите ее в **NotActions** раздел определения роли.
- Используйте * для указания всех таблиц.

Например, чтобы создать роль с доступом к _пульса_ и _AzureActivity_ таблиц, создать пользовательскую роль с помощью следующих действий:

```
"Actions":  [
              "Microsoft.OperationalInsights/workspaces/query/Heartbeat/read",
              "Microsoft.OperationalInsights/workspaces/query/AzureActivity/read"
  ],
```

Создание роли с доступом только к _SecurityBaseline_ и нет других таблиц, создать пользовательскую роль с помощью следующих действий:

```
    "Actions":  [
        "Microsoft.OperationalInsights/workspaces/query/*/read"
    ],
    "NotActions":  [
        "Microsoft.OperationalInsights/workspaces/query/SecurityBaseline/read"
    ],
```

### <a name="custom-logs"></a>Пользовательские журналы
 Пользовательские журналы, создаваемые источников данных, таких как API сборщика данных HTTP и настраиваемые журналы. Самый простой способ определить тип журнала, — путем проверки таблиц, перечисленных в разделе [настраиваемые журналы в схеме журнала](../log-query/get-started-portal.md#understand-the-schema).

 В настоящее время нельзя предоставить или запретить доступ к отдельным пользовательских журналов, но можно предоставить или запретить доступ для всех пользовательских журналов. Создание роли с доступом для всех настраиваемых журналов, создайте настраиваемую роль с помощью следующих действий:

```
    "Actions":  [
        "Microsoft.OperationalInsights/workspaces/query/Tables.Custom/read"
    ],
```

### <a name="considerations"></a>Рекомендации

- Если пользователю предоставлено глобального чтение с помощью стандартных читателя или участника роли, которые содержат  _\*/чтение_ действие, он будет переопределять, управление доступом по таблицам и предоставить им доступ ко всем данным журнала.
- Если пользователю предоставляется доступ к таблицам, но не имеет других разрешений, они смогут получить доступ к данным журнала, из API, но не с помощью портала Azure. Чтобы предоставить доступ к порталу Azure, используйте в качестве его базовой роли Читатель Log Analytics.
- Администраторам подписки будет иметь доступ ко всем типам данных, независимо от того, все остальные настройки разрешений.
- Владельцы рабочей области, рассматриваются как любой другой пользователь, для управления доступом к таблицам.
- Следует назначать роли группам безопасности, а не отдельным пользователям, чтобы уменьшить число назначений. Это также поможет вам использовать существующие инструменты управления группы для настройки и проверки доступа.




## <a name="next-steps"></a>Дальнейшие действия
* Сведения о сборе данных с компьютеров в центре обработки данных или в другой облачной среде см в статье об [агенте Log Analytics](../../azure-monitor/platform/log-analytics-agent.md).
* Сведения о настройке сбора данных на виртуальных машинах Azure см. в [этой статье](../../azure-monitor/learn/quick-collect-azurevm.md).  

