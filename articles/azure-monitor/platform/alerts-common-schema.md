---
title: Общая схема предупреждений для Azure Monitor оповещений
description: Понимание общей схемы предупреждений, зачем ее использовать и как ее включить
ms.topic: conceptual
ms.subservice: alerts
ms.date: 03/14/2019
ms.openlocfilehash: aa619976c8fa03b925d66e884ad03fc4e385693e
ms.sourcegitcommit: 04fb3a2b272d4bbc43de5b4dbceda9d4c9701310
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2020
ms.locfileid: "94565608"
---
# <a name="common-alert-schema"></a>Общая схема оповещений

В этой статье описывается общая схема предупреждений, преимущества ее использования и способы ее включения.

## <a name="what-is-the-common-alert-schema"></a>Что такое общая схема предупреждений?

Общая схема оповещений позволяет стандартизировать возможности использования уведомлений об оповещениях в Azure в настоящее время. Исторически, три типа оповещений в Azure уже сегодня (метрика, журнал и журнал действий) имеют собственные шаблоны электронной почты, схемы веб-перехватчиков и т. д. С помощью общей схемы предупреждений теперь можно получать уведомления о предупреждениях с помощью единообразной схемы.

Любой экземпляр предупреждения описывает **ресурс, который был затронут** , и **причину предупреждения** , и эти экземпляры описаны в общей схеме в следующих разделах:
* **Essentials** : набор **стандартизованных полей** , общих для всех типов оповещений, которые описывают, к **какому ресурсу** относится предупреждение, а также дополнительные общие метаданные предупреждений (например, серьезность или описание). 
* **Контекст предупреждения** : набор полей, описывающих **причину предупреждения** , с полями, которые зависят от **типа оповещения**. Например, оповещение метрики будет иметь такие поля, как имя метрики и значение метрики в контексте предупреждения, тогда как оповещение журнала действий будет содержать сведения о событии, создавшем предупреждение. 

Типичные сценарии интеграции, которые мы пропустили от клиентов, подразумевают маршрутизацию экземпляра предупреждения в рабочую группу на основе сводной группы (например, группы ресурсов), после чего ответственная команда начинает работать над ней. С помощью общей схемы предупреждений можно иметь стандартизованную логику маршрутизации по типам оповещений, используя основные поля, в то время как в контекстных группах нет полей контекста для дальнейшего изучения.

Это означает, что у вас может быть меньше интеграции, что делает процесс управления и обслуживания _гораздо_ более простым задачей. Кроме того, дальнейшие полезные данные оповещений (например, Настройка, обогащение диагностики и т. д.) будут отображаться только в общей схеме.

## <a name="what-enhancements-does-the-common-alert-schema-bring"></a>Какие усовершенствования поместит общую схему оповещений?

Общая схема предупреждений будет в основном проявляться в уведомлениях о предупреждениях. Ниже перечислены улучшения, которые вы увидите.

| Действие | Улучшения|
|:---|:---|
| SMS | Единообразный шаблон SMS для всех типов оповещений. |
| Адрес электронной почты | Единообразный и подробный шаблон сообщения электронной почты, позволяющий легко диагностировать проблемы с первого взгляда. Внедренные глубокие ссылки на экземпляр предупреждения на портале и затронутый ресурс гарантируют, что вы сможете быстро перейти к процессу исправления. |
| Веб-перехватчик, приложение логики, модуль Runbook функции или службы автоматизации Azure | Согласованная структура JSON для всех типов оповещений, которая позволяет легко создавать интеграции по различным типам оповещений. |

Новая схема также обеспечивает более широкие возможности использования оповещений как в портал Azure, так и в мобильное приложение Azure в немедленном будущем. 

[Узнайте больше о определениях схемы для веб-перехватчиков/Logic Apps, а также в модулях Runbook для функций и служб автоматизации.](./alerts-common-schema-definitions.md)

> [!NOTE]
> Следующие действия не поддерживают общую схему предупреждений: соединитель ITSM.

## <a name="how-do-i-enable-the-common-alert-schema"></a>Разделы справки включить общую схему оповещений?

Вы можете принять участие в общей схеме предупреждений или отказаться от нее с помощью групп действий на портале и с помощью REST API. Переключатель для переключения на новую схему существует на уровне действия. Например, необходимо отдельно принять участие в действиях электронной почты и действиях веб-перехватчика.

> [!NOTE]
> 1. Следующие типы оповещений поддерживают общую схему по умолчанию (не требуется обязательно):
>     * Оповещения интеллектуального обнаружения
> 1. В настоящее время следующие типы оповещений не поддерживают общую схему:
>     * Предупреждения, созданные [Azure Monitor для виртуальных машин](../insights/vminsights-overview.md)
>     * Оповещения, созданные службой " [Управление затратами Azure](../../cost-management-billing/manage/cost-management-budget-scenario.md) "

### <a name="through-the-azure-portal"></a>Через портал Azure

![Общее участие в схеме предупреждений](media/alerts-common-schema/portal-opt-in.png)

1. Откройте любое существующее или новое действие в группе действий. 
1. Выберите "Да" для переключателя, чтобы включить общую схему предупреждений, как показано ниже.

### <a name="through-the-action-groups-rest-api"></a>Через группы действий REST API

Вы также можете использовать [API групп действий](/rest/api/monitor/actiongroups) для выбора общей схемы предупреждений. При выполнении вызова [CREATE или update](/rest/api/monitor/actiongroups/createorupdate) REST API можно установить флаг "усекоммоналертсчема" в значение "true" (чтобы включить согласие) или "false" (чтобы отказаться) для любого из следующих действий: Электронная почта, веб-перехватчик, приложение логики, модуль Runbook функции или службы автоматизации Azure.

Например, следующий текст запроса, созданный для REST API [создания или обновления](/rest/api/monitor/actiongroups/createorupdate) , будет выполнять следующие действия:

* Включить общую схему оповещений для действия электронной почты "Джон Петров, электронная почта"
* Отключение общей схемы предупреждений для действия "Электронная почта Джейн Smith"
* Включение общей схемы предупреждений для действия веб-перехватчика "пример веб-перехватчика"

```json
{
  "properties": {
    "groupShortName": "sample",
    "enabled": true,
    "emailReceivers": [
      {
        "name": "John Doe's email",
        "emailAddress": "johndoe@email.com",
        "useCommonAlertSchema": true
      },
      {
        "name": "Jane Smith's email",
        "emailAddress": "janesmith@email.com",
        "useCommonAlertSchema": false
      }
    ],
    "smsReceivers": [
      {
        "name": "John Doe's mobile",
        "countryCode": "1",
        "phoneNumber": "1234567890"
      },
      {
        "name": "Jane Smith's mobile",
        "countryCode": "1",
        "phoneNumber": "0987654321"
      }
    ],
    "webhookReceivers": [
      {
        "name": "Sample webhook",
        "serviceUri": "http://www.example.com/webhook",
        "useCommonAlertSchema": true
      }
    ]
  },
  "location": "Global",
  "tags": {}
}
```





## <a name="next-steps"></a>Дальнейшие действия

- [Общие определения схемы предупреждений для веб-перехватчиков/Logic Apps, функций Azure и модулей Runbook службы автоматизации.](./alerts-common-schema-definitions.md)
- [Узнайте, как создать приложение логики, использующее общую схему оповещений для обработки всех ваших оповещений.](./alerts-common-schema-integrations.md)
