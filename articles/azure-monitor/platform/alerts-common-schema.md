---
title: Распространенные предупреждения схеме для оповещений Azure monitor
description: Основные сведения об общей схеме оповещений, почему следует использовать и как ее включить
author: anantr
services: azure-monitor
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 03/14/2019
ms.author: anantr
ms.component: alerts
ms.openlocfilehash: c18227a491478d0d8010761440a54fd088344b39
ms.sourcegitcommit: c884e2b3746d4d5f0c5c1090e51d2056456a1317
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "60149382"
---
# <a name="common-alert-schema"></a>Общая схема оповещений

В этой статье описывается, что такое общей схеме оповещений, преимущества использования его и как ее включить.

## <a name="what-is-the-common-alert-schema"></a>Что такое общей схеме оповещений?

Общей схеме оповещений Стандартизирует взаимодействие потребления для уведомления об оповещениях в Azure уже сегодня. Исторически сложилось так, что трех типов оповещений в Azure сегодня (метрики журнала и журнала действий) имели собственные шаблоны сообщений электронной почты, веб-перехватчика схемы и т. д. С общей схемой оповещений теперь могут получать уведомления об оповещениях с согласованную схему.

Описывает любой экземпляр предупреждения об изменении **ресурс, на который была затронута** и **причины возникновения предупреждения**, и описываются эти экземпляры в общей схеме в следующих разделах:
* **Essentials**: Набор **стандартизированный поля**, общих для всех типов оповещений, которые описывают **каких ресурсов** оповещение создается по вместе с дополнительными распространенных предупреждений метаданными (например, "серьезность" или "Описание"). 
* **Контекст предупреждения**: Набор полей, которые описывают **вызывают предупреждения**, с полями, отличающихся **зависимости от типа оповещений**. Например оповещения метрики бы поля, как имя метрики и значение метрики в контексте предупреждения, а оповещение журнала действий будут иметь сведения о событии, вызвавшем предупреждение. 

Типичный интеграции сценарии, которые мы получаем от клиентов включают в себя маршрутизации экземпляр предупреждения во избежание команде на некоторые pivot (например, группа ресурсов), после чего ответственной рабочей группы начнет работу на его основе. С общей схемой оповещения вы может стандартными логику маршрутизации для типов оповещений за счет использования важных полей, оставляя полях контекста как предназначен для команд, важные для дальнейшего.

Это означает, что можно использовать меньшее количество интеграций, что делает процесс их обслуживание и управление ими _большую_ простым. Кроме того усовершенствования будущих предупреждений полезных данных (например, настройки, диагностики обогащение и др.) будут исследовать только вверх в общей схеме.

## <a name="what-enhancements-does-the-common-alert-schema-bring"></a>Какие улучшения использовать общую схему оповещения?

Общая схема оповещения в первую очередь проявляется в ваши уведомления. Ниже перечислены усовершенствования, которые будут доступны.

| Действие | Улучшения|
|:---|:---|
| SMS | Согласованное шаблона SMS для всех типов оповещений. |
| Email | Шаблон согласованное и подробное сообщение электронной почты, что позволяет легко диагностировать проблемы с первого взгляда. Внедренные глубокого ссылки на экземпляр предупреждения об изменении на портале и затронутого ресурса убедитесь, что можно быстро перейти в процесс исправления. |
| Веб-перехватчик или логику приложения или Azure функция/автоматизации Runbook | Согласованную структуру JSON для всех типов оповещений, который позволяет легко создавать интеграции для разных типов оповещений. |

Новая схема также включает более широкие возможности оповещений потребления в мобильное приложение Azure и портала Azure в ближайшее будущее. 

[Дополнительные сведения об определениях схемы для веб-перехватчик или логику приложения или Azure функции и автоматизацию Runbook.](https://aka.ms/commonAlertSchemaDefinitions)

> [!NOTE]
> Общей схеме оповещений не поддерживают следующие действия: Соединитель ITSM.

## <a name="how-do-i-enable-the-common-alert-schema"></a>Как включить оповещения общей схеме?

Можно согласиться или отказаться в общей схеме оповещений через группы действий, оба портала и REST API. Переключатель для переключения на новую схему существует на уровне действия. Например необходимо отдельно включить для действия отправки электронного письма и действие webhook.

> [!NOTE]
> 1. Общую схему по умолчанию, поддерживают следующие типы оповещений (не необязательно в требуется):
>     * Оповещения интеллектуального обнаружения
> 1. Следующие типы оповещений в настоящее время не поддерживают общей схеме:
>     * Предупреждения, созданные [Azure Monitor для виртуальных машин](https://docs.microsoft.com/azure/azure-monitor/insights/vminsights-overview)
>     * Предупреждения, созданные [управление затратами Azure](https://docs.microsoft.com/azure/billing/billing-cost-management-budget-scenario)

### <a name="through-the-azure-portal"></a>На портале Azure

![Согласиться общей схеме оповещений](media/alerts-common-schema/portal-opt-in.png)

1. Откройте все существующие или новые действия в группе действий. 
1. Выберите «Да» для переключателя, позволяющего в общей схеме оповещений, как показано.

### <a name="through-the-action-groups-rest-api"></a>Через REST API группы действий

Можно также использовать [API группы действий](https://docs.microsoft.com/rest/api/monitor/actiongroups) согласие на использование в общей схеме оповещений. Делая [Создание или обновление](https://docs.microsoft.com/rest/api/monitor/actiongroups/createorupdate) вызова REST API, можно задать флаг «useCommonAlertSchema», «true» (чтобы согласиться) или «false» (Чтобы отказаться от) для любого из следующих действий - функция и автоматизацию runbook электронной почты или веб-перехватчик или логику приложения или Azure.

К примеру, следующий запрос внесенные в текст [Создание или обновление](https://docs.microsoft.com/rest/api/monitor/actiongroups/createorupdate) REST API сделает следующее:

* Включение общей схеме оповещений для действия электронной почты «John Doe email»
* Отключение общей схеме оповещений для действия электронной почты «Мария Смит email»
* Включение общей схеме оповещений для действия веб-перехватчик «Пример веб-перехватчик»

```json
{
  "properties": {
    "groupShortName": "sample",
    "enabled": true,
    "emailReceivers": [
      {
        "name": "John Doe's email",
        "emailAddress": "johndoe@email.com",
        "useCommonAlertSchema": true
      },
      {
        "name": "Jane Smith's email",
        "emailAddress": "janesmith@email.com",
        "useCommonAlertSchema": false
      }
    ],
    "smsReceivers": [
      {
        "name": "John Doe's mobile",
        "countryCode": "1",
        "phoneNumber": "1234567890"
      },
      {
        "name": "Jane Smith's mobile",
        "countryCode": "1",
        "phoneNumber": "0987654321"
      }
    ],
    "webhookReceivers": [
      {
        "name": "Sample webhook",
        "serviceUri": "http://www.example.com/webhook",
        "useCommonAlertSchema": true
      }
    ]
  },
  "location": "Global",
  "tags": {}
}
```





## <a name="next-steps"></a>Дальнейшие действия

- [Общие определения оповещений схемы для веб-перехватчик или логику приложения или Azure функции и автоматизацию Runbook.](https://aka.ms/commonAlertSchemaDefinitions)



