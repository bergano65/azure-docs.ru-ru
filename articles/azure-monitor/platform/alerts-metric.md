---
title: Создание и просмотр оповещений метрик, а также управление ими с помощью Azure Monitor
description: Узнайте, как с помощью портала Azure или CLI создавать, просматривать оповещения метрик, а также управлять ими.
author: snehithm
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 09/18/2018
ms.author: snmuvva
ms.subservice: alerts
ms.openlocfilehash: 117b65265c853194e93a97fe5e2b2dcc6e9f5bc2
ms.sourcegitcommit: 98645e63f657ffa2cc42f52fea911b1cdcd56453
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54807394"
---
# <a name="create-view-and-manage-metric-alerts-using-azure-monitor"></a>Создание и просмотр оповещений метрик, а также управление ими с помощью Azure Monitor

Оповещения метрик в Azure Monitor позволяют получать уведомления, когда одна из ваших метрик достигает порогового значения. Оповещения метрик работают со множеством многомерных метрик платформы, пользовательских метрик, стандартных и пользовательских метрик Application Insights. В этой статье мы расскажем, как создавать, просматривать правила генерации оповещений метрик и управлять ими на портале Azure и с помощью Azure CLI. Вы также можете создавать правила генерации оповещений метрик с использованием шаблонов Azure Resource Manager, описанных в [отдельной статье](alerts-metric-create-templates.md).

Подробнее о том, как работают оповещения метрик, см. в [этом обзоре](alerts-metric-overview.md).

## <a name="create-with-azure-portal"></a>Создание с помощью портала Azure

Следующая процедура описывает, как создать правило генерации оповещений метрики на портале Azure:

1. На [портале Azure](https://portal.azure.com) выберите **Монитор**. В колонке "Монитор" объединены все параметры мониторинга и данные в одном представлении.

2. Щелкните **Оповещения** и выберите **+ Новое правило генерации оповещений**.

    > [!TIP]
    > В большинстве колонок ресурсов в меню ресурсов также есть **оповещения** в разделе **Мониторинг**, и вы также можете создать оповещения там.

3. Щелкните **Выбор цели**, в загружаемой контекстной области выберите целевой ресурс, для которого следует создать оповещение. В раскрывающихся списках **Подписка** и **Тип ресурса** найдите ресурс, который вы хотите отслеживать. Вы также можете найти ресурс с помощью панели поиска.

4. Если выбранный ресурс имеет метрики, по которым можно создавать оповещения, эти метрики будут отображаться на вкладке **Available signals** (Доступные сигналы) в правом нижнем углу. Полный список типов ресурсов, поддерживаемых для оповещений метрик, см. в этой [статье](../../azure-monitor/platform/alerts-metric-near-real-time.md#metrics-and-dimensions-supported).

5. После выбора целевого ресурса щелкните **Добавить условие**.

6. Вы увидите список сигналов, поддерживаемых для ресурса, и сможете выбрать метрику, для которой хотите создать оповещение.

7. При необходимости уточните метрику, настроив**период** и **агрегирование**. Если для метрики имеются измерения, вы увидите таблицу **Размеры**. Выберите одно или несколько значений для каждого измерения. Оповещение метрики будет выполнять оценку условия для всех сочетаний выбранных значений. [Дополнительные сведения о том, как срабатывают оповещения на основе многомерных метрик](alerts-metric-overview.md). Вы также можете **выбрать \*** для любого из измерений. Если **выбрать \***, выбор всех текущих и будущих значений измерений будет динамически масштабироваться.

8. Вы увидите график метрики за последние 6 часов. Задайте параметры оповещений: **тип условия**, **частоту**, **оператор**, **порог** или **чувствительность**. Это определит логику, которую будет оценивать правило генерации оповещений метрики. [Дополнительные сведения о типе условия "Динамические пороговые значения" и значениях параметра конфиденциальности](alerts-dynamic-thresholds.md).

9. При использовании статических пороговых значений диаграмма метрик может помочь определить, что может быть приемлемым пороговым значением. При использовании динамических пороговых значений на диаграмме метрик отображаются вычисленные пороговые значения на основе последних данных.

10. Нажмите кнопку **Done** (Готово).

11. При необходимости добавьте еще один критерий, если вы хотите отслеживать сложное правило генерации оповещений. Сейчас пользователи могут применять правила оповещения с одиночным условием динамического порогового значения.

12. Заполните **сведения об оповещении**, такие как **имя правила генерации оповещений**, **описание** и **серьезность**.

13. Добавьте группу действий в оповещение: выберите имеющуюся или создайте группу действий.

14. Нажмите кнопку **Готово** для сохранения правила генерации оповещений метрики.

> [!NOTE]
> Правила генерации оповещений метрики, созданные на портале, создаются в той же группе ресурсов, что и целевой ресурс.

## <a name="view-and-manage-with-azure-portal"></a>Просмотр и управление с помощью портала Azure

Вы можете просматривать правила генерации оповещений метрики и управлять ими, используя колонку "Управление правилами" в разделе "Оповещения". В приведенной ниже процедуре показано, как просмотреть свои правила генерации оповещений метрики и изменить одно из них.

1. На портале Azure выберите **Монитор**.

2. Щелкните **Оповещения**, а затем **Управление правилами**.

3. В колонке **Управление правилами** вы можете просмотреть все правила генерации оповещений по подпискам. Вы можете дополнительно фильтровать правила, используя **группу ресурсов**, **тип ресурса** и **ресурс**. Если вы хотите видеть только оповещения метрики, выберите метрику в качестве **типа сигнала**.

    > [!TIP]
    > В колонке **Управление правилами** вы можете выбрать несколько правил генерации оповещений и включить или отключить их. Это может быть полезно, когда необходимо выполнить обслуживание определенных целевых ресурсов.

4. Щелкните имя правила генерации оповещений метрики, которое вы хотите изменить.

5. На вкладке "Изменить правило" щелкните **критерии предупреждения**, которые вы хотите отредактировать. Вы можете изменить метрику, условие порогового значения и другие поля по мере необходимости.

    > [!NOTE]
    > Нельзя изменить **целевой ресурс** и **имя правила генерации оповещений** после создания оповещения метрики.

6. Нажмите кнопку **Готово**, чтобы сохранить изменения.

## <a name="with-azure-cli"></a>С помощью Azure CLI

В предыдущих разделах описаны создание, просмотр правил генерации оповещений метрики и управление ими с помощью портала Azure. В этом разделе вы узнаете, как сделать то же самое с помощью кроссплатформенного [Azure CLI](https://docs.microsoft.com/cli/azure/get-started-with-azure-cli?view=azure-cli-latest). Самый быстрый способ начать использование Azure CLI — это [Azure Cloud Shell](https://docs.microsoft.com/azure/cloud-shell/overview?view=azure-cli-latest). В этой статье мы будем использовать Cloud Shell.

1. Перейдите на портал Azure и щелкните **Cloud Shell**.

2. В командной строке вы можете использовать команды с параметром ``--help``, чтобы узнать больше о команде и о том, как ее использовать. Например, следующая команда показывает вам список команд, доступных для создания, просмотра оповещений метрики и управления ими.

    ```azurecli
    az monitor metrics alert --help
    ```

3. Вы можете создать простое правило генерации оповещений метрики, которое срабатывает, если средняя загрузка ЦП на виртуальной машине превышает 90 %.

    ```azurecli
    az monitor metrics alert create -n {nameofthealert} -g {ResourceGroup} --scopes {VirtualMachineResourceID} --condition "avg Percentage CPU > 90" --description {descriptionofthealert}
    ```

4. Вы можете просмотреть все оповещения метрики в группе ресурсов, используя следующую команду.

    ```azurecli
    az monitor metrics alert list  -g {ResourceGroup}
    ```

5. Вы можете увидеть подробности определенного правила генерации оповещений метрики, используя имя или идентификатор ресурса правила.

    ```azurecli
    az monitor metrics alert show -g {ResourceGroup} -n {AlertRuleName}
    ```

    ```azurecli
    az monitor metrics alert show --ids {RuleResourceId}
    ```

6. Вы можете отключить правило генерации оповещений, используя следующую команду.

    ```azurecli
    az monitor metrics alert update -g {ResourceGroup} -n {AlertRuleName} --enabled false
    ```

7. Вы можете удалить правило генерации оповещений метрики, используя следующую команду.

    ```azurecli
    az monitor metrics alert delete -g {ResourceGroup} -n {AlertRuleName}
    ```

## <a name="next-steps"></a>Дополнительная информация

- [Создание классического оповещения метрики с помощью шаблона Resource Manager](../../azure-monitor/platform/alerts-enable-template.md).
- [Сведения о работе оповещений метрики в Azure Monitor](alerts-metric-overview.md).
- [Оповещения с динамическими пороговыми значениями в Azure Monitor (ограниченная закрытая предварительная версия)](alerts-dynamic-thresholds.md).
- [Схема полезных данных](../../azure-monitor/platform/alerts-metric-near-real-time.md#payload-schema)

