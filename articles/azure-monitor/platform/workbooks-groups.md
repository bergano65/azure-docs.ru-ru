---
title: Azure Monitor группы книг
description: Использование групп в Azure Monitor книгах.
services: azure-monitor
author: lgayhardt
manager: carmonm
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.topic: conceptual
ms.date: 05/06/2020
ms.author: lagayhar
ms.openlocfilehash: b6377cdcdb5816426eba62fdbef79eeb42659dcc
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "82892086"
---
# <a name="how-to-use-groups-in-workbooks"></a>Использование групп в книгах

Элемент группы в книге позволяет логически группировать набор шагов в книге.

Группы в книгах полезны для следующих задач:

- Layout
  - В сценариях, где элементы должны быть упорядочены по вертикали, можно создать группу элементов, все из которых будут включены в стек, и установить стиль группы в процентной ширине, а не задавать ширину в процентах для всех отдельных элементов.
- Видимость
  - В тех случаях, когда требуется скрыть или показать несколько элементов, можно задать видимость всей группы элементов, а не задавать параметры видимости для каждого отдельного элемента. Это может быть полезно в шаблонах, использующих вкладки, так как в качестве содержимого вкладки можно использовать группу, а вся группа может быть скрыта или показана на основе параметров, заданных выбранной вкладкой.
- Производительность
  - В случаях, когда имеется очень крупный шаблон с множеством разделов или вкладок, можно преобразовать каждый раздел в его собственный вложенный шаблон и использовать группы для загрузки всех подшаблонов в шаблон верхнего уровня. Содержимое подшаблонов не будет загружаться и выполняться до тех пор, пока пользователь не сделает эти группы видимыми. Дополнительные сведения о [разделении большого шаблона на множество шаблонов](#how-to-split-a-large-template-into-many-templates).

## <a name="using-groups"></a>Использование групп

Чтобы добавить группу в книгу, выберите *Добавить* , а затем *Добавить группу*.

![Выберите Добавить, а затем группа.](./media/workbooks-groups/add-group.png)

Ниже приведен снимок экрана группы в режиме чтения с двумя элементами внутри: текстовый элемент и элемент запроса.  

![Сгруппируйте в режиме чтения.](./media/workbooks-groups/groups-view.png)

При редактировании книги можно увидеть, что эти два элемента находятся внутри элемента группы:

![Сгруппируйте в режиме редактирования. ](./media/workbooks-groups/groups-edit.png)

На снимке экрана выше группа находится в режиме редактирования, и она содержит два элемента (внутри пунктирной области). Каждый шаг может находиться в режиме редактирования или чтения независимо друг от друга. Например, текстовый шаг находится в режиме редактирования, а шаг запроса находится в режиме чтения.

## <a name="scoping"></a>Scoping

В настоящее время группа рассматривается как новая область в книге. Все параметры, созданные в группе, отображаются только внутри группы. Это также справедливо для слияния, данные можно просматривать только внутри их группы или на родительском уровне.

## <a name="group-types"></a>Типы группы

Элемент группы книг позволяет добавлять в книгу группу элементов. Как автор книги вы указываете, какой тип группы он будет иметь. Существует два типа групп:

- Editable
  - Группа в книге позволяет добавлять, удалять или изменять содержимое элементов в группе. Чаще всего это используется для макета и видимости.
- Из шаблона
  - Группа в книге загружается из содержимого другого шаблона по его ИДЕНТИФИКАТОРу. Содержимое этого шаблона загружается и объединяется в книгу во время выполнения. В режиме редактирования нельзя изменять любое содержимое группы, так как они просто загружаются из шаблона в следующий раз при загрузке элемента.  

## <a name="load-types"></a>Типы нагрузки

Существует несколько различных способов загрузки содержимого группы. Автор книги может указать, когда и как будет загружаться содержимое группы.

### <a name="lazy-the-default"></a>Lazy (по умолчанию)

Группа будет загружаться, только если элемент является видимым. Это позволяет использовать группу элементами вкладки. Если вкладка никогда не выделена, группа никогда не становится видимой, поэтому содержимое не загружается.

Для групп, созданных из шаблона, содержимое шаблона не извлекается, а элементы в группе не создаются, пока группа не станет видимой. Во время извлечения содержимого пользователь увидит счетчики хода выполнения для всей группы.

### <a name="explicit"></a>Явно

В этом режиме кнопка отображается в том месте, где находится группа, и содержимое не извлекается и не создается до тех пор, пока пользователь явно не нажмет кнопку для загрузки содержимого. Это полезно в сценариях, где содержимое может быть дорогостоящим для вычислений или редко используемым. Автор может указать текст, который будет отображаться на кнопке.

Ниже приведен снимок экрана с параметрами явной загрузки, в которых показана настроенная кнопка "загрузить еще".

![Параметры явной загрузки](./media/workbooks-groups/groups-explicitly-loaded.png)

Группа перед загрузкой в книгу:

![Явная группа перед загрузкой в книгу](./media/workbooks-groups/groups-explicitly-loaded-before.png)

Группа после загрузки в книгу:

![Явная группа после загрузки в книгу](./media/workbooks-groups/groups-explicitly-loaded-after.png)

### <a name="always"></a>Всегда

В этом режиме содержимое группы всегда загружается и создается сразу после загрузки книги. Это наиболее часто используется при использовании группы только для целей макета, где содержимое всегда будет видимым.

## <a name="using-templates-inside-a-group"></a>Использование шаблонов внутри группы

Если группа настроена для загрузки из шаблона, это содержимое будет загружаться по умолчанию: ленивое, оно будет загружаться только тогда, когда группа видима.

При загрузке шаблона в группу книга пытается объединить все параметры, объявленные в загружаемом шаблоне, с параметрами, уже существующими в группе. Все параметры, которые уже существуют в книге с одинаковыми именами, будут объединены из загружаемого шаблона. Если все параметры на шаге параметра объединяются, шаг с параметрами исчезает.

### <a name="example-1-all-parameters-have-identical-names"></a>Пример 1. все параметры имеют одинаковые имена

Рассмотрим шаблон с двумя параметрами в верхней части.

- `TimeRange`— параметр диапазона времени.
- `Filter`— текстовый параметр.

![Изменение элемента параметров: "параметры верхнего уровня"](./media/workbooks-groups/groups-top-level-params.png)

Затем элемент группы загружает второй шаблон с собственными двумя параметрами и текстовым шагом, где параметры именуются одинаково:

![Изменение элемента параметра для второго шаблона](./media/workbooks-groups/groups-merged-away.png)

При загрузке второго шаблона в группу дублированные параметры будут объединены. Так как все параметры объединяются, шаг внутренние параметры также объединяется, в результате чего группа будет содержать только текстовый шаг.

### <a name="example-2-one-parameter-has-an-identical-name"></a>Пример 2. один параметр имеет одинаковое имя

Рассмотрим шаблон группы, в верхней части которого есть два параметра.

- `TimeRange`— параметр диапазона времени.
- `FilterB`— текстовый параметр, обратите внимание, что он не `Filter` похож на верхний шаблон.

![Изменение элемента группы с результатами слияния параметров](./media/workbooks-groups/groups-wont-merge-away.png)

После загрузки шаблона итем'с группы `TimeRange` параметр будет объединен в группу. Затем в книге будут присутствовать начальные параметры с `TimeRange` и `Filter` , а шаг параметра группы будет включать только`FilterB`

![результат параметров, которые не будут объединены](./media/workbooks-groups/groups-wont-merge-away-result.png)

Если загруженный шаблон содержал `TimeRange` и `Filter` (а не `FilterB` ), то результирующая книга будет содержать шаг параметров и группу, в которой осталось только текстовое действие.

## <a name="how-to-split-a-large-template-into-many-templates"></a>Разбиение большого шаблона на несколько шаблонов

Для повышения производительности целесообразно разбить большой шаблон на несколько небольших шаблонов, которые загружают содержимое отложенно или по требованию пользователя. Это делает начальную нагрузку быстрее, так как шаблон верхнего уровня может быть намного меньше.

При разбиении шаблона на части необходимо разделить шаблон на несколько шаблонов (подшаблонов), которые будут работать по отдельности. Поэтому, если у шаблона верхнего уровня есть `TimeRange` параметр, который используется в других шагах, подшаблону также потребуется шаг параметров, определяющий параметр с точным именем. Это позволяет работать с подшаблонами независимо друг от друга и позволяет загружать их внутри крупных шаблонов в группах.

Чтобы преобразовать шаблон большего размера в несколько подшаблонов:

1.  Создайте новую пустую группу в верхней части книги после общих параметров. В конечном итоге эта новая группа станет подшаблоном.
2. Создайте копию шага общие параметры, а затем используйте команду *переместить в группу* , чтобы переместить копию в группу, созданную на шаге 1. Этот шаг параметров позволит подшаблону работать независимо от внешнего шаблона и будет объединен при загрузке внутри внешнего шаблона.
    > [!NOTE]
    > Вложенному шаблону технически не нужно иметь эти параметры, которые будут объединены, если вы не хотите, чтобы подшаблоны были видимы сами по себе. Тем не менее, если потребуется сделать это позже, это затрудняет редактирование или отладку.

3. Переместите каждый элемент книги, который вы хотите поместить в подшаблоне, в группу, созданную на шаге 1.
4. Если отдельные шаги, перемещенные на шаге 3, имеют условное видимости, то это станет видимостью внешней группы (как используется на вкладках). Удалите их из элементов внутри группы и добавьте этот параметр видимости в саму группу. Сохраните здесь, чтобы избежать потери изменений и (или) экспорта и сохранения копии содержимого JSON.
5. Если необходимо загрузить группу из шаблона, можно нажать кнопку *изменить* на панели инструментов в группе. Это приведет к открытию только содержимого этой группы в виде книги в новом окне. Затем можно сохранить его соответствующим образом и закрыть представление книги (не закрывайте браузер, просто это представление, чтобы вернуться к предыдущей рабочей книге, которую вы редактировали).
6. Затем можно изменить шаг группы, чтобы загрузить из шаблона, и задать в поле "идентификатор шаблона" книгу или шаблон, созданные на шаге 5. Для работы с идентификаторами книг источник должен быть ИДЕНТИФИКАТОРом ресурса общей книги. Нажмите кнопку *Load (загрузить* ), после чего содержимое этой группы будет загружено из этого подшаблона, а не сохранено внутри этой внешней книги.

## <a name="next-steps"></a>Дальнейшие шаги
- [Общие сведения о книгах](workbooks-overview.md)
- [Использование JSONPath с книгами](workbooks-jsonpath.md)