---
title: Мониторинг работоспособности виртуальных машин с помощью Azure Monitor для виртуальных машин (предварительная версия) | Документация Майкрософт
description: В этой статье объясняется, как оценить работоспособность виртуальной машины и операционной системы с помощью Azure Monitor для виртуальных машин.
services: azure-monitor
documentationcenter: ''
author: mgoedtel
manager: carmonm
editor: ''
ms.assetid: ''
ms.service: azure-monitor
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/08/2019
ms.author: magoedte
ms.openlocfilehash: 38236cba6af46df2701bb0128fe9d78e95aa6ec7
ms.sourcegitcommit: 2d0fb4f3fc8086d61e2d8e506d5c2b930ba525a7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/18/2019
ms.locfileid: "58076825"
---
# <a name="understand-the-health-of-your-azure-virtual-machines-with-azure-monitor-for-vms-preview"></a>Общие сведения об оценке работоспособности виртуальных машин Azure с помощью Azure Monitor для виртуальных машин (предварительная версия)
Azure предлагает несколько служб, каждая из которых выполняет определенную роль или задачу мониторинга. Но полноценный и подробный анализ работоспособности операционной системы, размещенной на виртуальных машинах Azure, до сих пор был недоступен.  Хотя можно отслеживать для различных условий, с помощью Azure Monitor, не предназначенные для моделирования и представления работоспособности ключевых компонентов или общую работоспособность виртуальной машины.  Платформа Azure Monitor для виртуальных машин осуществляет упреждающий мониторинг доступности и производительности гостевой ОС Windows или Linux. Платформа использует модель ключевых компонентов и связей между ними, критерии оценки работоспособности этих компонентов и оповещения об обнаружении состояний неработоспособности.  

В Azure Monitor есть два варианта просмотра сведений об общей работоспособности виртуальной машины Azure: непосредственно с виртуальной машины или с платформы Azure Monitor для всех виртуальных машин в группе ресурсов.

Из этой статьи вы узнаете, как быстро оценить, изучить и устранить обнаруженные проблемы с работоспособностью.

Сведения о настройке Azure Monitor для виртуальных машин, см. в [этой статье](vminsights-onboard.md).

> [!NOTE]
> 11 февраля 2019 года мы начнем переводить текущую функцию работоспособности в Azure Monitor для виртуальных машин, к которой сейчас можно получить доступ в интерфейсе диагностики работоспособности, на новую модель. Это обновление повысит производительность обработки сводного показателя работоспособности. В рамках обновления будет реализована усовершенствованная модель работоспособности. Сведения будут отображаться в представлении "Диагностика работоспособности". 
> 
> Новая модель работоспособности позволит быстрее создавать сводку критериев работоспособности дочернего элемента. В конечном итоге это позволит обновлять состояние работоспособности родительского элемента до желаемого или целевого с меньшей задержкой. Вы сможете фильтровать критерии работоспособности в категориях **Производительность** и **Доступность**, в отличие от предыдущего метода на основе вкладок, когда нужно было выбирать одну из категорий.
> 
> Дополнительные сведения о новом интерфейсе диагностики работоспособности см. в [разделе](#health-diagnostics) этой статьи о диагностике работоспособности. 
> 
> В этом обновлении реализовано следующее: 
> 
> - обработка сводного показателя работоспособности с уменьшенной задержкой;  
> - ускоренное создание оповещений об изменениях состояния работоспособности; 
> - ускоренное обновление состояния работоспособности в представлении агрегированных виртуальных машин для всех виртуальных машин. 
> 
> Новое решение не уступает в функциональности текущей функции работоспособности Azure Monitor для виртуальных машин.
> 
> Это изменение затрагивает систему диагностики работоспособности следующим образом: журнал изменений состояния будет сброшен, а сведения о предыдущих изменениях состояния для критериев работоспособности будут недоступны для просмотра в столбце "Изменение состояния" на странице диагностики работоспособности. Если вам нужны данные журнала любой критически важной виртуальной машины, можно сделать снимок экрана с данными критериев работоспособности и сведениями о соответствующих изменениях состояния. 

## <a name="monitoring-configuration-details"></a>Сведения о настройке мониторинга
В этом разделе описаны критерии работоспособности, используемые по умолчанию для мониторинга виртуальных машин Azure на базе Windows и Linux. Все критерии работоспособности предварительно настроены на оповещение при соблюдении условия неработоспособности. 

### <a name="windows-vms"></a>Виртуальные машины Windows

- доступный объем памяти, мегабайт; 
- среднее время на операцию записи, секунд (логический диск);
- среднее время на операцию записи, секунд (диск);
- среднее время на операцию чтения, секунд (логический диск);
- среднее время на операцию перемещения, секунд (логический диск);
- среднее время на операцию чтения, секунд (диск);
- среднее время на операцию перемещения, секунд (диск);
- текущая длина очереди диска (логический диск);
- текущая длина очереди диска (диск);
- процент времени простоя диска;
- ошибка или повреждение файловой системы;
- мало свободного пространства на логическом диске (в процентах);
- мало свободного пространства на логическом диске (в мегабайтах);
- процент времени простоя логического диска;
- страниц памяти в секунду;
- процент используемой пропускной способности чтения;
- процент используемой общей пропускной способности;
- процент используемой пропускной способности записи;
- процент используемой выделенной памяти;
- процент времени простоя физического диска;
- работоспособность службы DHCP-клиента;
- работоспособность службы DNS-клиента;
- работоспособность службы RPC;
- работоспособность службы сервера;
- общий процент использования ЦП;
- работоспособность службы журнала событий Windows;
- работоспособность службы брандмауэра Windows;
- работоспособность службы удаленного управления Windows.

### <a name="linux-vms"></a>Виртуальные машины Linux
- диск, средн. — время обращения к диску (с) 
- диск, средн. — время чтения с диска (с) 
- диск, средн. — время записи на диск (с) 
- работоспособность диска;
- свободное пространство на логическом диске;
- свободное пространство на логическом диске (в процентах);
- свободные дескрипторы на логическом диске (в процентах);
- работоспособность сетевого адаптера;
- процент времени DPC процессора;
- процент процессорного времени процессора;
- общее процессорное время в процентах;
- общее время DCP в процентах;
- доступный для операционной системы объем памяти, мегабайт.

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure
Войдите на [портале Azure](https://portal.azure.com). 

## <a name="introduction-to-health-experience"></a>Знакомство с интерфейсом для оценки работоспособности системы
Прежде чем углубляться в тонкости использования функции для оценки работоспособности виртуальной машины или группы виртуальных машин, мы представим краткий обзор, чтобы вам было легче понять отображаемую информацию и визуализации.  

## <a name="view-health-directly-from-a-virtual-machine"></a>Просмотр сведений о работоспособности непосредственно с виртуальной машины 
Чтобы просмотреть состояние работоспособности виртуальной машины Azure, выберите **Аналитические сведения (предварительная версия)** в левой области страницы виртуальной машины. На странице аналитики виртуальных машин по умолчанию открывается вкладка **Работоспособность** с представлением работоспособности виртуальной машины.  

![Представление работоспособности выбранной виртуальной машины Azure в Azure Monitor для виртуальных машин](./media/vminsights-health/vminsights-directvm-health.png)

На вкладке **Работоспособность** в разделе **Работоспособность гостевых виртуальных машин** отображаются сведения о текущей работоспособности виртуальной машины и общее число оповещений о неработоспособности определенного компонента. См. дополнительные сведения о функции оповещений.  

В следующей таблице описываются состояния работоспособности, которые могут быть определены для виртуальной машины: 

|Значок |Исправное состояние |Значение |
|-----|-------------|------------|
| |Healthy |Значение "Исправно" означает, что состояние работоспособности находится в пределах определенных условий. Это значение указывает на то, что никаких проблем с виртуальной машиной не обнаружено и она работает надлежащим образом. Для родительских сводных мониторов выполняется сведение всех дочерних элементов. При этом отображается только самое хорошее или самое плохое из состояний этих дочерних элементов.|
| |критические ошибки. |Значение "Критическое" означает, что состояние работоспособности находится за пределами определенных условий. Это значение указывает на то, что обнаружены одна или несколько критических проблем, которые нужно устранить, чтобы восстановить нормальную работу виртуальной машины. Для родительских сводных мониторов выполняется сведение всех дочерних элементов. При этом отображается только самое хорошее или самое плохое из состояний этих дочерних элементов.|
| |Предупреждение |Значение "Предупреждение" означает, что показатель работоспособности находится между двумя определенными порогами. Один из них указывает на состояние *Предупреждение*, а другой — на состояние *Критическое* (можно настроить три порога состояния работоспособности). Это состояние также присваивается при обнаружении некритических проблем, которые могут привести к критическим, если их не устранить. Для родительских сводных мониторов состояние *Предупреждение* присваивается в том случае, если один или несколько дочерних элементов находятся в состоянии предупреждения. Если же одновременно для какого-либо дочернего элемента зафиксировано состояние *Критическое*, а для другого — состояние *Предупреждение*, в родительском сводным мониторе для состояния работоспособности отображается значение *Критическое*.|
| |Unknown |Состояние работоспособности *Неизвестно* присваивается в тех случаях, когда по любой причине не удается установить состояние работоспособности. Например, если монитор не может собрать данные, служба выполняет инициализацию и т. д. Это состояние работоспособности не настраивается.| 

Щелкните **Просмотреть диагностику работоспособности**, чтобы открыть страницу со списком всех компонентов виртуальной машины, для которых указаны критерии работоспособности, сведения об изменении состояний и серьезных проблемах, обнаруженных в ходе мониторинга компонентов виртуальной машины. Дополнительные сведения см. в разделе [Диагностика работоспособности](#health-diagnostics). 

В разделе **Работоспособность компонентов** представлена таблица со сводной информацией о состояниях работоспособности по основным категориям, отслеживаемым для соответствующих областей, например **ЦП**, **Память**, **Диск** и **Сеть**.  Выбрав любой из этих компонентов, вы откроете страницу со списком всех аспектов мониторинга работоспособности и указанием состояния работоспособности для каждого из них.  

Если страница работоспособности открывается с виртуальной машины Azure под управлением операционной системы Windows, в разделе **Работоспособность основных служб** отображаются сведения о работоспособности для пяти основных служб Windows.  Выберите любую из них, чтобы открыть страницу со списком критериев работоспособности для мониторинга этого компонента и сведениями о его работоспособности.  Щелкните имя критерия работоспособности, чтобы открыть панель свойств, на которой можно просмотреть сведения о конфигурации, в том числе об оповещениях Azure Monitor для этого критерия работоспособности. Дополнительные сведения см. в разделе о [диагностике работоспособности и использовании ее критериев](#health-diagnostics).  

## <a name="aggregate-virtual-machine-perspective"></a>Агрегированное представление виртуальных машин
Чтобы просмотреть сводные данные о работоспособности всех виртуальных машин в группе ресурсов, выберите на портале в списке навигации пункт **Azure Monitor**, а затем — элемент **Виртуальные машины (предварительная версия)**.  

![Страница аналитики виртуальных машин. Представление мониторинга в Azure Monitor](./media/vminsights-health/vminsights-aggregate-health.png)

В раскрывающихся списках **Подписка** и **Группа ресурсов** выберите подходящий вариант, который включает целевые виртуальные машины, связанные с группой, для просмотра передаваемого состояния работоспособности.  Выбор применяется только к функции работоспособности и не применяется к производительности.

На вкладке **Работоспособность** можно получить следующие сведения:

* Сколько виртуальных машин находятся в критическом, неработоспособном или исправном состоянии либо не отправляют данные (то есть имеют неизвестное состояние).
* Для каких виртуальных машин и с какими операционными системами (ОС) зафиксировано состояние неработоспособности.
* Сколько виртуальных машин находятся в неработоспособном состоянии из-за проблем с процессором, диском, памятью или сетевым адаптером (в разбивке по категориям состояний работоспособности).  
* Сколько виртуальных машин находятся в неработоспособном состоянии из-за проблем с базовой операционной системой (в разбивке по категориям состояний работоспособности).

Здесь вы можете быстро определить наиболее критичные проблемы, которые обнаруживаются с помощью профилактического мониторинга виртуальной машины, а также просмотреть предупреждения о работоспособности виртуальной машины и соответствующие статьи базы знаний для диагностики и исправления проблемы.  Чтобы открыть страницу [Все оповещения](../../azure-monitor/platform/alerts-overview.md#all-alerts-page), отфильтрованную по конкретной серьезности, щелкните ее.

В списке **Распределение виртуальных машин по операционной системе** перечислены виртуальные машины по каждому выпуску Windows и (или) версии дистрибутива Linux. В каждой категории операционных систем виртуальные машины дополнительно разделены по состояниям работоспособности. 

![Страница аналитики виртуальных машин. Представление с распределением виртуальных машин](./media/vminsights-health/vminsights-vmdistribution-by-os.png)

Вы можете щелкнуть любой элемент столбца, например **Число виртуальных машин**, **Критическое**, **Предупреждение**, **Исправно** или **Неизвестно**, чтобы открыть страницу **Виртуальные машины** с подробными результатами, отфильтрованными по выбранному столбцу. Например, если мы хотим просмотреть все виртуальные машины с ОС **Red Hat Enterprise Linux версии 7.5**, щелкните значение **Число виртуальных машин**, отображаемое для этой ОС. Откроется показанная ниже страница со списком виртуальных машин по этому фильтру и сведениями о работоспособности для них.  

![Пример сводного монитора для виртуальных машин Red Hat Linux](./media/vminsights-health/vminsights-rollup-vm-rehl-01.png)
 
На странице **Виртуальные машины** вы можете выбрать имя виртуальной машины в столбце **Имя виртуальной машины**, чтобы перейти на страницу экземпляра виртуальной машины. Здесь представлены подробные сведения об оповещениях и обнаруженных несоответствиях критериям работоспособности, которые влияют на работоспособность выбранной виртуальной машины.  На этой странице можно отфильтровать сведения о работоспособности, щелкнув значок **Состояние работоспособности** в верхнем левом углу страницы. Например, можно отобразить все компоненты, которые находятся в неработоспособном состоянии или просмотреть оповещения о работоспособности виртуальной машины, вызванные неработоспособным компонентом, в разбивке по категориям серьезности предупреждения.    

Если щелкнуть имя виртуальной машины в представлении списка виртуальных машин, откроется та же самая страница **Работоспособность** для этой виртуальной машины, что и при выборе для нее ссылки **Аналитические сведения (предварительная версия)**.

![Страница аналитики виртуальных машин. Информация по выбранной виртуальной машине Azure](./media/vminsights-health/vminsights-directvm-health.png)

Здесь вы видите сводный монитор **Состояние работоспособности** для виртуальной машины и **оповещения**, сгруппированные по уровням серьезности, то есть оповещения о работоспособности виртуальной машины, создаваемые при ухудшении работоспособности.  Если выбрать элемент **VMs in critical condition** (Виртуальные машины в критическом состоянии), откроется страница со сведениями об одной или нескольких виртуальных машинах, которые находятся в критическом состоянии.  Щелкните состояние работоспособности любой из виртуальных машин в этом списке, чтобы для виртуальной машины отобразилось представление **Диагностика работоспособности**.  Здесь можно выяснить, по каким критериям определена проблема с работоспособностью. На странице **Диагностика работоспособности** отобразятся сведения обо всех компонентах виртуальной машины и критериях работоспособности для них, по которым определено текущее состояние работоспособности.  Дополнительные сведения см. в разделе [Диагностика работоспособности](#health-diagnostics).  

Щелкните **Просмотреть все условия работоспособности**, чтобы открыть страницу со списком всех доступных для этой функции критериев работоспособности.  Эти данные можно дополнительно отфильтровать по следующим параметрам:

* **Тип.** Есть три типа критериев работоспособности для оценки условий и общего состояния работоспособности отслеживаемой виртуальной машины.  
    a. **Блок.** Отслеживается определенный модуль виртуальной машины. К этому типу критериев работоспособности относятся проверка счетчика производительности для определения производительности компонента, выполнение закодированной в скрипте синтетической транзакции или отслеживание события, свидетельствующего о наличии ошибки.  По умолчанию для фильтра указано именно значение "Блок".  
    2. **Зависимость.** Предоставляется сводный монитор по нескольким сущностям. Такой критерий работоспособности определяет, что работоспособность определенной сущности зависит от работоспособности сущностей другого типа, которые необходимы ей для успешной работы.  
    c. **Агрегация.** Предоставляются обобщенные сведения о работоспособности по другим критериям работоспособности. В этом критерии работоспособности обычно используются сведения по критерию "Блок" и (или) "Зависимость". Критерий агрегации не только позволяет лучше упорядочить несколько разных критериев для одной сущности, но и определить уникальные состояния работоспособности для отдельных категорий сущностей.

* **Категория.** Этот тип критерия работоспособности используется, чтобы сгруппировать аналогичные критерии для отчетности.  Это могут быть критерии **доступности** или **производительности**.

Вы можете просмотреть более подробные сведения, например найти конкретные неработоспособные экземпляры, щелкнув значение в столбце **Unhealthy Component** (Неработоспособный компонент).  На этой странице представлена таблица со списком компонентов, которые находятся в критическом состоянии.    

## <a name="health-diagnostics"></a>Диагностика работоспособности
На странице **Диагностика работоспособности** представлена модель работоспособности виртуальной машины в виде списка компонентов виртуальной машины и всех существующих для них критериев работоспособности, сведений об изменении состояний и серьезных проблемах, обнаруженных в ходе мониторинга компонентов, которые связаны с виртуальной машиной.

![Пример страницы диагностики работоспособности для виртуальной машины](./media/vminsights-health/health-diagnostics-page-01.png)

Диагностику работоспособности можно запустить указанными ниже способами.

* Через сводный монитор работоспособности для всех виртуальных машин, который отображается в представлении агрегированных сведений о виртуальной машине в Azure Monitor.  На странице **работоспособности** щелкните значок состояния работоспособности **Критическое**, **Предупреждение**, **Исправно** или **Неизвестно** в разделе **Работоспособность гостевой виртуальной машины**, а затем перейдите к странице со списком виртуальных машин, соответствующих выбранной категории.  Если щелкнуть значение в столбце **Состояние работоспособности**, откроется страница диагностики работоспособности для конкретной виртуальной машины.      

* Через операционную систему в представлении агрегированных сведений о виртуальной машине в Azure Monitor. Из раздела **Распределение виртуальных машин** при выборе любого из значений в столбцах открывается страница **Виртуальные машины** со списком в табличном виде, который отфильтрован по выбранной категории.  Если щелкнуть значение в столбце **Состояние работоспособности**, откроется страница диагностики работоспособности для выбранной виртуальной машины.    
 
* С гостевой виртуальной машины на вкладке **Работоспособность** в Azure Monitor для виртуальных машин. Нужно выбрать **Просмотреть диагностику работоспособности**. 

На странице диагностики работоспособности сведения о работоспособности упорядочены по следующим категориям: 

* Доступность
* Производительность
 
Все критерии работоспособности, определенные для конкретного компонента, например логического диска, ЦП и т. д. Кроме того, категории монитора отображаются рядом с ним в столбце **Критерии работоспособности**.  

Для каждого критерия работоспособности определяется одно из четырех состояний: *Критическое*, *Предупреждение*, *Исправно* или *Неизвестно*. Первые три — настраиваемые, то есть можно изменить пороги монитора с помощью [API мониторинга рабочей нагрузки](https://docs.microsoft.com/rest/api/monitor/microsoft.workloadmonitor/monitors/update). Состояние *Неизвестно* нельзя настроить. Оно зарезервировано для определенных сценариев.  

На странице "Диагностика работоспособности" есть три основных раздела:

* "Модель компонентов"; 
* Health Criteria (Критерии работоспособности);
* "Изменения состояния". 

![Разделы страницы диагностики работоспособности](./media/vminsights-health/health-diagnostics-page-02.png)

### <a name="component-model"></a>Модель компонентов
Крайний столбец слева на странице диагностики работоспособности содержит модель компонентов. В этом столбце отображаются все компоненты, связанные с виртуальной машиной, и сведения об их текущем состоянии работоспособности. 

В следующем примере обнаружены следующие компоненты: диск, логический диск, процессор, память и операционная система. В этом столбце обнаруживаются и отображаются несколько экземпляров этих компонентов. Например, на приведенном ниже рисунке показано, что на виртуальной машине используется два экземпляра логических дисков — C: и D:, которые находятся в исправном состоянии.  

![Пример модели компонентов в разделе диагностики работоспособности](./media/vminsights-health/health-diagnostics-page-component.png)

### <a name="health-criteria"></a>Критерии работоспособности
Центральный столбец на странице диагностики работоспособности называется **Health Criteria** (Критерии работоспособности). Модель работоспособности, созданная для виртуальной машины, отображается здесь в виде иерархического дерева. Модель работоспособности для виртуальной машины состоит из критериев работоспособности "Блок" и "Агрегация".  

![Пример критериев работоспособности в разделе диагностики работоспособности](./media/vminsights-health/health-diagnostics-page-healthcriteria.png)

С помощью каждого критерия работоспособность отслеживаемого экземпляра оценивают по определенному показателю, например по порогу, состоянию сущности и т. д. Критерий работоспособности может принимать два или три настраиваемых порога состояния работоспособности, как описано ранее. В любой момент критерий работоспособности может находиться только в одном из допустимых состояний. 

Общая работоспособность целевого объекта определяется работоспособностью по каждому критерию, установленному в модели работоспособности. Это может быть любое сочетание критериев работоспособности для самого целевого объекта или компонентов, от которых он агрегируется, свернутых в сводный монитор. Эта иерархия проиллюстрирована в разделе **критериев работоспособности** на странице "Диагностика работоспособности". Политика сводного монитора работоспособности определяется в конфигурации критериев агрегации, по умолчанию *Worst-of* (Наихудшее из). Список настроенных по умолчанию критериев работоспособности для этой функции вы найдете в разделе [Сведения о настройке мониторинга](#monitoring-configuration-details).  

Чтобы изменить конфигурацию для критерия работоспособности **Блок**, щелкните крайнюю ссылку справа с многоточием и выберите действие **Показать сведения**, после чего откроется панель конфигурации. 

![Пример конфигурации критериев работоспособности](./media/vminsights-health/health-diagnostics-vm-example-02.png)

На панели конфигурации для выбранного критерия работоспособности можно настроить порог с другим числовым значением, используя пример **Average Disk Seconds Per Write** (Среднее время записи на диск в секундах). Это монитор двух состояний. Состояние может изменяться только со значения "Исправно" на значение "Предупреждение". Критерии работоспособности могут поддерживать три состояния, и тогда для них можно отдельно настроить пороги для предупреждения и критического состояния.  

>[!NOTE]
>Изменения конфигурации, вносимые в критерии работоспособности для одного экземпляра, применяются сразу ко всем отслеживаемым экземплярам.  Например, если вы выберете **Disk -1 D:** (Диск -1 D:) и измените порог для **Average Disk Seconds Per Write** (Среднее время записи на диск в секундах), это значение будет действовать не только для выбранного экземпляра, но и для всех остальных обнаруженных экземпляров диска на отслеживаемой виртуальной машине.
>

![Пример настройки критерия работоспособности для базового монитора](./media/vminsights-health/health-diagnostics-criteria-config-01.png)

С дополнительными сведениями об индикаторе работоспособности можно ознакомиться в статьях базы знаний, где описаны методы выявления проблем, их причины и способы устранения. Щелкните ссылку **Просмотреть сведения**. Статья базы знаний по определенной проблеме откроется в новой вкладке браузера. Вы можете в любой момент просмотреть статьи базы знаний о критериях оценки работоспособности Azure Monitor для виртуальных машин [здесь](https://docs.microsoft.com/azure/monitoring/infrastructure-health/).
  
### <a name="state-changes"></a>Изменения состояний
В крайнем столбце справа на странице диагностики работоспособности отображаются сведения об **изменениях состояния**. Здесь перечислены все изменения состояний, обнаруженные для выбранных критериев работоспособности в разделе **Health Criteria** (Критерии работоспособности), а также изменения состояний для виртуальной машины, если она была выбрана в столбце таблицы **Модель компонентов** или **Health Criteria** (Критерии работоспособности). 

![Пример изменений состояний в разделе диагностики работоспособности](./media/vminsights-health/health-diagnostics-page-statechanges.png)

Этот раздел содержит сведения об изменении состояния критериев работоспособности и времени их изменения с сортировкой по убыванию актуальности.   

### <a name="association-of-component-model-health-criteria-and-state-change-columns"></a>Взаимосвязи между столбцами модели компонентов, критериев работоспособности и изменений состояния 
Эти три столбца связаны друг с другом. Если выбрать обнаруженный экземпляр в разделе **Модель компонентов**, раздел **Критерии работоспособности** фильтруется по этому компоненту, а затем обновляется раздел **Изменение состояния** в зависимости от набора выбранных критериев работоспособности. 

![Пример выбора отслеживаемого экземпляра и фильтрации результатов](./media/vminsights-health/health-diagnostics-vm-example-01.png)

Когда в приведенном выше примере вы выбираете экземпляр **Disk - 1 D:** (Диск -1 D:), дерево критериев работоспособности фильтруется по экземпляру **Disk - 1D:** (Диск -1 D:). Теперь в столбце **Изменение состояния** отображаются только изменения состояния, касающиеся доступности экземпляра **Disk - 1D:** (Диск -1 D:). 

Чтобы просмотреть обновленные сведения о работоспособности, обновите страницу диагностики. Для этого щелкните ссылку **Обновить**.  Если состояние работоспособности для критерия работоспособности изменяется с определенным заданным интервалом, это действие позволит избежать ожидания и сразу отобразить свежие данные о работоспособности.  Фильтр **Состояние критериев работоспособности** позволяет ограничить результаты по значению состояния работоспособности: *Исправно*, *Предупреждение*, *Критическое*, *Неизвестно* или получить результаты по *всем* этим значениям.  Значение времени **Последнее обновление** в верхнем углу справа — это момент последней загрузки страницы диагностики работоспособности.  

## <a name="alerts"></a>Оповещения
Функцию оценки работоспособности в Azure Monitor для виртуальных машин можно интегрировать с [интерфейсом оповещений Azure](../../azure-monitor/platform/alerts-overview.md), чтобы создавать оповещения о переходе критериев работоспособности из состояния "Исправно" в любое неисправное состояние. Оповещения разделяются на несколько уровней серьезности — от 0 до 4, где 0 обозначает наивысший уровень серьезности.  

Общее число оповещений о работоспособности виртуальной машины с разбивкой по уровням серьезности можно найти на панели мониторинга **Работоспособность** в разделе **Оповещения**. Когда вы выбираете общее число оповещений или число, соответствующее определенному уровню серьезности, открывается страница **Оповещения** со списком всех оповещений для выбранного элемента.  Например, если вы выбрали строку для уровня серьезности **Sev level 1**, вы увидите следующее:

![Пример оповещений для уровня серьезности 1](./media/vminsights-health/vminsights-sev1-alerts-01.png)

На странице **Оповещения** отображаются не только оповещения, соответствующие выбранным параметрам, но и отфильтрованные по **типу ресурса**, чтобы отображались только оповещения о работоспособности, вызванные ресурсом виртуальной машины.  Это отражено в списке оповещений в столбце **Целевой ресурс**, где отображается виртуальная машина Azure, которая вызвала оповещение о соблюдении условия неработоспособности.  

Оповещения от других типов ресурсов или службы не предназначены для включения в этом представлении, такие как журнал оповещений на основе журнала запросов или оповещения метрик, можно будет просматривать по умолчанию Azure Monitor [все оповещения](../../azure-monitor/platform/alerts-overview.md#all-alerts-page) страницы. 

Это представление можно отфильтровать, выбрав значения в раскрывающемся меню в верхней части страницы.

|столбец |ОПИСАНИЕ | 
|-------|------------| 
|Подписка |Выберите подписку Azure. В представление включены только оповещения из выбранных подписок. | 
|Группа ресурсов |Выбор одной группы ресурсов. Только те предупреждения, которые отмечены в выбранной группе ресурсов, включены в представление. | 
|Тип ресурса |Выбор одной или нескольких группу ресурсов. По умолчанию только оповещения целевого объекта **Виртуальные машины** выбраны и включены в это представление. Этот столбец становится доступным только после указания группы ресурсов. | 
|Ресурс |Выбор ресурса. В представление включены только те оповещения, целью которых выбраны ресурсы. Этот столбец становится доступным только после указания типа ресурсов. | 
|Уровень серьезности |Выберите серьезность оповещения или щелкните *Все*, чтобы включить оповещения всех уровней серьезности. | 
|Состояние монитора |Выберите условие мониторинга, при котором отображаются предупреждения, созданные системой (*Fired*) или устраненные системой (*Resolved*) при прекращении действия условия. Также можно выбрать вариант *Все*, чтобы отобразить оповещения по любым условиям. | 
|Состояние оповещения |Выберите состояние оповещения *Новое*, *Подтверждено* или *Закрыто* или щелкните *Все*, чтобы включить оповещения во всех состояниях. | 
|Мониторинг службы |Выберите службу или щелкните *Все*, чтобы включить все службы. Эта функция поддерживает только оповещения от *аналитики виртуальных машин*.| 
|Диапазон времени| Только оповещения, выполненные в рамках выбранного временного интервала, будут включены в представление. Поддерживаемые значения: за последний час, за последние 24 часа, за последние 7 дней и за последние 30 дней. | 

При выборе оповещения отображается страница **сведений об оповещении**, где вы можете изменить его состояние. Дополнительные сведения об управлении оповещениями см. в статье [Создание и просмотр оповещений метрик, а также управление ими с помощью Azure Monitor](../../azure-monitor/platform/alerts-metric.md).  

>[!NOTE]
>Сейчас не поддерживается создание оповещений на основе критериев работоспособности или изменение существующих правил генерации оповещений о работоспособности в Azure Monitor на портале.  
>

![Панель сведений о выбранном оповещении](./media/vminsights-health/alert-details-pane-01.png)

Также состояние оповещения можно изменить, выбрав одно или несколько оповещений на странице **Все оповещения** в верхнем углу слева и выбрав **Изменить состояние**. На панели **Изменить состояние оповещения** следует выбрать одно из состояний, добавить для него описание в поле **Комментарий** и зафиксировать изменения, нажав кнопку **ОК**. Пока проверяются данные, ход применения изменений можно отслеживать с помощью пункта меню **Уведомления**.  

## <a name="next-steps"></a>Дальнейшие действия
Чтобы выявить узкие места производительности и общий уровень загрузки для виртуальных машин, изучите статью о [просмотре данных производительности виртуальной машины Azure](vminsights-performance.md). Просмотреть обнаруженные зависимости приложений поможет статья о [функции карты Azure Monitor для виртуальных машин](vminsights-maps.md). 
