---
title: Просмотр метрик в режиме реального времени с помощью Azure Monitor для контейнеров | Документация Майкрософт
description: В этой статье описывается представление метрик в режиме реального времени без использования kubectl с Azure Monitor для контейнеров.
services: azure-monitor
documentationcenter: ''
author: mgoedtel
manager: carmonm
editor: ''
ms.assetid: ''
ms.service: azure-monitor
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/15/2019
ms.author: magoedte
ms.openlocfilehash: 4608058d347888ab77bd4303600f00b270d6fed5
ms.sourcegitcommit: c22327552d62f88aeaa321189f9b9a631525027c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73514606"
---
# <a name="how-to-view-metrics-in-real-time"></a>Просмотр метрик в режиме реального времени

Функции Azure Monitor для динамических данных контейнеров (Предварительная версия) позволяют визуализировать метрики состояния узла и Pod в кластере в режиме реального времени. Он эмулирует прямой доступ к командам `kubectl top nodes`, `kubectl get pods –all-namespaces`и `kubectl get nodes` для вызова, анализа и визуализации данных в диаграммах производительности, которые включены в эту информацию. 

Эта статья содержит подробный обзор и поможет вам понять, как использовать эту функцию.  

>[!NOTE]
>Кластеры AKS, включенные в качестве [частных кластеров](https://azure.microsoft.com/updates/aks-private-cluster/) , не поддерживаются этой функцией. Эта функция зависит от прямого доступа к API Kubernetes через прокси-сервер из браузера. Включение сетевой безопасности для блокировки интерфейса API Kubernetes от этого прокси-сервера приведет к блокировке этого трафика. 

>[!NOTE]
>Эта функция доступна во всех регионах Azure, включая Azure для Китая. Сейчас она недоступна в Azure для государственных организаций США.

Чтобы получить справку по настройке и устранению неполадок интерактивных данных (Предварительная версия), ознакомьтесь с нашим [руководством по установке](container-insights-livedata-setup.md).

## <a name="how-it-works"></a>Принцип работы 

Функция интерактивных данных (Предварительная версия) напрямую обращается к API Kubernetes, а дополнительные сведения о модели проверки подлинности можно найти [здесь](https://kubernetes.io/docs/concepts/overview/kubernetes-api/). 

Эта функция выполняет операцию опроса для конечных точек метрик (включая `/api/v1/nodes`, `/apis/metrics.k8s.io/v1beta1/nodes`и `/api/v1/pods`), по умолчанию каждые пять секунд. Эти данные кэшируются в браузере и сохранятся в четырех диаграммах производительности, включенных в Azure Monitor для контейнеров на вкладке **кластер** , выбрав **Go Live (Предварительная версия)** . Каждый последующий опрос помещается в 5-минутное окно визуализации. 

![Параметр "перейти в реальном времени" в представлении кластера](./media/container-insights-livedata-metrics/cluster-view-go-live-example-01.png)

Интервал опроса настраивается из раскрывающегося списка **задать интервал** , что позволяет установить опрос для новых данных каждые 1, 5, 15 и 30 секунд. 

![Интервал опроса "в реальном времени"](./media/container-insights-livedata-metrics/cluster-view-polling-interval-dropdown.ping.png)

>[!IMPORTANT]
>Рекомендуется установить интервал опроса равным одной секунде при устранении проблемы в течение короткого периода времени. Эти запросы могут повлиять на доступность и регулирование API Kubernetes в кластере. Затем перенастройте его на более длительный интервал опроса. 

>[!IMPORTANT]
>При работе этой функции данные не сохраняются навсегда. Все сведения, захваченные во время этого сеанса, немедленно удаляются при закрытии браузера или переходе от функции. Данные остаются только для визуализации в течение пяти минут; все метрики старше пяти минут также удаляются без возможности восстановления.

Эти диаграммы нельзя закрепить на последней просматриваемой панели мониторинга Azure в режиме реального времени.

## <a name="metrics-captured"></a>Собранные показатели телеметрии

### <a name="node-cpu-utilization---node-memory-utilization-"></a>Использование ЦП узла%/занято памяти узла-% 

Эти две диаграммы производительности сопоставляются с эквивалентом вызова `kubectl top nodes` и захватывает результаты столбцов **ЦП%** и **Memory%** в соответствующей диаграмме. 

![Примеры результатов для основных узлов Kubectl](./media/container-insights-livedata-metrics/kubectl-top-nodes-example.png)

![Диаграмма процента использования ЦП узлами](./media/container-insights-livedata-metrics/cluster-view-node-cpu-util.png)

![Диаграмма процента использования памяти узла](./media/container-insights-livedata-metrics/cluster-view-node-memory-util.png)

Вычисления процентилей будут работать в больших кластерах, чтобы помочь определить узлы выбросов в кластере. Например, чтобы определить, используются ли узлы в целях уменьшения масштаба. Используя функцию агрегирования **min** , можно увидеть, какие узлы имеют низкую загрузку в кластере. Для дальнейшего изучения перейдите на вкладку **узлы** и отсортируйте сетку по использованию ЦП или памяти.

Это также поможет понять, какие узлы отправляются в их пределы, и если требуется горизонтальное масштабирование. Использование как агрегатов **Max** , так и **P95** может помочь увидеть, имеются ли в кластере узлы с высоким уровнем использования ресурсов. Для дальнейшего исследования снова перейдите на вкладку **узлы** .

### <a name="node-count"></a>Число узлов

Эта диаграмма производительности сопоставляется с эквивалентом вызова `kubectl get nodes` и сопоставления столбца **состояния** с диаграммой, сгруппированной по типам состояния.

![Примеры результатов Kubectl Get nodes](./media/container-insights-livedata-metrics/kubectl-get-nodes-example.png)

![Диаграмма количества узлов](./media/container-insights-livedata-metrics/cluster-view-node-count-01.png)

Узлы включаются в состояние **готовности** или **неготовности** . Они подсчитываются (и создается общее количество), а результаты этих двух агрегатов отображаются на диаграмме.
Например, чтобы понять, не находятся ли узлы в состоянии сбоя. Используя агрегирование **неготовности** , можно быстро увидеть количество узлов в кластере, находящихся в состоянии " **не готово** ".

### <a name="active-pod-count"></a>Число активных модулей

Эта диаграмма производительности сопоставляется с эквивалентом вызова `kubectl get pods –all-namespaces` и сопоставляет столбец **состояния** с диаграммой, сгруппированной по типам состояния.

![Пример результатов получения Kubectl для модулей Pod](./media/container-insights-livedata-metrics/kubectl-get-pods-example.png)

![Диаграмма счетчика Pod узлов](./media/container-insights-livedata-metrics/cluster-view-node-pod-count.png)

>[!NOTE]
>Имена состояния, интерпретируемые `kubectl`, могут не совпадать в точности в диаграмме. 

## <a name="next-steps"></a>Дальнейшие действия

Просмотрите [примеры запросов журналов](container-insights-log-search.md#search-logs-to-analyze-data) , чтобы просмотреть предопределенные запросы и примеры для создания предупреждений, визуализаций или выполнения дальнейшего анализа кластеров.