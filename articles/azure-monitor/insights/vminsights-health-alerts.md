---
title: Azure Monitor для виртуальных машин оповещений о работоспособности гостевой системы (Предварительная версия)
description: Описание предупреждений, созданных Azure Monitor для виртуальных машин работоспособности гостевых систем, включая включение и настройку уведомлений.
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 11/10/2020
ms.openlocfilehash: 9bbb0be321e78317c52586454de3d49cb2f878c1
ms.sourcegitcommit: c157b830430f9937a7fa7a3a6666dcb66caa338b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "94686892"
---
# <a name="azure-monitor-for-vms-guest-health-alerts-preview"></a>Azure Monitor для виртуальных машин оповещений о работоспособности гостевой системы (Предварительная версия)
Azure Monitor для виртуальных машин работоспособности гостевых систем позволяет просматривать работоспособность виртуальной машины в соответствии с набором измерений производительности, которые вычисляются с регулярным интервалом. Оповещение может быть создано, когда виртуальная машина или монитор переходит в неработоспособное состояние. Вы можете просматривать эти оповещения и управлять ими с помощью [правил генерации оповещений в Azure Monitor](../platform/alerts-overview.md) и выбирать упреждающее уведомление при создании нового оповещения.

## <a name="configure-alerts"></a>Настройка оповещений
Вы не можете создать явное правило генерации оповещений для Azure Monitor для виртуальных машин работоспособности гостя, пока эта функция находится на этапе предварительной версии. По умолчанию предупреждения будут создаваться для каждой виртуальной машины, но не для каждого монитора.  Это означает, что если монитор переходит в состояние, которое не влияет на текущее состояние виртуальной машины, оповещение не создается, так как состояние виртуальной машины не изменилось. 

Вы можете отключить оповещения для определенной виртуальной машины или для определенного монитора на виртуальной машине из параметра **состояния оповещения** в конфигурации виртуальной машины в портал Azure. Дополнительные сведения о настройке мониторов в портал Azure см. в статье [Настройка мониторинга в Azure Monitor для виртуальных машин гостевой работоспособности (Предварительная версия)](vminsights-health-configure.md) . Дополнительные сведения о настройке мониторов в наборе виртуальных машин см. в статье [Настройка мониторинга в Azure Monitor для виртуальных машин работоспособности гостевой системы с помощью правил сбора данных (Предварительная версия)](vminsights-health-configure-dcr.md) .

## <a name="alert-severity"></a>Серьезность оповещения
Серьезность предупреждения, созданного гостевой работоспособностью, напрямую сопоставляется с уровнем серьезности виртуальной машины или монитора, запускающего оповещение.

| Состояние монитора | Серьезность оповещения |
|:---|:---|
| Критически важно | Sev1 |
| Предупреждение  | Sev2 |
| Работоспособно  | Sev4 |

## <a name="alert-lifecycle"></a>Жизненный цикл оповещения
[Оповещение Azure](../platform/alerts-overview.md) будет создано для каждой виртуальной машины в любое время, когда оно изменится на **предупреждение** или **критическое** состояние. Просмотрите **оповещение в меню** **Azure Monitor** или в меню виртуальной машины в портал Azure.

Если предупреждение уже выдается при **изменении состояния виртуальной** машины, второе предупреждение не будет создано, но серьезность того же оповещения будет изменена в соответствии с состоянием виртуальной машины. Например, если виртуальная машина переходит в **критическое** состояние, когда **предупреждающее** оповещение уже находилось в состоянии **срабатывания** , уровень серьезности этого предупреждения изменится на **Sev1**. Если виртуальная машина переходит в состояние **предупреждения** , когда оповещение **Sev1** уже находилось в **запущенном** состоянии, уровень серьезности этого предупреждения изменится на **Sev2**. Если виртуальная машина переходит в **работоспособное** состояние, предупреждение будет разрешаться с уровнем серьезности изменено на **Sev4**.

## <a name="viewing-alerts"></a>Просмотр оповещений
Просмотрите предупреждения, созданные Azure Monitor для виртуальных машин гостевой работоспособности с другими [оповещениями в портал Azure](../platform/alerts-overview.md#alerts-experience). Вы можете выбрать **оповещения** в меню **Azure Monitor** , чтобы просмотреть предупреждения для всех наблюдаемых ресурсов, или выбрать **оповещения** из меню виртуальной машины, чтобы просмотреть предупреждения только для этой виртуальной машины.

## <a name="alert-properties"></a>Свойства предупреждения

### <a name="properties-in-the-azure-portal"></a>Свойства в портал Azure
Свойства предупреждения при его просмотре в портал Azure описаны в следующей таблице.

| Свойство | Описание |
|:---|:---|
| Состояние монитора перед созданием предупреждения | Состояние монитора или виртуальной машины, прежде чем это предупреждение будет инициировано в первый раз. |
| Отслеживать состояние при создании предупреждения | Состояние монитора или виртуальной машины при первом запуске предупреждения. Это состояние, вызвавшее срабатывание предупреждения. |
| Дополнительные сведения о переходе состояния при создании оповещения | Ссылка на страницу работоспособности виртуальной машины, на которой можно увидеть точную смену состояния. Это переход состояния представляет экземпляр, когда монитор впервые перешел из **работоспособного** состояния в неработоспособное состояние. |

Например, монитор переходит от **работоспособного** к **критическому** времени T0, а новое оповещение запускается с помощью **Sev1**. Затем он переходит от **критического** к **предупреждению** в момент T1, а серьезность предупреждения обновляется до **Sev2**. Он становится **работоспособным** во время T2, и предупреждение разрешается.

Свойства предупреждения будут иметь эти значения во всей последовательности.

- Состояние монитора перед созданием предупреждения: работоспособное
- Состояние монитора при создании предупреждения: критическое
- Дополнительные сведения о переходе состояния при создании предупреждения: ссылка навигации на переход состояния произошла во время T0.


### <a name="properties-in-notifications"></a>Свойства в уведомлениях
Свойства предупреждения, включаемые в уведомления, описаны в следующей таблице.

| Свойство | Описание |
|:---|:---|
| Предыдущее состояние монитора | Состояние монитора или виртуальной машины до изменения состояния. Если обновление серьезности оповещения активирует это уведомление, это свойство представляет состояние, которое было непосредственно перед обновлением серьезности. |
| Текущее состояние монитора | Состояние монитора или виртуальной машины при изменении состояния. Если обновление серьезности оповещения активирует это уведомление, это свойство представляет новое состояние. |
| Дополнительные сведения об этом переходе о состоянии | Ссылка на страницу работоспособности виртуальной машины, на которой можно увидеть точную смену состояния. Это переход состояния представляет экземпляр при наблюдении за измененным состоянием, которое активировало это уведомление. |

Используя приведенный выше пример, уведомления будут иметь следующие свойства в каждый момент времени.

Уведомление получено во время T0
- Предыдущее состояние монитора: работоспособное
- Текущее состояние монитора: критическое
- Дополнительные сведения об этом переходе состояния: ссылка навигации на переход состояния произошла во время T0.

Уведомление получено во время T1
- Предыдущее состояние монитора: критическое
- Текущее состояние монитора: предупреждение
- Дополнительные сведения об этом переходе состояния: ссылка навигации на переход состояния произошла во время T1.

Уведомление получено во время T2
- Предыдущее состояние монитора: предупреждение
- Текущее состояние монитора: работоспособно
- Дополнительные сведения об этом переходе между состояниями: ссылка навигации на переход состояния произошла во время T2.

## <a name="configure-notifications"></a>Настройка уведомлений
Для упреждающего уведомления о предупреждении, инициированном работоспособностью гостевого компьютера, создайте [группу действий](../platform/action-groups.md) , чтобы определить различные действия, которые необходимо выполнить, такие как отправка SMS-сообщения или запуск приложения логики. Затем создайте [правило действия](../platform/alerts-action-rules.md) , определяющее область мониторов и виртуальных машин и использующее эту группу действий.

В меню " **монитор** " в портал Azure выберите пункт **оповещения**.  Выберите **Управление действиями** , а затем **правила действий (Предварительная версия)**. 

![Новое правило действия](media/vminsights-health-alerts/action-rule-new.png)

Щелкните **создать правило действия** , чтобы создать новое правило. Нажмите кнопку **выбрать** рядом с областью и выберите подписку, группу ресурсов или одну или несколько конкретных виртуальных машин. Уведомление будет запущено только для виртуальных машин, которые находятся в пределах области.

![Область действия правила](media/vminsights-health-alerts/action-rule-scope.png)

Нажмите кнопку **Добавить** рядом с полем **Фильтр**. Создание фильтра, где **Служба мониторинга принимает значение "VM Insights" — работоспособность**. Добавьте другие фильтры, чтобы указать конкретные оповещения, которые должны активировать уведомление. Например, можно использовать **уровень серьезности** для сопоставления предупреждений всех мониторов, соответствующих определенному уровню серьезности.

![Фильтр правил действий](media/vminsights-health-alerts/action-rule-filter.png)

В поле **определить в этой области** выберите **Группа действий** , а затем выберите группу действий, чтобы связать ее с монитором. Присвойте правилу имя и выберите группу ресурсов, в которой оно должно быть сохранено. Нажмите кнопку **создать** , чтобы создать правило.

![Правило действия](media/vminsights-health-alerts/action-rule.png)


## <a name="next-steps"></a>Дальнейшие действия

- [Включение работоспособности гостевых систем в Azure Monitor для виртуальных машин и встроенных агентах.](vminsights-health-enable.md)
- [Настройка мониторов с помощью портал Azure.](vminsights-health-configure.md)
- [Настройка мониторов с помощью правил сбора данных.](vminsights-health-configure-dcr.md)