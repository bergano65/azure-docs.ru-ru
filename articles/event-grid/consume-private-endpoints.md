---
title: Доставка событий с помощью службы частной связи
description: В этой статье описывается, как обойти ограничение невозможности доставки событий с помощью службы Private Link.
ms.topic: how-to
ms.date: 02/12/2021
ms.openlocfilehash: ad6f500830383f60e0350a297d2650bfbeae2f6f
ms.sourcegitcommit: d4734bc680ea221ea80fdea67859d6d32241aefc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100418034"
---
# <a name="deliver-events-using-private-link-service"></a>Доставка событий с помощью службы частной связи
В настоящее время невозможно доставить события с помощью [частных конечных точек](../private-link/private-endpoint-overview.md). То есть нет никакой поддержки, если есть требования к сетевой изоляции, в которых трафик доставленных событий не должен выходить за пределы частного IP-адреса. 

## <a name="use-managed-identity"></a>Использование управляемого удостоверения
Однако если ваши требования вызывают безопасный способ отправки событий с помощью зашифрованного канала и известного удостоверения отправителя (в этом случае — службы "Сетка событий") с использованием пространства общедоступного IP-адреса, можно передать события в концентраторы событий, служебную шину или службу хранилища Azure с помощью пользовательского раздела службы "Сетка событий Azure" или домена с удостоверением, управляемым системой. Дополнительные сведения о доставке событий с помощью управляемого удостоверения см. в статье о [доставке событий с помощью управляемого удостоверения](managed-service-identity.md). 

Затем можно использовать закрытую ссылку, настроенную в функциях Azure, или веб-перехватчик, развернутый в виртуальной сети, для извлечения событий. См. Пример: [Подключение к частным конечным точкам с помощью функций Azure](/samples/azure-samples/azure-functions-private-endpoints/connect-to-private-endpoints-with-azure-functions/).


:::image type="content" source="./media/consume-private-endpoints/deliver-private-link-service.png" alt-text="Доставка через службу частных ссылок":::


В этой конфигурации трафик передается через общедоступный IP-адрес или Интернет из службы "Сетка событий" в концентраторы событий, служебную шину или службу хранилища Azure, но канал может быть зашифрован и используется управляемое удостоверение службы "Сетка событий". Если вы настраиваете функции Azure или веб-перехватчик, развернутые в виртуальной сети, для использования концентраторов событий, служебной шины или хранилища Azure с помощью частной связи, этот раздел трафика будет оставаться в пределах Azure.

## <a name="deliver-events-to-event-hubs-using-managed-identity"></a>Доставка событий в концентраторы событий с помощью управляемого удостоверения
Для доставки событий в концентраторы событий в пространстве имен концентраторов событий с помощью управляемого удостоверения выполните следующие действия.

1. [Включите назначенное системой удостоверение для раздела или домена](managed-service-identity.md#create-a-custom-topic-or-domain-with-an-identity). 
1. [Добавьте удостоверение в роль **отправителя данных концентраторов событий Azure** в пространстве имен концентраторов событий](../event-hubs/authenticate-managed-identity.md#to-assign-azure-roles-using-the-azure-portal).
1. [Установите флажок **разрешить доверенным службам Майкрософт обходить этот параметр брандмауэра** в пространстве имен концентраторов событий](../event-hubs/event-hubs-service-endpoints.md#trusted-microsoft-services). 
1. [Настройте подписку на события](managed-service-identity.md#create-event-subscriptions-that-use-an-identity) , которая использует концентратор событий в качестве конечной точки для использования назначенного системой удостоверения.

## <a name="deliver-events-to-service-bus-using-managed-identity"></a>Доставка событий в служебную шину с помощью управляемого удостоверения
Чтобы доставлять события в очереди или разделы служебной шины в пространстве имен служебная шина с помощью управляемого удостоверения, выполните следующие действия.

1. [Включите назначенное системой удостоверение для раздела или домена](managed-service-identity.md#create-a-custom-topic-or-domain-with-an-identity). 
1. Добавление удостоверения в роль [отправителя данных служебной шины Azure](/service-bus-messaging/service-bus-managed-service-identity.md#azure-built-in-roles-for-azure-service-bus) в пространстве имен служебной шины
1. [Установите флажок **разрешить доверенным службам Майкрософт обходить этот параметр брандмауэра** в пространстве имен служебной шины](../service-bus-messaging/service-bus-service-endpoints.md#trusted-microsoft-services). 
1. [Настройте подписку на события](managed-service-identity.md#create-event-subscriptions-that-use-an-identity) , использующую очередь или раздел служебной шины в качестве конечной точки для использования назначенного системой удостоверения.

## <a name="deliver-events-to-storage"></a>Доставка событий в хранилище 
Для доставки событий в очереди хранилища с помощью управляемого удостоверения выполните следующие действия.

1. [Включите назначенное системой удостоверение для раздела или домена](managed-service-identity.md#create-a-custom-topic-or-domain-with-an-identity).
1. Добавьте удостоверение в роль [отправителя сообщений очереди хранилища](../storage/common/storage-auth-aad-rbac-portal.md) в очереди службы хранилища Azure.
1. [Настройте подписку на события](managed-service-identity.md#create-event-subscriptions-that-use-an-identity) , использующую очередь или раздел служебной шины в качестве конечной точки для использования назначенного системой удостоверения.


## <a name="next-steps"></a>Следующие шаги
Дополнительные сведения о доставке событий с помощью управляемого удостоверения см. в разделе [Доставка событий с помощью управляемого удостоверения](managed-service-identity.md). 
