---
title: Перемещение доменов службы "Сетка событий Azure" в другой регион
description: В этой статье показано, как переместить домены службы "Сетка событий Azure" из одного региона в другой.
ms.topic: how-to
ms.custom: subject-moving-resources
ms.date: 08/20/2020
ms.openlocfilehash: fff8638a819511f84f15c52ad0695cdd5759f971
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "89086218"
---
# <a name="move-azure-event-grid-domains-to-another-region"></a>Перемещение доменов службы "Сетка событий Azure" в другой регион
Вам может потребоваться переместить ресурсы в другой регион по ряду причин. Например, чтобы воспользоваться преимуществами нового региона Azure, чтобы удовлетворить внутренние требования к политике и управлению, а также в ответ на требования к планированию емкости. 

Ниже приведены общие действия, описанные в этой статье. 

- **Экспортируйте доменный** ресурс в шаблон Azure Resource Manager. 

    > [!IMPORTANT]
    > Доменные ресурсы и разделы в домене экспортируются в шаблон. Подписки на разделы домена не экспортируются. 
- **Используйте шаблон для развертывания домена** в целевом регионе. 
- **Создание подписок для разделов домена вручную** в целевом регионе. При экспорте домена в шаблон в текущем регионе подписки для разделов домена не экспортируются. Поэтому создайте их после создания разделов домена и домена в целевом регионе. 
- **Проверка развертывания**. Отправка события в доменный раздел в домене и проверка вызова обработчика событий, связанного с подпиской. 
- Чтобы **завершить перемещение**, удалите домен из исходного региона. 

## <a name="prerequisites"></a>Предварительные требования
- Убедитесь, что служба "Сетка событий" доступна в целевом регионе. См. страницу [Доступность продуктов по регионам](https://azure.microsoft.com/global-infrastructure/services/?products=event-grid&regions=all).

## <a name="prepare"></a>Подготовка.
Чтобы приступить к работе, экспортируйте шаблон диспетчер ресурсов для домена. 

1. Войдите на [портал Azure](https://portal.azure.com).
2. В строке поиска введите **домен сетки событий**и выберите в списке результатов пункт **домены сетки событий** . 

    :::image type="content" source="./media/move-domains-across-regions/search-domains.png" alt-text="Поиск и выбор доменов сетки событий":::
3. Выберите **домен** , который необходимо экспортировать в шаблон диспетчер ресурсов. 

    :::image type="content" source="./media/move-domains-across-regions/select-domain.png" alt-text="Поиск и выбор доменов сетки событий":::   
4. На странице **домен сетки событий** выберите **Экспорт шаблона** в разделе **Параметры** в меню слева и нажмите кнопку **скачать** на панели инструментов. 

    :::image type="content" source="./media/move-domains-across-regions/export-template-download.png" alt-text="Поиск и выбор доменов сетки событий" lightbox="./media/move-domains-across-regions/export-template-download.png":::   

    > [!IMPORTANT]
    > Разделы домена и домена экспортируются. Подписки для разделов домена не экспортируются. Поэтому необходимо создать подписки для разделов домена после перемещения разделов предметной области. 
5. Выберите **ZIP** -файл, скачанный с портала, и распакуйте его в выбранную папку. Этот ZIP-файл содержит шаблонные и параметры JSON-файлы. 
1. Откройте **template.js** в любом редакторе по своему усмотрению. 
8. Обновите `location` ресурс **домена** до целевого региона или расположения. Чтобы получить коды расположения, см. раздел [расположения Azure](https://azure.microsoft.com/global-infrastructure/locations/). Код для региона — это имя региона без пробелов, например, `West US` равно `westus` .

    ```json
    "type": "Microsoft.EventGrid/domains",
    "apiVersion": "2020-06-01",
    "name": "[parameters('domains_spegriddomain_name')]",
    "location": "westus",
    ```
1. **Сохраните** шаблон. 

## <a name="recreate"></a>Повторно создать 
Разверните шаблон, чтобы создать разделы домена и домена в целевом регионе. 

1. В портал Azure выберите **создать ресурс**.
2. В **поле Поиск в Marketplace**введите **шаблон развертывание**и нажмите клавишу **Ввод**.
3. Выберите **шаблоны развертывания**.
4. Нажмите кнопку **создания**.
5. Выберите **Создать собственный шаблон в редакторе**.
6. Выберите **загрузить файл**и следуйте инструкциям по загрузке **template.jsв** файл, скачанный в предыдущем разделе.
7. Нажмите кнопку **сохранить** , чтобы сохранить шаблон. 
8. На странице **Настраиваемое развертывание** выполните следующие действия.
    1. Выберите **подписку**Azure. 
    1. Выберите существующую **группу ресурсов** в целевом регионе или создайте ее. 
    1. В поле **регион**выберите целевой регион. Если выбрана существующая группа ресурсов, этот параметр доступен только для чтения. 
    1. В поле **доменное имя**введите новое имя для домена. 
    1. Выберите **Review + create** (Просмотреть и создать). 
    
        :::image type="content" source="./media/move-domains-across-regions/deploy-template.png" alt-text="Поиск и выбор доменов сетки событий":::        
    1. После завершения проверки шаблона выберите **создать** в нижней части страницы, чтобы развернуть ресурс. 
    1. После завершения развертывания выберите **Переход к группе ресурсов** для перехода к странице Группа ресурсов. Убедитесь, что в группе ресурсов есть домен. Выберите домен. Убедитесь, что в домене есть разделы предметной области. 

## <a name="discard-or-clean-up"></a>Отмена или очистка
Чтобы завершить перемещение, удалите домен в исходном регионе.  

Если вы хотите начать заново, удалите домен в целевом регионе и повторите действия, описанные в разделах [Подготовка](#prepare) и [Повторное создание](#recreate) этой статьи.

Чтобы удалить домен с помощью портал Azure, выполните следующие действия.

1. В окне поиска в верхней части портал Azure введите " **Сетка событий**" и выберите " **домены событий** " в результатах поиска. 
2. Выберите домен для удаления и щелкните **Удалить** на панели инструментов. 
3. На странице Подтверждение введите имя группы ресурсов и выберите **Удалить**.  

Чтобы удалить группу ресурсов, содержащую домен, с помощью портал Azure:

1. В окне поиска в верхней части портал Azure введите **группы ресурсов**и выберите **группы ресурсов** из результатов поиска. 
2. Выберите группу ресурсов для удаления и щелкните **Удалить** на панели инструментов. 
3. На странице Подтверждение введите имя группы ресурсов и выберите **Удалить**.  

## <a name="next-steps"></a>Дальнейшие действия
Вы узнали, как переместить домен сетки событий из одного региона в другой. Ознакомьтесь со следующими статьями для перемещения системных разделов, пользовательских разделов и пространств имен партнеров между регионами.

- [Перемещение системных разделов по регионам](move-system-topics-across-regions.md). 
- [Перемещение пользовательских разделов по регионам](move-custom-topics-across-regions.md). 
- [Перемещение пространств имен партнеров между регионами](move-partner-namespaces-across-regions.md).

Дополнительные сведения о перемещении ресурсов между регионами и аварийным восстановлением в Azure см. в следующей статье: [Перемещение ресурсов в новую группу ресурсов или подписку](../azure-resource-manager/management/move-resource-group-and-subscription.md).