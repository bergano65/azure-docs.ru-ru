---
title: Домены событий в службе "Сетка событий Azure"
description: В этой статье описывается, как использовать домены событий для управления потоком настраиваемых событий для различных бизнес-организаций, клиентов или приложений.
ms.topic: conceptual
ms.date: 07/07/2020
ms.openlocfilehash: 9b313784cd006087f3c2f1354053540cc9224782
ms.sourcegitcommit: 03713bf705301e7f567010714beb236e7c8cee6f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2020
ms.locfileid: "92328833"
---
# <a name="understand-event-domains-for-managing-event-grid-topics"></a>Общие сведения о доменах событий, используемых для управления разделами службы "Сетка событий Azure"

В этой статье описывается, как использовать домены событий для управления потоком настраиваемых событий для различных бизнес-организаций, клиентов или приложений. Домены событий можно использовать для выполнения следующих задач:

* Управление мультитенантными архитектурами обработки событий в масштабе.
* Управление аутентификацией и авторизацией.
* Распределение разделов без необходимости управлять каждым из них по отдельности.
* Избежание индивидуальной публикации в каждой конечной точке раздела.

## <a name="event-domain-overview"></a>Обзор домена событий

Домен событий — это инструмент управления для большого количества разделов Сетки событий, связанных с одним и тем же приложением. Его можно считать метаразделом, в котором может содержаться тысячи отдельных разделов.

Благодаря доменам событий вам становится доступна архитектура, используемая в службах Azure (служба хранилища и Центр Интернета вещей), предоставляющая возможность публикации событий. Они позволяют публиковать события во множестве разделов. Домены также обеспечивают авторизацию и аутентификацию в каждом разделе, чтобы вы могли разделить свои клиенты.

### <a name="example-use-case"></a>Пример варианта использования

Работу доменов событий можно легко объяснить на примере. Предположим, вы запускаете машинный механизм создания Contoso, где вы создаете дистракторы, продвигаясь вглубь оборудование и прочее интенсивное оборудование. В рамках ведения бизнеса вы отправляете клиентам сведения в режиме реального времени об обслуживании оборудования, работоспособности системы, обновлениях контрактов. Вся эта информация поступает на различные конечные точки, включая ваше приложение, конечные точки клиента и другие настроенные компоненты инфраструктуры.

Домены событий позволяют моделировать строительный механизм Contoso как единый объект событий. Каждый из ваших клиентов представляется как раздел в пределах домена. Проверка подлинности и авторизация выполняются с помощью Azure Active Directory. Каждый из этих клиентов может подписаться на свой раздел и настроить отправку событий в него. Благодаря управляемому доступу через домен событий клиенты получают доступ только к своим разделам.

Вы также получаете единую конечную точку, в которой можете публиковать все ваши клиентские события. Служба "Сетка событий" уведомляет каждый раздел о событиях клиента.

![Пример конструкции Contoso](./media/event-domains/contoso-construction-example.png)

## <a name="access-management"></a>Управление доступом

Благодаря домену вы получаете точную авторизацию и управление проверкой подлинности в каждом разделе с помощью управления доступом на основе ролей Azure (Azure RBAC). С помощью этих ролей вы можете ограничивать каждого клиента в приложении для использования только тех разделов, к которым вы хотите предоставить доступ.

Azure RBAC в доменах событий работает так же, как и [управляемый контроль доступа](security-authorization.md) , в оставшейся части службы "Сетка событий" и Azure. Используйте Azure RBAC для создания и применения пользовательских определений ролей в доменах событий.

### <a name="built-in-roles"></a>Встроенные роли

Сетка событий имеет два встроенных определения ролей, которые упрощают использование Azure RBAC для работы с доменами событий. Это **Участник EventGrid EventSubscription (предварительная версия)** и **Читатель EventGrid EventSubscription (предварительная версия)**. Вы назначаете эти роли пользователям, которым необходимо подписаться на разделы в вашем домене событий. Вы можете ограничить назначение ролей только тем, на которые пользователи должны подписываться.

Сведения об этих ролях см. в разделе [Встроенные роли для службы "Сетка событий"](security-authorization.md#built-in-roles).

## <a name="subscribing-to-topics"></a>Подписка на разделы

Подписка на события в разделе в домене событий похожа на [создание подписки на события в настраиваемом разделе](./custom-event-quickstart.md) или на подписку на событие из службы Azure.

### <a name="domain-scope-subscriptions"></a>Подписки на область Домена

Домены событий также позволяют оформить подписку на область домена. В случае подписки на события в домене событий вы получаете все события, отправленные в домен, независимо от раздела, в который они отправляются. Подписки на область Домена могут быть необходимы для целей управления и аудита.

## <a name="publishing-to-an-event-domain"></a>Публикация в домене событий

При создании домена событий вам предоставляется конечная точка публикации точно так же, как при создании раздела в Сетке событий. 

Чтобы опубликовать события в любом разделе домена событий, отправьте события в конечную точку домена [так же, как для пользовательского раздела](./post-to-custom-topic.md). Единственное различие заключается в том, что вы должны указать раздел, в который хотите отправить событие.

Например, при публикации следующего массива событий в раздел `foo` будет отправлено событие с `"id": "1111"`, в то время как событие с `"id": "2222"` будет отправлено в раздел `bar`:

```json
[{
  "topic": "foo",
  "id": "1111",
  "eventType": "maintenanceRequested",
  "subject": "myapp/vehicles/diggers",
  "eventTime": "2018-10-30T21:03:07+00:00",
  "data": {
    "make": "Contoso",
    "model": "Small Digger"
  },
  "dataVersion": "1.0"
},
{
  "topic": "bar",
  "id": "2222",
  "eventType": "maintenanceCompleted",
  "subject": "myapp/vehicles/tractors",
  "eventTime": "2018-10-30T21:04:12+00:00",
  "data": {
    "make": "Contoso",
    "model": "Big Tractor"
  },
  "dataVersion": "1.0"
}]
```

Домены событий выполняют публикацию в разделы автоматически. Вместо того, чтобы публиковать события в каждом управляемом вами разделе отдельно, вы можете опубликовать все свои события в конечной точке домена, а Сетка событий позаботится о том, чтобы каждое событие было отправлено в нужный раздел.

## <a name="limits-and-quotas"></a>Ограничения и квоты
Ниже приведены ограничения и квоты, связанные с доменами событий.

- 100 000 разделов на домен событий 
- 100 доменов событий на подписку Azure 
- 500. подписки на события для каждого раздела в домене событий
- 50 подписки на область домена 
- Частота приема событий в секунду (в домен): 5 000

Если эти ограничения не подходят вам, обратитесь в службу поддержки или отправьте сообщение по адресу [askgrid@microsoft.com](mailto:askgrid@microsoft.com) . 

## <a name="pricing"></a>Цены
Домены событий используют те же [операции ценообразования](https://azure.microsoft.com/pricing/details/event-grid/) , что и все остальные функции, используемые в сетке событий.

Операции работают в доменах событий точно так же, как и в настраиваемых разделах. Каждое поступление события в домене событий является операцией, и каждая попытка отправки события также является операцией.

## <a name="next-steps"></a>Дальнейшие шаги

* Дополнительные сведения о настройке доменов событий, создании разделов, создании подписок на события и публикации событий см. в разделе [Управление доменами событий](./how-to-event-domains.md).
