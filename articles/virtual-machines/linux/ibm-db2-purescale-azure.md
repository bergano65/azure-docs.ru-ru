---
title: IBM DB2 pureScale в Azure
description: В этой статье показана архитектура для работы среды IBM DB2 pureScale в Azure.
author: njray
manager: edprice
editor: edprice
ms.service: virtual-machines-linux
ms.subservice: workloads
ms.workload: infrastructure-services
ms.topic: how-to
ms.date: 11/09/2018
ms.author: edprice
ms.openlocfilehash: 0b032f48e18651af7f360471cc2834a5c45acc56
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "87831419"
---
# <a name="ibm-db2-purescale-on-azure"></a>IBM DB2 pureScale в Azure

Среда IBM DB2 pureScale предоставляет кластер баз данных для Azure с высоким уровнем доступности и масштабируемости в операционных системах Linux. В этой статье показана архитектура для работы DB2 pureScale в Azure.

## <a name="overview"></a>Обзор

Предприятия используют долгосрочные платформы системы управления реляционными базами данных (РСУБД) для удовлетворения своих потребностей в оперативной обработке транзакций (OLTP). В настоящее время многие переносят свои среды баз данных на основе мейнфреймов в Azure, чтобы увеличить емкость, сократить расходы и поддерживать стабильную структуру эксплуатационных расходов. Миграция зачастую является первым этапом модернизации устаревшей платформы. 

Недавно клиент предприятия переводил свою среду IBM DB2, работающую в z/OS, в IBM DB2 Пурескале в Azure. Решение кластера баз данных DB2 Пурескале обеспечивает высокий уровень доступности и масштабируемости в операционных системах Linux. Клиент успешно запустил DB2 в качестве автономного экземпляра на одной виртуальной машине в крупном масштабе системы в Azure до установки DB2 Пурескале. 

Хотя эта среда не идентична исходной, IBM DB2 pureScale в Linux предоставляет примерно те же функции обеспечения высокого уровня доступности и масштабируемости, что и IBM DB2 для z/OS в конфигурации Parallel Sysplex на мейнфрейме. В этом сценарии кластер подключается через iSCSI к общему кластеру хранилища. Мы использовали файловую систему Глустерфс, бесплатную масштабируемый распределенную файловую систему с открытым исходным кодом, специально оптимизированную для облачного хранилища. Однако IBM больше не поддерживает это решение. Чтобы поддерживать поддержку от IBM, необходимо использовать поддерживаемую iSCSI-совместимую файловую систему. Майкрософт предлагает Локальные дисковые пространства (S2D) в качестве варианта

В этой статье описана архитектура, используемая для этой миграции в Azure. Для тестирования конфигурации использовалась операционная система Red Hat Linux 7.4. Эта версия доступна в Azure Marketplace. Прежде чем выбирать дистрибутив Linux, обязательно проверьте поддерживаемые в настоящее время версии. Дополнительные сведения см. в документации по [IBM DB2 пурескале](https://www.ibm.com/support/knowledgecenter/SSEPGG) и [глустерфс](https://docs.gluster.org/en/latest/).

Эта статья представляет собой отправную точку для плана реализации DB2. Ваши бизнес-требования будут другими, но базовый шаблон остается без изменений. Этот архитектурный шаблон также можно использовать для приложений OLAP в Azure.

В этой статье не рассматриваются различия и возможные задачи миграции для перемещения базы данных IBM DB2 для z/OS на платформу IBM DB2 pureScale в Linux. Кроме того, в ней не представлены приблизительные размеры и данные анализа рабочих нагрузок для перехода с DB2 z/OS на DB2 pureScale. 

Чтобы помочь вам выбрать лучшую архитектуру DB2 pureScale для вашей среды, мы советуем провести полную оценку размера и установить гипотезу. В исходной системе следует учитывать DB2 z/OS Parallel Sysplex с архитектурой обмена данными, конфигурацию раздела обеспечения взаимодействия и статистику использования оборудования для распределенных данных (DDF).

> [!NOTE]
> В этой статье описывается один из подходов к миграции DB2, но есть и другие. Например, DB2 pureScale также может работать в виртуализированных локальных средах. IBM поддерживает DB2 в Microsoft Hyper-V с различными конфигурациями. Дополнительные сведения см. в статье [архитектура виртуализации DB2 пурескале](https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.qb.server.doc/doc/r0061462.html) в центре знаний IBM.

## <a name="architecture"></a>Architecture

Для поддержки высокого уровня доступности и масштабируемости в Azure для DB2 pureScale можно использовать архитектуру общих данных с горизонтальным масштабированием. Для нашей клиентской миграции использовался приведенный ниже пример архитектуры.

![Пурескале DB2 на виртуальных машинах Azure с хранилищем и сетью](media/db2-purescale-on-azure/pureScaleArchitecture.png "Пурескале DB2 на виртуальных машинах Azure с хранилищем и сетью")


На схеме показаны логические уровни, необходимые для кластера DB2 pureScale. В их число входят виртуальные машины для клиента, управления, кэширования, ядра СУБД и общего хранилища. 

Помимо узлов ядра СУБД, схема также включает два узла, используемых для разделов кэширования кластера (CF). Для ядра СУБД используется как минимум два узла. Сервер DB2, принадлежащий кластеру pureScale, называется элементом. 

Кластер подключен через iSCSI к общему кластеру хранилища с тремя узлами для обеспечения масштабируемого хранения и высокой доступности. DB2 pureScale устанавливается на виртуальных машинах Azure под управлением Linux.

Этот подход представляет собой шаблон, который можно изменить в соответствии с размером и масштабом, необходимыми организации. Он основывается на следующем.

-   Два или несколько элементов базы данных совмещаются как минимум с двумя узлами CF. Узлы управляют глобальным буферным пулом (GBP) для общей памяти и глобальным диспетчером блокировки (GLM) для управления общим доступом и состязанием блокировки между активными элементами. Один узел CF выступает в качестве основного узла, а другой — в качестве дополнительного узла для отработки отказа. Во избежание создания среды с единой точкой отказа требуется как минимум четыре узла для кластера DB2 pureScale.

-   Высокопроизводительное общее хранилище (показанное с размером P30 на схеме). Каждый узел использует это хранилище.

-   Сетевые подключения высокой производительности для элементов данных и общего хранилища.

### <a name="compute-considerations"></a>Рекомендации по вычислениям

В этой архитектуре уровни приложений, хранилищ и данных работают на виртуальных машинах Azure. [Скрипты настройки развертывания](https://aka.ms/db2onazure) создают следующие компоненты:

-   Кластер DB2 pureScale. Необходимый тип вычислительных ресурсов в Azure зависит от конфигурации. В целом можно использовать два подхода:

    -   Используйте сеть высокопроизводительных вычислений (HPC) с несколькими узлами, где экземпляры от малого до среднего размера получают доступ к общему хранилищу. Для такой конфигурации типа HPC [виртуальные машины](../sizes.md) Azure серии E (оптимизированные для памяти) и серии L (оптимизированные для хранилища) предоставляют необходимую вычислительную мощность.

    -   Используйте меньше крупных экземпляров виртуальных машин для подсистем обработки данных. Что касается крупных экземпляров, самые большие виртуальные машины [серии M](https://azure.microsoft.com/pricing/details/virtual-machines/series/), оптимизированные для операций в памяти, идеально подходят для требовательных рабочих нагрузок в памяти. Вам может потребоваться выделенный экземпляр, в зависимости от размера логического раздела (LPAR), используемого для работы DB2.

-   CF DB2 использует оптимизированные для памяти виртуальные машины, например серии E и L.

-   Общий кластер хранилища, использующий \_ стандартные \_ виртуальные машины DS4 v2 под управлением Linux.

-   Jumpbox управления — это стандартная \_ \_ Виртуальная машина DS2 v2 под управлением Linux.  Альтернативой является служба Azure бастиона, которая обеспечивает безопасный интерфейс RDP или SSH для всех виртуальных машин в виртуальной сети.

-   Клиент — это виртуальная машина Standard\_DS3\_v2 с Windows (используемая для тестирования).

-   *Необязательно*. Следящий сервер. Это необходимо только в некоторых более ранних версиях DB2 Пурескале. В этом примере используется стандартная \_ \_ Виртуальная машина DS3 v2 под управлением Linux (используется для DB2 пурескале).

> [!NOTE]
> В кластере DB2 pureScale требуется как минимум два экземпляра DB2. Кроме того, необходимы экземпляры кэша и диспетчера блокировки.

### <a name="storage-considerations"></a>Рекомендации по работе с хранилищем

Как и Oracle RAC, DB2 pureScale представляет собой высокопроизводительную базу данных с блочным вводом-выводом и горизонтальным масштабированием. Мы советуем использовать самый крупный из доступных вариантов [SSD Azure (цен. категория "Премиум")](disks-types.md), соответствующий вашим потребностям. Варианты хранилища меньшего размера могут подходить для сред разработки и тестирования, в то время как для рабочих сред требуется хранилище большей емкости. В примере архитектуры используется решение [P30](https://azure.microsoft.com/pricing/details/managed-disks/), выбранное из-за соотношения количества операций ввода-вывода в секунду с размером и стоимостью. Независимо от размера, для оптимальной производительности используйте хранилище класса Premium.

DB2 pureScale использует полностью общую архитектуру, где все данные доступны со всех узлов кластера. Хранилище класса Premium должно быть общим для нескольких экземпляров, будь то по запросу или выделенным экземплярам.

Для крупного кластера DB2 pureScale может потребоваться 200 терабайт (ТБ) и общее хранилище класса выше Premium, где число операций ввода-вывода в секунду составляет 100 000. DB2 pureScale поддерживает интерфейс блоков iSCSI, который можно использовать в Azure. Интерфейсу iSCSI требуется общий кластер хранилища, который можно реализовать с помощью S2D или другого средства. Решение этого типа создает устройство виртуальной сети хранения данных (vSAN) в Azure. DB2 pureScale использует сеть vSAN для установки кластеризованной файловой системы, применяемой для предоставления доступа к данным между виртуальными машинами.

### <a name="networking-considerations"></a>Рекомендации по работе с сетями

IBM рекомендует сети InfiniBand для всех элементов кластера DB2 pureScale. DB2 pureScale также по мере возможности применяет удаленный доступ к памяти (RDMA) для используемых CF.

Во время установки вы создали [группу ресурсов](../../azure-resource-manager/management/overview.md) Azure, содержащую все виртуальные машины. Как правило, группы ресурсов создаются в зависимости от времени существования ресурсов и пользователя, который ими управляет. Для виртуальных машин в этой архитектуре необходима [ускоренная сеть](https://azure.microsoft.com/blog/maximize-your-vm-s-performance-with-accelerated-networking-now-generally-available-for-both-windows-and-linux/). Это функция Azure, предоставляющая согласованную, крайне низкую задержку сети через SR-IOV на виртуальной машине.

Каждая виртуальная машина Azure развертывается в виртуальной сети, с подсетями: основной сетью, интерфейсной сетью Gluster FS (gfsfe), фоновой сетью Gluster FS (bfsbe), DB2 pureScale (db2be) и интерфейсной сетью DB2 pureScale (db2fe). Скрипт установки также создает основные [сетевые адаптеры](./multiple-nics.md) на виртуальных машинах в основной подсети.

Для ограничения сетевого трафика в виртуальной сети и изолирования подсетей следует использовать [группы безопасности сети](../../virtual-network/virtual-network-vnet-plan-design-arm.md) (NSG).

В Azure сеть DB2 pureScale должна использовать для хранилища сетевое подключение по протоколу TCP/IP.

## <a name="next-steps"></a>Дальнейшие шаги

-   [Развертывание этой архитектуры в Azure](deploy-ibm-db2-purescale-azure.md)