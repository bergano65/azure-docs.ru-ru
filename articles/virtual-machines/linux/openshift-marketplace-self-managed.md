---
title: Развертывание предложения самостоятельным управлением Marketplace платформы контейнеров OpenShift в Azure | Документация Майкрософт
description: Развертывание предложения самостоятельным управлением Marketplace платформы контейнеров OpenShift в Azure.
services: virtual-machines-linux
documentationcenter: virtual-machines
author: haroldwongms
manager: mdotson
editor: ''
tags: azure-resource-manager
ms.assetid: ''
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 04/18/2019
ms.author: haroldw
ms.openlocfilehash: 1228c770799de37c85b8a48b1dc923ac8294eeca
ms.sourcegitcommit: bf509e05e4b1dc5553b4483dfcc2221055fa80f2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "60014648"
---
# <a name="configure-prerequisites"></a>Настройка необходимых компонентов

Прежде чем использовать предложение в Marketplace для развертывания кластера самостоятельным управлением платформы контейнеров OpenShift в Azure, необходимо настроить несколько требований.  Чтение [предварительные требования OpenShift](https://docs.microsoft.com/azure/virtual-machines/linux/openshift-prerequisites) статье инструкции по созданию ssh key (без парольной фразы), хранилище ключей Azure, секрет хранилища ключей и субъект-службу.

 
## <a name="deploy-using-the-marketplace-offer"></a>Развертывание с помощью предложения Marketplace

Чтобы развернуть кластер самостоятельным управлением платформы контейнеров OpenShift в Azure проще всего использовать [предложение Azure Marketplace](https://azuremarketplace.microsoft.com/marketplace/apps/redhat.openshift-container-platform?tab=Overview).

Этот параметр является наиболее простым, но он имеет ограниченные возможности настройки. Предложения Marketplace развертывание платформы контейнеров OpenShift 3.11.82 и включает следующие параметры конфигурации:

- **Master Nodes** (Главные узлы). Три главных узла, для которых можно указать тип экземпляра.
- **Infra Nodes** (Узлы инфраструктуры). Три узла инфраструктуры, для которых можно указать тип экземпляра.
- **Узлы**: Количество узлов (от 1 до 9) и тип экземпляра можно настроить.
- **Тип диска**. Используются Управляемые диски.
- **Сеть**. Поддержка новой или существующей сети и настраиваемого диапазона CIDR.
- **CNS**. Позволяет включить CNS.
- **Метрики**. Позволяет включить метрики.
- **Ведение журналов.** Позволяет включить ведение журнала.
- **Azure Cloud Provider** (Поставщик облачных служб Azure). Включено по умолчанию, можно отключить.

В левом верхнем углу портала Azure щелкните **создать ресурс**, введите в поле поиска «платформа контейнеров openshift» и нажмите клавишу ВВОД.

   ![Новый поиск ресурсов](media/openshift-marketplace-self-managed/ocp-search.png)  
<br>

Откроется страница результатов с **Red Hat OpenShift контейнера платформы Self-Managed** в списке. 

   ![Новый результат поиска ресурсов](media/openshift-marketplace-self-managed/ocp-searchresult.png)  
<br>

Щелкните предложение, чтобы просмотреть сведения о предложения. Чтобы развернуть в рамках данного предложения, щелкните **создать**. Введите необходимые параметры пользовательского интерфейса будет отображаться. На экране **основы** колонке.

   ![Страница Название предложения](media/openshift-marketplace-self-managed/ocp-titlepage.png)  
<br>

**Основы**

Чтобы получить справку по любой из входных параметров, наведите указатель мыши ***я*** рядом с именем параметра.

Введите значения для входных параметров и нажмите кнопку **ОК**.

| Входной параметр | Описание параметра |
|-----------------------|-----------------|
| Имя пользователя администратора виртуальной Машины | Администратора будут созданы для всех экземпляров виртуальной Машины |
| SSH открытый ключ для пользователя с правами администратора | Открытый ключ SSH, используемого для входа в виртуальной Машине, не должен иметь парольной фразы |
| Подписка | Подписка Azure для развертывания кластера в |
| Группа ресурсов | Создайте новую группу ресурсов или выберите существующую группу ресурсов для ресурсов кластера |
| Location | Регион Azure для развертывания кластера в |

   ![Колонка "Основные" предложения](media/openshift-marketplace-self-managed/ocp-basics.png)  
<br>

**Параметры инфраструктуры**

Введите значения для входных параметров и нажмите кнопку **ОК**.

| Входной параметр | Описание параметра |
|-----------------------|-----------------|
| Префикс имени кластера OCP | Администратора будут созданы для всех экземпляров виртуальной Машины |
| Размер главного узла | Примите значение по умолчанию размер виртуальной Машины или нажмите кнопку **изменить размер** чтобы выбрать другой размер виртуальной Машины.  Выберите соответствующий размер виртуальной Машины для вашей рабочей нагрузки |
| Размер узла инфраструктуры | Примите значение по умолчанию размер виртуальной Машины или нажмите кнопку **изменить размер** чтобы выбрать другой размер виртуальной Машины.  Выберите соответствующий размер виртуальной Машины для вашей рабочей нагрузки |
| Количество узлов приложения | Примите значение по умолчанию размер виртуальной Машины или нажмите кнопку **изменить размер** чтобы выбрать другой размер виртуальной Машины.  Выберите соответствующий размер виртуальной Машины для вашей рабочей нагрузки |
| Размер узла приложения | Примите значение по умолчанию размер виртуальной Машины или нажмите кнопку **изменить размер** чтобы выбрать другой размер виртуальной Машины.  Выберите соответствующий размер виртуальной Машины для вашей рабочей нагрузки |
| Размер узла-бастиона | Примите значение по умолчанию размер виртуальной Машины или нажмите кнопку **изменить размер** чтобы выбрать другой размер виртуальной Машины.  Выберите соответствующий размер виртуальной Машины для вашей рабочей нагрузки |
| Новой или существующей виртуальной сети | Создать новую виртуальную сеть (по умолчанию) или использовать существующую виртуальную сеть |
| Выберите параметры по умолчанию CIDR или настроить диапазон IP-адрес (CIDR) | Примите диапазоны CIDR по умолчанию или выберите **пользовательский диапазон IP-адресов** и ввод сведений о настраиваемом CIDR.  Параметры по умолчанию создаст виртуальную сеть с CIDR 10.0.0.0/14 master подсети с 10.1.0.0/16, инфраструктуры с 10.2.0.0/16 и вычислительные ресурсы и cns подсети с 10.3.0.0/16 |
| Имя группы ресурсов KEY Vault | Имя группы ресурсов, который содержит хранилище ключей |
| Имя хранилища ключей | Имя хранилища ключей, которое содержит секрет с ssh закрытый ключ.  Только буквы, цифры и дефисы допускаются и находиться в диапазоне от 3 до 24 символов |
| Имя секрета | Имя секрета, который содержит ssh закрытый ключ.  Допускаются только буквы, цифры и дефисы |

   ![Колонка инфраструктуры предложения](media/openshift-marketplace-self-managed/ocp-inframain.png)  
<br>

**Изменение размера**

Чтобы выбрать другой размер виртуальной Машины, щелкните ***изменить размер***.  Откроется окно выбора виртуальной Машины.  Выберите размер виртуальной Машины и щелкните **выберите**.

   ![Выберите размер виртуальной Машины](media/openshift-marketplace-self-managed/ocp-selectvmsize.png)  
<br>

**Существующая виртуальная сеть**

| Входной параметр | Описание параметра |
|-----------------------|-----------------|
| Имя существующей виртуальной сети | Имя существующей виртуальной сети |
| Имя подсети для основных узлов | Имя существующей подсети для главных узлов.  Должен содержать минимум 16 IP-адреса и выполните RFC 1918 |
| Имя подсети для инфраструктуры узлов | Имя существующей подсети для инфраструктуры узлов.  Должен содержать по крайней мере 32 IP-адреса и выполните RFC 1918 |
| Имя подсети для вычислительных ресурсов и их узлов. | Имя существующей подсети для вычислительных ресурсов и их узлов.  Должен содержать по крайней мере 32 IP-адреса и выполните RFC 1918 |
| Группу ресурсов для существующей виртуальной сети | Имя группы ресурсов, содержащий существующую виртуальную сеть |

   ![Предложить существующей инфраструктуры виртуальной сети](media/openshift-marketplace-self-managed/ocp-existingvnet.png)  
<br>

**Диапазон пользовательский IP-адресов**

| Входной параметр | Описание параметра |
|-----------------------|-----------------|
| Диапазон адресов для виртуальной сети | Custom CIDR для виртуальной сети |
| Диапазон адресов для подсети, содержащей главные узлы | Custom CIDR для подсети master |
| Диапазон адресов для подсети, содержащей узлы инфраструктуры | Custom CIDR для подсети инфраструктуры |
| Диапазон адресов для подсети, содержащий узлы, вычислительные ресурсы и cns | Пользовательские CIDR для вычислительных ресурсов и их узлов |

   ![Предоставляют инфраструктуру пользовательский диапазон IP-адрес](media/openshift-marketplace-self-managed/ocp-customiprange.png)  
<br>

**Платформа контейнеров OpenShift**

Введите значения для параметров ввода и нажмите кнопку **ОК**

| Входной параметр | Описание параметра |
|-----------------------|-----------------|
| Пароль администратора OpenShift | Пароль для первоначальной пользователя OpenShift.  Этот пользователь также будет администратором кластера |
| Подтвердите пароль администратора OpenShift | Повторно введите пароль администратора OpenShift |
| Имя пользователя для Red Hat Subscription Manager | Имя пользователя для доступа к вашей подписки Red Hat или идентификатор организации.  Эти учетные данные можно зарегистрировать экземпляр RHEL к своей подписке и не будут храниться корпорацией Майкрософт или Red Hat |
| Пароль пользователя Red Hat Subscription Manager | Пароль для доступа к вашей подписки Red Hat или ключ активации.  Эти учетные данные можно зарегистрировать экземпляр RHEL к своей подписке и не будут храниться корпорацией Майкрософт или Red Hat |
| Идентификатор пула OpenShift Red Hat Subscription Manager | Идентификатор пула, содержащий назначение платформы контейнеров OpenShift. Убедитесь, что у вас недостаточно прав платформы контейнеров OpenShift для установки кластера |
| Идентификатор пула OpenShift Red Hat Subscription Manager для брокера или главные узлы | Пул идентификатор, который содержит права платформы контейнеров OpenShift для Broker / главных узлах. Убедитесь, что у вас недостаточно прав платформы контейнеров OpenShift для установки кластера. Если не используется broker / master идентификатор пула, введите идентификатор пула для узлов приложения |
| Настройка поставщика облака Azure | Настройте OpenShift для использования поставщика облачных служб Azure. Данный параметр является обязательным, если с помощью дисков Azure подключить для постоянные тома.  Значение по умолчанию — Да |
| Идентификатор GUID Azure AD субъекта-службы клиента | Субъект-службу AD клиента идентификатор GUID службы Azure — также известен как AppID. Требуется только, если настроить поставщик облачных служб Azure **Да** |
| Секрет идентификатор клиента Azure AD субъекта-службы | Секрет идентификатор клиента Azure AD субъекта-службы. Требуется только, если настроить поставщик облачных служб Azure **Да** |
 
   ![Колонка OpenShift предложения](media/openshift-marketplace-self-managed/ocp-ocpmain.png)  
<br>

**Дополнительные параметры**

Колонка "Дополнительные параметры" позволяет настраивать CNS для хранения glusterfs ведения журнала, метрики и маршрутизатор Sub домена.  Значение по умолчанию не устанавливают какое-либо из этих вариантов и будет использовать nip.io как домен sub маршрутизатора для целей тестирования. Включение CNS установит три дополнительных вычислительных узлов с помощью трех дополнительных подключенных дисков, где будет размещаться glusterfs модулей.  

Введите значения для параметров ввода и нажмите кнопку **ОК**

| Входной параметр | Описание параметра |
|-----------------------|-----------------|
| Настройка контейнера собственный формат хранения (CNS) | Устанавливает CNS в OpenShift кластера и включите ее в качестве хранилища. Будет по умолчанию, если поставщик Azure отключена |
| Настройка ведения журнала кластера | Устанавливает EFK функции ведения журнала в кластере.  Размер инфраструктуры узлов соответствующим образом для модулей POD EFK узла |
| Настройка метрик для кластера | Устанавливает Hawkular метрики в кластер OpenShift.  Размер инфраструктуры узлов соответствующим образом для модулей POD Hawkular метрики узла |
| По умолчанию маршрутизатор поддомен. | Выберите nipio для тестирования или пользовательских ввести собственный домен sub для рабочей среды |
 
   ![Новая колонка предложения](media/openshift-marketplace-self-managed/ocp-additionalmain.png)  
<br>

**Дополнительные параметры - Дополнительные параметры**

| Входной параметр | Описание параметра |
|-----------------------|-----------------|
| (CNS) Размер узла | Изменяя размер узла по умолчанию или выберите **изменить размер** выбрать новый размер виртуальной Машины |
| Введите пользовательский поддомен | Пользовательский домен маршрутизации для предоставления приложений через маршрутизатор на кластер OpenShift.  Не забудьте создать запись DNS соответствующий подстановочный знак] |
 
   ![Предложить дополнительные cns установки](media/openshift-marketplace-self-managed/ocp-additionalcnsall.png)  
<br>

**Сводка**

Проверка выполняется на этом этапе, чтобы проверить квоты ядер достаточно для развертывания общее число виртуальных машин, выбранных для кластера.  Просмотрите все параметры, которые были введены.  Если входные данные являются допустимыми, щелкните **ОК** для продолжения.

   ![Колонка сводки предложения](media/openshift-marketplace-self-managed/ocp-summary.png)  
<br>

**Купить**

Подтвердите контактные сведения на странице "Купить" и нажмите кнопку **покупки** чтобы принять условия использования и запустить развертывание кластера платформы контейнеров OpenShift.

   ![Колонка покупку предложения](media/openshift-marketplace-self-managed/ocp-purchase.png)  
<br>


## <a name="connect-to-the-openshift-cluster"></a>Подключение к кластеру OpenShift

Когда завершится развертывание, получите данные для подключения из раздела выходных данных развертывания. Подключение к консоли OpenShift с помощью обозревателя с помощью **URL-адрес консоли OpenShift**. Вы также можете SSH на узел-Бастион. В следующем примере в качестве имени администратора указано clusteradmin, а для полного доменного имени DNS с общедоступным IP-адресом узла-бастиона — bastiondns4hawllzaavu6g.eastus.cloudapp.azure.com.

```bash
$ ssh clusteradmin@bastiondns4hawllzaavu6g.eastus.cloudapp.azure.com
```

## <a name="clean-up-resources"></a>Очистка ресурсов

Если группа ресурсов, кластер OpenShift и все связанные ресурсы больше не нужны, их можно удалить с помощью команды [az group delete](/cli/azure/group).

```azurecli 
az group delete --name openshiftrg
```

## <a name="next-steps"></a>Дальнейшие действия

- [Задачи, выполняемые после развертывания](./openshift-post-deployment.md)
- [Устранение неполадок с развертыванием OpenShift в Azure](./openshift-troubleshooting.md)
- [Overview](https://docs.openshift.com/container-platform) (Обзор)

