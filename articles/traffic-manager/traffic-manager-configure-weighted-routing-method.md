---
title: Руководство по настройке взвешенной маршрутизации трафика с циклическим перебором с помощью Диспетчера трафика Azure
description: В этом учебнике объясняется, как балансировать нагрузку трафика методом циклического перебора в диспетчере трафика
services: traffic-manager
documentationcenter: ''
author: duongau
ms.service: traffic-manager
ms.devlang: na
ms.topic: tutorial
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/19/2020
ms.author: duau
ms.openlocfilehash: abcfce43b90c7371d5b38aa5b7a6d478e9d6a0dd
ms.sourcegitcommit: 957c916118f87ea3d67a60e1d72a30f48bad0db6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/19/2020
ms.locfileid: "92207845"
---
# <a name="tutorial-configure-the-weighted-traffic-routing-method-in-traffic-manager"></a>Руководство по Настройка метода взвешенной маршрутизации трафика в диспетчере трафика

Общепринятый подход к методу маршрутизации трафика состоит в предоставлении набора идентичных конечных точек (облачных служб и веб-сайтов) и равномерной отправке трафика в каждую из них. Ниже приведены инструкции по настройке такого метода маршрутизации трафика.

> [!NOTE]
> Веб-сайты Azure уже обеспечивают балансировку нагрузки с циклическим перебором для веб-сайтов в любом регионе Azure (который может содержать несколько центров обработки данных). Диспетчер трафика позволяет распределять трафик между веб-сайтами в разных центрах обработки данных.

В этом руководстве описано следующее:
> [!div class="checklist"]
> - Создание профиля Диспетчера трафика со взвешенной маршрутизацией.
> - Использование профиля Диспетчера трафика.
> - Удаление профиля Диспетчера трафика.

## <a name="prerequisites"></a>Предварительные требования

* Учетная запись Azure с активной подпиской. [Создайте учетную запись](https://azure.microsoft.com/free/) бесплатно.

## <a name="configure-the-weighted-traffic-routing-method"></a>Настройка метода взвешенной маршрутизации трафика

1. В браузере войдите на [портал Azure](https://portal.azure.com).

1. На панели поиска портала выполните поиск имени **профиля Диспетчера трафика** , созданного в предыдущем разделе, и выберите профиль диспетчера трафика в отображаемых результатах.

    :::image type="content" source="./media/traffic-manager-weighted-routing-method/search-traffic-manager-weighted-profile.png" alt-text="Поиск профиля Диспетчера трафика":::

1. Щелкните **Конфигурация** и выберите или введите следующие параметры:

    | Параметр         | Значение                                              |
    | ---             | ---                                                |
    | Метод маршрутизации            | Выберите **Взвешенная** . |    
    | Срок жизни (TTL) DNS | Это значение определяет, как часто локальный кэширующий сервер имен клиента будет запрашивать в системе Диспетчера трафика обновленные записи DNS. Любое изменение, возникающее в Диспетчере трафика, например изменение метода маршрутизации трафика или изменение доступности добавленных конечных точек, продлится это время, прежде чем обновление произойдет для всей глобальной системы DNS-серверов. |
    | Протокол    | Выберите протокол для мониторинга конечных точек. *Доступные варианты: HTTP, HTTPS и TCP* |
    | Порт | Укажите номер порта. |
    | путь | Для мониторинга конечных точек необходимо указать путь и имя файла. Косая черта ("/") является допустимым относительным путем и указывает, что файл расположен в корневом каталоге (по умолчанию). |
    | Параметры пользовательского заголовка | Настройте пользовательские заголовки в формате хост:contoso.com,новый_заголовок:новое_значение. Максимально поддерживаемая пара — 8. Применимо для протоколов HTTP и HTTPS. Применимо ко всем конечным точкам в профиле |
    | Ожидаемый диапазон кодов состояний (по умолчанию: 200) | Настройте диапазоны кодов состояний в формате 200–299,301–301. Максимально поддерживаемый диапазон — 8. Применимо для протоколов HTTP и HTTPS. Применимо ко всем конечным точкам в профиле |
    | Интервал проверки | Настройте интервал времени между пробами работоспособности конечных точек. Можно выбрать 10 или 30 секунд. |
    | Допустимое число сбоев | Настройте число неудачных попыток проверки работоспособности до активации конечной точки. Можно ввести число от 0 до 9. | 
    | Время ожидания пробы | Настройте время до истечения времени ожидания проверки работоспособности конечной точки. Это значение должно быть не менее 5 и меньше значения интервала проверки. |

1. Чтобы завершить настройку, нажмите кнопку **Сохранить** .

    :::image type="content" source="./media/traffic-manager-weighted-routing-method/traffic-manager-weighted-configuration.png" alt-text="Поиск профиля Диспетчера трафика"::: 

1. Щелкните **Конечная точка** и настройте вес каждой конечной точки. Вес может находиться в диапазоне 1–1000. Чем выше вес, тем выше приоритет.  

    :::image type="content" source="./media/traffic-manager-weighted-routing-method/traffic-manager-configure-endpoints-weighted.png" alt-text="Поиск профиля Диспетчера трафика"::: 

## <a name="use-the-traffic-manager-profile"></a>Использование профиля диспетчера трафика

В **профиле диспетчера трафика** отображается DNS-имя только что созданного профиля диспетчера трафика. Имя могут использовать клиенты (например, перейдя к нему в веб-браузере) для направления к нужной конечной точке в соответствии с типом маршрутизации. В этом случае все запросы направляются к каждой конечной точке методом циклического перебора.

:::image type="content" source="./media/traffic-manager-weighted-routing-method/traffic-manager-weighted-overview.png" alt-text="Поиск профиля Диспетчера трафика"::: 

## <a name="clean-up-resources"></a>Очистка ресурсов

Если профиль Диспетчера трафика больше не нужен, перейдите к профилю и выберите **Удалить профиль** .

:::image type="content" source="./media/traffic-manager-weighted-routing-method/delete-traffic-manager-weighted-profile.png" alt-text="Поиск профиля Диспетчера трафика":::

## <a name="next-steps"></a>Дальнейшие шаги

Дополнительные сведения о методе взвешенной маршрутизации см. в следующих статьях:

> [!div class="nextstepaction"]
> [Метод взвешенной маршрутизации трафика](traffic-manager-routing-methods.md#weighted)