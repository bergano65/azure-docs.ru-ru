---
title: Часто задаваемые вопросы о службе "Миграция Azure" | Документация Майкрософт
description: В этой статье рассматриваются часто задаваемые вопросы о службе "Миграция Azure".
author: snehaamicrosoft
ms.service: azure-migrate
ms.topic: conceptual
ms.date: 01/11/2019
ms.author: snehaa
ms.openlocfilehash: 619369972991bab0b23e7e9ae4e0a146f875e59a
ms.sourcegitcommit: 58dc0d48ab4403eb64201ff231af3ddfa8412331
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2019
ms.locfileid: "55079262"
---
# <a name="azure-migrate---frequently-asked-questions-faq"></a>Часто задаваемые вопросы о службе "Миграция Azure"

Эта статья содержит часто задаваемые вопросы о службе "Миграция Azure". Если после прочтения статьи у вас возникли дополнительные запросы, вы можете опубликовать их на [форуме, посвященном службе "Миграция Azure"](https://aka.ms/AzureMigrateForum).

## <a name="general"></a>Общие сведения

### <a name="does-azure-migrate-support-assessment-of-only-vmware-workloads"></a>Верно ли, что служба "Миграция Azure" поддерживает оценку только для рабочих нагрузок VMware?

Да, служба "Миграция Azure" пока поддерживает оценку только для рабочих нагрузок VMware. Поддержка Hyper-V и физических серверов будет реализована в будущем.

### <a name="does-azure-migrate-need-vcenter-server-to-discover-a-vmware-environment"></a>Требуется ли службе "Миграция Azure" vCenter Server для обнаружения среды VMware?

Да, службе "Миграция Azure" требуется vCenter Server для обнаружения среды VMware. Служба не поддерживает обнаружение узлов ESXi, которые не находятся под управлением vCenter Server.

### <a name="how-is-azure-migrate-different-from-azure-site-recovery"></a>Чем служба "Миграция Azure" отличается от Azure Site Recovery?

"Миграция Azure" — это служба оценки, которая помогает обнаруживать локальные рабочие нагрузки и планировать миграцию в Azure. Служба [Azure Site Recovery](https://docs.microsoft.com/azure/site-recovery/migrate-tutorial-on-premises-azure), которая также является решением для аварийного восстановления, помогает переносить локальные рабочие нагрузки на виртуальные машины IaaS в Azure.

### <a name="whats-the-difference-between-using-azure-migrate-for-assessments-and-the-map-toolkit"></a>В чем разница между оценкой с помощью службы "Миграция Azure" и MAP Toolkit?

[Служба "Миграция Azure"](migrate-overview.md) оценивает миграцию исключительно в контексте готовности локальных рабочих нагрузок к переносу в Azure. [Microsoft Assessment and Planning (MAP) Toolkit](https://www.microsoft.com/en-us/download/details.aspx?id=7826) обеспечивает другие функции, такие как планирование миграции для новых версий операционных систем клиента и сервера Windows и отслеживание потребления программного обеспечения. Для всех этих сценариев нужно и дальше использовать MAP Toolkit.


### <a name="how-is-azure-migrate-different-from-azure-site-recovery-deployment-planner"></a>Чем служба "Миграция Azure" отличается от Планировщика развертывания Azure Site Recovery?

Служба "Миграция Azure" — это средство планирования миграции, а Планировщик развертывания Azure Site Recovery — средство планирования аварийного восстановления.

**Миграция из VMware в Azure**: если вам нужно перенести локальные рабочие нагрузки в Azure, планируйте Миграцию Azure с помощью службы "Миграция Azure". Служба "Миграция Azure" оценивает локальные рабочие нагрузки и предоставляет рекомендации, советы и механизмы, помогающие выполнить миграцию в Azure. Когда план миграции будет готов, можно будет использовать такие службы, как Azure Site Recovery и Azure Database Migration Service, чтобы перенести компьютеры в Azure.

**Миграция из Hyper-V в Azure**: служба "Миграция Azure" сейчас поддерживает только оценку виртуальных машин VMware для миграции в Azure. Вскоре мы планируем реализовать поддержку Hyper-V в службе "Миграция Azure". До этого вы можете использовать Планировщик развертывания Site Recovery. Когда поддержка Hyper-V в службе "Миграция Azure" будет включена, можно будет использовать эту службу для планирования переноса рабочих нагрузок Hyper-V.

**Аварийное восстановление из VMware/Hyper-V в Azure**: если вы планируете выполнять аварийное восстановление в Azure с помощью Azure Site Recovery (Site Recovery), используйте для планирования аварийного восстановления Планировщик развертывания Site Recovery. Планировщик развертывания Site Recovery проводит глубокую оценку локальной среды, ориентированную на задачи ASR. Он предоставляет рекомендации, которые необходимо выполнить, чтобы служба Site Recovery могла успешно выполнить аварийное восстановление (например, посредством репликации и отработки отказа виртуальных машин).  

### <a name="which-azure-geographies-are-supported-by-azure-migrate"></a>Какие географические регионы Azure поддерживает служба "Миграция Azure"?

В качестве географических регионов проекта служба "Миграция Azure" в настоящее время поддерживает такие: Европа, США и Azure для государственных организаций. Хотя проекты миграции можно создавать только в этих географических регионах, вы все равно можете оценить компьютеры для [нескольких целевых расположений](https://docs.microsoft.com/azure/migrate/how-to-modify-assessment#edit-assessment-properties). Географический регион проекта используется только для хранения обнаруженных метаданных.

**География** | **Место хранения метаданных**
--- | ---
Azure Government | Правительство штата Вирджиния
Азия | Юго-Восточная Азия
Европа | Северная или Западная Европа
США | Восточная часть США или центрально-западная часть США

### <a name="how-does-the-on-premises-site-connect-to-azure-migrate"></a>Как локальный сайт подключается к службе "Миграция Azure"?

Подключение можно организовать через Интернет или канал ExpressRoute с общедоступным пирингом.

### <a name="can-i-harden-the-vm-set-up-with-the-ova-template"></a>Могу ли я защитить виртуальную машину, используя OVA-файл шаблона?

В OVA-файл шаблона можно добавлять дополнительные компоненты (например, антивирусные программы). Важно не изменять правила обмена данными и правила брандмауэра, необходимые для работы устройства в службе "Миграция Azure".   

### <a name="to-harden-the-azure-migrate-appliance-what-are-the-recommended-antivirus-av-exclusions"></a>Какие исключения антивирусной программы (AV) рекомендуются для защиты устройства службы "Миграция Azure"?

Для антивирусного сканирования вам потребуется исключить следующие папки в устройстве.

- Папка с двоичными файлами для службы "Миграция Azure". Исключите все вложенные папки.
  %ProgramFiles%\ProfilerService  
- Веб-приложение службы "Миграция Azure". Исключите все вложенные папки.
  %SystemDrive%\inetpub\wwwroot
- Локальный кэш для базы данных и файлов журнала. Службе "Миграция Azure" необходим доступ к этой папке с правами на чтение и запись.
  %SystemDrive%\Profiler

## <a name="discovery"></a>Обнаружение

### <a name="what-data-is-collected-by-azure-migrate"></a>Какие данные собираются службой "Миграция Azure"?

Служба "Миграция Azure" поддерживает два вида обнаружения — на основе устройства и на основе агентов.
При обнаружении на основе устройства собираются метаданные локальных виртуальных машин. Полный список метаданных, собранных устройством, перечислен ниже:

**Данные конфигурации виртуальной машины:**
- отображаемое имя виртуальной машины (в vCenter);
- путь инвентаризации виртуальной машины (узел, кластер или папка в vCenter);
- IP-адрес
- MAC-адрес.
- Операционная система
- Число ядер, дисков и сетевых адаптеров.
- Объем памяти, размеры диска.

**Сведения о производительности виртуальной машины:**
- Загрузка ЦП.
- Использование памяти
- Для каждого диска, подключенного к виртуальной машине:
  - пропускная способность чтения с диска;
  - скорость записи на диск;
  - число операций чтения с диска в секунду;
  - число операций записи на диск в секунду.
- Для каждого сетевого адаптера, подключенного к виртуальной машине:
  - Входящая скорость сети
  - Исходящая скорость сети

Обнаружение на основе агентов — функция в рамках обнаружения на основе устройства, которая помогает клиентам [визуализировать зависимости](how-to-create-group-machine-dependencies.md) локальных виртуальных машин. Агенты зависимостей собирают такие данные, как полное доменное имя, сведения об ОС, IP-адрес, MAC-адрес, сведения о процессах, выполняющихся внутри виртуальной машины, а также о входящих и исходящих TCP-подключениях этой машины. Обнаружение на основе агентов является необязательным. Вы можете не устанавливать агенты, если не требуется визуализировать зависимости виртуальных машин.

### <a name="would-there-be-any-performance-impact-on-the-analyzed-esxi-host-environment"></a>Будет ли снижаться производительность в среде проанализированных узлов ESXi?

В случае использования [подхода однократного обнаружения](https://docs.microsoft.com/azure/migrate/concepts-collector#discovery-methods), чтобы собирать данные о производительности, на сервере vCenter необходимо выставить уровень статистики 3. Установив этот уровень, вы включите сбор большого количества данных об устранении неполадок, которые будут храниться в базе данных vCenter Server. Это, в свою очередь, может привести к определенным проблемам с производительностью в vCenter Server. Последствия для узла ESXi будут пренебрежительно малы.

Мы представили непрерывное профилирование данных о производительности (эта функция доступна в предварительной версии). Благодаря непрерывному профилированию, больше не требуется менять уровень статистики vCenter Server, чтобы провести оценку на основе производительности. Модуль сборщика теперь будет профилировать локальные компьютеры для оценки данных о производительности виртуальных машин. Это практически не повлияет на производительность узлов ESXi, а также vCenter Server.

### <a name="where-is-the-collected-data-stored-and-for-how-long"></a>Где хранятся собранные данные и как долго?

Данные, собранные устройством сборщика, хранятся в расположении Azure, указанном при создании проекта миграции. Данные хранятся в подписке Майкрософт с поддержкой надлежащего уровня безопасности и удаляются при удалении пользователем проекта миграции Azure.

Чтобы визуализировать зависимости при установке агентов на виртуальные машины, собранные агентами зависимостей данные сохраняются в США в рабочей области Log Analytics, созданной в подписке пользователя. При удалении рабочей области Log Analytics из подписки эти данные удаляются. [Узнайте больше](https://docs.microsoft.com/azure/migrate/concepts-dependency-visualization).

### <a name="is-the-data-encrypted-at-rest-and-while-in-transit"></a>Шифруются ли данные при хранении и во время передачи?

Да, собранные данные шифруются как во время хранения, так и во время передачи. Собранные устройством метаданные передаются в службу "Миграция Azure" с поддержкой надлежащего уровня безопасности через Интернет по протоколу HTTPS. Собранные метаданные хранятся в базе данных [Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/database-encryption-at-rest) и в [хранилище BLOB-объектов Azure](https://docs.microsoft.com/azure/storage/common/storage-service-encryption) в подписке Майкрософт и шифруются при хранении.

Данные, собранные агентами зависимостей, также шифруются при передаче (через защищенный канал HTTPS) и хранятся в рабочей области Log Analytics в подписке пользователя. Они также шифруются при хранении.

### <a name="how-does-the-collector-communicate-with-the-vcenter-server-and-the-azure-migrate-service"></a>Как сборщик взаимодействует с vCenter Server и службой "Миграция Azure"?

Устройство сборщика подключается к vCenter Server (порт 443) с использованием учетных данных, предоставленных пользователем в устройстве. Оно отправляет в vCenter Server запрос на использование VMware PowerCLI, чтобы собрать метаданные виртуальных машин под управлением vCenter Server. Устройство собирает из vCenter Server как данные конфигурации виртуальных машин (сведения о ядрах, памяти, дисках, сетевых адаптерах и т. д.), так и данные журнала производительности каждой виртуальной машины за последний месяц. Затем собранные метаданные передаются в службу "Миграция Azure" (через Интернет по протоколу HTTPS) для оценки. [Подробнее](concepts-collector.md)

### <a name="can-i-connect-the-same-collector-appliance-to-multiple-vcenter-servers"></a>Можно ли подключить один модуль сборщика к нескольким серверам vCenter?

Да, один модуль сборщика можно использовать для обнаружения нескольких vCenter, но не одновременно. Операции обнаружения следует выполнять поочередно.

### <a name="is-the-ova-template-used-by-site-recovery-integrated-with-the-ova-used-by-azure-migrate"></a>Можно ли интегрировать OVA-файл шаблона, используемый службой Site Recovery, с OVA-файлом, используемым службой "Миграция Azure"?

Сейчас такая интеграция невозможна. В службе Site Recovery OVA-файл используется для настройки репликации виртуальных машин VMware или физических серверов на сервере конфигурации Site Recovery. OVA-файл в службе "Миграция Azure" используется для обнаружения виртуальных машин VMware, управляемых сервером vCenter, в целях оценки готовности к переносу.

### <a name="i-changed-my-machine-size-can-i-rerun-the-assessment"></a>Я изменил размер виртуальной машины. Можно ли повторно выполнить оценку?

После изменения параметров виртуальной машины, которую вы хотите оценить, следует еще раз запустить модуль сборщика для обнаружения. В модуле для этого есть функция **Снова запустить сбор**. После завершения сбора выберите на портале параметр **Пересчитать**, чтобы получить обновленные оценки результаты.

### <a name="how-can-i-discover-a-multi-tenant-environment-in-azure-migrate"></a>Как обнаружить мультитенантную среду в службе "Миграция Azure"?

Если несколько клиентов имеют общий доступ к вашей среде и вы не хотите, чтобы обнаружение выполнялось для виртуальных машин одного клиента в подписке другого клиента, вы можете использовать поле "Область" на устройстве сборщика, чтобы обозначить область обнаружения. Если клиенты совместно используют узлы, создайте учетную запись с доступом только для чтения и только для тех виртуальных машин, которые принадлежат конкретному клиенту. Используйте эти учетные данные на устройстве сборщика, указав область в качестве узла для обнаружения. Кроме того, вы можете создать папки в vCenter Server (скажем, папку 1 для клиента 1 и папку 2 для клиента 2) на совместно используемом узле, переместить виртуальные машины для клиента 1 в папку 1, а для клиента 2 в папку 2, а затем обозначить в сборщике соответствующую область обнаружения, указав нужную папку.

### <a name="how-many-virtual-machines-can-be-discovered-in-a-single-migration-project"></a>Сколько виртуальных машин можно обнаружить в одном проекте миграции?

В одном проекте миграции можно обнаружить 1500 виртуальных машин. Если количество машин в локальной среде превышает это число, [см. дополнительные сведения](how-to-scale-assessment.md) о возможностях обнаружения крупномасштабной среды в службе "Миграция Azure".


## <a name="assessment"></a>Оценка

### <a name="does-azure-migrate-support-enterprise-agreement-ea-based-cost-estimation"></a>Поддерживает ли служба "Миграция Azure" оценку затрат на основе Соглашения Enterprise (EA)?

Служба "Миграция Azure" сейчас не поддерживает оценку затрат для [Соглашение Enterprise](https://azure.microsoft.com/offers/enterprise-agreement-support/). В качестве решения укажите предложение с оплатой по мере использования и вручную введите процент скидки (применяемой к подписке) в поле скидки свойств оценки.

  ![Скидка](./media/resources-faq/discount.png)

### <a name="what-is-the-difference-between-as-on-premises-sizing-and-performance-based-sizing"></a>Какова разница между определением размера как для локального экземпляра и определением размера на основе производительности?

При указании условия определения размера как для локального экземпляра служба "Миграция Azure" не учитывает данные о производительности виртуальных машин и определяет размеры виртуальных машин на основе локальной конфигурации. Если условие определения размера основано на производительности, определение размеров выполняется на основе данных об использовании. Предположим, используется локальная виртуальная машина с 4 ядрами и 8 ГБ памяти с показателем использования ЦП 50 % и показателем использования памяти также 50 %. Если условие определения размера представлено в качестве локального определения размера, рекомендуется номер SKU виртуальной машины Azure с 4 ядрами и 8 ГБ памяти. Тем не менее условие определения размера на основе производительности в качестве номера SKU виртуальной машины с 2 ядрами и 4 ГБ, рекомендуемого как процент использования, учитывается при рекомендации размера. Аналогичным образом выбор размера диска зависит от двух свойств оценки — условия определения размера и типа хранилища. Если условие определения размера основано на производительности и задан автоматический тип хранилища, при определении типа целевого диска (категории "Стандартный" или "Премиум") учитываются показатель операций ввода-вывода в секунду и пропускная способность диска. Если условие определения размера основано на производительности и тип хранилища — хранилище класса Premium, рекомендуется использовать диск категории "Премиум", номер SKU диска категории "Премиум" в Azure выбирается на основе размера локального диска. Та же логика применяется при выборе размера диска, когда условие определения размера основано на локальных характеристиках и задан тип хранилища ценовой категории "Стандартный" или "Премиум".

### <a name="what-impact-does-performance-history-and-percentile-utilization-have-on-the-size-recommendations"></a>Как данные журнала производительности и процент использования влияют на рекомендации по размеру?

Эти свойства применимы только при выборе размера на основе производительности. В службе "Миграция Azure" ведется журнал производительности локальных компьютеров. Эти данные используются для рекомендаций по выбору размера и типа диска виртуальной машины в Azure. Устройство сборщика постоянно профилирует локальную среду. Каждые 20 секунд в режиме реального времени собираются данные об использовании. Модуль загружает 20-секундные образцы и создает одну точку данных каждые 15 минут. Чтобы создать одну точку данных, устройство выбирает пиковое значение из всех 20-секундных образцов и отправляет его в Azure. При создании в Azure оценки с учетом периода оценки производительности и значения процентиля журнала производительности служба "Миграция Azure" вычисляет значение эффективного использования и учитывает его при определении размера. Например, если вы задали период оценки производительности 1 день и значение процентиля 95, служба "Миграция Azure" использует 15-минутные примеры точек, отправляемые сборщиком за последний день, сортирует их в порядке возрастания и выбирает значение процентиля 95 в качестве эффективного использования. Значение 95-го процентиля гарантирует, что вы пропускаете выбросы, которые могут присутствовать при выборе 99-го процентиля. Если вам нужно выбрать пиковое использование для периода и вы не хотите пропустить все выбросы, следует выбрать 99-й процентиль.

## <a name="dependency-visualization"></a>Визуализация зависимостей

> [!NOTE]
> Функция визуализации зависимостей недоступна в Azure для государственных организаций.

### <a name="what-is-dependency-visualization"></a>Что такое визуализация зависимостей?

Визуализация зависимостей позволяет оценивать группы виртуальных машин для миграции с большей уверенностью, перекрестно проверяя зависимости машин перед тем, как выполнить оценку. Визуализация зависимостей поможет избежать непредвиденных сбоев при миграции в Azure. Служба "Миграция Azure" использует решение "Сопоставление служб" в Log Analytics для визуализации зависимостей.

### <a name="do-i-need-to-pay-to-use-the-dependency-visualization-feature"></a>Нужно ли платить за использование функции визуализации зависимостей?

№ См. дополнительные сведения о [ценах на Миграцию Azure](https://azure.microsoft.com/pricing/details/azure-migrate/).

### <a name="do-i-need-to-install-anything-for-dependency-visualization"></a>Нужно ли устанавливать дополнительные программы для визуализации зависимостей?

Чтобы использовать визуализацию зависимостей, необходимо скачать и установить агенты на каждом локальном компьютере, который нужно оценить.

- Агент [Microsoft Monitoring Agent (MMA)](https://docs.microsoft.com/azure/log-analytics/log-analytics-agent-windows) должен быть установлен на каждом компьютере.
- Программа [Dependency Agent](https://docs.microsoft.com/azure/monitoring/monitoring-service-map-configure) должна быть установлена на каждом компьютере.
- Кроме того, если у вас есть компьютеры без подключения к Интернету, необходимо скачать и установить на них шлюз Log Analytics.

Если вы не используете визуализацию зависимостей, эти агенты не нужны на компьютерах, которые вы хотите оценить.

### <a name="can-i-use-an-existing-workspace-for-dependency-visualization"></a>Можно ли использовать существующую рабочую область для визуализации зависимостей?

Да, "Миграция Azure" теперь позволяет вложить существующую рабочую область в проект миграции и применять его для визуализации зависимостей. [Узнайте больше](https://docs.microsoft.com/azure/migrate/concepts-dependency-visualization#how-does-it-work).

### <a name="can-i-export-the-dependency-visualization-report"></a>Можно ли экспортировать отчет о визуализации зависимостей?

Нет, экспортировать отчет о визуализации зависимостей нельзя. Но служба "Миграция Azure" применяет для визуализации зависимостей сопоставление служб, и вы можете использовать [интерфейсы REST API сопоставления служб](https://docs.microsoft.com/rest/api/servicemap/machines/listconnections), чтобы получить зависимости в формате JSON.

### <a name="how-can-i-automate-the-installation-of-microsoft-monitoring-agent-mma-and-dependency-agent"></a>Как автоматизировать установку агентов Microsoft Monitoring Agent (MMA) и Dependency Agent?

[Вот](https://docs.microsoft.com/azure/monitoring/monitoring-service-map-configure#installation-script-examples) сценарий, который можно использовать для установки Dependency Agent. [Здесь](https://docs.microsoft.com/azure/azure-monitor/platform/log-analytics-agent#install-and-configure-agent) представлены инструкции о том, как установить MMA с помощью командной строки или автоматизированных методов. Для MMA вы также можете использовать сценарий, [доступный](https://gallery.technet.microsoft.com/scriptcenter/Install-OMS-Agent-with-2c9c99ab) на сайте Technet.

Помимо сценариев, для развертывания агентов можно использовать инструменты развертывания, такие как System Center Configuration Manager (SCCM), [Intigua](https://www.intigua.com/getting-started-intigua-for-azure-migration) и т. д.

### <a name="what-are-the-operating-systems-supported-by-mma"></a>Какие операционные системы поддерживаются агентом MMA?

Список операционных систем Windows, поддерживаемых MMA, см. в [этой статье](https://docs.microsoft.com/azure/log-analytics/log-analytics-concept-hybrid#supported-windows-operating-systems).
Список операционных систем Linux, поддерживаемых MMA, см. в [этой статье](https://docs.microsoft.com/azure/log-analytics/log-analytics-concept-hybrid#supported-linux-operating-systems).

### <a name="what-are-the-operating-systems-supported-by-dependency-agent"></a>Какие операционные системы поддерживаются агентом зависимостей?

Список операционных систем Windows, поддерживаемых агентом зависимостей, см. в [этой статье](https://docs.microsoft.com/azure/monitoring/monitoring-service-map-configure#supported-windows-operating-systems).
Список операционных систем Linux, поддерживаемых агентом зависимостей, см. в [этой статье](https://docs.microsoft.com/azure/monitoring/monitoring-service-map-configure#supported-linux-operating-systems).

### <a name="can-i-visualize-dependencies-in-azure-migrate-for-more-than-one-hour-duration"></a>Возможно ли в службе "Миграция Azure" визуализировать зависимости за период свыше одного часа?
Нет, в службе "Миграция Azure" визуализация зависимостей не может длиться больше часа. Служба "Миграция Azure" позволяет вернуться к определенной дате в журнале за последний месяц, но максимальный период, для которого можно визуализировать зависимости, составляет не более 1 часа. Например, вы можете использовать функцию периода времени на карте зависимостей, чтобы просмотреть вчерашние зависимости, однако просматривать их можно только для периода времени в один час. Тем не менее можно использовать Log Analytics для [запроса данных зависимостей](https://docs.microsoft.com/azure/migrate/how-to-create-group-machine-dependencies#query-dependency-data-from-log-analytics) за более длительный срок.

### <a name="is-dependency-visualization-supported-for-groups-with-more-than-10-vms"></a>Поддерживается ли визуализация зависимостей для групп, в которых более 10 виртуальных машин?
Вы можете [визуализировать зависимости групп](https://docs.microsoft.com/azure/migrate/how-to-create-group-dependencies), содержащих до 10 виртуальных машин. Если в группе более 10 виртуальных машин, рекомендуем разбить ее на более мелкие группы, а после этого приступить к визуализации зависимостей.


## <a name="next-steps"></a>Дополнительная информация

- См. [общие сведения о службе "Миграция Azure"](migrate-overview.md).
- Узнайте, как выполнить [обнаружение и оценку](tutorial-assessment-vmware.md) в среде VMware.
