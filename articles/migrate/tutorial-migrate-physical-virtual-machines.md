---
title: Перенос компьютеров в качестве физического сервера в Azure с помощью службы "Миграция Azure".
description: В этой статье описывается, как перенести физические компьютеры в Azure с помощью службы "Миграция Azure".
ms.topic: tutorial
ms.date: 04/15/2020
ms.custom: MVC
ms.openlocfilehash: 67ea5800885b4edb16581f22c199d139053af495
ms.sourcegitcommit: fa90cd55e341c8201e3789df4cd8bd6fe7c809a3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2020
ms.locfileid: "93337818"
---
# <a name="migrate-machines-as-physical-servers-to-azure"></a>Перенос компьютеров в качестве физических серверов в Azure

В этой статье показано, как перенести компьютеры в качестве физических серверов с помощью средства "Миграция сервера" службы "Миграция Azure". Перенос компьютеров в качестве физических серверов полезен в ряде сценариев:

- Локальные физические серверы.
- Виртуальные машины, виртуализированные такими платформами, как Xen и KVM.
- Выполните миграцию виртуальных машин Hyper-V или VMware, если по какой-либо причине вы не можете использовать стандартный процесс миграции [Hyper-V](tutorial-migrate-hyper-v.md) или [VMware](server-migrate-overview.md).
- Виртуальные машины, работающие в частных облаках.
- Виртуальные машины, работающие в общедоступных облаках, таких как Amazon Web Services (AWS) или Google Cloud Platform (GCP).


Это руководство является третьим в серии, в которой показано, как оценивать и переносить физические серверы в Azure. В этом руководстве описано следующее:

> [!div class="checklist"]
> * Подготовка к использованию Azure с помощью средства "Миграция сервера" службы "Миграция Azure".
> * Проверка требований к компьютерам, которые вы хотите перенести, и подготовка компьютера для устройства репликации Миграции Azure, которое используется для обнаружения и миграции компьютеров в Azure.
> * Добавление средства "Миграция сервера" службы "Миграция Azure" в концентратор Миграции Azure.
> * Настройка устройства репликации.
> * Установка службы мобильности на виртуальных компьютерах, которые нужно перенести.
> * Включите репликацию.
> * Выполнение тестовой миграции, позволяющей убедиться в правильной работе всех компонентов.
> * Выполнение полной миграции в Azure.

> [!NOTE]
> В руководствах показан простейший путь развертывания сценария, использование которого позволяет быстро настроить проверку концепции. В руководствах по возможности используются параметры по умолчанию и показаны не все возможные параметры и пути. Для получения подробных инструкций ознакомьтесь со статьями с инструкциями по Миграции Azure.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/pricing/free-trial/), прежде чем начинать работу.


## <a name="prerequisites"></a>Предварительные требования

Для работы с этим руководством вам потребуется:

[Просмотрите](./agent-based-migration-architecture.md) архитектуру миграции.

## <a name="prepare-azure"></a>Подготовка Azure

Подготовка Azure к миграции с помощью средства "Миграция сервера".

**Задача** | **Сведения**
--- | ---
**Создание проекта службы "Миграция Azure"** | Для создания проекта учетная запись Azure должна иметь разрешения "Участник" или "Владелец".
**Проверка разрешений учетной записи Azure** | Учетная запись Azure должна иметь разрешения на создание виртуальной машины и на запись на управляемый диск Azure.


### <a name="assign-permissions-to-create-project"></a>Назначение разрешений для создания проекта

1. На портале Azure откройте подписку, а затем выберите **Управление доступом (IAM)** .
2. В разделе **Проверить доступ** найдите соответствующую учетную запись и щелкните ее, чтобы просмотреть разрешения.
3. Вы должны обладать разрешениями уровня **Участник** или **Владелец**.
    - Если вы создали бесплатную учетную запись Azure, вы являетесь владельцем подписки.
    - Если вы не являетесь владельцем подписки, назначьте эту роль совместно с владельцем.


### <a name="assign-azure-account-permissions"></a>Назначение разрешений учетной записи Azure

Назначьте учетной записи Azure роль участника виртуальных машин. Это предоставит следующие разрешения:

- разрешение на создание виртуальной машины в выбранной группе ресурсов;
- разрешение на создание виртуальной машины в выбранной виртуальной сети;
- разрешение на запись на управляемый диск Azure. 

### <a name="create-an-azure-network"></a>Создание сети Azure

[Настройте](../virtual-network/manage-virtual-network.md#create-a-virtual-network) виртуальную сеть Azure. При репликации в Azure создаются виртуальные машины Azure, которые присоединяются к виртуальной сети Azure, указанной при настройке миграции.

## <a name="prepare-for-migration"></a>Подготовка к переносу

Чтобы подготовиться к миграции физических серверов, необходимо проверить их параметры, а также выполнить подготовку к развертыванию устройства репликации.

### <a name="check-machine-requirements-for-migration"></a>Проверка требований к компьютеру для миграции

Убедитесь, что компьютеры соответствуют требованиям для миграции в Azure. 

> [!NOTE]
> При переносе физических компьютеров средство миграции сервера службы "Миграция Azure" использует ту же архитектуру репликации, что и функция аварийного восстановления на основе агента в Azure Site Recovery, а некоторые из их компонентов используют одну и ту же базу кода. В некоторых местах может упоминаться документация по Site Recovery.

1. [Проверьте](migrate-support-matrix-physical-migration.md#physical-server-requirements) соответствие требованиям к физическому серверу.
2. Убедитесь, что локальные виртуальные машины, которые реплицируются в Azure, соответствуют [требованиям к виртуальным машинам Azure](migrate-support-matrix-physical-migration.md#azure-vm-requirements).
3. Прежде чем переносить виртуальные машины в Azure, необходимо внести в них некоторые изменения.
    - В некоторых операционных системах Миграция Azure вносит эти изменения автоматически. 
    - Важно внести эти изменения до начала миграции. Если вы перенесете виртуальную машину до внесения изменений, она может не загрузиться в Azure. Просмотрите сведения об изменениях для [Windows](prepare-for-migration.md#windows-machines) и [Linux](prepare-for-migration.md#linux-machines), которые необходимо внести.

### <a name="prepare-a-machine-for-the-replication-appliance"></a>Подготовка компьютера для устройства репликации

Средство "Миграция сервера" службы "Миграция Azure" использует модуль репликации для репликации компьютеров в Azure. Устройство репликации запускает следующие компоненты.

- **Сервер конфигурации** : Сервер конфигурации используется для управления обменом данными между локальным источником и Azure, а также репликацией данных.
- **Сервер обработки** Сервер обработки выступает в качестве шлюза репликации. Он получает данные репликации, оптимизирует их путем кэширования, сжатия и шифрования и отправляет их в учетную запись хранения кэша Azure. 

Выполните подготовку к развертыванию устройства следующим образом:

- Вам нужно подготовить компьютер для размещения модуля репликации. [Просмотрите требования](migrate-replication-appliance.md#appliance-requirements) к компьютеру.
- Модуль репликации использует MySQL. Проверьте [параметры](migrate-replication-appliance.md#mysql-installation) для установки MySQL в модуле.
- Проверьте URL-адреса Azure, к которым модуль репликации будет обращаться в [общедоступных](migrate-replication-appliance.md#url-access) облаках и облаках [для государственных организаций](migrate-replication-appliance.md#azure-government-url-access).
- Просмотрите требования относительно доступа к [порту] (migrate-replication-appliance.md#port-access) для модуля репликации.

> [!NOTE]
> Устройство репликации не следует устанавливать на исходном компьютере, который необходимо реплицировать, или на устройстве обнаружения и оценки службы "Миграция Azure", которое вы могли установить ранее.

## <a name="add-the-server-migration-tool"></a>Добавление средства "Миграция сервера"

Настройте проект службы "Миграция Azure", а затем добавьте в него средство "Миграция сервера".

1. На портал Azure выберите **Все службы** и найдите службу **Миграция Azure**.
2. В разделе **Службы** выберите **Миграция Azure**.
3. В разделе **Обзор** щелкните **Оценка и миграция серверов**.
4. В области **Обнаружение, оценка и перенос серверов** щелкните **Оценка и миграция серверов**.

    ![Обнаружение и оценка серверов](./media/tutorial-migrate-physical-virtual-machines/assess-migrate.png)

5. В разделе **Обнаружение, оценка и перенос серверов** щелкните **Add tools** (Добавить инструменты).
6. В разделе **Проект миграции** выберите подписку Azure и создайте группу ресурсов, если у вас ее нет.
7. В разделе **Сведения о проекте** укажите имя проекта и регион для создания проекта, а затем щелкните **Далее**. Просмотрите список поддерживаемых регионов для [общедоступного](migrate-support-matrix.md#supported-geographies-public-cloud) облака и облака для [государственных организаций](migrate-support-matrix.md#supported-geographies-azure-government).

    ![Создание проекта службы "Миграция Azure"](./media/tutorial-migrate-physical-virtual-machines/migrate-project.png)

8. В разделе **Выберите инструмент оценки** щелкните **Пропустить добавление инструмента оценки** > **Далее**.
9. В области **Выберите инструмент миграции** выберите **Azure Migrate: Server Migration** (Миграция Azure: миграция сервера) > **Далее**.
10. В области **Review + add tools** (Проверка и добавление инструментов) проверьте параметры и щелкните **Add tools** (Добавить инструменты).
11. После добавления инструмента он появится в проекте Миграции Azure в разделе **Серверы** > **Средства миграции**.

## <a name="set-up-the-replication-appliance"></a>Настройка устройства репликации

Первым шагом миграции является настройка устройства репликации. Чтобы настроить модуль для миграции физического сервера, скачайте файл установщика для модуля, а затем запустите его на [подготовленном вами компьютере](#prepare-a-machine-for-the-replication-appliance). После установки устройства вы зарегистрируете его с помощью средства "Миграция сервера" службы "Миграция Azure".


### <a name="download-the-replication-appliance-installer"></a>Скачивание установщика устройства репликации

1. В проекте "Миграция Azure" > **Серверы** , в разделе **Azure Migrate: Server Migration** (Миграция Azure: Миграция сервера), выберите **Обнаружить**.

    ![Обнаружение виртуальных машин](./media/tutorial-migrate-physical-virtual-machines/migrate-discover.png)

3. В разделе **Обнаружение компьютеров** > **Ваши компьютеры виртуализированы?** выберите **Not virtualized/Other** (Не виртуализированы/Другое).
4. В поле **Целевой регион** выберите регион Azure, в который необходимо перенести компьютеры.
5. Выберите параметр **Подтвердите, что целевым регионом для миграции является "имя-региона"** .
6. Щелкните **Создать ресурсы**. После этого в фоновом режиме создается хранилище Azure Site Recovery.
    - Если вы уже настроили миграцию с помощью средства "Миграция сервера" службы "Миграция Azure", целевой параметр нельзя настроить, так как ресурсы были настроены ранее.    
    - После нажатия этой кнопки вы не сможете изменить целевой регион для этого проекта.
    - Все последующие миграции будут выполняться в этот регион.

7. В разделе **Do you want to install a new replication appliance?** (Вы хотите установить новое устройство репликации?) щелкните **Установить устройство репликации**.
9. В разделе **Download and install the replication appliance software** (Скачайте и установите ПО устройства репликации) скачайте установщик устройства и регистрационный ключ. Для регистрации устройства необходим ключ. Ключ действителен в течение пяти дней после скачивания.

    ![Скачивание поставщика](media/tutorial-migrate-physical-virtual-machines/download-provider.png)

10. Скопируйте файл установки устройства и файл ключа на компьютер под управлением Windows Server 2016, который вы создали для устройства.
11. После установки будет автоматически запущен мастер настройки устройства (мастер можно также запустить вручную с помощью ярлыка cspsconfigtool, который создается на рабочем столе устройства). Используйте вкладку "Управление учетными записями" мастера, чтобы добавить сведения об учетной записи для принудительной установки службы "Мобильность". В рамках этого учебника мы будем устанавливать службу "Мобильность" вручную на исходных виртуальных машинах, которые нужно реплицировать. Поэтому создайте на этом этапе фиктивную учетную запись и продолжайте работу. Вы можете указать следующие сведения для создания фиктивной учетной записи: guest в качестве имени, username в качестве имени пользователя и password в качестве пароля учетной записи. Такая фиктивная учетная запись потребуется вам на шаге "Включение репликации". 

12. После настройки и перезапуска устройства на вкладке **Обнаружение компьютеров** выберите новое устройство в разделе **Выберите сервер конфигурации** и нажмите кнопку **Finalize registration** (Завершить регистрацию). Завершение регистрации выполняет пару заключительных задач по подготовке устройства репликации.

    ![Завершение регистрации](./media/tutorial-migrate-physical-virtual-machines/finalize-registration.png)

После завершения регистрации может пройти некоторое время, пока обнаруженные виртуальные машины не отобразятся в средстве миграции сервера службы "Миграция Azure". При обнаружении виртуальных машин количество **обнаруженных серверов** увеличивается.

![Обнаруженные серверы](./media/tutorial-migrate-physical-virtual-machines/discovered-servers.png)


## <a name="install-the-mobility-service"></a>Установка службы Mobility

Установите службу мобильности на виртуальных компьютерах, которые нужно перенести. Установщики агента доступны на устройстве репликации. Найдите правильный установщик и установите агент на каждой машине, которую хотите перенести. Это можно сделать указанным ниже образом.

1. Войдите на устройство репликации.
2. Перейдите по ссылке **%ProgramData%\ASR\home\svsystems\pushinstallsvc\repository**.
3. Найдите версию установщика, которая соответствует ОС компьютера. Проверьте [поддерживаемые операционные системы](../site-recovery/vmware-physical-azure-support-matrix.md#replicated-machines). 
4. Скопируйте файл установщика на компьютер, который вы хотите перенести.
5. Убедитесь, что у вас есть пароль, сгенерированный при развертывании устройства.
    - Сохраните файл во временный текстовый файл на компьютере.
    - На устройстве репликации можно получить парольную фразу. В командной строке выполните **C:\ProgramData\ASR\home\svsystems\bin\genpassphrase.exe -v** , чтобы просмотреть текущую парольную фразу.
    - Не создавайте парольную фразу повторно. Это нарушит соединение и вам придется перерегистрировать устройство репликации.


### <a name="install-on-windows"></a>Установка в Windows

1. Извлеките содержимое файла установщика в локальную папку (например, C:\Temp) на компьютере следующим образом:

    ```
    ren Microsoft-ASR_UA*Windows*release.exe MobilityServiceInstaller.exe
    MobilityServiceInstaller.exe /q /x:C:\Temp\Extracted
    cd C:\Temp\Extracted
    ```
2. Запустите установщик Службы мобильности:
    ```
   UnifiedAgent.exe /Role "MS" /Platform "VmWare" /Silent
    ```
3. Зарегистрируйте агент на устройстве репликации:
    ```
    cd C:\Program Files (x86)\Microsoft Azure Site Recovery\agent
    UnifiedAgentConfigurator.exe  /CSEndPoint <replication appliance IP address> /PassphraseFilePath <Passphrase File Path>
    ```

### <a name="install-on-linux"></a>Установка в Linux

1. Извлеките содержимое файла tarball установщика в локальную папку (например, /tmp/MobSvcInstaller) на компьютере следующим образом:
    ```
    mkdir /tmp/MobSvcInstaller
    tar -C /tmp/MobSvcInstaller -xvf <Installer tarball>
    cd /tmp/MobSvcInstaller
    ```
2. Запустите скрипт установщика.
    ```
    sudo ./install -r MS -v VmWare -q
    ```
3. Зарегистрируйте агент на устройстве репликации:
    ```
    /usr/local/ASR/Vx/bin/UnifiedAgentConfigurator.sh -i <replication appliance IP address> -P <Passphrase File Path>
    ```

## <a name="replicate-machines"></a>Репликация компьютеров

Теперь выберите виртуальные машины для миграции. 

> [!NOTE]
> Можно реплицировать до 10 виртуальных машин за раз. Если требуется реплицировать большее число виртуальных машин, выполните одновременную репликацию в пакетах из 10 машин.

1. В проекте службы "Миграция Azure" щелкните **Серверы** и в разделе **Azure Migrate: Server Migration** (Миграция Azure: миграция сервера) выберите **Репликация**.

    ![Снимок экрана: страница "Миграция Azure — серверы" с выбранной кнопкой "Реплицировать" в средстве "Миграция сервера" Миграции Azure в разделе "Средства миграции".](./media/tutorial-migrate-physical-virtual-machines/select-replicate.png)

2. В разделе **Репликация** выберите **Параметры исходного кода** > **Ваши компьютеры виртуализированы?**  > **Not virtualized/Other** (Без виртуализации или иное).
3. В разделе **Локальное устройство** выберите имя устройства Миграции Azure, которое вы настроили.
4. В разделе **Сервер обработки** выберите имя устройства репликации.
6. В разделе **Учетные данные гостя** выберите созданную на этапе [настройки установщика репликации](#download-the-replication-appliance-installer) фиктивную учетную запись, чтобы вручную установить службу "Мобильность" (автоматическая установка не поддерживается). Выберите **Next: Виртуальные машины**.   

    ![Снимок экрана: вкладка "Параметры источника" на странице "Репликация" с выделенным полем "Учетные данные гостя".](./media/tutorial-migrate-physical-virtual-machines/source-settings.png)

7. В разделе **Виртуальные машины** на вкладке **Импортировать параметры миграции из оценки?** оставьте параметр по умолчанию **No, I'll specify the migration settings manually** (Нет, я укажу параметры миграции вручную).
8. Проверьте каждую виртуальную машину, которую требуется перенести. Выберите **Next: Целевые параметры**.

    ![Выбор виртуальных машин](./media/tutorial-migrate-physical-virtual-machines/select-vms.png)


9. В разделе **Целевые параметры** выберите подписку и целевой регион, в который вы хотите выполнить миграцию, а также укажите группу ресурсов, в которой будут находиться виртуальные машины Azure после миграции.
10. В разделе **Виртуальная сеть** выберите виртуальную сеть или подсеть Azure, к которой будут подключены виртуальные машины Azure после миграции.
11. В области **Параметры доступности** выберите следующие параметры.
    -  "Зона доступности", чтобы закрепить перенесенный компьютер в определенной зоне доступности в регионе. Используйте этот параметр для распределения серверов, образующих уровень приложения с несколькими узлами, по зонам доступности. Если вы выберете этот параметр, нужно будет указать зону доступности, чтобы использовать ее для каждого из выбранных компьютеров на вкладке "Вычисление". Этот параметр доступен только в том случае, если в целевом регионе, выбранном для миграции, поддерживаются зоны доступности.
    -  "Группа доступности", чтобы поместить перенесенную виртуальную машину в группу доступности. Чтобы использовать этот параметр, выбранная целевая группа ресурсов должна содержать одну или несколько групп доступности.
    - Параметр "Избыточность инфраструктуры не требуется", если вам не нужна ни одна из этих конфигураций доступности для перенесенных виртуальных машин.
12. Для параметра **Преимущество гибридного использования Azure**

    - выберите вариант **Нет** , если вы не хотите применять Преимущество гибридного использования Azure. Затем нажмите кнопку **Далее**.
    - Выберите вариант **Да** , если у вас есть компьютеры с Windows Server, на которые распространяются активные подписки Software Assurance или Windows Server, и вы хотите применить это преимущество к компьютерам, которые вы переносите. Затем нажмите кнопку **Далее**.

    ![Целевые параметры](./media/tutorial-migrate-physical-virtual-machines/target-settings.png)

13. В разделе **Вычисление** проверьте имя виртуальной машины, ее размер, тип диска ОС и конфигурацию доступности (если она выбрана на предыдущем шаге). Виртуальные машины должны соответствовать [требованиям Azure](migrate-support-matrix-physical-migration.md#azure-vm-requirements).

    - **Размер виртуальной машины**. Если вы используете рекомендации по оценке, в раскрывающемся списке размеров виртуальных машин отобразится рекомендуемый размер. В противном случае Миграция Azure выбирает размер в зависимости от ближайшего совпадения в подписке Azure. В качестве альтернативы выберите размер вручную в разделе **Размер виртуальной машины Azure**.
    - **Диск ОС** : Укажите загрузочный диск ОС для виртуальной машины. Диск ОС — это диск с загрузчиком операционной системы и установщиком.
    - **Зона доступности.** Укажите зону доступности, которую необходимо использовать.
    - **Группа доступности**. Укажите группу доступности, которую необходимо использовать.

> [!NOTE]
> Если для наборов виртуальных машин нужно выбрать другой вариант доступности, перейдите к шагу 1 и повторите действия, задав другие параметры доступности после запуска репликации для одного набора виртуальных машин.

   ![Параметры вычислений](./media/tutorial-migrate-physical-virtual-machines/compute-settings.png)

13. В разделе **Диски** укажите, следует ли реплицировать диски виртуальных машин в Azure, и выберите тип диска (SSD или HDD (цен. категория "Стандартный") или управляемые диски (цен. категория "Премиум")) в Azure. Затем нажмите кнопку **Далее**.
    - Диски можно исключить из репликации.
    - Если вы исключите диски, они не будут присутствовать на виртуальной машине Azure после миграции. 

    ![Параметры дисков](./media/tutorial-migrate-physical-virtual-machines/disks.png)


14. В разделе **Review and start replication** (Просмотр и запуск репликации) просмотрите параметры и нажмите кнопку **Реплицировать** , чтобы начать первоначальную репликацию серверов.

> [!NOTE]
> Вы можете обновить параметры репликации в любое время до начала репликации в разделе **Управление** > **Репликация компьютеров**. Настройки невозможно изменить после начала репликации.



## <a name="track-and-monitor"></a>Отслеживание и мониторинг

- Когда вы нажимаете кнопку **Реплицировать** , выполняется задание "Запуск репликации". 
- После успешного завершения задания "Запуск репликации" компьютеры начинают первоначальную репликацию в Azure.
- После завершения начальной репликации начинается разностная репликация. Добавочные изменения локальных дисков периодически реплицируются на диски реплики в Azure.


Отслеживать состояние задания можно в уведомлениях портала.

Вы можете отслеживать состояние репликации, щелкнув **Репликация серверов** в разделе **Azure Migrate: Server Migration** (Миграция Azure: миграция сервера).
![Мониторинг репликации](./media/tutorial-migrate-physical-virtual-machines/replicating-servers.png)

## <a name="run-a-test-migration"></a>Выполнение тестовой миграции


Когда начинается разностная репликация, вы можете запустить тестовую миграцию для виртуальных машин перед выполнением полной миграции в Azure. Мы настоятельно рекомендуем сделать это хотя бы один раз для каждой машины перед ее миграцией.

- Запуск тестовой миграции позволяет проверить, что миграция будет работать должным образом, не затрагивая локальные машины, которые остаются работоспособными и продолжают репликацию. 
- Тестовая миграция моделирует миграцию путем создания виртуальной машины Azure с использованием реплицированных данных (обычно выполняется миграция в нерабочую виртуальную сеть в вашей подписке Azure).
- Вы можете использовать реплицированную тестовую виртуальную машину Azure для проверки миграции, выполнения тестирования приложений и решения любых проблем перед полной миграцией.

Выполните тестовую миграцию следующим образом:


1. Последовательно выберите разделы **Цели миграции** > **Серверы** > **Azure Migrate: Server Migration** (Миграция Azure: миграция сервера) щелкните **Тестовая миграция серверов выполнена**.

     ![Тестовая миграция серверов](./media/tutorial-migrate-physical-virtual-machines/test-migrated-servers.png)

2. Щелкните правой кнопкой мыши виртуальную машину, чтобы выполнить тест, и выберите **Тестовая миграция**.

    ![Тестовая миграция](./media/tutorial-migrate-physical-virtual-machines/test-migrate.png)

3. В разделе **Тестовая миграция** выберите виртуальную сеть Azure, в которой будет находиться виртуальная машина Azure после миграции. Мы рекомендуем использовать нерабочую виртуальную сеть.
4. Запустится задание **Тестовая миграция**. Отслеживайте задание и уведомления на портале.
5. После завершения миграции просмотрите перенастроенную виртуальную машину Azure в разделе **Виртуальные машины** на портале Azure. Имя машины содержит суффикс **-Test**.
6. После завершения теста щелкните правой кнопкой мыши виртуальную машину Azure в разделе **Репликация компьютеров** и выберите **Очистка тестовой миграции**.

    ![Очистка миграции](./media/tutorial-migrate-physical-virtual-machines/clean-up.png)


## <a name="migrate-vms"></a>Перенос виртуальных машин

Убедившись, что тестовая миграция работает должным образом, вы можете выполнить миграцию локальных компьютеров.

1. В проекте "Миграция Azure" щелкните **Серверы** > **Azure Migrate: Server Migration** (Миграция Azure: миграция сервера) и выберите **Репликация серверов**.

    ![Репликация серверов](./media/tutorial-migrate-physical-virtual-machines/replicate-servers.png)

2. В области **Репликация компьютеров** щелкните правой кнопкой мыши виртуальную машину и выберите **Миграция**.
3. В разделе **Миграция** > **Shut down virtual machines and perform a planned migration with no data loss** (Завершить работу виртуальных машин и выполнить запланированную миграцию без потери данных?) выберите вариант **Да** > **ОК**.
    - Если вы не хотите выключать виртуальную машину, выберите вариант **Нет**.
    
    Примечание. Для переноса физического сервера рекомендуется перевести приложение в окно миграции (не позволяя приложениям принимать подключения), а затем инициировать миграцию (сервер должен продолжать работу, чтобы оставшиеся изменения можно было синхронизировать) до завершения процесса.

4. Запустится задание миграции виртуальной машины. Отслеживайте задание в уведомлениях Azure.
5. После завершения работы вы можете просматривать виртуальную машину и управлять ею на странице **Виртуальные машины**.

## <a name="complete-the-migration"></a>Выполнение миграции

1. После завершения миграции щелкните правой кнопкой мыши виртуальную машину и выберите **Stop migration** (Остановка миграции). Таким образом вы сделаете следующее:
    - Остановите репликацию для локального компьютера.
    - Удалите компьютер из числа **реплицируемых серверов** в средстве для миграции серверов Миграции Azure.
    - Очистите информацию о состоянии репликации для компьютера.
2. Установите агент виртуальной машины Azure для [Windows](../virtual-machines/extensions/agent-windows.md) или [Linux](../virtual-machines/extensions/agent-linux.md) на перенесенных компьютерах.
3. Выполните любые действия по настройке после миграции приложения, такие как обновление строк подключения к базе данных и конфигурация веб-сервера.
4. Выполните приемочное тестирование конечного приложения и миграции на перенесенном приложении, работающем в Azure.
5. Остановите трафик для перенесенного экземпляра виртуальной машины Azure.
6. Удалите локальные виртуальные машины из списка локальных виртуальных машин.
7. Удалите локальные виртуальные машины из локальных заданий резервного копирования.
8. Обновите внутренние документы и отразите в них новое расположение и IP-адреса виртуальных машин Azure. 

## <a name="post-migration-best-practices"></a>Рекомендации, выполняемые после миграции

- Для повышения устойчивости:
    - Обеспечьте безопасность данных путем резервного копирования виртуальных машин Azure с помощью службы Azure Backup. [Подробнее](../backup/quick-backup-vm-portal.md).
    - Обеспечьте непрерывную работу и постоянную доступность рабочих нагрузок за счет репликации виртуальных машин Azure в дополнительный регион с помощью Site Recovery. [Подробнее](../site-recovery/azure-to-azure-tutorial-enable-replication.md).
- Для повышения уровня безопасности:
    - Заблокируйте и ограничьте доступ входящего трафика с помощью [JIT-администрирования](../security-center/security-center-just-in-time.md) центра безопасности Azure.
    - Ограничьте сетевой трафик конечными точками с помощью [групп безопасности сети](../virtual-network/network-security-groups-overview.md).
    - Разверните [шифрование дисков Azure](../security/fundamentals/azure-disk-encryption-vms-vmss.md), чтобы обеспечить безопасность дисков и защитить данные от кражи и несанкционированного доступа.
    - Ознакомьтесь с дополнительными сведениями о [защите ресурсов IaaS](https://azure.microsoft.com/services/virtual-machines/secure-well-managed-iaas/) и посетите [центр безопасности Azure](https://azure.microsoft.com/services/security-center/).
- Для мониторинга и управления:
    - Рассмотрите возможность развертывания [службы "Управление затратами Azure"](../cost-management-billing/cloudyn/overview.md) для мониторинга использования ресурсов и затрат.


## <a name="next-steps"></a>Дальнейшие действия

Проанализируйте процесс [миграции в облако](/azure/architecture/cloud-adoption/getting-started/migrate) в Azure Cloud Adoption Framework.