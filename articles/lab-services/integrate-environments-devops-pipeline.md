---
title: Интеграция среды в Azure конвейеров в Azure DevTest Labs | Документация Майкрософт
description: Узнайте, как интегрировать Azure DevTest Labs среды в Azure DevOps с непрерывной интеграции (CI) и конвейеры непрерывной поставки (CD).
services: devtest-lab,virtual-machines,lab-services
documentationcenter: na
author: spelluru
manager: femila
ms.service: lab-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/02/2019
ms.author: spelluru
ms.openlocfilehash: deb5595ac6a8b0d189e5594fda8e4b60480d038c
ms.sourcegitcommit: c174d408a5522b58160e17a87d2b6ef4482a6694
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59357404"
---
# <a name="integrate-environments-into-your-azure-devops-cicd-pipelines"></a>Интеграция среды в Azure DevOps непрерывной Интеграции и Развертывания конвейеров
Можно использовать расширение задачи Azure DevTest Labs, в который установлена службам DevOps в Azure (прежнее название Visual Studio Team Services) для простой интеграции непрерывной интеграции (CI) / конвейер непрерывной поставки (CD) сборки — выпуска с Azure DevTest Labs. Эти расширения упрощают для быстрого развертывания [среды](devtest-lab-test-env.md) для конкретного теста задач и затем удалите его, после завершения теста. 

В этой статье показано, как создать и развернуть среду, а затем удалить среду, в один полный конвейер. Обычно выполняются каждую из этих задач по отдельности в свои собственные пользовательские сборки, тестирования и развертывания конвейера. Расширения, используемые в этой статье, помимо этих [создание, удаление задачи виртуальных Машин оно](devtest-lab-integrate-ci-cd-vsts.md):

- Создание среды
- Удаление среды

## <a name="before-you-begin"></a>Перед началом работы
Прежде чем вы можете интегрировать конвейер CI/CD с Azure DevTest Labs, установить [задачи Azure DevTest Labs](https://marketplace.visualstudio.com/items?itemName=ms-azuredevtestlabs.tasks) расширение из Visual Studio Marketplace. 

## <a name="create-and-configure-the-lab-for-environments"></a>Создание и настройка лабораторных сред
В этом разделе описывается создание и настройка лаборатории, в которой будет развернут в среде Azure.

1. [Создание лаборатории](devtest-lab-create-lab.md) Если у вас еще нет. 
2. Настройка лаборатории и создание шаблона среды, следуя инструкциям из этой статьи: [Создание сред со множеством виртуальных Машин и ресурсов PaaS с помощью шаблонов Azure Resource Manager](devtest-lab-create-environment-from-arm.md).
3. Например, использовать существующий шаблон быстрого запуска Azure [ https://azure.microsoft.com/resources/templates/201-web-app-redis-cache-sql-database/ ](https://azure.microsoft.com/resources/templates/201-web-app-redis-cache-sql-database/).
4. Копировать **201-web-app-redis-cache-sql-database** папку в **ArmTemplate** папки в репозитории, настроенной на шаге 2.

## <a name="create-a-release-definition"></a>Создание определения выпуска
Чтобы создать определение выпуска, сделайте следующее:

1.  На **выпуски** вкладке **сборка и выпуск концентратора**выберите **плюс (+)** кнопки.
2.  В окне **Создание определения выпуска** выберите шаблон **Пустой**, а затем нажмите кнопку **Далее**.
3.  Выберите **Выбрать позже**, а потом щелкните **Создать**, чтобы создать определение выпуска с одной средой по умолчанию без связанных артефактов.
4.  Чтобы открыть контекстное меню, в новое определение выпуска, выберите **кнопку с многоточием (...)**  рядом с именем среды, а затем выберите **настроить переменные**.
5.  В окне **настройки среды** введите следующие значения переменных, используемых в задачах определения выпуска:
1.  Для **administratorLogin**, введите имя входа администратора SQL.
2.  Для **administratorLoginPassword**, введите пароль, используемый для входа администратора SQL. Используйте значок "замка" для скрытия и защиты пароля.
3.  Для **databaseName**, введите имя базы данных SQL.
4.  Эти переменные под конкретные примеры сред, различных средах может иметь различные переменные.

## <a name="create-an-environment"></a>Создание среды
Следующий этап развертывания заключается в том, чтобы создать среду для разработки и тестирования.

1. В определении выпуска выберите **Добавить задачи**.
2. На **задачи** вкладке, добавление задачи Azure DevTest Labs создавать среды. Настройте задачу следующим образом.
    1. В поле **Подписка на AzureRM** выберите подключение в списке **Доступные подключения к службе Azure** или создайте подключение с ограниченными разрешениями к вашей подписке Azure. Дополнительные сведения см. в разделе о [конечной точке службы Azure Resource Manager](/azure/devops/pipelines/library/service-endpoints).
2. Для **имя лабораторной**, выберите имя экземпляра, который был создан ранее *.
3. Для **имя репозитория**, выберите репозиторий, где был отправлен в шаблоне Resource Manager (201) *.
4. Для **имя шаблона**, выберите имя среды, созданный для вашего исходного кода репозитории *. 
5. **Имя лабораторной**, **имя репозитория**, и **имя шаблона** это понятное представление идентификаторов ресурсов Azure. Вручную, указав понятное имя будет привести к сбоям, используйте раскрывающиеся списки для выбора сведений.
6. Для **имя среды**, введите имя для уникальной идентификации экземпляра среды в лаборатории.  Оно должно быть уникальным в лаборатории.
7. **Файл параметров** и **параметры**, Разрешить пользовательские параметры, передаваемые в среду. Чтобы задать значения параметров можно использовать одно или оба. В этом примере будет использоваться раздел параметров. Используйте имена переменных, определенных в среде, например: `-administratorLogin “$(administratorLogin)” -administratorLoginPassword “$(administratorLoginPassword)” -databaseName “$(databaseName)” -cacheSKUCapacity 1`
8. Сведения в шаблоне среды могут передаваться в разделе выходных данных шаблона. Проверьте **создание выходных переменных на основе выходных данных шаблона среды** , данные можно использовать другие задачи. `$(Reference name.Output Name)` — шаблон для выполнения. Например, если оно было ссылочное имя и имя выходных данных в шаблоне расположение переменной будет `$(DTL.location)`.

## <a name="delete-the-environment"></a>Удаление среды
Завершающим этапом является удаление среды, который был развернут на экземпляре Azure DevTest Labs. После выполнения задач разработки или выполнение тестов, которые необходимы в развернутых ресурсов, обычно удаление среды.

В определении выпуска выберите **добавлять задачи**, а затем на **развернуть** вкладку, добавьте **удалить среду Azure DevTest Labs** задачи. Настройте его следующим образом.

1. Чтобы удалить виртуальную Машину, см. в разделе [задачи Azure DevTest Labs](https://marketplace.visualstudio.com/items?itemName=ms-azuredevtestlabs.tasks):
    1. В поле **Подписка на AzureRM** выберите подключение в списке **Доступные подключения к службе Azure** или создайте подключение с ограниченными разрешениями к вашей подписке Azure. Дополнительные сведения см. в разделе о [конечной точке службы Azure Resource Manager](/azure/devops/pipelines/library/service-endpoints).
    2. Для **имя лабораторной**, выберите ту, где среда существует.
    3. Для **имя среды**, введите имя среды для удаления.
2. Введите имя для определения выпуска и сохраните его.

## <a name="next-steps"></a>Дальнейшие действия
Ознакомьтесь со следующими статьями: 
- [Создание сред со множеством виртуальных Машин с помощью шаблонов Resource Manager](devtest-lab-create-environment-from-arm.md).
- Шаблоны быстрого запуска Resource Manager для автоматизации DevTest Labs из [репозитории DevTest Labs на сайте GitHub](https://github.com/Azure/azure-quickstart-templates).
- [Устранение неполадок VSTS страницы](/azure/devops/pipelines/troubleshooting)

