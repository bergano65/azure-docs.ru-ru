---
title: Планирование развертывания кластера Azure Service Fabric | Документация Майкрософт
description: Узнайте, как планировать и подготавливать рабочую Service Fabric развертывание кластера в Azure.
services: service-fabric
documentationcenter: .net
author: athinanthny
manager: chackdan
ms.assetid: ''
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: conceptual
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 03/20/2019
ms.author: atsenthi
ms.openlocfilehash: a130e9bc8859360704c9be1c0a7fe066d2ed4567
ms.sourcegitcommit: fe6b91c5f287078e4b4c7356e0fa597e78361abe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/29/2019
ms.locfileid: "68600001"
---
# <a name="plan-and-prepare-for-a-cluster-deployment"></a>Планирование и подготовка к развертыванию кластера

Планирование и подготовка к развертыванию производственного кластера очень важно.  Есть много факторов, которые следует учитывать.  В этой статье описано, как подготовить развертывание кластера.

## <a name="read-the-best-practices-information"></a>Прочтите сведения о рекомендациях
Для успешного управления приложениями Azure Service Fabric и кластерами существуют операции, которые мы настоятельно рекомендуем выполнить для оптимизации надежности рабочей среды.  Дополнительные сведения см. в статье [Service Fabric рекомендации по приложениям и кластерам](service-fabric-best-practices-overview.md).

## <a name="select-the-os-for-the-cluster"></a>Выберите ОС для кластера
Service Fabric позволяет создавать кластеры Service Fabric на любых виртуальных машинах или компьютерах под управлением Windows Server или Linux.  Перед развертыванием кластера необходимо выбрать ОС:  Windows или Linux.  Каждый узел (виртуальная машина) в кластере выполняет одну и ту же ОС. Вы не можете смешивать виртуальные машины Windows и Linux в одном кластере.

## <a name="capacity-planning"></a>Планирование ресурсов
Для любой рабочей развернутой службы важным шагом является планирование загрузки. Вот несколько моментов, которые необходимо учесть:

* Начальное число типов узлов для кластера 
* Свойства каждого типа узла (размер, число экземпляров, первичный, с выходом в Интернет, количество виртуальных машин и т. д.)
* Надежность и устойчивость характеристик кластера.

### <a name="select-the-initial-number-of-node-types"></a>Выберите начальное число типов узлов
Во-первых, необходимо выяснить, для чего будет использоваться создаваемый кластер и какие виды приложений планируется в нем развернуть. Есть ли у вашего приложения несколько служб, среди которых есть службы, которые должны быть общедоступными или доступными из Интернета? У служб (составляющих приложение) различные требования к инфраструктуре, например больше ОЗУ или тактов центрального процессора? Кластер Service Fabric может состоять более чем из одного типа узла: типа первичного узла и одного или нескольких типов непервичных узлов. Каждый тип узла соответствует набору масштабирования виртуальных машин. Каждый тип узла поддерживает возможность независимого масштабирования, имеет разные наборы открытых портов и собственные метрики емкости. [Свойства узла и ограничения на размещение][placementconstraints] можно настроить для ограничения конкретных служб конкретными типами узлов.  Дополнительные сведения см. [в статье число типов узлов, с которыми должен начинаться кластер](service-fabric-cluster-capacity.md#the-number-of-node-types-your-cluster-needs-to-start-out-with).

### <a name="select-node-properties-for-each-node-type"></a>Выберите свойства узла для каждого типа узла.
Типы узлов определяют номера SKU, Номера и свойства ВИРТУАЛЬНЫХ машин в связанном масштабируемом наборе.

Минимальный размер виртуальных машин для каждого типа узла определяется [уровнем устойчивости][durability] , выбранным для типа узла.

Минимальное число виртуальных машин для типа первичного узла определяется выбранным [уровнем надежности][reliability] .

Ознакомьтесь с минимальными рекомендациями для типов [первичных узлов](service-fabric-cluster-capacity.md#primary-node-type---capacity-guidance), [рабочих нагрузок с отслеживанием состояния на типах узлов, не являющихся первичными](service-fabric-cluster-capacity.md#non-primary-node-type---capacity-guidance-for-stateful-workloads), и [рабочих нагрузок без отслеживания состояния на типах узлов, не являющихся первичными](service-fabric-cluster-capacity.md#non-primary-node-type---capacity-guidance-for-stateless-workloads). 

Количество узлов, превышающее минимальное, должно быть основано на количестве реплик приложения или служб, которые необходимо выполнить в этом типе узла.  [Планирование ресурсов для Service Fabric приложений](service-fabric-capacity-planning.md) помогает оценить ресурсы, необходимые для выполнения приложений. Вы всегда можете увеличить или уменьшить масштаб кластера позже, чтобы изменить рабочую нагрузку приложения. 

### <a name="select-the-durability-and-reliability-levels-for-the-cluster"></a>Выбор уровней устойчивости и надежности для кластера
Уровень устойчивости используется, чтобы указать системе привилегии, имеющиеся у виртуальных машин в базовой инфраструктуре Azure. Для типа первичного узла эта привилегия позволяет Service Fabric приостановить любой запрос инфраструктуры на уровне виртуальной машины (например, перезагрузку, переустановку из образа или перенос виртуальной машины), который влияет на требования к кворуму, установленные для системных служб и ваших служб с отслеживанием состояния. Для типов вторичных узлов эта привилегия позволяет Service Fabric приостановить любой запрос инфраструктуры на уровне виртуальной машины (например, перезагрузку, переустановку из образа и перенос виртуальной машины), который влияет на требования к кворуму, установленные для ваших служб с отслеживанием состояния.  Преимущества различных уровней и рекомендаций по уровню [надежности кластера][durability]и рекомендации по их использованию.

Уровень надежности используется для задания числа реплик системных служб, которые будут выполняться в этом кластере на первичных узлах. Чем больше реплик, тем надежнее системные службы в кластере.  Для получения преимуществ различных уровней и рекомендаций по уровню использования и, когда, см. статью [характеристики надежности кластера][reliability]. 

## <a name="enable-reverse-proxy-andor-dns"></a>Включение обратных прокси-серверов и (или) DNS
Службы, которые подключаются друг к другу в рамках кластера, обычно могут напрямую обратиться к конечным точкам другой службы, так как узлы в кластере расположены в пределах одной локальной сети. Для облегчения подключения между службами Service Fabric предоставляет дополнительные службы. [Служба DNS](service-fabric-dnsservice.md) и [Служба обратных прокси-серверов](service-fabric-reverseproxy.md).  Обе службы можно включить при развертывании кластера.

Так как многие службы, особенно контейнерные службы, могут иметь существующее URL-имя, возможность их устранения с помощью стандартного протокола DNS (а не протокола Служба именования) удобна, особенно в сценариях "поднятие и смена приложений". Именно это и делает служба DNS. Она позволяет сопоставить DNS-имена с именем службы и, следовательно, разрешить IP-адреса конечных точек.

Обратный прокси-сервер обращается к службам в кластере, которые предоставляют конечные точки HTTP (включая HTTPS). Обратный прокси-сервер значительно упрощает вызов других служб, предоставляя конкретный формат URI.  Обратный прокси-сервер также обрабатывает шаги разрешения, подключения и повтора, необходимые для взаимодействия одной службы с другой.

## <a name="prepare-for-disaster-recovery"></a>Подготовка к аварийному восстановлению
Для обеспечения высокого уровня доступности крайне важно гарантировать продолжение работы всех типов служб при любых сбоях. Это особенно важно в ситуациях незапланированных сбоев, которые находятся вне вашего контроля. [Подготовка к аварийному восстановлению](service-fabric-disaster-recovery.md) описывает некоторые распространенные режимы сбоев, которые могут быть аварийными, если они не моделируются и не управляются надлежащим образом. В нем также обсуждаются меры по устранению рисков и действия, выполняемые в случае возникновения аварии.

## <a name="production-readiness-checklist"></a>Контрольный список готовности рабочей среды
Готовы ли ваше приложение и кластер к приему рабочего трафика? Перед развертыванием кластера в рабочей среде выполните контрольный [список готовности к производству](service-fabric-production-readiness-checklist.md). Используйте элементы этого контрольного списка, чтобы обеспечить бесперебойную работу приложения и кластера. Мы настоятельно рекомендуем отключать все эти элементы перед переходом в рабочую среду.

## <a name="next-steps"></a>Следующие шаги
* [Создание кластера Service Fabric под Windows](service-fabric-best-practices-overview.md)
* [Создание кластера Service Fabric под управлением Linux](service-fabric-tutorial-create-vnet-and-linux-cluster.md)

[placementconstraints]: service-fabric-cluster-resource-manager-cluster-description.md#node-properties-and-placement-constraints
[durability]: service-fabric-cluster-capacity.md#the-durability-characteristics-of-the-cluster
[reliability]: service-fabric-cluster-capacity.md#the-reliability-characteristics-of-the-cluster