---
title: Перемещение данных в облачный контейнер кэша HPC Azure
description: Как заполнить хранилище BLOB-объектов Azure для использования с кэшем HPC Azure
author: ekpgh
ms.service: hpc-cache
ms.topic: conceptual
ms.date: 10/30/2019
ms.author: rohogue
ms.openlocfilehash: a206b63b03bcb3bb17e201487f0e00bcb3926151
ms.sourcegitcommit: f4d8f4e48c49bd3bc15ee7e5a77bee3164a5ae1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73582226"
---
# <a name="move-data-to-azure-blob-storage"></a>Перемещение данных в хранилище BLOB-объектов Azure

Если рабочий процесс включает перемещение данных в хранилище BLOB-объектов Azure, убедитесь, что используется эффективная стратегия. Вы можете предварительно загрузить данные в новый контейнер больших двоичных объектов, прежде чем определять их в качестве целевого объекта хранилища, или добавить контейнер, а затем скопировать данные с помощью кэша HPC Azure.

В этой статье описываются лучшие способы перемещения данных в хранилище BLOB-объектов для использования с кэшем HPC Azure.

Учитывайте следующие факты:

* Кэш Azure HPC использует специализированный формат хранилища для организации данных в хранилище BLOB-объектов. Именно поэтому целевой объект хранилища BLOB-объектов должен быть новым, пустым контейнером или контейнером больших двоичных объектов, который ранее использовался для кэширования данных Azure HPC. ([Авере вфкст для Azure](https://azure.microsoft.com/services/storage/avere-vfxt/) также использует эту облачную файловую систему.)

* Копирование данных через кэш HPC Azure в серверную цель хранилища более эффективно, если используется несколько клиентов и параллельных операций. Простая команда копирования из одного клиента замедляет перемещение данных.

Для загрузки содержимого в контейнер хранилища BLOB-объектов доступна служебная программа на основе Python. Дополнительные сведения [см. в статье Предварительная загрузка данных в хранилище BLOB-объектов](#pre-load-data-in-blob-storage-with-clfsload) .

Если вы не хотите использовать служебную программу загрузки или хотите добавить содержимое в имеющуюся цель хранилища, следуйте советам по приему параллельных данных в статье [копирование данных через кэш HPC Azure](#copy-data-through-the-azure-hpc-cache).

## <a name="pre-load-data-in-blob-storage-with-clfsload"></a>Предварительная загрузка данных в хранилище BLOB-объектов с помощью Клфслоад

Можно использовать <!--[Avere CLFSLoad](https://aka.ms/avere-clfsload)--> Авере Клфслоад Utility, чтобы скопировать данные в новый контейнер хранилища BLOB-объектов, прежде чем добавлять их в качестве целевого объекта хранилища. Эта служебная программа работает в одной системе Linux и записывает данные в собственный формат, необходимый для кэша HPC Azure. Клфслоад — это наиболее эффективный способ заполнения контейнера хранилища BLOB-объектов для использования с кэшем.

Служебная программа Авере Клфслоад доступна по запросу команды кэша Azure HPC. Обратитесь к своему контактному лицу команды или отправьте запрос в [службу поддержки](hpc-cache-support-ticket.md) , чтобы запросить помощь.

Этот параметр работает только с новыми пустыми контейнерами. Создайте контейнер перед использованием Авере Клфслоад.

Подробные сведения содержатся в дистрибутиве Авере Клфслоад, доступном по запросу группы кэша HPC Azure. <!-- [Avere CLFSLoad readme](https://github.com/microsoft/Avere-CLFSLoad/blob/master/README.md). --><!-- caution literal link -->

Общий обзор процесса:

1. Подготовьте систему Linux (виртуальную машину или физическую) с Python версии 3,6 или более поздней. Для лучшей производительности рекомендуется использовать Python 3,7.
1. Установите программное обеспечение Авере-Клфслоад в системе Linux.
1. Выполните перенос из командной строки Linux.

Программе Авере Клфслоад требуются следующие сведения:

* Идентификатор учетной записи хранения, содержащей контейнер хранилища BLOB-объектов.
* Имя контейнера пустого хранилища BLOB-объектов
* Маркер подписанного URL-адрес (SAS), позволяющий программе записывать в контейнер.
* Локальный путь к источнику данных — локальный каталог, содержащий копируемые данные, или локальный путь к подключенной удаленной системе с данными

<!-- The requirements are explained in detail in the [Avere CLFSLoad readme](https://aka.ms/avere-clfsload). -->

## <a name="copy-data-through-the-azure-hpc-cache"></a>Копирование данных через кэш HPC Azure

Если вы не хотите использовать служебную программу Авере Клфслоад или хотите добавить большой объем данных в существующую целевую папку хранилища BLOB-объектов, вы можете скопировать их через кэш. Кэш Azure HPC предназначен для одновременного обслуживания нескольких клиентов, поэтому для копирования данных через кэш следует использовать параллельные операции записи из нескольких клиентов.

![Схема, показывающая многопоточное перемещение данных с несколькими клиентами. В левом верхнем углу из значка локального аппаратного хранилища исходят несколько стрелок. Стрелки указывают на четыре клиентских компьютера. На каждом клиентском компьютере три стрелки указывают на кэш HPC Azure. В кэше Azure HPC несколько стрелок указывают на хранилище BLOB-объектов.](media/hpc-cache-parallel-ingest.png)

Команды ``cp`` или ``copy``, которые обычно используются для перемещения данных из одной системы хранения в другую, являются многопоточными процессами, которые копируют только один файл за раз. Это означает, что файловый сервер принимает только один файл за раз, что является отходом ресурсов кэша.

В этом разделе описываются стратегии создания многоклиентской многопотоковой системы копирования файлов для перемещения данных в хранилище BLOB-объектов с помощью кэша HPC Azure. В ней описываются концепции передачи файлов и точки принятия решений, которые можно использовать для эффективного копирования данных с использованием нескольких клиентов и простых команд копирования.

Здесь также описываются некоторые служебные программы, которые могут помочь. С помощью служебной программы ``msrsync`` можно частично автоматизировать процесс разделения набора данных на группы и применение команд rsync. Сценарий ``parallelcp`` — это другая служебная программа, которая считывает исходный каталог и выдает команды копирования автоматически.

### <a name="strategic-planning"></a>Стратегическое планирование

При составлении стратегии для копирования данных в параллельном режиме следует учитывать компромиссы между размерами файлов, их количеством и глубиной каталогов.

* Если файлы малы, нужная метрика — количество файлов в секунду.
* Если файлы большие (10 MБ или больше), нужная метрика — число байт в секунду.

Каждый процесс копирования имеет пропускную способность и скорость передачи файлов, которые можно измерять по времени команды копирования с учетом размера и количества файлов. Объяснение того, как измерять скорость, выходит за рамки этого документа, но важно понять, с файлами какого размера вы будете работать.

Ниже приведены стратегии параллельного приема данных с помощью кэша HPC Azure.

* Ручное копирование — можно вручную создать многопотоковую копию на клиенте, одновременно запустив несколько команд копирования в фоновом режиме для предопределенных наборов файлов или путей. Дополнительные сведения см. в статье получение [данных кэша HPC для Azure с ручным копированием](hpc-cache-ingest-manual.md) .

* Частичное автоматическое копирование с помощью ``msrsync`` - ``msrsync`` — это служебная программа-оболочка, которая запускает несколько параллельных ``rsync`` процессов. Дополнительные сведения см. в статье о [методе приема данных кэша HPC в Azure](hpc-cache-ingest-msrsync.md).

* Создание скриптов для копирования с помощью ``parallelcp``. Узнайте, как создать и запустить скрипт параллельного копирования в [методе создания скрипта приема данных в кэше Azure HPC](hpc-cache-ingest-parallelcp.md).

## <a name="next-steps"></a>Дальнейшие действия

После настройки хранилища Узнайте, как клиенты могут подключать кэш.

* [Доступ к системе кэша HPC Azure](hpc-cache-mount.md)
