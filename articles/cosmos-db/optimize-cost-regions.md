---
title: Оптимизация затрат для развертываний в нескольких регионах в Azure Cosmos DB
description: В этой статье объясняется, как управлять затратами развертываний в нескольких регионах в Azure Cosmos DB.
author: markjbrown
ms.author: mjbrown
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 10/23/2020
ms.openlocfilehash: a559a51feafa310a4645282dc6368f520fc6b972
ms.sourcegitcommit: 6a350f39e2f04500ecb7235f5d88682eb4910ae8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2020
ms.locfileid: "96459619"
---
# <a name="optimize-multi-region-cost-in-azure-cosmos-db"></a>Оптимизация затрат на использование нескольких регионов в Azure Cosmos DB
[!INCLUDE[appliesto-all-apis](includes/appliesto-all-apis.md)]

Добавить или удалить регионы в учетной записи Azure Cosmos можно в любое время. Пропускная способность, настроенная для разных баз данных и контейнеров Azure Cosmos, зарезервирована в каждом регионе, связанном с учетной записью. Если подготавливается пропускная способность в час, то есть сумма единиц запросов/s, настроенных во всех базах данных и контейнерах для учетной записи Azure Cosmos `T` , а также число регионов Azure, связанных с учетной записью базы данных `N` , то общая пропускная способность для вашей учетной записи Cosmos для данного часа равна `T x N RU/s` .

Подготовленная пропускная способность с одним регионом стоит 0,008 долларов США в час на 100 ЕЗ/с, а подготовленная пропускная способность с несколькими регионами для записи стоит 0,016 долларов США в час на 100 ЕЗ/с. Дополнительные сведения см. на странице [Цены на Azure Cosmos DB](https://azure.microsoft.com/pricing/details/cosmos-db/).

## <a name="costs-for-multiple-write-regions"></a>Затраты нескольких регионов записи

В системе записи с несколькими регионами общедоступный адрес NFS для операций записи увеличивает `N` время, где `N` — число регионов записи. В отличие от операций записи в один регион, каждый регион теперь доступен для записи и поддерживает разрешение конфликтов. На основе точки планирования затрат, чтобы выполнять `M` операции записи на единицу во всем мире, необходимо подготавливать M `RUs` на уровне контейнера или базы данных. Затем можно добавить любое количество регионов и использовать их для операций записи для выполнения `M` ЕЗ из общего числа операций записи по всему миру.

### <a name="example"></a>Пример

Предположим, что у вас есть контейнер в западной части США, настроенный для операций записи в один регион, подготовленный с пропускной способностью 10 000 единиц запросов в секунду, в этом месяце будет храниться 0,5 ТБ данных. Предположим, что вы добавили регион "Восточная часть США" с тем же хранилищем и пропускной способностью, и вам требуется возможность записи в контейнеры в обоих регионах из приложения. Новый общий ежемесячный счет (при условии, что 730 часов в месяц) будет следующим:

|**Элемент**|**Использование (ежемесячно)**|**Тариф**|**Ежемесячные расходы**|
|----|----|----|----|
|Счет пропускной способности для контейнера в западной части США (один регион для записи) |10000 единиц запросов в секунду * 730 ч |$0,008 на 100 единиц запросов в час |$584 |
|Счет пропускной способности для контейнера в 2 регионах — Западная часть США & Восточная часть США (несколько регионов записи) |2 * 10000 единиц запросов в секунду * 730 ч |0,016 долларов США за 100 ЕЗ/с в час |$2 336 |
|Счет за хранение контейнера в западной части США |0,5 ТБ (или 512 ГБ) |0,25 долл. США за ГБ |$128 |
|Счет за хранилище для контейнера в двух регионах — Западная часть США & Восточная часть США |2 * 0,5 ТБ (или 1 024 ГБ) |0,25 долл. США за ГБ |$256 |

## <a name="improve-throughput-utilization-on-a-per-region-basis"></a>Повышение эффективности использования пропускной способности для региона

При наличии неэффективного использования, например одного или нескольких неиспользуемых регионов чтения, можно выполнить действия по максимальному использованию компонента RUs в регионах чтения с помощью канала изменений из региона чтения или переместить его на другой вторичный сервер при чрезмерном использовании. Необходимо сначала оптимизировать подготовленную пропускную способность (RUs) в регионе записи. Операции записи больше, чем операции чтения, за исключением очень больших запросов, поэтому поддержание даже использования может оказаться сложной задачей. В общем, отслеживайте потребленную пропускную способность в регионах и добавляйте или удаляйте регионы по запросу, чтобы масштабировать пропускную способность чтения и записи, что позволяет понять последствия задержки для всех приложений, развернутых в том же регионе.

## <a name="next-steps"></a>Дальнейшие действия

Теперь вы можете перейти к изучению оптимизации затрат в Azure Cosmos DB в следующих статьях:

* Дополнительные сведения об [оптимизации для разработки и тестирования](optimize-dev-test.md)
* Дополнительные сведения о [расшифровке счета Azure Cosmos DB](understand-your-bill.md)
* Дополнительные сведения об [оптимизации расходов на пропускную способность](optimize-cost-throughput.md)
* Дополнительные сведения об [оптимизации расходов на хранилище](optimize-cost-storage.md)
* Дополнительные сведения об [оптимизации расходов на операции чтения и записи](optimize-cost-reads-writes.md)
* Дополнительные сведения об [оптимизации затрат на запросы](./optimize-cost-reads-writes.md).
