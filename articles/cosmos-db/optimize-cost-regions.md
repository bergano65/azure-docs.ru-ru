---
title: Оптимизация затрат для развертываний в нескольких регионах в Azure Cosmos DB
description: В этой статье объясняется, как управлять затратами развертываний в нескольких регионах в Azure Cosmos DB.
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 12/07/2018
ms.author: rimman
ms.openlocfilehash: 0ec603df7005b9151f1cf760df80de9aaffc78b3
ms.sourcegitcommit: 71ee622bdba6e24db4d7ce92107b1ef1a4fa2600
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/17/2018
ms.locfileid: "53539710"
---
# <a name="optimize-the-cost-for-multi-region-deployments-in-azure-cosmos-db"></a>Оптимизация затрат для развертываний в нескольких регионах в Azure Cosmos DB

Добавить или удалить регионы в учетной записи Azure Cosmos можно в любое время. Пропускная способность, настроенная для разных баз данных и контейнеров Azure Cosmos, зарезервирована в каждом регионе, связанном с учетной записью. Если объем подготовленной пропускной способности в час (сумма ЕЗ/с, настроенных для всех баз данных и контейнеров для вашей учетной записи Azure Cosmos) `T`, а количество регионов Azure, связанных с учетной записью базы данных — `N`, общая подготовленная пропускная способность для учетной записи Cosmos для заданного часа равна следующему:

1. ` T x N RU/s`, если ваша учетная запись Azure Cosmos настроена с одним регионом записи. 

1. `T x (N+1) RU/s`, если для учетной записи Azure Cosmos настроены все регионы, способные обрабатывать операции записи. 

Подготовленная пропускная способность с одним регионом стоит 0,008 долларов США в час на 100 ЕЗ/с, а подготовленная пропускная способность с несколькими регионами для записи стоит 0,016 долларов США в час на 100 ЕЗ/с. Дополнительные сведения см. на странице [Цены на Azure Cosmos DB](https://azure.microsoft.com/pricing/details/cosmos-db/).

## <a name="costs-for-multiple-write-regions"></a>Затраты нескольких регионов записи

В системе с несколькими источниками чистое количество ЕЗ, доступных для операций записи, увеличивается в `N` раз, где `N` — число регионов записи. В отличие от операций записи в одном регионе, теперь все регионы доступны для записи и должны поддерживать разрешение конфликтов. Объем рабочей нагрузки для регионов с записью увеличился. С точки зрения затрат для выполнения` M` ЕЗ/с для операций записи по всему миру вам нужно будет подготовить M `RUs` на уровне контейнера или базы данных. Затем можно добавить любое количество регионов и использовать их для операций записи для выполнения `M` ЕЗ из общего числа операций записи по всему миру. 

### <a name="example"></a>Пример

Предположим, что в этом месяце вы подготовили в регионе "Западная часть США" контейнер с пропускной способностью 10 000 ЕЗ/с и 1 ТБ данных в хранилище. Предположим, вы добавляете три региона — восточную часть США, Северную Европу и Восточную Азию, в каждом из которых вы будете использовать хранилища одинакового объема и одинаковую пропускную способность. Вам необходима возможность записывать данные в контейнеры во всех четырех регионах из вашего глобально распределенного приложения. Общий ежемесячный счет (при 31 днях в месяце) следующий:

|**Элемент**|**Использование (ежемесячно)**|**Тариф**|**Ежемесячные расходы**|
|----|----|----|----|
|Счет за пропускную способность контейнера в регионе "Западная часть США" (несколько регионов записи) |10 000 ЕЗ/с * 24 * 31 |0,016 долларов США за 100 ЕЗ/с в час |1190,40 долл. США |
|Счет за пропускную способность в трех дополнительных регионах — "Восточная часть США", "Северная Европа" и "Восточная Азия" (несколько регионов записи) |(3 + 1) * 10 000 ЕЗ/с * 24 * 31 |0,016 долларов США за 100 ЕЗ/с в час |4761,60 долл. США |
|Счет за хранение контейнера в западной части США |100 ГБ |0,25 долл. США / ГБ |25 долл. США |
|Счет за хранение в трех дополнительных регионах (восточная часть США, Северная Европа и Восточная Азия) |3 * 1 TБ |0,25 долл. США / ГБ |75 долл. США |
|**Всего**|||**6052 долл. США** |

## <a name="improve-throughput-utilization-on-a-per-region-basis"></a>Повышение эффективности использования пропускной способности для региона

Например, если один или несколько регионов используются недостаточно или чрезмерно загружены, можно выполнить следующие действия, чтобы повысить эффективность использования пропускной способности:  

1. Убедитесь в том, что вы оптимизировали подготовленную пропускную способность (ЕЗ) в регионе записи, а затем максимально используйте единицы запросов в регионах чтения с помощью веб-канала из региона чтения и т. д. 

2. Операции чтения и записи нескольких регионов записи можно масштабировать по всем регионам, связанным с учетной записью Azure Cosmos. 

3. Отслеживайте действия в своих регионах и сможете добавлять и удалять регионы по запросу для масштабирования пропускной способности чтения и записи.

## <a name="next-steps"></a>Дополнительная информация

Теперь вы можете перейти к подробным сведениям об оптимизации затрат в Azure Cosmos DB, которые представлены в следующих статьях.

* Дополнительные сведения [об оптимизации для разработки и тестирования](optimize-dev-test.md).
* Дополнительные сведения о [расшифровке счета Azure Cosmos DB](understand-your-bill.md)
* Дополнительные сведения об [оптимизации расходов на пропускную способность](optimize-cost-throughput.md)
* Дополнительные сведения об [оптимизации расходов на хранилище](optimize-cost-storage.md)
* Дополнительные сведения об [оптимизации затрат на операции чтения и записи](optimize-cost-reads-writes.md).
* Дополнительные сведения об [оптимизации расходов на запросы](optimize-cost-queries.md).

