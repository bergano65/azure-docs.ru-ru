---
title: Перенос данных из Cassandra в API Cassandra Azure Cosmos DB с помощью Блитзз
description: Узнайте, как перенести данные из базы данных Apache Cassandra в Azure Cosmos DB API Cassandra с помощью Блитзз.
author: SnehaGunda
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 08/21/2019
ms.author: sngun
ms.reviewer: sngun
ms.openlocfilehash: 746232a85e326f08d44cf2dbe0a4ae718c7cc312
ms.sourcegitcommit: 6d2a147a7e729f05d65ea4735b880c005f62530f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2019
ms.locfileid: "69984372"
---
# <a name="migrate-data-from-cassandra-to-azure-cosmos-db-cassandra-api-account-using-blitzz"></a>Перенос данных из Cassandra в учетную запись API Cassandra Azure Cosmos DB с помощью Блитзз

API Cassandra в Azure Cosmos DB стали отличным выбором для корпоративных рабочих нагрузок, работающих на Apache Cassandra, по различным причинам: 

* **Отсутствие дополнительных издержек при управлении и мониторинге:** Она устраняет издержки на управление множеством параметров в файлах ОС, ВИРТУАЛЬНОЙ машины Java и YAML и их взаимодействиях.

* **Значительные сокращения затрат:** Вы можете сэкономить затраты с Azure Cosmos DB, включая стоимость виртуальных машин, пропускной способности и применимых лицензий. Кроме того, вам не нужно управлять центрами обработки данных, серверами, хранилищем SSD, сетью и расходами электроэнергии. 

* **Возможность использования существующего кода и средств:** Azure Cosmos DB обеспечивает совместимость на уровне сетевого протокола с существующими пакетами SDK и средствами для Cassandra. Благодаря этой совместимости можно использовать имеющуюся базу кода с API Cassandra для Azure Cosmos DB, внеся простые изменения.

Существует несколько способов миграции рабочих нагрузок базы данных с одной платформы на другую. [Блитзз](https://www.blitzz.io) — это средство, обеспечивающее безопасный и надежный способ выполнения миграции из различных баз данных в Azure Cosmos DB. В этой статье описываются шаги, необходимые для переноса данных из базы данных Apache Cassandra в Azure Cosmos DB API Cassandra с помощью Блитзз.

## <a name="benefits-using-blitzz-for-migration"></a>Преимущества использования Блитзз для миграции

Решение для миграции блитзз следует пошаговому подходу к переносу сложных рабочих нагрузок. Ниже приведены некоторые ключевые аспекты плана миграции нулевого времени простоя Блитзз.

* Она обеспечивает автоматическую миграцию бизнес-логики (таблиц, индексов, представлений) из базы данных Apache Cassandra в Azure Cosmos DB. Создавать схемы вручную не требуется.

* Блитзз предлагает репликацию с большим объемом и параллельной базой данных. Она обеспечивает синхронизацию исходной и целевой платформ во время миграции с помощью методики, именуемой Change-Data-Capture (CDC). С помощью CDC Блитзз непрерывно извлекает поток изменений из базы данных-источника (Apache Cassandra) и применяет его к целевой базе данных (Azure Cosmos DB).

* Это отказоустойчивость и гарантирует ровно одну доставку данных даже во время сбоя оборудования или программного обеспечения в системе.

* Он обеспечивает защиту данных во время передачи с помощью различных методов обеспечения безопасности, таких как SSL, шифрование.

## <a name="steps-to-migrate-data"></a>Шаги для переноса данных

В этом разделе описаны шаги, необходимые для настройки Блитзз и переноса данных из базы данных Apache Cassandra в Azure Cosmos DB.

1. На компьютере, где планируется установить Блитзз репликант, добавьте сертификат безопасности. Этот сертификат необходим Блитзз Репликант для установки SSL-подключения с указанной учетной записью Azure Cosmos DB. Сертификат можно добавить, выполнив следующие действия.

   ```bash
   wget https://cacert.omniroot.com/bc2025.crt
   mv bc2025.crt bc2025.cer
   keytool -keystore $JAVA_HOME/lib/security/cacerts -importcert -alias bc2025ca -file bc2025.cer
   ```

1. Вы можете получить установку Блитзз и двоичные файлы, запросив демонстрацию на [веб-сайте блитзз](https://www.blitzz.io). Кроме того, можно отправить группе [сообщение электронной почты](mailto:success@blitzz.io) .

   ![Загрузка средства блитзз Репликант](./media/cassandra-migrate-cosmos-db-blitzz/blitzz-replicant-download.png)

   ![Файлы Репликант блитзз](./media/cassandra-migrate-cosmos-db-blitzz/replicant-files.png)

1. В окне терминала CLI настройте конфигурацию базы данных источника. Откройте файл конфигурации с помощью **`vi conf/conn/cassandra.yml`** команды и добавьте разделенный запятыми список IP-адресов узлов Cassandra, номер порта, имя пользователя, пароль и другие необходимые сведения. Ниже приведен пример содержимого в файле конфигурации.

   ```bash
   type: CASSANDRA
  
   host: 172.17.0.2
   port: 9042

   username: 'cassandra'
   password: 'cassandra'

   max-connections: 30

   ```

   ![Открыть редактор подключения Cassandra](./media/cassandra-migrate-cosmos-db-blitzz/open-connection-editor-cassandra.png)

   ![Конфигурация подключения Cassandra](./media/cassandra-migrate-cosmos-db-blitzz/cassandra-connection-configuration.png)

   После заполнения сведений о конфигурации сохраните и закройте файл.

1. При необходимости можно настроить файл фильтра базы данных источника. Файл фильтра указывает, какие схемы или таблицы нужно перенести. Откройте файл конфигурации с помощью **`vi filter/cassandra_filter.yml`** команды и введите следующие сведения о конфигурации:

   ```bash

   allow:
   -    schema: “io_blitzz”
   Types: [TABLE]
   ```

   После заполнения сведений о фильтре базы данных сохраните и закройте файл.

1. Далее вы настроите конфигурацию целевой базы данных. Перед определением конфигурации [Создайте учетную запись API Cassandra Azure Cosmos DB](create-cassandra-dotnet.md#create-a-database-account) , а затем создайте пространства ключей и таблицу для хранения перенесенных данных. Так как вы выполняете миграцию из Apache Cassandra в API Cassandra в Azure Cosmos DB, вы можете использовать тот же ключ раздела, который использовался с Apache Cassandra.

1. Перед переносом данных увеличьте пропускную способность контейнера до объема, необходимого для быстрого переноса приложения. Например, можно увеличить пропускную способность до 100000 RUs. Масштабирование пропускной способности перед началом миграции поможет перенести данные за меньшее время.

   ![Масштабирование контейнера Azure Cosmos по всему](./media/cassandra-migrate-cosmos-db-blitzz/scale-throughput.png)

   Уменьшите пропускную способность после завершения миграции. В зависимости от объема хранимых данных и числа получателей, необходимых для каждой операции, можно оценить пропускную способность, необходимую после переноса данных. Дополнительные сведения о том, как оценить требуемый метод RUs, см. в статьях [предоставление пропускной способности для контейнеров и баз данных](set-throughput.md) и [Оценка единиц запросов в секунду с помощью планировщика ресурсов Azure Cosmos DB](estimate-ru-with-capacity-planner.md) .

1. Получите **контактную точку, порт, имя пользователя**и **первичный пароль** учетной записи Azure Cosmos на панели **строка подключения** . Эти значения будут использоваться в файле конфигурации.

1. В окне терминала CLI настройте конфигурацию целевой базы данных. Откройте файл конфигурации с помощью **`vi conf/conn/cosmosdb.yml`** команды и добавьте разделенный запятыми список URI узла, номер порта, имя пользователя, пароль и другие необходимые параметры. В следующем примере показано содержимое файла конфигурации:

   ```bash
   type: COSMOSDB

   host: '<Azure Cosmos account’s Contact point>'
   port: 10350

   username: 'blitzzdemo'
   password: '<Your Azure Cosmos account’s primary password>'

   max-connections: 30
   ```

1. Затем перенесите данные с помощью Блитзз. Вы можете запустить Близз Репликант в режиме **полного** или **моментального снимка** :

   * **Полный режим** — в этом режиме Репликант продолжит работу после миграции и прослушивает любые изменения в исходной системе Apache Cassandra. При обнаружении изменений они реплицируются в целевой учетной записи Azure Cosmos в режиме реального времени.

   * **Режим моментальных снимков** — в этом режиме можно выполнять миграцию схемы и однократную репликацию данных. Репликация в режиме реального времени не поддерживается в этом параметре.

   С помощью двух описанных выше режимов миграция может быть выполнена с нулевым временем простоя. 

1. Чтобы перенести данные из терминала Блитзз Репликант CLI, выполните следующую команду:

   ```bash
   ./bin/replicant full conf/conn/cassandra.yaml conf/conn/cosmosdb.yaml --filter filter/cassandra_filter.yaml --replace-existing
   ```

   В пользовательском интерфейсе Репликант отображается ход выполнения репликации. После завершения миграции схемы и создания моментального снимка ход выполнения показывает 100%. После завершения миграции можно проверить данные в целевой базе данных Azure Cosmos.

   ![Выходные данные миграции данных Cassandra](./media/cassandra-migrate-cosmos-db-blitzz/cassandra-data-migration-output.png)


1. Так как вы использовали полный режим миграции, вы можете выполнять такие операции, как вставка, обновление или удаление данных в исходной базе данных Apache Cassandra. Затем проверьте, что они реплицируются в режиме реального времени в целевой базе данных Azure Cosmos. После миграции убедитесь, что пропускная способность, настроенная для контейнера Azure Cosmos, снижена.

1. Вы можете отключить Репликант любую точку и перезапустить ее с параметром **--Resume** . Репликация возобновляется с момента остановки, не нарушая согласованность данных. Следующая команда показывает, как использовать параметр Resume.

   ```bash
   ./bin/replicant full conf/conn/cassandra.yaml conf/conn/cosmosdb.yaml --filter filter/cassandra_filter.yaml --replace-existing --resume
   ```

Дополнительные сведения о переносе данных в назначение, перенос в режиме реального времени см. в [блитзз Репликант Demo](https://www.youtube.com/watch?v=fsUhF9LUZmM).

## <a name="next-steps"></a>Следующие шаги

* [Обеспечение необходимой пропускной способности для контейнеров и баз данных](set-throughput.md) 
* [Рекомендации по использованию ключа секции](partitioning-overview.md#choose-partitionkey)
* [Оценка единиц запросов в секунду с помощью планировщика ресурсов Azure Cosmos DB](estimate-ru-with-capacity-planner.md)