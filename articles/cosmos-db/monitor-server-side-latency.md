---
title: Мониторинг задержки на стороне сервера для операций в Azure Cosmos DB
description: Узнайте, как отслеживать задержку сервера для операций в учетной записи Azure Cosmos DB или контейнере. Владельцы учетной записи Azure Cosmos DB могут понимать проблемы задержки на стороне сервера с учетными записями Azure Cosmos.
ms.service: cosmos-db
ms.topic: how-to
author: kanshiG
ms.author: govindk
ms.date: 04/07/2020
ms.openlocfilehash: 9c266e42804a12403e446bf024e93fe879497570
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91803268"
---
# <a name="how-to-monitor-the-server-side-latency-for-operations-in-an-azure-cosmos-db-container-or-account"></a>Мониторинг задержки на стороне сервера для операций в контейнере Azure Cosmos DB или учетной записи

Azure Monitor для Azure Cosmos DB предоставляет представление метрик для мониторинга учетной записи и создания панелей мониторинга. Метрики по Azure Cosmos DB собираются по умолчанию, для этого компонента не требуется явно включать или настраивать что-либо. Метрика задержки на стороне сервера используется для просмотра задержки операции на стороне сервера. Azure Cosmos DB предоставляет SLA менее 10 мс для операций чтения и записи точки с прямым подключением. Для операций чтения и записи точки соглашения об уровне обслуживания рассчитываются, как описано в [документе SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db/v1_3/).

Задержка на стороне сервера можно отслеживать, если отображается необычно высокая задержка для операции с точкой, например:

* Операция GET или SET с ключом секции и ИДЕНТИФИКАТОРом в режиме прямого подключения
* Операция чтения или записи или
* Запрос

Чтобы узнать размер возвращаемых данных, можно выполнить поиск в журнале диагностики. Если вы видите постоянную высокую задержку операций запроса, следует найти журнал диагностики для более высокой [пропускной способности или единиц запросов/с](cosmosdb-monitor-resource-logs.md#diagnostic-queries) . Задержка на стороне сервера показывает время, затраченное на серверную инфраструктуру перед возвратом данных клиенту. Важно обратить внимание на эту метрику, чтобы исключить все проблемы с задержкой серверной части.

## <a name="view-the-server-side-latency-metric"></a>Просмотр метрики задержки на стороне сервера

1. Войдите на [портал Azure](https://portal.azure.com/).

1. Выберите **монитор** на панели навигации слева и щелкните **метрики**.

   :::image type="content" source="./media/monitor-server-side-latency/monitor-metrics-blade.png" alt-text="Область метрик в Azure Monitor":::

1. В области **Метрики** щелкните **Выбрать ресурс** и выберите требуемые **подписку** и **группу ресурсов**. В поле **Тип ресурса** выберите **Учетные записи Azure Cosmos DB**, выберите одну из существующих учетных записей Azure Cosmos и нажмите кнопку **Применить**.
   
   :::image type="content" source="./media/monitor-server-side-latency/select-cosmos-db-account.png" alt-text="Область метрик в Azure Monitor":::

1. Затем выберите метрику **задержки на стороне сервера**  в списке доступных метрик. Подробные сведения о всех доступных метриках в списке см. в статье с [перечнем метрик по категориям](monitor-cosmos-db-reference.md). В этом примере мы выбираем **задержку на стороне сервера** и **AVG** в качестве значения статистической обработки. Помимо этих сведений, можно также выбрать **диапазон времени** и **степень детализации времени** для метрик. Вы можете просмотреть метрики максимум за последние 30 дней.  После применения фильтра отображается диаграмма на его основе. Вы видите задержку на стороне сервера в минуту за выбранный период.  

   :::image type="content" source="./media/monitor-server-side-latency/server-side-latency-metric.png" alt-text="Область метрик в Azure Monitor":::

## <a name="filters-for-server-side-latency"></a>Фильтры задержки на стороне сервера

Можно также фильтровать метрики и получать диаграммы, отображаемые конкретными **CollectionName**, **ConnectionMode**, **DatabaseName**, **OperationType**, **Region**и **публикапитипе**. 

Чтобы отфильтровать метрики, выберите **Добавить фильтр** и выберите требуемое свойство, например **публикапитипе** , и выберите значение **SQL**. Добавьте еще один фильтр для **OperationType**. Затем граф отображает задержку на стороне сервера для различных операций за выбранный период. Операции, выполняемые с помощью хранимой процедуры, не регистрируются в журнале, поэтому они недоступны в метрике OperationType.

Метрики **задержки на стороне сервера** для каждой операции отображаются, как показано на следующем рисунке:

:::image type="content" source="./media/monitor-server-side-latency/server-side-latency-filters.png" alt-text="Область метрик в Azure Monitor":::

Метрики также можно сгруппировать с помощью параметра **Применить разделение** .  

## <a name="next-steps"></a>Дальнейшие шаги

* Отслеживайте Azure Cosmos DB данные с помощью [параметров диагностики](cosmosdb-monitor-resource-logs.md) в Azure.
* [Аудит операций Azure Cosmos DB плоскости управления](audit-control-plane-logs.md)
