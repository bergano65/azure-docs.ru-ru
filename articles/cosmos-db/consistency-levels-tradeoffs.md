---
title: Достижение компромисса между доступностью и быстродействием для разных уровней согласованности в Azure Cosmos DB
description: Достижение компромисса между доступностью и быстродействием для разных уровней согласованности в Azure Cosmos DB.
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 07/23/2019
ms.author: rimman
ms.reviewer: sngun
ms.openlocfilehash: 2d80e291b3c054fec92b169c8a216a7189e24b79
ms.sourcegitcommit: 04ec7b5fa7a92a4eb72fca6c6cb617be35d30d0c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/22/2019
ms.locfileid: "68384200"
---
# <a name="consistency-availability-and-performance-tradeoffs"></a>Компромиссы согласованности, доступности и производительности 

Распределенные базы данных, которые полагаются на репликацию для обеспечения высокого уровня доступности, низкой задержки или того и другого, должны быть компромиссными. Это компромиссы между согласованностью чтения и доступностью, задержкой и пропускной способностью.

В Azure Cosmos DB согласованность данных рассматривается как плавный спектр возможных вариантов. Этот подход включает дополнительные возможности помимо двух крайностей в виде строгой и итоговой согласованности. Вы можете выбрать из пяти четко определенных моделей спектра согласованности. Это такие модели (приведены в порядке от сильных к слабым):

- *Строгая*
- *Ограниченное устаревание*
- *Согласованность сеанса*
- *Постоянный префикс*
- *Итоговая*

Каждая модель предоставляет компромиссы по доступности и производительности и обеспечивается комплексными соглашениями об уровне обслуживания.

## <a name="consistency-levels-and-latency"></a>Уровни согласованности и время задержки

Задержка чтения для всех уровней согласованности гарантированно никогда не превышает 10 миллисекунд для 99-го процентиля, что оговаривается Соглашением об уровне обслуживания. Среднее время задержки чтения (50-й процентиль) обычно не превышает 2 миллисекунды. Учетные записи Azure Cosmos, охватывающие несколько регионов и настраиваемые со строгой согласованностью, являются исключением из этой гарантии.

Задержка записи для всех уровней согласованности всегда гарантирована менее 10 миллисекунд на 99-м процентиль. Соглашение об уровне обслуживания хранит задержку записи. Среднее время задержки записи (50-й процентиль) обычно не превышает 5 миллисекунд.

Для учетных записей Azure Cosmos, для которых настроена строгая согласованность с несколькими регионами, задержка записи гарантируется менее чем в два раза больше времени приема-передачи (RTT) между любым из двух самых крайних регионов, плюс 10 миллисекунд на 99-м процентиль.

Точная задержка RTT определяется расстоянием, которое преодолевает сигнал, двигаясь со скоростью света, и топологией сети Azure. Для сетей Azure не предусмотрены Соглашения об уровне обслуживания, определяющие задержки для RTT между любыми двумя регионами Azure. Задержки репликации учетной записи Azure Cosmos отображаются на портале Azure. Вы можете использовать портал Azure (перейдите в колонку метрики), чтобы отслеживать задержки репликации между различными регионами, связанными с вашей учетной записью Azure Cosmos.

## <a name="consistency-levels-and-throughput"></a>Уровни согласованности и пропускная способность

- Для одинакового количества единиц запроса уровни согласованности "Сеансовая", "Постоянный префикс" и "Нестрогая" обеспечивают пропускную способность для операций чтения примерно в два раза выше, чем у уровней согласованности "Строгая" и "Ограниченное устаревание".

- Для этого типа операций записи (вставка, замена, обновление или вставка, удаление и т. д.) пропускная способность одинаковая для всех уровней согласованности.

## <a id="rto"></a>Уровни согласованности и устойчивость данных

В среде глобально распределенной базы данных существует прямая связь между уровнем согласованности и устойчивостью данных при наличии простоя в регионе. При разработке плана обеспечения непрерывности бизнес-процессов нужно понимать, какое максимальное время до полного восстановления приложения после аварийного события допустимо. Время, необходимое для полного восстановления приложения, называется **целевым временем восстановления** (**RTO**). Необходимо также понимать, потерю какого максимального периода последних обновлений данных приложение может допустить при восстановлении после аварийного события. Период времени, в течение которого можно потерять обновления, называется **целевой точкой восстановления** (**RPO**).

В приведенной ниже таблице определяется связь между моделью согласованности и устойчивостью данных при непростом уровне региона. Важно отметить, что в распределенной системе даже при строгой согласованности невозможно иметь распределенную базу данных с RPO и RTO, равными нулю, из-за ограничения теорема. Дополнительные сведения о том, почему, см. [в разделе уровни согласованности в Azure Cosmos DB](consistency-levels.md).

|**Регионы**|**Режим репликации**|**Уровень согласованности**|**RPO**|**RTO**|
|---------|---------|---------|---------|---------|
|1|Подход с одним или несколькими источниками|Любой уровень согласованности|< 240 минут|< 1 неделя|
|>1|Single Master|Сеанс, постоянный префикс, случайный|< 15 минут|< 15 минут|
|>1|Single Master|Ограниченное устаревание|*K*T & |< 15 минут|
|>1|Single Master|Надежный|0|< 15 минут|
|>1|Подход с несколькими источниками|Сеанс, постоянный префикс, случайный|< 15 минут|0|
|>1|Подход с несколькими источниками|Ограниченное устаревание|*K*T & |0|

*K* = число версий *"K"* (т. е. обновлений) элемента.

*T* = интервал времени *"T"* с момента последнего обновления.

## <a name="next-steps"></a>Следующие шаги

Узнайте о глобальном распределении и общих компромиссах согласованности в распределенных системах: Ознакомьтесь со следующими статьями:

- [Consistency Tradeoffs in Modern Distributed Database Systems Design](https://www.computer.org/csdl/magazine/co/2012/02/mco2012020037/13rRUxjyX7k) (Достижение компромиссов согласованности в современных распределенных базах данных)
- [Высокая доступность](high-availability.md)
- [Соглашение об уровне обслуживания для Azure Cosmos DB](https://azure.microsoft.com/support/legal/sla/cosmos-db/v1_2/)
