---
title: Устранение неполадок при использовании эмулятора Azure Cosmos DB
description: Узнайте, как устранять недоступность службы, сертификаты, шифрование и управление версиями при использовании эмулятора Azure Cosmos DB.
ms.service: cosmos-db
ms.topic: troubleshooting
author: markjbrown
ms.author: mjbrown
ms.date: 09/17/2020
ms.custom: contperfq1
ms.openlocfilehash: 83559cc2ab1ca9597cca405333061e53b6f56aa9
ms.sourcegitcommit: 2e9643d74eb9e1357bc7c6b2bca14dbdd9faa436
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "96030753"
---
# <a name="troubleshoot-issues-when-using-the-azure-cosmos-db-emulator"></a>Устранение неполадок при использовании эмулятора Azure Cosmos DB
[!INCLUDE[appliesto-all-apis](includes/appliesto-all-apis.md)]

Эмулятор Azure Cosmos DB предоставляет локальную среду для разработки, которая эмулирует службу Azure Cosmos DB. Воспользуйтесь советами в этой статье, чтобы помочь в устранении неполадок, возникающих при установке или использовании эмулятора Azure Cosmos DB. 

Если установлена новая версия эмулятора и возникли ошибки, убедитесь, что вы сбросили данные. Вы можете сбросить данные, щелкнув правой кнопкой мыши значок эмулятора Azure Cosmos DB в области уведомлений, а затем выбрав команду сбросить данные.... Если эти ошибки не устранены, можно удалить эмулятор и все более старые версии эмулятора, если он найден, удалить *C:\Program files\azure multi Cosmos DB Directory Emulator* и переустановить эмулятор. Инструкции см. в разделе [Удаление локального эмулятора](local-emulator.md#uninstall). Кроме того, если сброс данных не работает, перейдите в `%LOCALAPPDATA%\CosmosDBEmulator` расположение и удалите папку.

## <a name="troubleshoot-corrupted-windows-performance-counters"></a>Устранение неполадок с поврежденными счетчиками производительности Windows

* Если эмулятор Azure Cosmos DB аварийно завершает работу, собирайте файлы дампа из `%LOCALAPPDATA%\CrashDumps` папки, сжимают их и открывайте запрос в службу поддержки из [портал Azure](https://portal.azure.com).

* Если в `Microsoft.Azure.Cosmos.ComputeServiceStartupEntryPoint.exe` возникают сбои, это может означать нарушение состояния счетчиков производительности. Обычно такую проблему удается исправить, выполнив следующую команду из командной строки с правами администратора:

  ```cmd
  lodctr /R
   ```

## <a name="troubleshoot-connectivity-issues"></a>Устранение проблем подключения

* Если возникли проблемы с подключением, [соберите файлы трассировки](#trace-files), сожмите их и создайте запрос в службу поддержки на портале [Azure](https://portal.azure.com).

* При получении сообщения **Служба недоступна** эмулятор может не инициализировать сетевой стек. Проверьте, установлен ли защищенный клиент Pulse или сетевой клиент Juniper, так как драйверы их сетевого фильтра могут вызвать проблему. Удаление драйверов сетевого фильтра сторонних производителей обычно устраняет проблему. Также можно запустить эмулятор с параметром /DisableRIO, который настраивает для сетевого взаимодействия эмулятора использование Winsock. 

* Если вы столкнулись **с "запрещено", запрос "Message" (сообщение ":") выполняется с запрещенным шифрованием в транзитном протоколе или шифром. Установите флажок Учетная запись SSL/TLS минимум разрешенный параметр протокола... "** проблемы с подключением. это может быть вызвано глобальными изменениями в операционной системе (например, предварительная версия сборки 20170) или параметрами браузера, которые включают TLS 1,3 по умолчанию. Подобная ошибка может возникать при использовании пакета SDK для выполнения запроса к эмулятору Cosmos, например **Microsoft.Azure.Documents.Docументклиентексцептион: запрос выполняется с запрещенным шифрованием в транзитном протоколе или шифре. Проверьте минимально допустимый параметр протокола SSL/TLS для учетной записи**. На данном этапе это ожидаемо, так как эмулятор Cosmos принимает и работает только с протоколом TLS 1.2. Рекомендуется изменить параметры и использовать по умолчанию TLS 1,2; Например, в диспетчере IIS перейдите к узлу "сайты"-> "веб-сайты по умолчанию" и найдите "привязки сайта" для порта 8081 и измените их, чтобы отключить TLS 1,3. Аналогичную операцию можно выполнить для веб-браузера с помощью пункта "Параметры".

* Если во время работы эмулятора компьютер переходит в ждущий режим или запускает какие-либо обновления операционной системы, может появиться сообщение **Service is currently unavailable** (Служба сейчас недоступна). Сбросьте данные эмулятора, щелкнув правой кнопкой мыши значок, который отображается в области уведомлений Windows, и выбрав действие **Сбросить данные**.

## <a name="collect-trace-files"></a><a id="trace-files"></a>Сбор файлов трассировки

Для сбора отладочных трассировок выполните следующие команды в командной строке с правами администратора.

1. Перейдите по пути, где установлен эмулятор:

   ```bash
   cd /d "%ProgramFiles%\Azure Cosmos DB Emulator"
   ```

1. Завершите работу эмулятора и просмотрите область уведомлений, чтобы убедиться, что программа была выключена. Выполнение может занять около минуты. Можно также выбрать **выход** в пользовательском интерфейсе эмулятора Azure Cosmos DB.

   ```bash
   Microsoft.Azure.Cosmos.Emulator.exe /shutdown
   ```

1. Начните ведение журнала с помощью следующей команды:

   ```bash
   Microsoft.Azure.Cosmos.Emulator.exe /startwprtraces
   ```

1. Запуск эмулятора

   ```bash
   Microsoft.Azure.Cosmos.Emulator.exe
   ```

1. Воспроизведите проблему. Если обозреватель данных не работает, необходимо подождать, пока браузер не будет открыт в течение нескольких секунд, чтобы перехватить ошибку.

1. Прерывать ведение журнала с помощью следующей команды:

   ```bash
   Microsoft.Azure.Cosmos.Emulator.exe /stopwprtraces
   ```
   
1. Перейдите по `%ProgramFiles%\Azure Cosmos DB Emulator` пути и найдите файл *docdbemulator_000001. ETL* .

1. Создайте запрос в службу поддержки на [портале Azure](https://portal.azure.com) и добавьте ETL-файл вместе с действиями по воспроизведению.

## <a name="next-steps"></a>Следующие шаги

В этой статье вы узнали, как отлаживать проблемы с локальным эмулятором. Теперь можно перейти к следующим статьям:

* [Экспорт Azure Cosmos DB сертификатов эмулятора для использования с приложениями Java, Python и Node.js](local-emulator-export-ssl-certificates.md)
* [Использование параметров командной строки и команд PowerShell для управления эмулятором](emulator-command-line-parameters.md)
