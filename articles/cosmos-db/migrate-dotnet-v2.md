---
title: Перенос приложения для использования пакета SDK для Azure Cosmos DB .NET 2,0 (Microsoft. Azure. Cosmos)
description: Узнайте, как обновить существующее приложение .NET с пакета SDK для версии 1 до пакета SDK .NET v2 для Core (SQL) API.
author: stefArroyo
ms.author: esarroyo
ms.service: cosmos-db
ms.topic: how-to
ms.date: 10/15/2020
ms.openlocfilehash: 88c40452da72ed4ab43d2d7613636136a5b78cfe
ms.sourcegitcommit: 6ab718e1be2767db2605eeebe974ee9e2c07022b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2020
ms.locfileid: "94550109"
---
# <a name="migrate-your-application-to-use-the-azure-cosmos-db-net-sdk-v2"></a>Перенос приложения для использования пакета SDK для Azure Cosmos DB .NET версии 2

> [!IMPORTANT]
> Важно отметить, что версия 3 пакета SDK для .NET в настоящее время доступна, а план перехода с версии v2 на v3 доступен [здесь](migrate-dotnet-v3.md). Дополнительные сведения о Azure Cosmos DB .NET SDK v2 см. в [заметках о выпуске](sql-api-sdk-dotnet.md), в [репозитории .NET GitHub](https://github.com/Azure/azure-cosmos-dotnet-v2), [Советы по повышению производительности](performance-tips.md).NET SDK v2 и [руководство по устранению неполадок](troubleshoot-dot-net-sdk.md).
>

В этой статье описываются некоторые рекомендации по обновлению существующего приложения .NET версии 1 для Azure Cosmos DB API .NET v2 для Core (SQL). Azure Cosmos DB .NET SDK v2 соответствует `Microsoft.Azure.DocumentDB` пространству имен. Сведения, приведенные в этом документе, можно использовать при переносе приложения из любой из следующих Azure Cosmos DB платформ .NET для использования пакета SDK v2 `Microsoft.Azure.Cosmos` :

* Пакет SDK для Azure Cosmos DB .NET Framework v1 для SQL API
* Azure Cosmos DB пакет SDK для .NET Core v1 для API SQL

## <a name="whats-available-in-the-net-v2-sdk"></a>Что доступно в пакете SDK для .NET v2

Пакет SDK для v2 содержит множество улучшений удобства использования и производительности, в том числе:

* Поддержка режима TCP Direct для клиентов, не использующих Windows
* Поддержка записи в нескольких регионах
* Улучшения производительности запросов
* Поддержка геопространственных и геометрических коллекций и индексирования
* Улучшены улучшения для диагностики Direct/TCP-транспорта
* Обновления в стеке прямого TCP-транспорта для сокращения числа установленных подключений
* Улучшения в снижении задержки в RequestTimeout

Большая часть логики повтора и более низкие уровни пакета SDK остаются в значительной степени без изменений.

## <a name="why-migrate-to-the-net-v2-sdk"></a>Зачем переходить на пакет SDK для .NET v2

В дополнение к многочисленным улучшениям производительности новые функции, внесенные в последнюю версию пакета SDK, не будут перенесены в более старые версии.

Кроме того, более старые пакеты SDK будут заменены новыми версиями, а пакет SDK v1 перейдет в [режим обслуживания](sql-api-sdk-dotnet.md). Для лучшего удобства разработки рекомендуется перенести приложение на более позднюю версию пакета SDK.

## <a name="major-changes-from-v1-sdk-to-v2-sdk"></a>Основные изменения в пакете SDK v1 до версии 2

### <a name="direct-mode--tcp"></a>Прямой режим + TCP

Пакет SDK для .NET v2 теперь поддерживает как прямой, так и режим шлюза. Режим Direct поддерживает подключение по протоколу TCP и обеспечивает лучшую производительность, так как он напрямую подключается к серверным репликам с меньшим числом прыжков сети.

Для получения дополнительных сведений ознакомьтесь с [руководством по режимам подключения пакета SDK для SQL Azure Cosmos DB](sql-sdk-connection-modes.md).

### <a name="session-token-formatting"></a>Форматирование токенов сеанса

Пакет SDK v2 больше не использует формат *простого* маркера сеанса, используемый в версии v1, а использует форматирование *вектора* . Формат должен быть преобразован при передаче клиентскому приложению с разными версиями, так как форматы не взаимозаменяемы.

Дополнительные сведения см. [в статье преобразование форматов токенов сеанса в пакет SDK для .NET](how-to-convert-session-token.md).

### <a name="using-the-net-change-feed-processor-sdk"></a>Использование пакета SDK для обработчика веб-канала изменений .NET

Библиотека процессора веб-канала изменений .NET 2.1. x требует `Microsoft.Azure.DocumentDB` 2,0 или более поздней версии.

В библиотеке 2.1. x имеются следующие основные изменения.

* Улучшения стабильности и диагностики
* Улучшенная обработка ошибок и исключений
* Дополнительная поддержка секционированных коллекций аренды
* Расширенные расширения для реализации `ChangeFeedDocument` интерфейса и класса для дополнительной обработки ошибок и трассировки
* Добавлена поддержка использования пользовательского хранилища для сохранения маркеров продолжения на секцию.

Дополнительные сведения см. в [заметках о выпуске](sql-api-sdk-dotnet-changefeed.md)библиотеки обработчика веб-канала изменений.

### <a name="using-the-bulk-executor-library"></a>Использование библиотеки для выполнения операций с массовым исполнителем

В настоящее время библиотека NET выполнителя v2 имеет зависимость от Azure Cosmos DB пакета SDK .NET 2.5.1 или более поздней версии.

Дополнительные сведения см. в статьях [Обзор библиотеки Azure Cosmos DBного выполнителя](bulk-executor-overview.md) и [заметки о выпуске](sql-api-sdk-bulk-executor-dot-net.md)библиотеки .NET NET выполнителя.

## <a name="next-steps"></a>Дальнейшие действия

* [Дополнительные советы по повышению производительности](sql-api-get-started.md) см. в статье Использование Azure Cosmos DB для SQL API версии 2 для оптимизации приложения для достижения максимальной производительности.
* Дополнительные сведения о том, [что можно сделать с помощью пакета SDK v2](sql-api-dotnet-samples.md)