---
title: Пакет SDK, интерфейс API SQL и ресурсы для Python (Azure Cosmos DB)
description: Сведения о пакете SDK и интерфейсах API SQL для Python, включая даты выхода и прекращения использования, а также изменения, внесенные в каждую версию пакета SDK для Azure Cosmos DB на Python.
author: anfeldma-ms
ms.service: cosmos-db
ms.subservice: cosmosdb-sql
ms.devlang: python
ms.topic: reference
ms.date: 05/20/2020
ms.author: anfeldma
ms.custom: tracking-python
ms.openlocfilehash: d68fc7b01e6204cb9ad00ea60e413c73856d758e
ms.sourcegitcommit: 8def3249f2c216d7b9d96b154eb096640221b6b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/03/2020
ms.locfileid: "87542452"
---
# <a name="azure-cosmos-db-python-sdk-for-sql-api-release-notes-and-resources"></a>Пакет SDK для Azure Cosmos DB на Python для API SQL. Заметки о выпуске и материалы

> [!div class="op_single_selector"]
> * [Пакет SDK версии 3 для .NET](sql-api-sdk-dotnet-standard.md)
> * [Пакет SDK для .NET версии 2](sql-api-sdk-dotnet.md)
> * [Пакет SDK для .NET Core версии 2](sql-api-sdk-dotnet-core.md)
> * [Пакет SDK для веб-канала изменений .NET версии 2](sql-api-sdk-dotnet-changefeed.md)
> * [Node.js](sql-api-sdk-node.md)
> * [Пакет SDK для Java версии 4](sql-api-sdk-java-v4.md)
> * [Пакет SDK для Async Java версии 2](sql-api-sdk-async-java.md)
> * [Пакет SDK для Sync Java версии 2](sql-api-sdk-java.md)
> * [Python](sql-api-sdk-python.md)
> * [REST](/rest/api/cosmos-db/)
> * [Поставщик ресурсов REST](/rest/api/cosmos-db-resource-provider/)
> * [SQL](sql-api-query-reference.md)
> * [Групповой исполнитель — .NET v2](sql-api-sdk-bulk-executor-dot-net.md)
> * [Исполнитель массовых операций — Java](sql-api-sdk-bulk-executor-java.md)

| |  |
|---|---|
|**Скачать пакет SDK**|[PyPI](https://pypi.org/project/azure-cosmos)|
|**Документация по API**|[Справочная документация по API Python](https://docs.microsoft.com/python/api/azure-cosmos/?view=azure-python)|
|**Инструкции по установке пакета SDK**|[Инструкции по установке пакета SDK для Python](https://github.com/Azure/azure-sdk-for-python/tree/master/sdk/cosmos/azure-cosmos)|
|**Начало работы**|[Приступая к работе с пакетом SDK для Python](create-sql-api-python.md)|
|**Текущая поддерживаемая платформа**|[Python 2.7](https://www.python.org/downloads/) и [Python 3.5.3+](https://www.python.org/downloads/)|

## <a name="release-history"></a>История выпусков

### <a name="400"></a>4.0.0

* Стабильный выпуск.
* В конвейер добавлен HttpLoggingPolicy, чтобы включить передачу в пользовательском средстве ведения журнала для заголовков запросов и ответов.

### <a name="400b6"></a>4.0.0b6

* Исправлена ошибка в synchronized_request для API мультимедиа.
* MediaReadMode и MediaRequestTimeout удалены из ConnectionPolicy, так как запросы мультимедиа не поддерживаются.

### <a name="400b5"></a>4.0.0b5

* Модуль azure.cosmos.errors устарел и заменен azure.cosmos.exceptions.
* Параметры условия доступа (`access_condition`, `if_match`, `if_none_match`) устарели и заменены отдельными параметрами `match_condition` и `etag`.
* Исправлена ошибка в поставщике схемы маршрутизации.
* Добавлена поддержка запросов Distinct, Offset и Limit.
* Контекст выполнения запроса документа по умолчанию теперь используется для

  * запросов ChangeFeed;
  * запросов с одним разделом (partitionkey, partitionKeyRangeId есть в параметрах);
  * запросов, не относящихся к документам;

* ошибок из статистических выражений в нескольких разделах, когда включение запросов по нескольким разделам установлено на true, но ключевое слово value отсутствует;
* попаданий в конечную точку плана запроса для других сценариев, чтобы получить план запроса.
* Добавлена поддержка `__repr__` объектов сущностей Cosmos.
* Обновлена документация.

### <a name="400b4"></a>4.0.0b4

* Добавлена поддержка аргумента ключевого слова `timeout` для всех операций, чтобы указать абсолютный тайм-аут в секундах, в течение которого операция должна быть завершена. Если значение времени ожидания превышено, будет вызвано `azure.cosmos.errors.CosmosClientTimeoutError`.

* Добавлен новый `ConnectionRetryPolicy` для управления поведением повторных попыток во время ошибок подключения HTTP.

* Добавлены новые аргументы конструктора и ключевые слова конфигурации для каждой операции:

  * `retry_total` — максимальное количество повторных попыток.
  * `retry_backoff_max` — максимальное время ожидания повтора в секундах.
  * `retry_fixed_interval` — фиксированный интервал попытки (в миллисекундах).
  * `retry_read` — максимальное число повторных попыток чтения сокетов.
  * `retry_connect` — максимальное число повторных попыток при ошибке соединения.
  * `retry_status` — максимальное число повторных попыток при выдаче кодов состояния ошибки.
  * `retry_on_status_codes` — список конкретных кодов состояния, требующих повторной попытки.
  * `retry_backoff_factor` — коэффициент для вычисления времени ожидания между повторными попытками.

### <a name="400b3"></a>4.0.0b3

* Функции `create_database_if_not_exists()` и `create_container_if_not_exists` добавлены к CosmosClient и базе данных, соответственно.

### <a name="400b2"></a>4.0.0b2

* Версия 4.0.0b2 — это наша вторая попытка создания клиентской библиотеки, удовлетворяющей рекомендациям по языку Python.

**Критические изменения**

* Клиентское соединение было адаптировано для использования конвейера HTTP, определенного в `azure.core.pipeline`.

* Теперь интерактивные объекты переименованы как прокси-серверы. В том числе:

  * `Database` -> `DatabaseProxy`
  * `User` -> `UserProxy`
  * `Container` -> `ContainerProxy`
  * `Scripts` -> `ScriptsProxy`

* Конструктор `CosmosClient` обновлен.

  * Параметр `auth` был переименован в `credential` и теперь будет принимать тип проверки подлинности напрямую. Это означает, что ему можно передать значение главного ключа, словарь маркеров ресурсов или список разрешений. Однако старый формат словаря по-прежнему поддерживается.

  * Параметр `connection_policy` был создан как параметр только для ключевых слов, и, хотя он по-прежнему поддерживается, каждый из отдельных атрибутов политики теперь можно передать в виде явных аргументов ключевого слова:

    * `request_timeout`
    * `media_request_timeout`
    * `connection_mode`
    * `media_read_mode`
    * `proxy_config`
    * `enable_endpoint_discovery`
    * `preferred_locations`
    * `multiple_write_locations`

* В `CosmosClient` добавлен новый конструктор, позволяющий создание с помощью строки подключения, полученной из портала Azure.

* Некоторые `read_all` операции были переименованы в операции `list`:

  * `CosmosClient.read_all_databases` -> `CosmosClient.list_databases`
  * `Container.read_all_conflicts` -> `ContainerProxy.list_conflicts`
  * `Database.read_all_containers` -> `DatabaseProxy.list_containers`
  * `Database.read_all_users` -> `DatabaseProxy.list_users`
  * `User.read_all_permissions` -> `UserProxy.list_permissions`

* Все операции, принимающие параметры `request_options` или `feed_options`, были перемещены в параметры только для ключевых слов. Кроме того, хотя эти словари параметров по-прежнему поддерживаются, каждый из отдельных параметров в словаре теперь поддерживается как явные аргументы ключевого слова.

* Иерархия ошибок теперь наследуется от `azure.core.AzureError` :

  * `HTTPFailure` был переименован в `CosmosHttpResponseError`.
  * `JSONParseFailure` был удален и заменен объектом `azure.core.DecodeError`
  * Добавлены дополнительные ошибки для конкретных кодов ответов:
    * `CosmosResourceNotFoundError` для состояния 404
    * `CosmosResourceExistsError` для состояния 409
    * `CosmosAccessConditionFailedError` для состояния 412

* `CosmosClient` теперь можно запустить в диспетчере контекста для управления закрытием клиентского соединения.

* Итерируемые ответы (например, ответы на запросы и ответы списка) теперь имеют тип `azure.core.paging.ItemPaged`. Метод `fetch_next_block` был заменен дополнительным итератором, доступ к которому осуществляется методом `by_page`.

### <a name="400b1"></a>4.0.0b1

Версия 4.0.0b1 — это первый предварительный результат наших усилий по созданию удобной для пользователя клиентской библиотеки, соответствующей рекомендациям по языку Python. Дополнительные сведения об этом и предварительных версиях других библиотек Azure SDK см. на https://aka.ms/azure-sdk-preview1-python.

**Критические изменения: новый дизайн API**

* Операции теперь ограничены определенным клиентом:

  * `CosmosClient`: Этот клиент обрабатывает операции на уровне учетной записи. Сюда входят управление свойствами службы и вывод списка баз данных в учетной записи.
  * `Database`: Этот клиент обрабатывает операции уровня базы данных. Сюда входят создание и удаление контейнеров, пользователей и хранимых процедур. Доступ к нему можно получить из экземпляра cosmosClient по имени.
  * `Container`: Этот клиент обрабатывает операции для определенного контейнера. Сюда входят запросы и вставка элементов, а также управление свойствами.
  * `User`: Этот клиент обрабатывает операции для определенного пользователя. Сюда входят добавление и удаление разрешений, а также управление свойствами пользователей.

    Доступ к этим клиентам можно получить, переходя по иерархии клиентов с помощью метода `get_<child>_client`. Полные сведения о новом API см. в [справочной документации](https://aka.ms/azsdk-python-cosmos-ref).

* Доступ к клиентам осуществляется по их имени, а не по идентификатору. Нет необходимости объединять строки для создания ссылок.

* Больше нет необходимости импортировать типы и методы из отдельных модулей. Контактная зона общедоступного API доступна непосредственно в пакете `azure.cosmos`.

* Отдельные свойства запроса могут предоставляться как аргументы ключевого слова, вместо создания отдельных экземпляров `RequestOptions`.

### <a name="302"></a>3.0.2

* Добавлена поддержка типа данных MultiPolygon.
* Исправление ошибки в политике повтора чтения сеанса.
* Исправление ошибки неверного заполнения при декодировании строк base 64.

### <a name="301"></a>3.0.1

* Исправление ошибки в LocationCache.
* Исправление ошибки в логике повторных попыток конечной точки.
* Исправленная документация

### <a name="300"></a>3.0.0

* Добавлена поддержка для операций записи в нескольких регионах.
* Изменение имен.
  * DocumentClient переименован в CosmosClient.
  * Коллекция в контейнер.
  * Документ в элемент.
  * Имя пакета изменено на "azure-cosmos".
  * Пространство имен изменено на "azure.cosmos".

### <a name="233"></a>2.3.3

* Добавлена поддержка прокси-сервера.
* Добавлена поддержка чтения канала изменений.
* Добавлена поддержка заголовков квот по умолчанию для коллекции.
* Устранена проблема с токенами больших сеансов.
* Устранены проблемы с API ReadMedia.
* Устранена проблема в кэше диапазона ключей секций.

### <a name="232"></a>2.3.2

* Добавлена поддержка для повторных попыток по умолчанию при проблемах с подключением.

### <a name="231"></a>2.3.1

* Обновленная документация для Azure DB Cosmos вместо Azure DocumentDB.

### <a name="230"></a>2.3.0

* Для этой версии пакета SDK требуется последняя версия эмулятора Azure Cosmos DB. Ее можно скачать по адресу https://aka.ms/cosmosdb-emulator.

### <a name="221"></a>2.2.1

* Исправление ошибки для агрегатного словаря.
* Исправление ошибки для обрезки символа косой черты в ссылке на ресурс.
* Тесты для кодировки Юникод.

### <a name="220"></a>2.2.0

* Добавлена поддержка использования единиц запроса в минуту.
* Добавлена поддержка нового уровня согласованности с именем ConsistentPrefix.

### <a name="210"></a>2.1.0

* Добавлена поддержка статистических запросов (COUNT, MIN, MAX, SUM и AVG).
* Добавлена возможность отключения проверки SSL при работе с эмулятором DocumentDB.
* Удалено ограничение, согласно которому нужно использовать модуль зависимых запросов только версии 2.10.0.
* Минимальная пропускная способность секционированных коллекций снижена с 10 100 ЕЗ/с до 2500 ЕЗ/с.
* Добавлена поддержка включения ведения журнала сценариев во время выполнения хранимой процедуры.
* В этом выпуске версия REST API уменьшена до 2017-01-19.

### <a name="201"></a>2.0.1

* Внесены редакторские правки в комментарии к документации.

### <a name="200"></a>2.0.0

* Добавлена поддержка Python 3.5.
* Добавлена поддержка пулов подключений с использованием модуля запросов.
* Добавлена поддержка согласованности сеанса.
* Добавлена поддержка запросов TOP и ORDERBY для секционированных коллекций.

### <a name="190"></a>1.9.0

* Добавлена поддержка политики повтора для отрегулированных запросов. (Отрегулированные запросы порождают исключение слишком высокой частоты запросов с кодом ошибки 429.) По умолчанию при обнаружении кода ошибки 429 DocumentDB повторяет запрос девять раз, используя интервал retryAfter в заголовке ответа.
  Фиксированный интервал повтора теперь можно задать как часть свойства RetryOptions объекта ConnectionPolicy, если требуется игнорировать интервал retryAfter, возвращаемый сервером между повторными попытками.
  Теперь DocumentDB ожидает до 30 секунд, пока запрос регулируется (независимо от количества повторных попыток), и возвращает ответ с кодом ошибки 429.
  Этот интервал также можно переопределить в свойстве RetryOptions объекта ConnectionPolicy.

* Теперь DocumentDB возвращает x-ms-throttle-retry-count и x-ms-throttle-retry-wait-time-ms в заголовке ответа на каждый запрос, чтобы обозначить количество повторных попыток при регулировании и совокупное время ожидания запроса между повторами.

* Удален класс RetryPolicy и соответствующее свойство (retry_policy), предоставляемое в классе document_client. Вместо них добавлен класс RetryOptions, предоставляющий свойство RetryOptions класса ConnectionPolicy, с помощью которого можно переопределить некоторые параметры повторных попыток по умолчанию.

### <a name="180"></a>1.8.0

* Добавлена поддержка геореплицированных учетных записей базы данных.
* Исправления тестов для перемещения глобального узла и masterKey в отдельные тестовые классы.

### <a name="170"></a>1.7.0

* Добавлена поддержка функции срока жизни для документов.

### <a name="161"></a>1.6.1

* Исправления ошибок, связанных с секционированием на стороне сервера, которые позволяют использовать специальные знаки в пути partitionkey.

### <a name="160"></a>1.6.0

* Добавлена поддержка функции секционированных коллекций на стороне сервера.

### <a name="150"></a>1.5.0

* В пакет SDK добавлена платформа сегментирования на стороне клиента. Реализованы классы HashPartionResolver и RangePartitionResolver.

### <a name="142"></a>1.4.2

* Реализована операция Upsert. Для поддержки функции Upsert добавлены новые методы UpsertXXX.
* Реализована маршрутизация на основе идентификатора. Отсутствуют изменения общего API-интерфейса. Все изменения касаются внутреннего интерфейса.

### <a name="130"></a>1.3.0

* Пропущен номер выпуска для согласованности номера версии с другими пакетами SDK.

### <a name="120"></a>1.2.0

* Поддержка геопространственного индекса.
* Проверка свойств идентификатора для всех ресурсов. Идентификаторы ресурсов не могут содержать знаки `?, /, #, \\` или заканчиваться пробелом.
* Добавлен новый заголовок "ход выполнения преобразования индекса" в ResourceResponse.

### <a name="110"></a>1.1.0

* Реализована политика индексации версии 2.

### <a name="101"></a>1.0.1

* Добавлена поддержка прокси-подключения.

## <a name="release--retirement-dates"></a>Даты выпуска и вывода из эксплуатации

Корпорация Майкрософт отправляет уведомление минимум за **12 месяцев** до вывода пакета SDK из эксплуатации, чтобы обеспечить более плавный переход на новую или поддерживаемую версию. Новые функции, возможности и оптимизации добавляются только в текущую версию пакета SDK, поэтому рекомендуется как можно раньше обновлять пакет SDK до последней версии.

> [!WARNING]
> После 31 августа 2022 Azure Cosmos DB больше не будет устранять ошибки, добавить новые функции и предоставить поддержку версий 1. x или 2. x пакета SDK для Python Azure Cosmos DB для SQL API. Если вы предпочитаете не выполнять обновление, запросы, отправленные с версии 1. x и 2. x пакета SDK, продолжат обслуживаться службой Azure Cosmos DB.

| Версия | Дата выпуска | Дата вывода |
| --- | --- | --- |
| [4.0.0](#400) |20 мая 2020 г. |--- |
| [3.0.2](#302) |15 ноября 2018 г. |--- |
| [3.0.1](#301) |04 октября 2018 г. |--- |
| [2.3.3](#233) |08 сентября 2018 г. |30 августа 2020 г. |
| [2.3.2](#232) |8 мая 2018 г. |30 августа 2020 г. |
| [2.3.1](#231) |21 декабря 2017 г. |30 августа 2020 г. |
| [2.3.0](#230) |10 ноября 2017 г. |30 августа 2020 г. |
| [2.2.1](#221) |29 сентября 2017 г. |30 августа 2020 г. |
| [2.2.0](#220) |10 мая 2017 г. |30 августа 2020 г. |
| [2.1.0](#210) |1 мая 2017 г. |30 августа 2020 г. |
| [2.0.1](#201) |30 октября 2016 г. |30 августа 2020 г. |
| [2.0.0](#200) |29 сентября 2016 г. |30 августа 2020 г. |
| [1.9.0](#190) |7 июля 2016 г. |30 августа 2020 г. |
| [1.8.0](#180) |14 июня 2016 г. |30 августа 2020 г. |
| [1.7.0](#170) |26 апреля 2016 г. |30 августа 2020 г. |
| [1.6.1](#161) |8 апреля 2016 г. |30 августа 2020 г. |
| [1.6.0](#160) |29 марта 2016 г. |30 августа 2020 г. |
| [1.5.0](#150) |3 января 2016 г. |30 августа 2020 г. |
| [1.4.2](#142) |6 октября 2015 г. |30 августа 2020 г. |
| 1.4.1 |6 октября 2015 г. |30 августа 2020 г. |
| [1.2.0](#120) |6 августа 2015 г. |30 августа 2020 г. |
| [1.1.0](#110) |9 июля 2015 г. |30 августа 2020 г. |
| [1.0.1](#101) |25 мая 2015 г. |30 августа 2020 г. |
| 1.0.0 |7 апреля 2015 г. |30 августа 2020 г. |
| 0.9.4-prelease |14 января 2015 г. |29 февраля 2016 г. |
| 0.9.3-prelease |9 декабря 2014 г. |29 февраля 2016 г. |
| 0.9.2-prelease |25 ноября 2014 г. |29 февраля 2016 г. |
| 0.9.1-prelease |23 сентября 2014 г. |29 февраля 2016 г. |
| 0.9.0-prelease |21 августа 2014 г. |29 февраля 2016 г. |

## <a name="faq"></a>ВОПРОСЫ И ОТВЕТЫ

[!INCLUDE [cosmos-db-sdk-faq](../../includes/cosmos-db-sdk-faq.md)]

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о Cosmos DB см. на странице службы [Microsoft Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/). 
