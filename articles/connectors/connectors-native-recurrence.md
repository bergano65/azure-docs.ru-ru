---
title: Планирование повторяющихся задач и рабочих процессов
description: Планирование и выполнение повторяющихся автоматизированных задач и рабочих процессов с помощью триггера повторения в Azure Logic Apps
services: logic-apps
ms.suite: integration
ms.reviewer: deli, klam, logicappspm
ms.topic: conceptual
ms.date: 03/25/2020
ms.openlocfilehash: 47bb4e4cc4902168631fa67f186d0b3259c94328
ms.sourcegitcommit: ac4a365a6c6ffa6b6a5fbca1b8f17fde87b4c05e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2020
ms.locfileid: "83004668"
---
# <a name="create-schedule-and-run-recurring-tasks-and-workflows-with-the-recurrence-trigger-in-azure-logic-apps"></a>Создание, планирование и выполнение повторяющихся задач и рабочих процессов с помощью триггера повторения в Azure Logic Apps

Чтобы регулярно запускать задачи, процессы или задания по определенному расписанию, можно запустить рабочий процесс приложения логики с помощью встроенного триггера **повторения** . Можно задать дату и время, а также часовой пояс для запуска рабочего процесса и повторение для повторения этого рабочего процесса. Если по какой бы то ни было причине повторения не будет, этот триггер продолжит повторяться в следующий запланированный интервал. Дополнительные сведения о встроенных триггерах и действиях расписания см. в разделе [планирование и запуск повторяющихся автоматизированных, задач и рабочих процессов с Azure Logic Apps](../logic-apps/concepts-schedule-automated-recurring-tasks-workflows.md).

Ниже приведены некоторые закономерности, которые поддерживает этот триггер, а также более сложные повторения и комплексные расписания.

* Запустить немедленно и повторять каждые *n* часов, минут, ч, дней, недель или месяцев.

* Начните с определенной даты и времени, затем выполните и повторите каждые *n* секунд, минут, часов, дней, недель или месяцев.

* Запуск и повторение один или несколько раз каждый день, например в 8:00 или 17:00.

* Запуск и повторение каждую неделю, но только в определенные дни, например в субботу и воскресенье.

* Запуск и повторение каждую неделю, но только в определенные дни и время, например с понедельника по пятницу с 8:00 до 17:00.

Различия между этим триггером и триггером скользящего окна или дополнительные сведения о расписании повторяющихся рабочих процессов см. [в разделе Планирование и выполнение повторяющихся автоматизированных задач, процессов и рабочих процессов с Azure Logic Apps](../logic-apps/concepts-schedule-automated-recurring-tasks-workflows.md).

> [!TIP]
> Если вы хотите активировать приложение логики и запустить его только один раз в будущем, см. статью [выполнение заданий только один раз](../logic-apps/concepts-schedule-automated-recurring-tasks-workflows.md#run-once).

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас нет ее, вы можете [зарегистрироваться для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/).

* Основные сведения о [Logic Apps](../logic-apps/logic-apps-overview.md). Если вы не знакомы с Logic Apps, Узнайте, [как создать свое первое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

## <a name="add-recurrence-trigger"></a>Добавить триггер повторения

1. Войдите на [портал Azure](https://portal.azure.com). Создание пустого приложения логики.

1. После появления конструктора приложений логики в поле поиска введите `recurrence` фильтр. В списке триггеры выберите этот триггер в качестве первого шага в рабочем процессе приложения логики: **повторение**

   ![Выбор триггера "повторение"](./media/connectors-native-recurrence/add-recurrence-trigger.png)

1. Задайте интервал повторения и единицу времени. В этом примере задайте запуск рабочего процесса каждый день.

   ![Установка интервала и частоты](./media/connectors-native-recurrence/recurrence-trigger-details.png)

   | Свойство | Имя JSON | Обязательно | Тип | Описание |
   |----------|-----------|----------|------|-------------|
   | **Пределах** | `interval` | Да | Целое число | Положительное целое число, которое описывает, как часто выполняется рабочий процесс с учетом заданной частоты. Ниже приведены минимальный и максимальный интервалы. <p>— Месяц: 1–16 месяцев; <br>— Неделя: 1-71 недель <br>— День: 1–500 дней; <br>— Час: 1–12 000 часов; <br>— Минута: 1–72 000 минут; <br>— Секунда: 1–9 999 999 секунд.<p>Например, если интервал равен 6, а значение частоты — "Месяц", то повтор будет происходить каждые 6 месяцев. |
   | **Частота** | `frequency` | Да | Строка | Единица времени для повторения: **Секунда**, **Минута**, **Час**, **День**, **Неделя** или **Месяц**. |
   ||||||

   > [!IMPORTANT]
   > Если повторы не указывают дополнительные параметры планирования, будущие повторения основываются на времени последнего выполнения.
   > Время начала этих повторений может отменяться из-за таких факторов, как задержка во время вызовов хранилища. Чтобы убедиться, что приложение логики не пропустило повторение, особенно если частота указана в днях или дольше, используйте один из следующих вариантов.
   > 
   > * Укажите время начала повторения.
   > 
   > * Укажите часы и минуты, в которые следует запускать повторение, с помощью в **эти часы** и **в** свойствах минут.
   > 
   > * Используйте [триггер скользящего окна](../connectors/connectors-native-sliding-window.md), а не триггер повторения.

1. Чтобы задать дополнительные параметры планирования, откройте список **Добавить новый параметр** . Все выбранные параметры отображаются в триггере после выбора.

   ![Расширенные параметры планирования](./media/connectors-native-recurrence/recurrence-trigger-more-options-details.png)

   | Свойство | Имя JSON | Обязательно | Тип | Описание |
   |----------|-----------|----------|------|-------------|
   | **Часовой пояс** | `timeZone` | нет | Строка | Применяется только при указании времени начала, так как этот триггер не принимает [смещение от UTC](https://en.wikipedia.org/wiki/UTC_offset). Выберите часовой пояс, который необходимо применить. |
   | **Время начала** | `startTime` | нет | Строка | Укажите дату и время начала в следующем формате: <p>ГГГГ-ММ-ДДTчч:мм:сс, если выбран часовой пояс <p>-или- <p>ГГГГ-ММ-ДДTчч:мм:ссZ, если часовой пояс не выбран. <p>Например, если вы хотите 18 сентября 2020 в 2:00 PM, укажите "2020-09-18T14:00:00" и выберите часовой пояс, например тихоокеанское время (зима). Или укажите "2020-09-18T14:00:00Z" без часового пояса. <p>**Примечание.** Время начала не может превышать 49 лет в будущем. оно должно соответствовать [спецификации даты и времени ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations) в [формате даты и времени](https://en.wikipedia.org/wiki/Coordinated_Universal_Time)в формате UTC, но без [смещения в формате UTC](https://en.wikipedia.org/wiki/UTC_offset). Если вы не выберите часовой пояс, то необходимо в конце добавить букву Z без пробелов. Эта буква Z ссылается на соответствующее [судовое время](https://en.wikipedia.org/wiki/Nautical_time). <p>В простых расписаниях время начала определяет первый случай выполнения задания, а в сложных расписаниях триггер срабатывает не раньше, чем наступит время начала. [*Как можно использовать дату и время начала?*](../logic-apps/concepts-schedule-automated-recurring-tasks-workflows.md#start-time) |
   | **В эти дни** | `weekDays` | нет | Строка или массив строк | Если вы выбрали значение "Неделя", то можно выбрать один или несколько дней. В эти дни будет запускаться рабочий процесс: **Понедельник**, **Вторник**, **Среда**, **Четверг**, **Пятница**, **Суббота** и **Воскресенье**. |
   | **В эти часы** | `hours` | нет | Целое число или массив целых чисел | При выборе значения "день" или "Неделя" можно выбрать одно или несколько целых чисел от 0 до 23 в качестве часов дня для запуска рабочего процесса. <p><p>Например, если указать "10", "12" и "14", вы получаете 10 AM, 12 РМ и 2 PM в часы дня, но минуты дня рассчитываются на основе времени начала повторения. Чтобы задать определенные минуты дня, например 10:00 AM, 12:00 PM и 2:00 PM, укажите эти значения с помощью свойства **в минутах** . |
   | **В эти минуты** | `minutes` | нет | Целое число или массив целых чисел | Если вы выбрали значение "День" или "Неделя", то можно выбрать одно или несколько целых чисел от 0 до 59. В эти минуты часа будет запускаться рабочий процесс. <p>Например, если указать 30 минут и использовать предыдущий пример для часов, то вы получите 10:30, 12:30 и 14:30. |
   |||||

   Например, предположим, что сегодня это пятница, 4 сентября 2020. Следующий триггер повторения не срабатывает *раньше* , чем дата и время начала, то есть Пятница, 18 сентября 2020 в 8:00 AM тихоокеанскому времени. Тем не менее для расписания повторения заданы значения 10:30, 12:30 и 14:30 только по понедельникам. Поэтому при первом срабатывании триггера и создании экземпляра рабочего процесса приложения логики в понедельник в 10:30 AM. Дополнительные сведения о времени начала см. в этих [примерах](../logic-apps/concepts-schedule-automated-recurring-tasks-workflows.md#start-time).

   Последующие запуски будут выполняться в 12:30 и 14:30 в тот же день. Каждое повторение создает собственный экземпляр рабочего процесса. После этого весь этот процесс повторяется снова в следующий понедельник. [*Какие еще существуют примеры повторений?*](../logic-apps/concepts-schedule-automated-recurring-tasks-workflows.md#example-recurrences)

   ![Расширенный пример планирования](./media/connectors-native-recurrence/recurrence-trigger-advanced-schedule-options.png)

   > [!NOTE]
   > Триггер отображает предварительную версию определенного повторения, только если в качестве частоты установлено значение "День" или "Неделя".

1. Теперь создайте оставшийся рабочий процесс с другими действиями. Дополнительные действия, которые можно добавить, см. в разделе [соединители для Azure Logic Apps](../connectors/apis-list.md).

## <a name="workflow-definition---recurrence"></a>Определение рабочего процесса — повторение

В базовом определении рабочего процесса приложения логики, использующем JSON, можно просмотреть [определение триггера повторения](../logic-apps/logic-apps-workflow-actions-triggers.md#recurrence-trigger) с выбранными параметрами. Чтобы просмотреть это определение, на панели инструментов конструктора выберите **представление кода**. Чтобы вернуться к конструктору, выберите панель инструментов конструктора, **конструктор**.

В этом примере показано, как определение триггера повторения может выглядеть в базовом определении рабочего процесса:

``` json
"triggers": {
   "Recurrence": {
      "type": "Recurrence",
      "recurrence": {
         "frequency": "Week",
         "interval": 1,
         "schedule": {
            "hours": [
               10,
               12,
               14
            ],
            "minutes": [
               30
            ],
            "weekDays": [
               "Monday"
            ]
         },
         "startTime": "2020-09-07T14:00:00Z",
         "timeZone": "Pacific Standard Time"
      }
   }
}
```

## <a name="next-steps"></a>Дальнейшие действия

* [Приостановка рабочих процессов с отложенными действиями](../connectors/connectors-native-delay.md)
* [Соединители для Logic Apps](../connectors/apis-list.md)
