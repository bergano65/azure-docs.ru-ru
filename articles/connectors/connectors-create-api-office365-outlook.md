---
title: Интеграция с Office 365 Outlook
description: Автоматизируйте задачи и рабочие процессы, управляющие электронной почтой, контактами и календарями в Office 365 Outlook с помощью Azure Logic Apps
services: logic-apps
ms.suite: integration
ms.reviewer: logicappspm
ms.topic: article
ms.date: 11/13/2020
tags: connectors
ms.openlocfilehash: 9caf69a7f78c7872f0a5f8a2ed07bdc749a29023
ms.sourcegitcommit: c157b830430f9937a7fa7a3a6666dcb66caa338b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "94683001"
---
# <a name="manage-email-contacts-and-calendars-in-office-365-outlook-by-using-azure-logic-apps"></a>Управление сообщениями электронной почты, контактами и календарями в Office 365 Outlook с помощью Azure Logic Apps

С помощью [Azure Logic Apps](../logic-apps/logic-apps-overview.md) и [соединителя Office 365 Outlook](/connectors/office365connector/)можно создавать автоматизированные задачи и рабочие процессы, которые управляют рабочей или учебной учетной записью, создавая приложения логики. Например, можно автоматизировать следующие задачи.

* Получение, отправка и ответ на сообщение электронной почты.
* Запланируйте собрания в календаре.
* Добавление и изменение контактов.

Можно использовать любой триггер для запуска рабочего процесса, например, когда приходит новое сообщение электронной почты, когда обновляется элемент календаря или когда событие происходит в службе различий, например Salesforce. Вы можете использовать действия, которые отвечают на событие триггера, например отправить сообщение электронной почты или создать новое событие календаря.

## <a name="prerequisites"></a>Предварительные требования

* Учетная запись Outlook, в которой вы входите с помощью [рабочей или учебной учетной записи](https://www.office.com/). Если у вас есть @outlook.com @hotmail.com учетная запись или, используйте [соединитель Outlook.com](../connectors/connectors-create-api-outlook.md) . Чтобы подключиться к Outlook с другой учетной записью пользователя, например учетной записью службы, см. раздел [подключение с использованием других](#connect-using-other-accounts)учетных записей.

* Учетная запись и подписка Azure. Если у вас еще нет подписки Azure, [зарегистрируйтесь для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).

* Приложение логики, к которому требуется получить доступ к учетной записи Outlook. Чтобы запустить рабочий процесс с помощью триггера Outlook Office 365, необходимо иметь [пустое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md). Чтобы добавить в рабочий процесс действие Office 365 Outlook, приложение логики должно уже иметь триггер.

## <a name="add-a-trigger"></a>Добавление триггера

[Триггер](../logic-apps/logic-apps-overview.md#logic-app-concepts) — это событие, которое запускает рабочий процесс в приложении логики. В этом примере приложение логики использует триггер опроса, который проверяет наличие обновленного события календаря в учетной записи электронной почты на основе указанного интервала и частоты.

1. В [портал Azure](https://portal.azure.com)откройте пустое приложение логики в конструкторе приложений логики.

1. В поле поиска введите `office 365 outlook` в качестве фильтра. Этот пример выбирает **время начала предстоящего события в ближайшее** время.
   
   ![Выберите триггер, чтобы запустить приложение логики](./media/connectors-create-api-office365-outlook/office365-trigger.png)

1. Если у вас нет активного подключения к учетной записи Outlook, вам будет предложено выполнить вход и создать подключение. Чтобы подключиться к Outlook с другой учетной записью пользователя, например учетной записью службы, см. раздел [подключение с использованием других](#connect-using-other-accounts)учетных записей. В противном случае укажите сведения о свойствах триггера.

   > [!NOTE]
   > Срок действия подключения не истекает до отзыва, даже если вы измените учетные данные для входа. Дополнительные сведения см. в статье [Настройка времени жизни маркеров в Azure Active Directory](../active-directory/develop/active-directory-configurable-token-lifetimes.md).

   В этом примере выбирается календарь, который проверяет триггер, например:

   ![Настройка свойств триггера](./media/connectors-create-api-office365-outlook/select-calendar.png)

1. В триггере задайте значения **частоты** и **интервала** . Чтобы добавить другие доступные свойства триггера, такие как **Часовой пояс**, выберите эти свойства в списке **Добавить новый параметр** .

   Например, если требуется, чтобы триггер пропускал календарь каждые 15 минут, задайте для параметра **Frequency** значение **минуты**, а для параметра **интервал** — значение `15` . 

   ![Задать частоту и интервал для триггера](./media/connectors-create-api-office365-outlook/calendar-settings.png)

1. На панели инструментов конструктора щелкните **Сохранить**.

Теперь добавьте действие, которое выполняется после срабатывания триггера. Например, можно добавить действие Twilio **Отправить сообщение** , которое отправляет текст при запуске события календаря через 15 минут.

## <a name="add-an-action"></a>Добавление действия

[Действие](../logic-apps/logic-apps-overview.md#logic-app-concepts) — это операция, выполняемая рабочим процессом в приложении логики. В этом примере приложение логики создает новый контакт в Office 365 Outlook. Для создания контакта можно использовать выходные данные другого триггера или действия. Например, предположим, что приложение логики использует триггер Dynamics 365 **при создании записи**. Вы можете добавить контактное действие Office 365 Outlook **CREATE Contact** и использовать выходные данные триггера salesforce для создания нового контакта.

1. Откройте приложение логики в конструкторе приложений логики на [портале Azure](https://portal.azure.com).

1. Чтобы добавить действие в качестве последнего шага в рабочем процессе, выберите **новый шаг**. 

   Чтобы добавить действие между шагами, переместите указатель на стрелку между шагами. Нажмите появившийся знак "плюс" ( **+** ), а затем выберите **Добавить действие**.

1. В поле поиска введите `office 365 outlook` в качестве фильтра. В этом примере выбирается **Создание контакта**.

   ![Выберите действие для выполнения в приложении логики](./media/connectors-create-api-office365-outlook/office365-actions.png) 

1. Если у вас нет активного подключения к учетной записи Outlook, вам будет предложено выполнить вход и создать подключение. Чтобы подключиться к Outlook с другой учетной записью пользователя, например учетной записью службы, см. раздел [подключение с использованием других](#connect-using-other-accounts)учетных записей. В противном случае укажите сведения о свойствах действия.

   > [!NOTE]
   > Срок действия подключения не истекает до отзыва, даже если вы измените учетные данные для входа. Дополнительные сведения см. в статье [Настройка времени жизни маркеров в Azure Active Directory](../active-directory/develop/active-directory-configurable-token-lifetimes.md).

   В этом примере выбирается папка Contacts, в которой действие создает новый контакт, например:

   ![Настройка свойств действия](./media/connectors-create-api-office365-outlook/select-contacts-folder.png)

   Чтобы добавить другие доступные свойства действия, выберите эти свойства в списке **Добавить новый параметр** .

1. На панели инструментов конструктора щелкните **Сохранить**.

<a name="connect-using-other-accounts"></a>

## <a name="connect-using-other-accounts"></a>Подключение с использованием других учетных записей

При попытке подключения к Outlook с использованием учетной записи, отличной от той, которая в настоящее время входит в Azure, могут возникнуть ошибки [единого входа (SSO)](../active-directory/manage-apps/what-is-single-sign-on.md) . Эта проблема возникает при входе в портал Azure с одной учетной записью, но для создания подключения используйте другую учетную запись. Конструктор приложений логики планирует использовать учетную запись, которая входит в Azure. Чтобы устранить эту проблему, можно использовать следующие параметры:

* Настройте другую учетную запись в качестве **участника** группы ресурсов приложения логики.

  1. В меню группы ресурсов приложения логики выберите **Управление доступом (IAM)**. Настройте другую учетную запись с ролью **участника** . Дополнительные сведения см. в статье о [добавлении и удалении назначений ролей Azure с помощью портала Azure](../role-based-access-control/role-assignments-portal.md).

  1. Если вы вошли в портал Azure с рабочей или учебной учетной записью, выйдите и снова войдите, используя другую учетную запись. Теперь можно создать подключение к Outlook с помощью другой учетной записи.

* Настройте другую учетную запись, чтобы ваша рабочая или учебная учетная запись имеет разрешения "Отправить как".

   Если у вас есть разрешения администратора, в почтовом ящике учетной записи службы настройте рабочую или учебную учетную запись с разрешениями **Отправить как** или **Отправить от имени** . Дополнительные сведения см. [в разделе Предоставление разрешений для почтового ящика другому пользователю-администратору](/microsoft-365/admin/add-users/give-mailbox-permissions-to-another-user). Затем можно создать подключение с помощью рабочей или учебной учетной записи. Теперь в триггерах или действиях, где можно указать отправителя, можно использовать адрес электронной почты учетной записи службы.

   Например, действие **Отправить сообщение** имеет необязательный параметр **(Отправить как)**, который можно добавить к действию и использовать адрес электронной почты вашей учетной записи службы в качестве отправителя. Чтобы добавить этот параметр, выполните следующие действия.

   1. В действии **Отправить сообщение по электронной почте** откройте список **Добавить параметр** и выберите параметр **от (Отправить как)** .

   1. После того как параметр появится в действии, введите адрес электронной почты учетной записи службы.

## <a name="connector-reference"></a>Справочник по соединителям

Технические сведения об этом соединителе, такие как триггеры, действия и ограничения, как описано в файле Swagger соединителя, см. на [странице справочника по соединителю](/connectors/office365/). 

## <a name="next-steps"></a>Дальнейшие действия

* См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).