---
title: Подключение к серверу IBM MQ
description: Отправка и получение сообщений с помощью Azure или локального сервера IBM MQ и Azure Logic Apps
services: logic-apps
ms.suite: integration
author: valrobb
ms.author: valthom
ms.reviewer: chrishou, logicappspm
ms.topic: article
ms.date: 06/19/2019
tags: connectors
ms.openlocfilehash: ef9e91b526055ece58ce283572deb98cff951653
ms.sourcegitcommit: 76b48a22257a2244024f05eb9fe8aa6182daf7e2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/03/2019
ms.locfileid: "74789573"
---
# <a name="connect-to-an-ibm-mq-server-from-azure-logic-apps"></a>Подключение к серверу IBM MQ с Azure Logic Apps

Соединитель IBM MQ отправляет и извлекает сообщения, хранящиеся на сервере IBM MQ в локальной среде или в Azure. Этот соединитель включает в себя клиент Microsoft MQ для взаимодействия с удаленным сервером IBM MQ по сети TCP/IP. В этой статье представлено начальное руководство по использованию соединителя MQ. Чтобы начать с обзора одного сообщения в очереди, а затем выполнить другие действия.

Соединитель IBM MQ включает эти действия, но не предоставляет триггеры.

- Просмотр одного сообщения без удаления сообщения с сервера IBM MQ
- Просмотр пакета сообщений без удаления сообщений с сервера IBM MQ
- Получение одного сообщения и удаление сообщения с сервера IBM MQ
- Получение пакета сообщений и удаление сообщений с сервера IBM MQ
- Отправка одного сообщения на сервер IBM MQ

## <a name="prerequisites"></a>Технические условия

* Если вы используете локальный сервер MQ, [установите локальный шлюз данных](../logic-apps/logic-apps-gateway-install.md) на сервере в сети. На сервере, на котором установлен локальный шлюз данных, также должен быть установлен .NET Framework 4,6, чтобы соединитель MQ работал. Кроме того, необходимо создать ресурс в Azure для локального шлюза данных. Дополнительные сведения см. [в разделе Настройка подключения к шлюзу данных](../logic-apps/logic-apps-gateway-connection.md).

  Однако если сервер MQ является общедоступным или доступным в Azure, вам не нужно использовать шлюз данных.

* Официально поддерживаемые версии IBM WebSphere MQ:

  * MQ 7.5
  * MQ 8.0
  * MQ 9,0

* Приложение логики, в которое нужно добавить действие MQ. Это приложение логики должно использовать то же расположение, что и локальное подключение к локальному шлюзу данных, и он уже должен иметь триггер, запускающий рабочий процесс. 

  Соединитель MQ не имеет триггеров, поэтому сначала необходимо добавить триггер в приложение логики. Например, можно использовать триггер повторения. Если вы не знакомы с Logic Apps, воспользуйтесь этим [кратким руководством, чтобы создать свое первое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md). 

## <a name="browse-a-single-message"></a>Просмотр одного сообщения

1. В приложении логики в триггере или другом действии выберите **новый шаг**. 

1. В поле поиска введите "MQ" и выберите это действие: **Обзор сообщения** .

   ![Обзор сообщения](media/connectors-create-api-mq/Browse_message.png)

1. Если у вас нет существующего подключения MQ, создайте подключение:  

   1. В действии выберите **подключить через локальный шлюз данных**.
   
   1. Введите свойства для сервера MQ.  

      В поле **Сервер** укажите имя сервера MQ или введите IP-адрес, после него поставьте двоеточие, а затем укажите номер порта.
    
   1. Откройте список **шлюзов** , в котором отображаются все ранее настроенные подключения шлюза. Выберите шлюз.
    
   1. Когда все будет готово, выберите **Создать**. 
   
      Подключение будет выглядеть, как в следующем примере:

      ![Свойства подключения](media/connectors-create-api-mq/Connection_Properties.png)

1. Настройте свойства действия:

   * **Очередь**: укажите очередь, которая отличается от соединения.

   * **MessageId**, **correlationId**, **groupId**и другие свойства: Поиск сообщения на основе различных свойств сообщения MQ

   * **Свойства includeinfo**: укажите **значение true** , чтобы включить дополнительные сведения о сообщении в выходные данные. Или укажите **значение false** , чтобы не включать дополнительные сведения о сообщении в выходные данные.

   * **Время ожидания**. Введите значение, чтобы определить время ожидания поступления сообщения в пустую очередь. Если это значение не задано, то извлекается первое сообщение в очереди, и, следовательно, время на ожидание сообщения не тратится.

     ![Просмотр свойств сообщения](media/connectors-create-api-mq/Browse_message_Props.png)

1. **Сохраните** изменения, а затем **запустите** приложение логики.

   ![Сохранить и выполнить](media/connectors-create-api-mq/Save_Run.png)

   После завершения выполнения будут показаны шаги выполнения, и можно будет ознакомиться с выходными данными.

1. Чтобы ознакомиться с подробными сведениями о каждом шаге, выберите зеленую галочку. Чтобы просмотреть дополнительные сведения о выходных данных, выберите команду **отобразить необработанные выходные**данные.

   ![Просмотр выходных данных сообщения](media/connectors-create-api-mq/Browse_message_output.png)  

   Ниже приведен пример необработанного вывода.

   ![Просмотр сообщения: необработанные выходные данные](media/connectors-create-api-mq/Browse_message_raw_output.png)

1. Если для **Свойства includeinfo** задано значение true, отображаются следующие выходные данные:

   ![Обзор сообщения о включении](media/connectors-create-api-mq/Browse_message_Include_Info.png)

## <a name="browse-multiple-messages"></a>Просмотр нескольких сообщений

Действие **Browse messages** (Просмотреть сообщения) имеет свойство **BatchSize** (Размер пакета). Оно указывает, сколько сообщений должно быть возвращено из очереди.  Если для свойства **BatchSize** значение не задано, то возвращаются все сообщения. Возвращаемые выходные данные представляют собой массив сообщений.

1. При добавлении действия **Обзор сообщений** по умолчанию выбирается первое ранее настроенное соединение. Чтобы создать новое соединение, выберите **изменить подключение**. Или выберите другое соединение.

1. После завершения выполнения приложения логики ниже приведен пример выходных данных из действия " **Обзор сообщений** ":

   ![Просмотр сообщений: выходные данные](media/connectors-create-api-mq/Browse_messages_output.png)

## <a name="receive-single-message"></a>Получить одно сообщение

Действие **Получить сообщение** имеет такие входные и выходные данные, что и действие **Browse message** (Просмотреть сообщение). При использовании действия **Получить сообщение** это сообщение удаляется из очереди.

## <a name="receive-multiple-messages"></a>Получение нескольких сообщений

Действие **Получить сообщения** имеет такие входные и выходные данные, что и действие **Browse messages** (Просмотреть сообщения). При использовании действия **Получить сообщения** эти сообщения удаляются из очереди.

Если в очереди нет сообщений при выполнении просмотра или получения, этот шаг завершается с выходом.  

![Ошибка MQ при отсутствии сообщений](media/connectors-create-api-mq/MQ_No_Msg_Error.png)

## <a name="send-message"></a>Отправить сообщение

При добавлении действия **отправить сообщения** по умолчанию выбирается первое ранее настроенное соединение. Чтобы создать новое соединение, выберите **изменить подключение**. Или выберите другое соединение.

1. Выберите допустимый тип сообщения: **датаграмма**, **ответ**или **запрос**  

   ![Свойства отправки сообщения](media/connectors-create-api-mq/Send_Msg_Props.png)

1. После завершения работы приложения логики ниже приведен пример выходных данных из действия **Отправить сообщение** :

   ![Отправить сообщение: выходные данные](media/connectors-create-api-mq/Send_Msg_Output.png)

## <a name="connector-reference"></a>Справочник по соединителям

Технические сведения о действиях и ограничениях, описанных в описании OpenAPIа соединителя (прежнее название Swagger), см. на [странице справочника](/connectors/mq/)по соединителю.

## <a name="next-steps"></a>Дальнейшие действия

* См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).
