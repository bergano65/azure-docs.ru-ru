---
title: Прием данных в обозревателе данных Azure
description: Сведения о различных способах приема данных в обозревателе данных Azure.
services: data-explorer
author: orspod
ms.author: v-orspod
ms.reviewer: mblythe
ms.service: data-explorer
ms.topic: conceptual
ms.date: 09/24/2018
ms.openlocfilehash: 6c7d4d8d4a16e0679722f9de007870a7ec7554b0
ms.sourcegitcommit: 542964c196a08b83dd18efe2e0cbfb21a34558aa
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/14/2018
ms.locfileid: "51636005"
---
# <a name="azure-data-explorer-data-ingestion"></a>Прием данных в обозревателе данных Azure

Прием данных — это процесс, используемый для загрузки записей данных из одного или нескольких источников для создания или обновления таблицы в обозревателе данных Azure. После принятия данные становятся доступными для запроса. На следующей схеме показан сквозной поток работы в Azure Data Explorer, в том числе прием данных.

![Поток данных](media/ingest-data-overview/data-flow.png)

Служба управления данными в обозревателе данных Azure, которая отвечает за прием данных, предоставляет следующие функциональные возможности:

1. **Извлечение данных**. Извлечение данных из внешних источников (концентраторов событий) или считывание запросов на прием из очереди Azure.

1. **Пакетная обработка**. Пакетная обработка данных, поступающих в ту же базу данных и таблицу, для оптимизации пропускной способности приема.

1. **Проверка**. Предварительная проверка и преобразование формата при необходимости.

1. **Управление данными**. Сопоставление схемы, упорядочение, индексирование, кодирование и сжатие данных.

1. **Точка сохранения в потоке приема**. Управление нагрузкой приема в модуле и обработка повторных попыток при временных сбоях.

1. **Фиксация приема данных**. Эта операция делает данные доступными для запроса.

## <a name="ingestion-methods"></a>Методы приема

Обозреватель данных Azure поддерживает несколько методов приема, каждый из которых имеет собственные целевые сценарии, преимущества и недостатки. Azure Data Explorer предлагает конвейеры и соединители для общих служб, приема данных программными средствами с помощью пакетов SDK и прямого доступа к модулю в целях изучения.

### <a name="ingestion-using-pipelines"></a>Прием с помощью конвейеров

Azure Data Explorer сейчас поддерживает конвейер концентратора событий, которым можно управлять с помощью мастера управления на портале Azure. Дополнительные сведения см. в статье [Краткое руководство. Прием данных из концентратора событий в обозреватель данных Azure](ingest-data-event-hub.md).

### <a name="ingestion-using-connectors-and-plugins"></a>Прием с помощью соединителей и подключаемых модулей
Azure Data Explorer сейчас поддерживает подключаемый модуль Logstash. Дополнительные сведения см. на странице [Logstash Output Plugin for Azure Data Explorer](https://github.com/Azure/logstash-output-kusto/blob/master/README.md) (Подключаемый модуль выходных данных Logstash для Azure Data Explorer).

### <a name="programmatic-ingestion"></a>Прием данных программным образом

Обозреватель данных Azure предоставляет пакеты SDK, которые можно использовать для запросов и приема данных. Прием данных программным образом оптимизирован для снижения затрат на прием путем минимизации количества транзакций с хранилищем во время процесса приема и после него.

**Доступные пакеты SDK и проекты с открытым исходным кодом**:

Kusto предоставляет клиентский пакет SDK, с помощью которого можно принимать и запрашивать данные:

* [Пакет SDK для Python](/azure/kusto/api/python/kusto-python-client-library)

* [ПАКЕТ SDK .NET](/azure/kusto/api/netfx/about-the-sdk)

* [пакет SDK для Java](/azure/kusto/api/java/kusto-java-client-library)

* [Пакет SDK для Node](/azure/kusto/api/node/kusto-node-client-library)

* [REST API](/azure/kusto/api/netfx/kusto-ingest-client-rest)

**Методы приема данных программным образом**:

* Прием данных с помощью службы управления данными Azure Data Explorer (надежный прием данных с высокой пропускной способностью):

  * [**Пакетный прием данных**](/azure/kusto/api/netfx/kusto-ingest-queued-ingest-sample) (предоставляется пакетом SDK). Клиент отправляет данные в хранилище BLOB-объектов Azure (обозначено службой управления данными обозревателя данных Azure) и отправляет уведомление в очередь Azure. Это рекомендуемый метод для надежного недорогого приема большого объема данных.

* Прием данных непосредственно в модуль обозревателя данных Azure (лучше всего подходит для просмотра и создания прототипов):

  * **Встроенный прием данных**. Команда управления (.ingest inline), содержащая данные в общем канале, предназначена для тестирования ad-hoc.

  * **Прием из запроса**. Команда управления (.set, .set-or-append, .set-or-replace), указывающая на результаты запроса, используется для создания отчетов или небольших временных таблиц.

  * **Прием из хранилища**. Команда управления (.ingest into) с данными, хранящимися во внешнем хранилище (например, в хранилище BLOB-объектов Azure), которая выполняет эффективный массовый прием данных.

**Задержка для различных методов**:

| Метод | Latency |
| --- | --- |
| **Встроенный прием** | Немедленно |
| **Прием из запроса** | Время запроса + время обработки |
| **Прием из хранилища** | Время загрузки + время обработки |
| **Прием с постановкой в очередь** | Время пакетной обработки + время обработки |
| |

Время обработки зависит от размера данных. Обычно обработка занимает меньше нескольких секунд. Время пакетной обработки по умолчанию — 5 минут.

## <a name="choosing-the-most-appropriate-ingestion-method"></a>Выбор наиболее подходящего метода приема

Прежде чем начать прием данных, задайте себе следующие вопросы.

* Где находятся мои данные? 
* Каков формат данных и можно ли его изменить? 
* Какие обязательные поля должны запрашиваться? 
* Каковы ожидаемые тома данных и скорость? 
* Сколько типов событий ожидается (показано в виде количества таблиц)? 
* Как часто в схеме событий ожидаются изменения? 
* Сколько узлов будут создавать данные? 
* Какова исходная ОС? 
* Каковы требования к задержке? 
* Можно ли использовать один из существующих управляемых конвейеров приема? 

Для организаций с существующей инфраструктурой, основанной на таких службах обмена сообщениями, как концентратор событий, наиболее подходящим решением будет использование соединителя. Прием с постановкой в очередь подходит для больших объемов данных.

## <a name="supported-data-formats"></a>Поддерживаемые форматы данных

Для всех методов приема, отличных от приема из очереди, данные необходимо отформатировать в один из поддерживаемых форматов, чтобы обозреватель данных Azure мог их проанализировать.

* CSV, TSV, PSV, SCSV, SOH
* JSON (разделенный по строкам, многострочный), Avro
* ZIP и GZIP 

> [!NOTE]
> При приеме данных типы данных определяются на основе целевых столбцов таблицы. Если запись является неполной или поле не может быть проанализировано в необходимом типе данных, соответствующие столбцы таблицы заполняются значениями NULL.

## <a name="ingestion-recommendations-and-limitations"></a>Рекомендации по приему и ограничения
* Эффективная политика хранения получаемых данных является производной от политики хранения базы данных. Дополнительные сведения см. в статье о [политике хранения](/azure/kusto/concepts/retentionpolicy). Для приема данных требуется разрешение **Принимающей таблицы** или **Принимающей базы данных**.
* Максимальный размер принимаемого файла составляет 5 ГБ. Для приема рекомендуются файлы размером от 100 МБ до 1 ГБ.

## <a name="schema-mapping"></a>Сопоставление схем

Сопоставление схем помогает детерминировано привязать поля исходных данных к столбцам таблицы назначения.

* [Сопоставление CSV](/azure/kusto/management/mappings?branch=master#csv-mapping) (необязательно) работает со всеми форматами, состоящими из рядов, может передаваться в качестве параметра команды приема данных или быть [предварительно создано в таблице](/azure/kusto/management/tables?branch=master#create-ingestion-mapping) и вызываться из параметра команды приема.
* [Сопоставление JSON](/azure/kusto/management/mappings?branch=master#json-mapping) (обязательно) и [сопоставление Avro](/azure/kusto/management/mappings?branch=master#avro-mapping) (обязательно) могут передаваться в качестве параметра команды приема данных или [быть предварительно созданы в таблице](/azure/kusto/management/tables#create-ingestion-mapping) и вызываться из параметра команды приема.

## <a name="next-steps"></a>Дополнительная информация

[Краткое руководство. Прием данных из концентратора событий в обозреватель данных Azure](ingest-data-event-hub.md)

[Краткое руководство. Прием данных с помощью библиотеки Python в обозревателе данных Azure](python-ingest-data.md)

[Краткое руководство. Прием данных с помощью библиотеки Node в Azure Data Explorer](node-ingest-data.md)

