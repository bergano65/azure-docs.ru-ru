---
title: Копирование данных с фабрики данных Azure в Explorer данных Azure
description: В этой статье вы узнаете, как глотать (загружать) данные в Azure Data Explorer с помощью инструмента копирования Azure Data Factory.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: jasonh
ms.service: data-explorer
ms.topic: conceptual
ms.date: 04/15/2019
ms.openlocfilehash: 860b1a579d9c8cee6c6e80ae4c4e7fdd7949d5c7
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "71300603"
---
# <a name="copy-data-to-azure-data-explorer-by-using-azure-data-factory"></a>Копирование данных в Explorer данных Azure с помощью Azure Data Factory 

Azure Data Explorer — это быстрое, полностью управляемое сервис анализа данных. Он предлагает анализ больших объемов данных, которые передаются из многих источников, таких как приложения, веб-сайты и устройства IoT. С помощью Azure Data Explorer вы можете итеративно изучать данные и выявлять закономерности и аномалии для улучшения продуктов, повышения качества обслуживания клиентов, мониторинга устройств и ускорения операций. Это поможет вам изучить новые вопросы и получить ответы в считанные минуты. 

Azure Data Factory — это полностью управляемая облачная служба интеграции данных. Его можно использовать для заполнения базы данных Azure Data Explorer данными из существующей системы. Это может помочь вам сэкономить время при создании аналитических решений.

При загрузке данных в Azure Data Explorer фабрика данных предоставляет следующие преимущества:

* **Легкая настройка:** Получить интуитивно понятный, пятиступенчатый мастер без сценариев требуется.
* **Поддержка хранилища данных Rich:** Получите встроенную поддержку для богатого набора штатных и облачных хранилив данных. Подробный список см. в таблице [Поддерживаемые хранилища данных и форматы](/azure/data-factory/copy-activity-overview#supported-data-stores-and-formats).
* **Безопасный и совместимый**: Данные передаются через HTTPS или Azure ExpressRoute. Наличие глобальной службы гарантирует, что ваши данные никогда не покинут заданных географических границ.
* **Высокая производительность:** Скорость загрузки данных составляет до 1 гигабайта в секунду (GBps) в Azure Data Explorer. Для получения дополнительной информации [см.](/azure/data-factory/copy-activity-performance)

В этой статье используется инструмент копирования данных Data Factory для загрузки данных из службы простого хранения данных Amazon (S3) в Azure Data Explorer. Можно следить за аналогичным процессом копирования данных из других хранилики данных, таких как:
* [Хранение Azure Blob](/azure/data-factory/connector-azure-blob-storage)
* [База данных SQL Azure](/azure/data-factory/connector-azure-sql-database)
* [Хранилище данных SQL Azure](/azure/data-factory/connector-azure-sql-data-warehouse)
* [Google BigQuery](/azure/data-factory/connector-google-bigquery)
* [Oracle](/azure/data-factory/connector-oracle)
* [Файловая система](/azure/data-factory/connector-file-system)

## <a name="prerequisites"></a>Предварительные требования

* Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/) Azure, прежде чем начинать работу.
* [Кластер и база данных Azure Data Explorer](create-cluster-database-portal.md).
* Источник данных.

## <a name="create-a-data-factory"></a>Создание фабрики данных

1. Войдите на [портал Azure](https://ms.portal.azure.com).

1. В левой панели выберите Создать фабрику**аналитики** > **данных** **ресурсов.** > 

   ![Создание фабрики данных на портале Azure](media/data-factory-load-data/create-adf.png)

1. В **панели new data factory** укажите значения для полей в следующей таблице:

   ![Панель "Новая фабрика данных"](media/data-factory-load-data/my-new-data-factory.png)  

   | Параметр  | Значение для входа  |
   |---|---|
   | **Название** | В коробке введите глобально уникальное имя для вашей фабрики данных. Если вы получили ошибку, *имя \"фабрики\" данных LoadADXDemo недоступно,* введите другое имя для фабрики данных. Для правил именования артефактов [Data Factory naming rules](/azure/data-factory/naming-rules)Data Factory см.|
   | **Подписка** | В списке выпадающих списков выберите подписку Azure, в которой можно создать фабрику данных. |
   | **Ресурсная группа** | Выберите **Создать новый,** а затем введите имя новой группы ресурсов. Если у вас уже есть группа ресурсов, выберите **Используйте существующий**. |
   | **Версия** | В списке выпадающих вниз, выберите **V2**. |  
   | **Расположение** | В списке выпадающих данных выберите место для фабрики данных. В списке отображаются только поддерживаемые локации. Хранилища данных, используемые фабрикой данных, могут существовать в других местах или регионах. |

1. Выберите **Создать**.

1. Чтобы контролировать процесс создания, выберите **Уведомления** на панели инструментов. После создания фабрики данных выберите ее.
   
   Открывается панель **Data Factory.**

   ![Панель фабрики данных](media/data-factory-load-data/data-factory-home-page.png)

1. Чтобы открыть приложение в отдельной панели, выберите **автор & монитор** плитки.

## <a name="load-data-into-azure-data-explorer"></a>Загрузка данных в Explorer данных Azure

Можно загрузить данные из многих типов [хранилищ данных](/azure/data-factory/copy-activity-overview#supported-data-stores-and-formats) в Azure Data Explorer. В этой статье обсуждается, как загрузить данные с Amazon S3.

Вы можете загрузить данные в любом из следующих способов:

* В пользовательском интерфейсе Azure Data Factory в левом стеле выберите значок **автора,** как показано в разделе «Создание фабрики [данных» «Создание фабрики данных с помощью пользовательского интерфейса Azure Data Factory.](/azure/data-factory/quickstart-create-data-factory-portal#create-a-data-factory)
* В инструменте копирования данных Azure Data Factory, как показано в [инструменте «Использование данных копирования» для копирования данных.](/azure/data-factory/quickstart-create-data-factory-copy-data-tool)

### <a name="copy-data-from-amazon-s3-source"></a>Копия данных с Amazon S3 (источник)

1. В панели **Let's Get started,** откройте инструмент Copy Data, выбрав **данные копирования.**

   ![Кнопка инструменткопирования данных](media/data-factory-load-data/copy-data-tool-tile.png)

1. В панели **свойств,** в поле **имя задачи,** введите имя, а затем выберите **Следующий**.

    ![Панель свойств копирования данных](media/data-factory-load-data/copy-from-source.png)

1. В панели **хранилища данных Source** выберите **Создать новое соединение.**

    ![Панель копий данных "Хранилище исходных данных"](media/data-factory-load-data/source-create-connection.png)

1. Выберите **Amazon S3,** а затем выберите **Продолжить**.

    ![Новая связная панель службы](media/data-factory-load-data/amazons3-select-new-linked-service.png)

1. В **новой службе связи (Amazon S3)** панель, сделать следующее:

    ![Укажите сервис, связанный с Amazon S3](media/data-factory-load-data/amazons3-new-linked-service-properties.png)

    а. В поле **Name** введите название нового связанного сервиса.

    b. В **списке перебрасываемых моментов интеграции через интеграцию** выберите значение.

    c. В поле **идентификатора ключа доступа** введите значение.
    
    > [!NOTE]
    > В Amazon S3, чтобы найти ключ доступа, выберите имя пользователя Amazon в панели навигации, а затем выберите **мои учетные данные безопасности.**
    
    d. В поле **Secret Access Key** введите значение.

    д) Чтобы протестировать созданное соединение службы, выберите **Test Connection.**

    е) Нажмите кнопку **Готово**.
    
      **Панель хранилища исходных данных** отображает новое соединение AmazonS31. 

1. Нажмите кнопку **Далее**.

   ![Хранилище исходных данных создано соединением](media/data-factory-load-data/source-data-store-created-connection.png)

1. В **панели ввода выберите файл или папку:**

    а. Просмотрите файл или папку, которую вы хотите скопировать, а затем выберите его.

    b. Выберите выбранное поведение копии, которое вы хотите. Убедитесь, что **двоичная копия** флажок очищается.

    c. Нажмите кнопку **Далее**.

    ![Выбор файла или папки входных данных](media/data-factory-load-data/source-choose-input-file.png)

1. В **панели настроек формата файла** выберите соответствующие настройки для файла. а затем выберите **Следующий**.

   ![Панель "Настройки формата файла"](media/data-factory-load-data/source-file-format-settings.png)

### <a name="copy-data-into-azure-data-explorer-destination"></a>Копирование данных в Azure Data Explorer (направление)

Новая служба связанного с Azure Data Explorer создана для копирования данных в таблицу назначения Azure Data Explorer (sink), указанную в этом разделе.

#### <a name="create-the-azure-data-explorer-linked-service"></a>Создание службы, связанной с системой azure Data Explorer

Для создания службы, связанной с azure Data Explorer, сделайте следующее;

1. Чтобы использовать существующее соединение хранилища данных или указать новый магазин данных в панели **хранения данных Destination,** выберите **Создать новое соединение.**

    ![Панель хранения данных назначения](media/data-factory-load-data/destination-create-connection.png)

1. В **новой панели службы linked** выберите **Azure Data Explorer,** а затем выберите **Продолжить**.

    ![Новая связанная панель обслуживания](media/data-factory-load-data/adx-select-new-linked-service.png)

1. В **панели New Linked Service (Azure Data Explorer)** сделать следующее:

    ![Новая панель службы связи Azure Data Explorer](media/data-factory-load-data/adx-new-linked-service.png)

   а. В поле **«Имя»** введите имя службы, связанной с azure Data Explorer.

   b. В **методе выбора счета**сделайте одно из следующих: 

    * Выберите **подписку Azure,** а затем в списках выпадающих списков выберите **подписку Azure** и **кластер.** 

        > [!NOTE]
        > Контроль **Cluster** кластера выпадения списков только кластеров, которые связаны с вашей подпиской.

    * Выберите **Введите вручную,** а затем введите **конечную точку.**

   c. В поле **Арендатора** введите имя арендатора.

   d. В **окне идентификатора основного удостоверения службы** введите идентификатор основного удостоверения службы.

   д) Выберите **основной ключ службы,** а затем, в **главном ключе службы,** введите значение для ключа.

   е) В списке **выпадающих данных выберите** имя базы данных. Кроме того, выберите флажок **edit,** а затем введите имя базы данных.

   ж. Чтобы протестировать созданное соединение службы, выберите **Test Connection.** Если вы можете подключиться к подключенной службе, панель отображает зеленую галочку и успешное сообщение **Connection.**

   h. Выберите **завершение** для завершения создания связанных служб.

    > [!NOTE]
    > Директор службы используется фабрикой данных Azure для доступа к службе Azure Data Explorer. Чтобы создать основной сервис, перейдите на [создание основного сервиса Azure Active Directory (Azure AD).](/azure-stack/operator/azure-stack-create-service-principals#manage-an-azure-ad-service-principal) Не используйте метод Azure Key Vault.

#### <a name="configure-the-azure-data-explorer-data-connection"></a>Настройка соединения данных Azure Data Explorer

После создания связанного соединения службы панель **хранилища данных Destination** открывается, и созданное соединение доступно для использования. Для настройки соединения сделайте следующее;

1. Нажмите кнопку **Далее**.

    ![Панель данных Azure Data Explorer "Магазин данных назначения"](media/data-factory-load-data/destination-data-store.png)

1. В **панели отображения таблицы** установите название таблицы назначения, а затем выберите **Следующий**.

    ![Набор данных назначения "Таблица картирования" панель](media/data-factory-load-data/destination-dataset-table-mapping.png)

1. В **панели отображения столбцов** происходит следующее отображение:

    а. Первое отображение выполняется Фабрикой данных Azure в соответствии с [картографией схемы Azure Data Factory.](/azure/data-factory/copy-activity-schema-and-type-mapping) Выполните следующие действия.

    * Установите **отображение столбцов** для таблицы назначения Azure Data Factory. Отображение по умолчанию отображается из источника в таблицу назначения Azure Data Factory.

    * Отмените выделение столбцов, которые не требуются для определения отображения столбцов.

    b. Второе отображение происходит, когда эти табличные данные попадают в Azure Data Explorer. Картирование осуществляется в соответствии с [правилами отображения CSV.](/azure/kusto/management/mappings#csv-mapping) Даже если исходные данные не в формате CSV, Azure Data Factory преобразует данные в табликовый формат. Таким образом, отображение CSV является единственным соответствующим отображением на данном этапе. Выполните следующие действия.

    * (Необязательно) Под **свойствами раковины Azure Data Explorer (Kusto)** добавьте соответствующее **имя отображения ingestion,** чтобы можно было использовать отображение столбцов.

    * Если **имя отображения ingestion** не указано, будет использован порядок отображения *по имени,* определяемый в разделе **отображение столбцов.** Если неудается *отображение* по имени, Azure Data Explorer пытается глотать данные в порядке *постолба* (т.е. он отображает по позициям по умолчанию).

    * Нажмите кнопку **Далее**.

    ![Набор данных назначения "Колонка отображение" панели](media/data-factory-load-data/destination-dataset-column-mapping.png)

1. В панели **настроек** сделайте следующее:

    а. В **настройках допуска неисправностей**введите соответствующие настройки.

    b. В **настройках производительности** **постановка Включить** не применяется, а **Расширенные настройки** включают соображения затрат. Если у вас нет конкретных требований, оставьте эти настройки как есть.

    c. Нажмите кнопку **Далее**.

    ![Панель копий "Настройки"](media/data-factory-load-data/copy-data-settings.png)

1. В панели **Резюме** просмотрите настройки, а затем выберите **Следующий**.

    ![Копировалка данных "Резюме" панели](media/data-factory-load-data/copy-data-summary.png)

1. В **полной** панели развертывания сделайте следующее:

    а. Чтобы переключиться на вкладку **Monitor** и просмотреть состояние конвейера (т.е. прогресс, ошибки и поток данных), выберите **Monitor.**

    b. Для отсечения связанных служб, наборов данных и конвейеров выберите **Edit Pipeline.**

    c. Выберите **завершение** для выполнения задачи копирования данных.

    ![Панель "Развертывание завершена"](media/data-factory-load-data/deployment.png)

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте о [разъеме Azure Data Explorer](/azure/data-factory/connector-azure-data-explorer) на фабрике данных Azure.
* Подробнее о редактировании связанных служб, наборов данных и конвейеров в [uI Data Factory.](/azure/data-factory/quickstart-create-data-factory-portal)
* Узнайте о [запросах Azure Data Explorer](/azure/data-explorer/web-query-data) для запроса данных.
