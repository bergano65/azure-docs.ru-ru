---
title: Защита кластеров Исследователей данных Azure в Azure
description: Узнайте о том, как обеспечить безопасность кластеров в Azure Data Explorer.
author: saguiitay
ms.author: itsagui
ms.reviewer: orspodek
ms.service: data-explorer
ms.topic: conceptual
ms.date: 01/06/2020
ms.openlocfilehash: 786950011f10e25d6bcb72061212c1878e79d45a
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77373354"
---
# <a name="secure-azure-data-explorer-clusters-in-azure"></a>Защита кластеров Исследователей данных Azure в Azure

В этой статье содержится введение в систему безопасности в Azure Data Explorer, которая поможет защитить данные и ресурсы в облаке и удовлетворить потребности в безопасности вашего бизнеса. Важно обеспечить безопасность кластеров. Обеспечение безопасности кластеров включает в себя одну или несколько функций Azure, которые включают безопасный доступ и хранение. В этой статье содержится информация, которая поможет вам обеспечить безопасность кластера.

## <a name="managed-identities-for-azure-resources"></a>Управляемые удостоверения для ресурсов Azure

Общей проблемой при создании облачных приложений является управление учетных данных в коде для проверки подлинности облачных служб. Обеспечение безопасности учетных данных является важной задачей. Учетные данные не должны храниться на рабочих станциях разработчика или проверяться в исходном элементе управления. Azure Key Vault позволяет обеспечить безопасное хранение учетных данных, секретов, а также других ключей, но для их получения код должен выполнять проверку подлинности в Key Vault.

Элементы управления ресурсами Azure Active Directory (Azure AD) для ресурсов Azure решают эту проблему. Функция предоставляет службам Azure автоматически управляемое удостоверение в Azure AD. Удостоверение можно использовать для проверки подлинности в любой службе, которая поддерживает проверку подлинности Azure AD, включая Key Vault, при этом не сохраняя каких-либо учетных данных в коде. Для получения дополнительной информации об этой службе смотрите [управляемые идентификаторы на](/azure/active-directory/managed-identities-azure-resources/overview) странице обзора ресурсов Azure.

## <a name="data-encryption"></a>Шифрование данных

### <a name="azure-disk-encryption"></a>Шифрование дисков Azure

[Шифрование Azure Disk](/azure/security/azure-security-disk-encryption-overview) помогает защитить и защитить ваши данные в соответствии с вашими обязательствами по обеспечению безопасности и соответствия требованиям организации. Он обеспечивает громкое шифрование для ОС и дисков данных виртуальных машин вашего кластера. Шифрование azure Disk также интегрируется с [Azure Key Vault,](/azure/key-vault/)что позволяет нам управлять и управлять ключами шифрования диска и секретами, а также обеспечивать шифрование всех данных на дисках VM. 

### <a name="customer-managed-keys-with-azure-key-vault"></a>Ключи, управляемые клиентами с помощью Azure Key Vault

По умолчанию данные шифруются с помощью ключей, управляемых корпорацией Майкрософт. Для дополнительного контроля над ключами шифрования можно предоставить управляемые клиентом ключи для использования для шифрования данных. Вы можете управлять шифрованием данных на уровне хранения с помощью собственных ключей. Ключ, управляемый клиентом, используется для защиты и контроля доступа к корневому ключу шифрования, который используется для шифрования и расшифровки всех данных. Управляемые клиентом клавиши обеспечивают большую гибкость для создания, вращения, отключания и отзыва элементов управления доступом. Вы также можете провести аудит ключей шифрования, используемых для защиты ваших данных.

Используйте Azure Key Vault для хранения ключей, управляемых клиентом. Вы можете создать свои собственные ключи и хранить их в хранилище ключей, или вы можете использовать API-извешую клавиши Azure Key Vault для генерации ключей. Кластер Azure Data Explorer и Хранилище ключей Azure должны находиться в одном регионе, но они могут быть в разных подписках. Для получения дополнительной информации о [What is Azure Key Vault?](/azure/key-vault/key-vault-overview)Убежище ключей Azure см. Подробное разъяснение ключей, управляемых клиентами, можно узнать с [помощью ключей Azure Key Vault](/azure/storage/common/storage-service-encryption)с помощью ключей Azure. Настройка ключей, управляемых клиентами, в кластере Azure Data Explorer с помощью шаблона [«С»](/azure/data-explorer/customer-managed-keys-csharp) или [«Менеджер ресурсов Azure»](/azure/data-explorer/customer-managed-keys-resource-manager)

> [!Note]
> Управляемые клиентами ключи опираются на управляемые идентификаторы для ресурсов Azure, функцию Active Directory Azure (Azure AD). Для настройки ключей, управляемых клиентом на портале Azure, необходимо настроить управляемое удостоверение **SystemAs** в кластер, подробно описанный в [управляемых идентификаторах настройки для кластера Azure Data Explorer.](/azure/data-explorer/managed-identities)

#### <a name="store-customer-managed-keys-in-azure-key-vault"></a>Храните ключи, управляемые клиентами в Хранилище ключей Azure

Для включения ключей, управляемых клиентом в кластере, используйте Хранилище ключей Azure для хранения ключей. Вы должны включить свойства **Soft Delete** и Do **Not Purge** на хранилище ключей. Хранилище ключей должно быть расположено в той же подписке, что и кластер. Azure Data Explorer использует управляемые идентификаторы для ресурсов Azure для аутентификации хранилища ключей для операций шифрования и расшифровки. Управляемые идентификаторы не поддерживают сценарии кросс-каталога.

#### <a name="rotate-customer-managed-keys"></a>Поверните клавиши, управляемые клиентом

Вы можете повернуть ключ, управляемый клиентом, в Azure Key Vault в соответствии с вашими политиками соответствия. При повороте ключа необходимо обновить кластер, чтобы использовать новый ключ URI. Вращение ключа не вызывает повторного шифрования данных в кластере. 

#### <a name="revoke-access-to-customer-managed-keys"></a>Отмена доступа к ключам, управляемым клиентами

Чтобы отозвать доступ к ключам, управляемым клиентами, используйте PowerShell или Azure CLI. Для получения дополнительной информации смотрите [ВAzure Key Vault PowerShell](/powershell/module/az.keyvault/) или [Azure Key Vault CLI.](/cli/azure/keyvault) Отмена доступа блокирует доступ ко всем данным на уровне хранения кластера, так как ключ шифрования, следовательно, недоступен Azure Data Explorer.

> [!Note]
> Когда Azure Data Explorer определяет, что доступ к ключу, управляемому клиентом, аннулируется, он автоматически приостанавливает кластер для удаления любых кэшированных данных. Как только доступ к ключу возвращается, кластер должен быть возобновлен вручную.

## <a name="role-based-access-control"></a>Управление доступом на основе ролей

Используя [элементы управления доступом на основе ролей (RBAC),](/azure/role-based-access-control/overview)вы можете сегрегировать обязанности внутри вашей команды и предоставлять только необходимый доступ к пользователям кластеров. Вместо того, чтобы давать всем неограниченные разрешения на кластере, можно разрешить только определенные действия. Вы можете настроить [элемент управления доступом для баз данных](/azure/data-explorer/manage-database-permissions) на [портале Azure,](/azure/role-based-access-control/role-assignments-portal)используя [Azure CLI](/azure/role-based-access-control/role-assignments-cli)или [Azure PowerShell.](/azure/role-based-access-control/role-assignments-powershell)

## <a name="next-steps"></a>Дальнейшие действия

* [Защитите свой кластер в Azure Data Explorer - Portal,](manage-cluster-security.md) включив шифрование в состоянии покоя.
* [Настройка управляемых идентификаторов для кластера Azure Data Explorer](managed-identities.md)
* [Настройка управляемых клиентами ключей с помощью шаблона управления ресурсами Azure](customer-managed-keys-resource-manager.md)
* [Настройка управляемых клиентами ключей с помощью C #](customer-managed-keys-csharp.md)

