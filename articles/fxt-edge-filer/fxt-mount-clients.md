---
title: Подключение клиентов к кластеру Microsoft Azure FXT Edge Filer
description: Как компьютеры NFS-клиента подключают кэш гибридного хранилища Azure FXT Edge Filer
author: ekpgh
ms.service: fxt-edge-filer
ms.topic: tutorial
ms.date: 06/20/2019
ms.author: v-erkell
ms.openlocfilehash: b48d8d74843947c3e40dc80234560b0147be6eea
ms.sourcegitcommit: 5bdd50e769a4d50ccb89e135cfd38b788ade594d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/03/2019
ms.locfileid: "67542970"
---
# <a name="tutorial-mount-the-cluster"></a>Руководство по подключению кластера

В этом учебнике описано, как подключить NFS-клиенты к кластеру Azure FXT Edge Filer. Клиенты подключают пути к виртуальному пространству имен, которое вы назначили при добавлении серверного хранилища. 

В этом учебнике описаны: 

> [!div class="checklist"]
> * стратегии для клиентов балансировки нагрузки в диапазоне IP-адресов, ориентированных на клиента;
> * принципы создания пути подключения из IP-адресов, ориентированных на клиента, и соединению по пространству имен;
> * аргументы, которые следует использовать в команде подключения.

Для работы с этим учебником потребуется около 45 минут.

## <a name="steps-to-mount-the-cluster"></a>Действия для подключения кластера

Чтобы подключить клиентские компьютеры к кластеру Azure FXT Edge Filer, выполните приведенные ниже шаги.

1. Решите, как распределить нагрузку трафика клиентов между узлами кластера. Подробные сведения см. разделе [Распределение нагрузки клиента](#balance-client-load). 
1. Определите IP-адрес кластера и путь соединения для подключения.
1. Определите клиентский путь для подключения.
1. Выполните [команду подключения](#use-recommended-mount-command-options) с соответствующими аргументами.

## <a name="balance-client-load"></a>Распределение нагрузки клиента

Чтобы помочь распределить клиентские запросы между всеми узлами в кластере, подключите клиенты к полному диапазону IP-адресов, ориентированных на клиенты. Существует несколько способов автоматизации этой задачи.

Дополнительные сведения о балансировке нагрузки DNS с циклическим перебором для кластера см. в разделе [Настройка DNS для кластера Azure FXT Edge Filer](fxt-configure-network.md#configure-dns-for-load-balancing). Чтобы использовать этот метод, необходимо поддерживать DNS-сервер, который не описан в этих статьях.

Более простой метод для выполнения небольших установок — использовать сценарий для назначения IP-адресов в диапазоне во время подключения клиента. 

Для больших или сложных систем могут подходить другие методы балансировки нагрузки. Чтобы получить справку, обратитесь к представителю Майкрософт или откройте запрос на поддержку. (Azure Load Balancer сейчас *не поддерживается* для Azure FXT Edge Filer.)

## <a name="create-the-mount-command"></a>Создание команды подключения 

Со стороны клиента команда ``mount`` сопоставляет виртуальный сервер (vserver) в кластере Azure FXT Edge Filer с путем в локальной файловой системе. 

Формат — ``mount <FXT cluster path> <local path> {options}``.

Команда подключения состоит из трех элементов: 

* путь кластера (комбинация IP-адреса и пути соединения по пространству имен, описанная ниже);
* локальный путь (путь в клиенте); 
* параметры команды подключения (перечислены в разделе [Использование рекомендуемых параметров команд подключения](#use-recommended-mount-command-options)).

### <a name="create-the-cluster-path"></a>Создание пути к кластеру

Путь к кластеру представляет собой комбинацию *IP-адреса* vserver и пути к *соединению по пространству имен*. Соединение по пространству имен является виртуальным путем, который вы определяете при [добавлении системы хранения](fxt-add-storage.md#create-a-junction).

Например, если вы использовали ``/fxt/files`` в качестве пути к пространству имен, ваши клиенты подключат путь *IP-адрес*:/fxt/files к своей локальной точке подключения. 

![Диалоговое окно добавления нового соединения с /avere/files в поле пути к пространству имен](media/fxt-mount/fxt-junction-example.png)

IP-адрес представляет собой один из определенных для vserver IP-адресов, ориентированных на клиенты. Диапазон IP-адресов, взаимодействующих с клиентами, можно найти в двух расположениях на панели управления кластером:

* Таблица **VServers** (вкладка панели мониторинга): 

  ![вкладка Dashboard (Панель мониторинга) на панели управления со вкладкой VServer, выбранной в таблице данных под графиком, и обведенным разделом IP-адресов](media/fxt-mount/fxt-ip-addresses-dashboard.png)

* Страница параметров **Client Facing Network** (Сеть, ориентированная на клиента): 

  ![Settings (Параметры) > VServer> страница конфигурации Client Facing Network (Сеть, ориентированная на клиента) с обведенным разделом Address Range (Диапазон адресов) в таблице для конкретного vserver](media/fxt-mount/fxt-ip-addresses-settings.png)

Объедините IP-адрес и путь к пространству имен, чтобы сформировать путь к кластеру для команды подключения. 

Пример команды подключения клиента: ``mount 10.0.0.12:/sd-access /mnt/fxt {options}``

### <a name="create-the-local-path"></a>Создание локального пути

Вы сами решаете, какой локальный путь использовать для команды подключения. Вы можете задать любую структуру пути как часть виртуального пространства имен. Создайте пространство имен и локальный путь, которые подойдут для рабочего процесса клиента. 

Дополнительные сведения о пространстве имен для клиента см. в [обзоре пространства имен](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gns_overview.html) руководства по настройке кластера.

В дополнение к путям при подключении каждого клиента добавьте описанные ниже [параметры команды подключения](#use-recommended-mount-command-options).

### <a name="use-recommended-mount-command-options"></a>Использование рекомендуемых параметров команды подключения

Чтобы обеспечить простое подключение клиента, передайте эти параметры и аргументы в команде подключения: 

``mount -o hard,nointr,proto=tcp,mountproto=tcp,retry=30 ${VSERVER_IP_ADDRESS}:/${NAMESPACE_PATH} ${LOCAL_FILESYSTEM_MOUNT_POINT}``

| Обязательные параметры | |
--- | --- 
``hard`` | Нежесткие подключения к кластеру Azure FXT Edge Filer связаны со сбоями в работе приложений и возможной потерей данных. 
``proto=netid`` | Этот параметр поддерживает соответствующую обработку сетевых ошибок NFS.
``mountproto=netid`` | Этот параметр поддерживает соответствующую обработку сетевых ошибок для операций подключения.
``retry=n`` | Задайте значение ``retry=30``, чтобы избежать временных ошибок при подключении. (При подключении переднего плана рекомендуется использовать другое значение.)

| Предпочтительные параметры  | |
--- | --- 
``nointr``            | Если клиенты используют старые версии ядер ОС (до апреля 2008 г.), которые поддерживают этот параметр, используйте их. Значением по умолчанию выступает параметр intr.

## <a name="next-steps"></a>Дополнительная информация

После подключения клиентов вы можете проверить рабочий процесс и приступить к работе с кластером.

Если вам необходимо переместить данные в новое основное облачное файловое хранилище, воспользуйтесь преимуществом структуры кэша, используя параллельный прием данных. Некоторые стратегии описываются в статье [Moving data to the vFXT cluster — Parallel data ingest](https://docs.microsoft.com/azure/avere-vfxt/avere-vfxt-data-ingest) (Перемещение данных в кластер vFXT — параллельный прием данных). (Avere vFXT для Azure — это облачный продукт, который использует технологию кэширования, похожую на Azure FXT Edge Filer.)

Если вам нужно устранить неполадки с оборудованием, ознакомьтесь со статьей [Monitor Azure FXT Edge Filer hardware status](fxt-monitor.md) (Мониторинг состояния оборудования Azure FXT Edge Filer). 
