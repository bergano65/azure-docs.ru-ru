---
title: Настройка центра безопасности Azure для агента IoT | Документация Майкрософт
description: Узнайте, как настроить центр безопасности Azure для агентов безопасности IoT для использования с центром безопасности Azure для службы безопасности IoT.
services: asc-for-iot
ms.service: asc-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''
ms.assetid: f95c445a-4f0d-4198-9c6c-d01446473bd0
ms.subservice: asc-for-iot
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/25/2019
ms.author: mlottner
ms.openlocfilehash: 6adb918bbc6d4718be8518019394582a6a843fb8
ms.sourcegitcommit: 57eb9acf6507d746289efa317a1a5210bd32ca2c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/01/2019
ms.locfileid: "74664856"
---
# <a name="tutorial-configure-security-agents"></a>Учебник. Настройка агентов безопасности

В этой статье описывается центр безопасности Azure для агентов безопасности IoT и приводятся сведения об их изменении и настройке. 

> [!div class="checklist"]
> * Настройка агентов безопасности
> * Изменение поведения агента путем изменения свойств двойника
> * Обнаружение конфигурации по умолчанию

## <a name="agents"></a>Агенты

Центр безопасности Azure для агентов безопасности IoT соберет данные с устройств IoT и выполняет действия по обеспечению безопасности для устранения обнаруженных уязвимостей. Конфигурация агента безопасности может быть управляемой с помощью набора свойств двойникаа модуля, которые можно настроить. Как правило, вторичные обновления этих свойств происходят редко.  

Центр безопасности Azure для объекта конфигурации двойника агента безопасности IoT — это объект формата JSON. Объект конфигурации — это набор управляемых свойств, которые можно определить для управления поведением агента. 

Эти конфигурации помогают настроить агент для каждого необходимого сценария. Например, при настройке этих свойств можно автоматически исключать некоторые события или сохранять энергопотребление на минимальном уровне.  

Чтобы внести изменения, используйте [схему](https://aka.ms/iot-security-github-module-schema) конфигурации агента безопасности центра безопасности Azure для IOT.  

## <a name="configuration-objects"></a>Объекты конфигурации 

Свойства, относящиеся к каждому центру безопасности Azure для агента безопасности IoT, находятся в объекте конфигурации агента в разделе требуемых свойств модуля **азуреиотсекурити** . 

Чтобы изменить конфигурацию, создайте и измените этот объект в удостоверении двойника модуля **азуреиотсекурити** . 

Если объект конфигурации агента не существует в двойника модуля **азуреиотсекурити** , все значения свойств агента безопасности устанавливаются в значение по умолчанию. 

```json
"desired": {
  "ms_iotn:urn_azureiot_Security_SecurityAgentConfiguration": {
  } 
}
```

## <a name="configuration-schema-and-validation"></a>Схема и проверка конфигурации 

Обязательно проверьте конфигурацию агента в соответствии с этой [схемой](https://aka.ms/iot-security-github-module-schema). Агент не будет запущен, если объект конфигурации не соответствует схеме.

 
Если во время выполнения агента объект конфигурации изменяется на недействительную конфигурацию (конфигурация не соответствует схеме), агент игнорирует недопустимую конфигурацию и будет продолжать использовать текущую конфигурацию. 

### <a name="configuration-validation"></a>Проверка конфигурации

Центр безопасности Azure для агента безопасности IoT сообщает о своей текущей конфигурации в разделе сообщаемые свойства в **азуреиотсекурити** модуля двойника Identity.
Агент сообщает обо всех доступных свойствах, если свойство не было задано пользователем, агент сообщает о конфигурации по умолчанию.

Чтобы проверить конфигурацию, Сравните значения, заданные в нужном разделе, со значениями, переданными в разделе с отчетом.

В случае несоответствия между требуемыми и сообщаемыми свойствами агент не смог проанализировать конфигурацию.

Проверьте требуемые свойства для [схемы](https://aka.ms/iot-security-github-module-schema), исправьте ошибки и задайте нужные свойства еще раз.

> [!NOTE]
> Предупреждение об ошибке конфигурации будет вызвано агентом в случае, если агенту не удалось проанализировать нужную конфигурацию.
> Сравните сообщаемый и требуемый раздел, чтобы понять, применимо ли предупреждение.

## <a name="editing-a-property"></a>Изменение свойства 

Все пользовательские свойства должны быть заданы внутри объекта конфигурации агента в модуле **азуреиотсекурити** модуля двойника.
Чтобы использовать значение свойства по умолчанию, удалите свойство из объекта конфигурации.

### <a name="setting-a-property"></a>Задание свойства

1. В центре Интернета вещей перейдите к устройству, которое вы хотите изменить, и выберите его.

1. Щелкните свое устройство, а затем в модуле **азуреиотсекурити** .

1. Щелкните **модуль удостоверение двойника**.

1. Измените свойства, которые вы хотите изменить в модуле безопасности.
   
   Например, чтобы настроить события подключения с высоким приоритетом и получать события с высоким приоритетом каждые 7 минут, используйте следующую конфигурацию.
   
    ```json
    "desired": {
        "ms_iotn:urn_azureiot_Security_SecurityAgentConfiguration": {
            "highPriorityMessageFrequency": {
                "value": "PT7M"
            },
            "eventPriorityConnectionCreate": {
                "value": "High"
            }
        }
    }
    ```

1. В нижней части страницы нажмите кнопку **Save**.

### <a name="using-a-default-value"></a>Использование значения по умолчанию

Чтобы использовать значение свойства по умолчанию, удалите свойство из объекта конфигурации.

## <a name="default-properties"></a>Свойства по умолчанию 

В следующей таблице содержатся управляемые свойства центра безопасности Azure для агентов безопасности IoT.

Значения по умолчанию доступны в соответствующей схеме в [GitHub](https\://aka.ms/iot-security-module-default).

| Name| Status | Допустимые значения| Значения по умолчанию| Описание |
|----------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|---------------|
|хигхприоритимессажефрекуенци|Обязательный: false |Допустимые значения: Duration в формате ISO 8601 |Значение по умолчанию: PT7M |Максимальный интервал времени до отправки сообщений с высоким приоритетом.|
|ловприоритимессажефрекуенци |Обязательный: false|Допустимые значения: Duration в формате ISO 8601 |Значение по умолчанию: PT5H |Максимальное время перед отправкой сообщений с низким приоритетом.| 
|снапшотфрекуенци |Требовать: false|Допустимые значения: Duration в формате ISO 8601 |Значение по умолчанию PT13H |Интервал времени для создания моментальных снимков состояния устройства.| 
|макслокалкачесизеинбитес |Обязательный: false |Допустимые значения: |Значение по умолчанию: 2560000, больше 8192 | Максимальный объем хранилища (в байтах), разрешенный для кэша сообщений агента. Максимальный объем пространства, разрешенного для хранения сообщений на устройстве перед отправкой сообщений.| 
|максмессажесизеинбитес |Обязательный: false |Допустимые значения: положительное число, большее, чем 8192, меньше 262144. |Значение по умолчанию: 204800 |Максимально допустимый размер агента для облачного сообщения. Этот параметр определяет максимальный объем данных, отправляемых в каждое сообщение. |
|Евентприорити $ {EventName} |Обязательный: false |Допустимые значения: высокая, низкая, Выкл. |Значения по умолчанию: |Приоритет каждого события, создаваемого агентом | 

### <a name="supported-security-events"></a>Поддерживаемые события безопасности

|Имя события| PropertyName | Значение по умолчанию| Событие Snapshot| Состояние сведений  |
|----------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|---------------|
|Диагностическое событие|евентприоритидиагностик| Выключено| Нет| Диагностические события, связанные с агентом. Используйте это событие для подробного ведения журнала.| 
|Ошибка конфигурации |евентприоритиконфигуратионеррор |Низкая |Нет |Агенту не удалось проанализировать конфигурацию. Проверьте конфигурацию схемы.| 
|Статистика удаленных событий |евентприоритидроппедевентсстатистикс |Низкая |Да|Статистика событий, связанных с агентом. |
|Статистика сообщений|евентприоритимессажестатистикс |Низкая |Да |Статистика сообщений, связанных с агентом. |
|Подключенное оборудование|евентприоритиконнектедхардваре |Низкая |Да |Моментальный снимок всего оборудования, подключенного к устройству.|
|Ожидание передачи данных через порты|евентприоритилистенингпортс |Высокая |Да |Моментальный снимок всех открытых портов прослушивания на устройстве.|
|Создание процесса |евентприоритипроцесскреате |Низкая |Нет |Аудит создания процессов на устройстве.|
|Завершение процесса|евентприоритипроцесстерминате |Низкая |Нет |Аудит завершения процесса на устройстве.| 
|Сведения о системе |евентприоритисистеминформатион |Низкая |Да |Моментальный снимок системных сведений (например, ОС или ЦП).| 
|Локальные пользователи| евентприоритилокалусерс |Высокая |Да|Моментальный снимок зарегистрированных локальных пользователей в системе. |
|Вход|  евентприоритилогин |Высокая|Нет|Аудит событий входа на устройство (локальные и удаленные имена входа).|
|Создание подключения |евентприоритиконнектионкреате|Низкая|Нет|Выполняет аудит TCP-подключений, созданных на устройстве и с устройства. |
|Настройка брандмауэра| евентприоритифиреваллконфигуратион|Низкая|Да|Моментальный снимок конфигурации брандмауэра устройства (правила брандмауэра). |
|Базовые показатели ОС| евентприоритйосбаселине| Низкая|Да|Моментальный снимок базовой проверки ОС устройства.|
|
 

## <a name="next-steps"></a>Дальнейшие действия

- [Общие сведения о центре безопасности Azure для Интернета вещей](concept-recommendations.md)
- [Обзор центра безопасности Azure для оповещений IoT](concept-security-alerts.md)
- [Доступ к необработанным данным безопасности](how-to-security-data-access.md)
