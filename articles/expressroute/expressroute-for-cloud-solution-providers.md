---
title: Использование Azure ExpressRoute для поставщиков облачных решений | Документация Майкрософт
description: Эта статья содержит сведения для поставщиков облачных решений, которым нужно внедрить службы Azure и ExpressRoute в свои предложения.
services: expressroute
author: duongau
ms.service: expressroute
ms.topic: article
ms.date: 10/10/2016
ms.author: duau
ms.custom: seodec18
ms.openlocfilehash: 18ee64e6866764e250cfa08a1d4721674bb66e5a
ms.sourcegitcommit: 93329b2fcdb9b4091dbd632ee031801f74beb05b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2020
ms.locfileid: "92097343"
---
# <a name="expressroute-for-cloud-solution-providers-csp"></a>ExpressRoute для поставщиков облачных решений (CSP)
Корпорация Майкрософт предоставляет традиционным торговым посредникам и распространителям (CSP) гипермасштабируемые службы, с помощью которых вы сможете быстро подготавливать к работе новые службы и решения для своих клиентов, не вкладывая средства в их разработку. Чтобы разрешить CSP управлять новыми службами напрямую, корпорация Майкрософт предоставляет программы и API, позволяющие CSP управлять ресурсами Microsoft Azure от имени клиентов. Один из этих ресурсов — ExpressRoute. Благодаря ExpressRoute CSP может подключать существующие ресурсы клиента к службам Azure. ExpressRoute — это высокоскоростной частный канал связи со службами в Azure. 

ExpressRoute состоит из пары каналов для обеспечения высокого уровня доступности, которые присоединяются к подписке одного клиента и не могут совместно использоваться несколькими клиентами. Каждый канал должен закрываться на другом маршрутизаторе, чтобы обеспечить высокую доступность.

> [!NOTE]
> Существуют ограничения пропускной способности и числа подключений для каждого канала ExpressRoute. Если потребности одного клиента превышают эти ограничения, им потребуется несколько каналов ExpressRoute для реализации гибридной сети.
> 
> 

Microsoft Azure предоставляет все больше служб, которые можно предложить клиентам. ExpressRoute помогает вам и вашим клиентам воспользоваться преимуществами этих служб, обеспечивая высокоскоростной доступ к Microsoft Azure среде с низкой задержкой.

## <a name="microsoft-azure-management"></a>Управление Microsoft Azure
Корпорация Майкрософт предоставляет CSP с интерфейсами API для управления подписками клиентов Azure, предоставляя программную интеграцию с собственными системами управления службами. Сведения о поддерживаемых возможностях управления см. [здесь](https://msdn.microsoft.com/library/partnercenter/dn974944.aspx).

## <a name="microsoft-azure-resource-management"></a>Управление ресурсами Microsoft Azure
Управление подпиской зависит от условий контракта с клиентом. CSP может напрямую управлять созданием и обслуживанием ресурсов или клиент может контролировать подписки Microsoft Azure и при необходимости создавать ресурсы Azure. Если клиент управляет созданием ресурсов в своей Microsoft Azure подписке, они будут использовать одну из двух моделей: "*подключение через*" или "*прямое*" моделирование. Эти модели подробно описаны в следующих разделах.  

### <a name="connect-through-model"></a>Подключение через посредника
![Схема, на которой показана модель подключения.](./media/expressroute-for-cloud-solution-providers/connect-through.png)  

При подключении через посредника CSP создает прямое подключение между центром обработки данных и подпиской Azure клиента. Прямое подключение устанавливается с помощью решения ExpressRoute, которое подключает среду Azure к сети. Затем клиент подключается к сети. В этом сценарии требуется, чтобы клиент проходил через сеть CSP для доступа к службам Azure. 

Если у вашего клиента есть другие подписки Azure, не управляемые вами вами, они будут использовать общедоступный Интернет или собственное частное подключение для подключения к этим службам, подготовленным в рамках подписки, отличной от поставщика CSP. 

Для CSP, управляющего службами Azure, предполагается, что у CSP есть ранее установленное хранилище удостоверений клиента, которое затем реплицируется в Azure Active Directory для управления своей подпиской CSP с помощью администрирования (АОБО). Ключевые драйверы для этого сценария включают в себя, где у данного партнера или поставщика услуг есть установленная связь с клиентом, клиент использует службы поставщика в настоящее время, или партнер может предоставить сочетание размещенных в Azure решений и приложений, размещенных на основе поставщика, для обеспечения гибкости и решения проблем клиентов, которые не могут быть удовлетворены только CSP. Эта модель показана на **рисунке** ниже.

![Схема, на которой показан подробный сценарий для модели "подключение через".](./media/expressroute-for-cloud-solution-providers/connect-through-model.png)

### <a name="connect-to-model"></a>Прямое подключение
![Схема, на которой показана модель подключения.](./media/expressroute-for-cloud-solution-providers/connect-to.png)

Модель прямого подключения предусматривает, что поставщик служб создает прямое подключение между центром обработки данных своего клиента и подпиской Azure, подготовленной к работе CSP, при этом используя ExpressRoute в сети клиента.

> [!NOTE]
> Для работы ExpressRoute клиенту понадобится создать и обслуживать канал ExpressRoute.  
> 
> 

Этот сценарий подключения требует, чтобы клиент подключается напрямую через сеть клиента для доступа к подписке Azure, управляемой CSP, используя прямое сетевое подключение, которое создается, принадлежит и управляется заказчиком полностью или частично. Для этих клиентов предполагается, что на поставщике в настоящее время не установлено хранилище удостоверений клиентов, и поставщик помогает клиенту реплицировать свое хранилище идентификации в Azure Active Directory для управления подпиской через АОБО. Есть следующие основные факторы, влияющие на выбор этого сценария: если между партнером или поставщиком служб и клиентом установлены отношения, клиент пользуется службами поставщика в настоящее время или если партнер хочет предоставлять службы, разработанные полностью на базе решений, размещенных в среде Azure, без необходимости использовать существующий центр обработки данных или инфраструктуру поставщика.

![Схема, на которой показан подробный сценарий для модели подключения.](./media/expressroute-for-cloud-solution-providers/connect-to-model.png)

Выбор между этими двумя вариантами зависит от потребностей клиента и текущей потребности в предоставлении служб Azure. Сведения об этих моделях и связанные с ними функции управления доступом на основе ролей, функции сети и шаблоны проектирования удостоверений подробно рассматриваются в статьях по следующим ссылкам.

* **Управление доступом на основе ролей Azure (Azure RBAC)** — RBAC основывается на Azure Active Directory.  Дополнительные сведения об Azure RBAC см. [здесь](../role-based-access-control/role-assignments-portal.md).
* **Сети** — здесь описаны различные аспекты работы сети в Microsoft Azure.
* **Azure Active Directory (Azure AD)** — Azure AD предоставляет управление удостоверениями для Microsoft Azure и сторонних приложений SaaS. Дополнительные сведения об Azure AD см. [здесь](https://azure.microsoft.com/documentation/services/active-directory/).  

## <a name="network-speeds"></a>Скорость сети
ExpressRoute поддерживает скорость сети от 50 МБ/с до 10 ГБ/с. Это позволяет клиентам приобрести объем пропускной способности сети, требуемый для их уникальной среды.

> [!NOTE]
> При необходимости пропускную способность сети можно увеличить без прерывания связи. Чтобы уменьшить скорость сети, нужно закрыть канал и создать его заново, задав более низкую скорость.  
> 
> 

ExpressRoute поддерживает подключение нескольких виртуальных сетей к одному каналу ExpressRoute для более эффективного использования высокоскоростных подключений. Один канал ExpressRoute могут совместно использовать несколько подписок Azure, принадлежащих одному клиенту.

## <a name="configuring-expressroute"></a>Настройка ExpressRoute
В ExpressRoute можно настроить поддержку трех типов трафика ([доменов маршрутизации](#expressroute-routing-domains)) в одном канале. Этот трафик разделяется на частный пиринг, пиринг Майкрософт и общедоступный пиринг (не рекомендуется). Вы можете выбрать один или все типы трафика и отправлять его по одному каналу или использовать несколько каналов ExpressRoute в зависимости от размера канала ExpressRoute и изоляции, требуемой клиенту. Система безопасности клиента может запрещать передачу общедоступного и частного трафика по одному каналу.

### <a name="connect-through-model"></a>Подключение через посредника
В конфигурации с подключением к сети вы несете ответственность за все сетевые подкрепления для подключения ресурсов центра обработки данных клиента к подпискам, размещенным в Azure. Каждому из клиентов, желающих использовать возможности Azure, потребуется собственное подключение ExpressRoute, которое будет управляться вами. Вы будете использовать те же методы, которые клиент будет использовать для получения канала ExpressRoute. Вы выполните те же действия, описанные в статье о [рабочих процессах ExpressRoute](expressroute-workflows.md) для подготовки канала и состояния канала. Затем вы настроите маршруты протокол BGP (BGP) для управления трафиком, передаваемым между локальной сетью и Azure vNet.

### <a name="connect-to-model"></a>Прямое подключение
В конфигурации "подключение-к" у вашего клиента уже есть подключение к Azure или подключение к поставщику услуг Интернета с присоединением ExpressRoute из собственного центра обработки данных непосредственно в Azure вместо вашего центра обработки данных. Чтобы начать подготовку к работе, клиенту нужно выполнить действия, описанные в разделе "Подключение через посредника" выше. После того как канал будет установлен, клиенту потребуется настроить локальные маршрутизаторы для доступа к сети и виртуальных сетей Azure.

Вы можете помочь установить подключение и настроить маршруты, чтобы обеспечить взаимодействие ваших ресурсов с ресурсами клиента в вашем центре обработки данных или с ресурсами, размещенными в среде Azure.

## <a name="expressroute-routing-domains"></a>Домены маршрутизации ExpressRoute
ExpressRoute предлагает два домена маршрутизации для новых каналов: частный пиринг и пиринг Майкрософт. Каждый из доменов маршрутизации настраивается с идентичными маршрутизаторами в конфигурации "активный — активный" для обеспечения высокой доступности. Дополнительные сведения о доменах маршрутизации ExpressRoute см. [здесь](expressroute-circuit-peerings.md).

Вы можете определить фильтры пользовательских маршрутов и разрешить использовать только определенные или необходимые маршруты. Дополнительные сведения о фильтрах маршрутизации и о том, как внести эти изменения, см. в статье [Создание и изменение маршрутизации для канала ExpressRoute](expressroute-howto-routing-classic.md).

> [!NOTE]
> Для пиринга Майкрософт подключение должно быть таким же, как общедоступный IP-адрес, принадлежащий заказчику или CSP, и должен соответствовать всем определенным правилам. Дополнительные сведения см. на странице [предварительных требований ExpressRoute](expressroute-prerequisites.md) .  
> 
> 

## <a name="routing"></a>Маршрутизация
ExpressRoute подключается к сети Azure через шлюз виртуальной сети Azure. Сетевые шлюзы обеспечивают маршрутизацию для виртуальных сетей Azure.

При создании виртуальных сетей Azure также создается таблица маршрутизации по умолчанию для виртуальной сети, используемая для передачи трафика между подсетями виртуальной сети. Если таблица маршрутов по умолчанию недостаточна для решения, можно создать настраиваемые маршруты для маршрутизации исходящего трафика к пользовательским устройствам или блокировать маршруты в определенные подсети или внешние сети.

### <a name="default-routing"></a>Маршрутизация по умолчанию
Таблица маршрутов по умолчанию включает в себя следующие маршруты:

* в одной подсети;
* между подсетями в виртуальной сети;
* в Интернет;
* между виртуальными сетями с использованием VPN-шлюза;
* между виртуальной и локальной сетью с использованием VPN-шлюза или шлюза ExpressRoute.

![Схема, на которой показаны параметры маршрутизации по умолчанию.](./media/expressroute-for-cloud-solution-providers/default-routing.png)  

### <a name="user-defined-routing-udr"></a>Определяемые пользователем маршруты
Определяемые пользователем маршруты позволяют управлять передачей исходящего трафика из одной подсети в другие подсети в виртуальной сети или по одному из других предустановленных шлюзов (ExpressRoute, Интернета или VPN). Системную таблицу маршрутизации по умолчанию можно заменить определяемой пользователем таблицей. При этом маршруты в таблице маршрутизации по умолчанию заменяются пользовательскими маршрутами. При определяемой пользователем маршрутизации клиенты могут создавать отдельные маршруты для устройств, например брандмауэров или устройств обнаружения атак, а также блокировать доступ к определенным подсетям из подсети, в которой размещен определенный пользователем маршрут. Общие сведения о User-Defined маршрутах см. [здесь](../virtual-network/virtual-networks-udr-overview.md). 

## <a name="security"></a>Безопасность
В зависимости от используемой модели подключения (прямого подключения или подключения через посредника) клиент определяет политики безопасности в виртуальной сети или предъявляет CSP требования к политике безопасности для виртуальных сетей. Можно определить следующие критерии безопасности:

1. **Изоляция клиента.** Платформа Azure обеспечивает изоляцию клиента, сохраняя сведения об идентификаторе и виртуальной сети клиента в защищенной базе данных, что используется для инкапсуляции трафика клиента в туннеле GRE.
2. Правила **группы безопасности сети (NSG)** позволяют определить, какой трафик можно передавать в подсетях виртуальных сетей в Azure. По умолчанию NSG содержит правила блокировки для блокировки трафика из Интернета в виртуальную сеть и разрешает правила для трафика в виртуальной сети. Дополнительные сведения о группах безопасности сети см. [здесь](https://azure.microsoft.com/blog/network-security-groups/).
3. **Принудительное туннелирование.** При принудительном туннелировании интернет-трафик из среды Azure перенаправляется через подключение ExpressRoute в локальный центр обработки данных. Дополнительные сведения о принудительном туннелировании см. [здесь](expressroute-routing.md#advertising-default-routes).  
4. **Шифрование.** Несмотря на то что каналы ExpressRoute предназначены для конкретного клиента, существует вероятность атаки поставщика сети, в ходе которой злоумышленник может изучить трафик пакетов. Чтобы устранить возможную проблему, клиент или CSP может шифровать трафик, передаваемый через подключение, определив политики режима туннелирования IPSec для всего трафика между локальными ресурсами и ресурсами Azure (см. дополнительный режим туннелирования IPSec для клиента 1 на рис. 5 "Безопасность ExpressRoute" выше). Кроме того, можно установить брандмауэр на каждой конечной точке канала ExpressRoute. Это потребует установки дополнительных виртуальных машин или устройств брандмауэра сторонних производителей на обоих концах для шифрования трафика по каналу ExpressRoute.

![замещающий текст](./media/expressroute-for-cloud-solution-providers/expressroute-security.png)  

## <a name="next-steps"></a>Дальнейшие действия
Служба Cloud Solution Provider позволяет вам повысить эффективность взаимодействия с клиентом без необходимости приобретать дорогостоящие инфраструктуру и возможности. При этом вы продолжаете выполнять функции основного поставщика услуг аутсорсинга. API CSP обеспечивает простую интеграцию со средой Microsoft Azure, позволяя интегрировать управление Microsoft Azure в существующую платформу управления.  

Дополнительные сведения см. по ссылкам ниже:

[Azure в программе поставщиков облачных решений](https://docs.microsoft.com/azure/cloud-solution-provider)  
[Готовность к модели Cloud Solution Provider](https://partner.microsoft.com/solutions/cloud-reseller-pre-launch)  
[Ресурсы по программе Microsoft Cloud Solution Provider](https://partner.microsoft.com/solutions/cloud-reseller-resources)
