---
title: Сведения о шлюзах виртуальных сетей ExpressRoute — Azure | Документация Майкрософт
description: Сведения о шлюзах виртуальных сетей ExpressRoute. Эта статья содержит сведения о типах и номерах SKU шлюзов.
services: expressroute
author: cherylmc
ms.service: expressroute
ms.topic: conceptual
ms.date: 10/14/2019
ms.author: mialdrid
ms.openlocfilehash: 58e75e4efecf390c4c1449b7ec59684554fa7516
ms.sourcegitcommit: 8bd85510aee664d40614655d0ff714f61e6cd328
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/06/2019
ms.locfileid: "74894377"
---
# <a name="about-expressroute-virtual-network-gateways"></a>Сведения о шлюзах виртуальной сети ExpressRoute

Чтобы подключить виртуальную сеть Azure и локальную сеть через ExpressRoute, сначала необходимо создать шлюз виртуальной сети. Шлюз виртуальной сети служит двум целям: Обмен IP-маршрутами между сетями и маршрутизация сетевого трафика. В этой статье описываются типы шлюзов, номера SKU шлюзов и предполагаемая производительность по SKU. В этой статье также описана функция ExpressRoute [фастпас](#fastpath), которая позволяет сетевому трафику из локальной сети обходить шлюз виртуальной сети, чтобы повысить производительность.

## <a name="gateway-types"></a>Типы шлюзов

При создании шлюза виртуальной сети нужно указать несколько параметров. Один из обязательных параметров (-GatewayType) указывает, будет ли шлюз использоваться для трафика ExpressRoute или VPN. Существуют два типа шлюзов:

* **VPN.** Сетевой трафик направляется в зашифрованном виде через общедоступный Интернет (при использовании типа шлюза VPN). Он также называется VPN-шлюзом. При подключениях типа "сеть — сеть", "точка — сеть" и "виртуальная сеть — виртуальная сеть" используется VPN-шлюз.

* **ExpressRoute.** Сетевой трафик направляется через частное подключение (при использовании типа шлюза ExpressRoute). Он также называется шлюзом ExpressRoute. Этот тип шлюза используется для настройки ExpressRoute.

В виртуальной сети каждому типу шлюза может соответствовать только один шлюз виртуальной сети. Например, у вас может быть только один шлюз виртуальной сети типа VPN и только один типа ExpressRoute.

## <a name="gwsku"></a>SKU шлюзов
[!INCLUDE [expressroute-gwsku-include](../../includes/expressroute-gwsku-include.md)]

Если вы хотите обновить шлюз до более мощного SKU шлюза, в большинстве случаев можно использовать командлет PowerShell "Resize-Азвиртуалнетворкгатевай". Это подойдет для обновлений до SKU Standard и HighPerformance. Однако для обновления до SKU UltraPerformance шлюз необходимо создать заново. Повторное создание шлюза вызовет простой.

### <a name="aggthroughput"></a>Приблизительная производительность в зависимости от номера SKU шлюза
В таблице ниже приведены типы шлюзов с приблизительной производительностью. Эта таблица относится к классической модели развертывания и модели диспетчера ресурсов.

[!INCLUDE [expressroute-table-aggthroughput](../../includes/expressroute-table-aggtput-include.md)]

> [!IMPORTANT]
> Производительность приложения зависит от нескольких факторов, таких как сквозная задержка и количество потоков трафика, которые открывает приложение. Числа в таблице представляют собой верхний предел, которого приложение может теоретически достичь в идеальных условиях.
>
>

## <a name="gwsub"></a>Подсеть шлюза

Перед созданием шлюза ExpressRoute необходимо создать подсеть шлюза. Подсеть шлюза содержит IP-адреса, которые используют виртуальные машины и службы шлюза виртуальной сети. При создании шлюза виртуальной сети виртуальные машины шлюза развертываются в подсети шлюза и настраиваются с использованием требуемых параметров шлюза ExpressRoute. Никогда не развертывайте все остальное (например, дополнительные виртуальные машины) в подсети шлюза. Чтобы подсеть шлюза работала правильно, ее нужно назвать GatewaySubnet. Такое имя позволяет Azure определить, что это подсеть для развертывания виртуальных машин и служб шлюза виртуальной сети.

>[!NOTE]
>[!INCLUDE [vpn-gateway-gwudr-warning.md](../../includes/vpn-gateway-gwudr-warning.md)]
>

При создании подсети шлюза указывается количество IP-адресов, которое содержит подсеть. IP-адреса в подсети шлюза выделяются виртуальным машинам и службам шлюза. Некоторым конфигурациям требуется больше IP-адресов, чем прочим. 

При планировании размера подсети шлюза обратитесь к документации по конфигурации, которую вы планируете создать. Например, для конфигурации с сосуществованием шлюза ExpressRoute или VPN требуется более крупная подсеть шлюза, чем большинство других конфигураций. Кроме того, необходимо убедиться, что подсеть шлюза содержит достаточно IP-адресов для дополнительных конфигураций, которые могут быть добавлены в будущем. Хотя вы можете создать подсеть шлюза размером/29, мы рекомендуем создать подсеть шлюза размером/27 или больше (/27,/26 и т. д.), если у вас есть доступное адресное пространство. Это будет соответствовать большинству конфигураций.

В примере PowerShell для Resource Manager ниже показана подсеть шлюза GatewaySubnet. Здесь приведена нотация CIDR, указывающая размер /27, при котором можно использовать достаточно IP-адресов для большинства существующих конфигураций.

```azurepowershell-interactive
Add-AzVirtualNetworkSubnetConfig -Name 'GatewaySubnet' -AddressPrefix 10.0.3.0/27
```

[!INCLUDE [vpn-gateway-no-nsg](../../includes/vpn-gateway-no-nsg-include.md)]

### <a name="zrgw"></a>Номера SKU избыточного между зонами шлюза

Вы также можете развернуть шлюзы ExpressRoute в компоненте "Зоны доступности Azure". При этом происходит физическое и логическое разделение шлюзов в разные зоны доступности с защитой локального сетевого подключения к Azure от сбоев на уровне зоны.

![Избыточный между зонами шлюз ExpressRoute](./media/expressroute-about-virtual-network-gateways/zone-redundant.png)

Избыточные между зонами шлюзы используют определенные новые номера SKU шлюза ExpressRoute.

* ErGw1AZ
* ErGw2AZ
* ErGw3AZ

Новые номера SKU шлюза также поддерживают другие варианты развертывания в соответствии с вашими потребностями. При создании шлюза виртуальной сети с использованием новых номеров SKU вы также можете развернуть шлюз в определенной зоне. Такой шлюз называется зональным. При развертывании зонального шлюза все его экземпляры развертываются в одной зоне доступности.

## <a name="fastpath"></a>фастпас

Шлюз виртуальной сети ExpressRoute предназначен для обмена сетевыми маршрутами и маршрутизации сетевого трафика. Фастпас предназначен для повышения производительности пути к данным между локальной сетью и виртуальной сетью. Если этот параметр включен, Фастпас отправляет сетевой трафик непосредственно на виртуальные машины в виртуальной сети, минуя шлюз.

Дополнительные сведения о Фастпас, включая ограничения и требования, см. в разделе [About фастпас](about-fastpath.md).

## <a name="resources"></a>Интерфейсы REST API и командлеты PowerShell
Дополнительные технические материалы и специальные требования к синтаксису, действующие при использовании интерфейсов REST API и командлетов PowerShell для настройки конфигураций шлюзов виртуальных сетей, доступны по приведенным ниже ссылкам.

| **Классический** | **Resource Manager** |
| --- | --- |
| [PowerShell](https://docs.microsoft.com/powershell/module/servicemanagement/azure/?view=azuresmps-4.0.0#azure) |[PowerShell](https://docs.microsoft.com/powershell/module/az.network#networking) |
| [REST API](https://msdn.microsoft.com/library/jj154113.aspx) |[REST API](https://msdn.microsoft.com/library/mt163859.aspx) |

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о доступных конфигурациях подключений см. в статье [Обзор ExpressRoute](expressroute-introduction.md).

Дополнительные сведения о создании шлюзов ExpressRoute см. в статье [Создание шлюза виртуальной сети для expressroute](expressroute-howto-add-gateway-resource-manager.md).

Дополнительные сведения о настройке шлюзов, избыточных в зонах, см. [в статье Создание шлюза виртуальной сети, избыточного в виде зоны](../../articles/vpn-gateway/create-zone-redundant-vnet-gateway.md).

Дополнительные сведения о Фастпас см. в разделе [About фастпас](about-fastpath.md).