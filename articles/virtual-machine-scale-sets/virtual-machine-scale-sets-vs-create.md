---
title: Развертывание масштабируемого набора виртуальных машин с помощью Visual Studio | Документация Майкрософт
description: Развертывание набора масштабирования виртуальных машин с помощью Visual Studio и шаблона Resource Manager
services: virtual-machine-scale-sets
ms.custom: H1Hack27Feb2017
ms.workload: na
documentationcenter: ''
author: mayanknayar
manager: jeconnoc
editor: ''
tags: azure-resource-manager
ms.assetid: ed0786b8-34b2-49a8-85b5-2a628128ead6
ms.service: virtual-machine-scale-sets
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/09/2019
ms.author: manayar
ms.openlocfilehash: d397f81ce29e0ec738156b755948985a4edfc70b
ms.sourcegitcommit: 4f3f502447ca8ea9b932b8b7402ce557f21ebe5a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/02/2019
ms.locfileid: "71802254"
---
# <a name="how-to-create-a-virtual-machine-scale-set-with-visual-studio"></a>Как создать масштабируемый набор виртуальных машин с помощью Visual Studio

В этой статье показано, как развернуть масштабируемый набор виртуальных машин Azure с помощью развертывания группы ресурсов Visual Studio.

[Масштабируемые наборы виртуальных машин Azure](https://azure.microsoft.com/blog/azure-vm-scale-sets-public-preview/) — это ресурсы вычислений Azure для развертывания и управления коллекцией похожих виртуальных машин с автомасштабированием и балансировкой нагрузки. Масштабируемые наборы виртуальных машин можно подготавливать и развертывать с помощью [шаблонов Azure Resource Manager](https://github.com/Azure/azure-quickstart-templates). Шаблоны Azure Resource Manager можно развертывать с помощью Azure CLI, PowerShell, RESTFUL и непосредственно из Visual Studio. Visual Studio предоставляет набор примеров шаблонов, которые можно развернуть как часть проекта развертывания группы ресурсов Azure.

Развертывания группы ресурсов Azure позволяют сгруппировать несколько связанных ресурсов Azure и опубликовать их в одной операции развертывания. Дополнительные сведения см. в статье [Создание и развертывание групп ресурсов Azure с помощью Visual Studio](../vs-azure-tools-resource-groups-deployment-projects-create-deploy.md).

## <a name="prerequisites"></a>Предварительные требования

Чтобы приступить к развертыванию масштабируемых наборов виртуальных машин в Visual Studio, необходимы следующие компоненты:

* Visual Studio 2013 или более поздней версии
* Пакет SDK Azure версии 2.7, 2.8 или 2.9

>[!NOTE]
>В этой статье используется Visual Studio 2019 с [пакетом SDK для Azure 2,8](https://azure.microsoft.com/blog/announcing-the-azure-sdk-2-8-for-net/).

## Создание проекта<a name="creating-a-project"></a> 

1. Откройте Visual Studio и выберите **Создать проект**.

1. В окне **Создание нового проекта**выберите **Группа ресурсов Azure** для C# и нажмите кнопку **Далее**.

1. В окне **Настройка нового проекта**введите имя и нажмите кнопку **создать**.

    ![Присвойте имя и создайте проект](media/virtual-machine-scale-sets-vs-create/configure-azure-resource-group.png)

1. В списке шаблонов выберите шаблон масштабируемый **набор виртуальных машин Windows** или **масштабируемый набор виртуальных машин Linux** . Нажмите кнопку **ОК**.

   ![Выберите шаблон виртуальной машины](media/virtual-machine-scale-sets-vs-create/select-vm-template.png)

После создания проекта **Обозреватель решений** содержит скрипт развертывания PowerShell, шаблон Azure Resource Manager и файл параметров для масштабируемого набора виртуальных машин.

## <a name="customize-your-project"></a>Настройка проекта

Теперь можно изменить шаблон, чтобы настроить его для нужд вашего приложения. Можно добавить свойства расширения виртуальной машины или изменить правила балансировки нагрузки. По умолчанию шаблоны масштабируемых наборов виртуальных машин настроены для развертывания расширения **AzureDiagnostics** , что упрощает добавление правил автомасштабирования. Шаблоны также развертывают подсистему балансировки нагрузки с общедоступным IP-адресом, настроенным правилами NAT для входящего трафика.

Подсистема балансировки нагрузки позволяет подключаться к экземплярам виртуальных машин с помощью SSH (Linux) или RDP (Windows). Диапазон портов клиента начинается с 50000. Для Linux, если вы подключитесь к порту 50000 по протоколу SSH, балансировка нагрузки направляет вас на порт 22 первой виртуальной машины в масштабируемом наборе. Подключение к порту 50001 направляется на порт 22 второй виртуальной машины и т. д.

 Хорошим способом изменения шаблонов с помощью Visual Studio является использование **структуры JSON**. Можно организовывать параметры, переменные и ресурсы. Зная схему, Visual Studio может указать ошибки в шаблоне перед его развертыванием.

![Обозреватель JSON](media/virtual-machine-scale-sets-vs-create/json-explorer.png)

## <a name="deploy-the-project"></a>Развертывание проекта

Разверните шаблон Azure Resource Manager, чтобы создать ресурс масштабируемого набора виртуальных машин:

1. В **Обозреватель решений**щелкните правой кнопкой мыши проект и выберите пункт **развернуть** > **создать**.

    ![Развертывание проекта](media/virtual-machine-scale-sets-vs-create/deploy-new-project.png)

1. В **группе развертывание в группу ресурсов**выберите подписку, которую нужно использовать, и выберите группу ресурсов. При необходимости можно создать группу ресурсов.

1. Затем выберите **изменить параметры** , чтобы ввести параметры, которые передаются в шаблон.

   ![Введите подписку и группу ресурсов](media/virtual-machine-scale-sets-vs-create/deploy-to-resource-group.png)

1. Укажите имя пользователя и пароль для операционной системы. Эти значения необходимы для создания развертывания. Если PowerShell Tools for Visual Studio не установлен, выберите **сохранить пароли** , чтобы избежать скрытой командной строки PowerShell, или используйте [поддержку Key Vault](https://azure.microsoft.com/blog/keyvault-support-for-arm-templates/). Чтобы продолжить, нажмите кнопку **сохранить** .

    ![Изменить параметры развертывания](media/virtual-machine-scale-sets-vs-create/edit-deployment-parameters.png)

1. В **группе развертывание в группу ресурсов**выберите **развернуть**. Действие запускает скрипт **deploy-AzureResourceGroup. ps1** . В окне **Вывод** отображается ход развертывания.

   ![Выходные данные показывают результаты](media/virtual-machine-scale-sets-vs-create/deployment-output.png)

## Изучение масштабируемого набора виртуальных машин<a name="exploring-your-virtual-machine-scale-set"></a>

Выберите **view** > **Cloud Explorer** , чтобы просмотреть новый масштабируемый набор виртуальных машин. При необходимости используйте **Обновить все**.

![Cloud Explorer](media/virtual-machine-scale-sets-vs-create/cloud-explorer.png)

**Cloud Explorer** позволяет управлять ресурсами Azure в Visual Studio при разработке приложений. Масштабируемый набор виртуальных машин также можно просмотреть на [портале Azure](https://portal.azure.com) и в [обозревателе ресурсов Azure](https://resources.azure.com/).

 Портал предоставляет лучший способ управления инфраструктурой Azure с помощью веб-браузера. Обозреватель ресурсов Azure предоставляет простой способ просмотра и отладки ресурсов Azure. Обозреватель ресурсов Azure предлагает представление экземпляров, а также команды PowerShell для ресурсов, которые вы ищете.

## <a name="next-steps"></a>Следующие шаги

После успешного развертывания масштабируемых наборов виртуальных машин с помощью Visual Studio можно выполнить дальнейшую настройку проекта в соответствии с требованиями приложения. Например, настройте Автомасштабирование, добавив ресурс **Insights** . Вы можете добавить инфраструктуру в шаблон, например автономные виртуальные машины, или развернуть приложения с помощью расширения пользовательских сценариев. Хорошим примером шаблонов можно найти в репозитории [шаблонов](https://github.com/Azure/azure-quickstart-templates) быстрого запуска Azure. Выполните поиск `vmss`.
