---
title: 'База данных Azure для MySQL: аутентификация Active Directory'
description: Изучите принципы аутентификации Azure Active Directory с помощью Базы данных Azure для MySQL.
author: lfittl-msft
ms.author: lufittl
ms.service: mysql
ms.topic: conceptual
ms.date: 07/23/2020
ms.openlocfilehash: 942789d5541e796247af2dbdf9371cce4701105e
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "87171896"
---
# <a name="use-azure-active-directory-for-authenticating-with-mysql"></a>Использование аутентификации Azure Active Directory с MySQL

Аутентификация Microsoft Azure Active Directory — это механизм подключения к Базе данных Azure SQL с помощью удостоверений. определенных в Azure Active Directory.
С помощью аутентификации Azure AD можно централизованно управлять удостоверениями пользователей базы данных и другими службами Майкрософт, что упрощает управление разрешениями.

Преимущества использования Azure AD:

- единая аутентификация пользователей в службах Azure;
- централизованное управление политиками паролей и сменой паролей;
- Azure Active Directory поддерживает несколько видов аутентификации, что позволит избавиться от необходимости хранить пароли;
- клиенты могут управлять разрешениями базы данных с помощью внешних групп (Azure AD);
- в службе аутентификации Azure AD для аутентификации удостоверений на уровне базы данных используются пользователи базы данных MySQL;
- для приложений, подключающихся к Базе данных Azure для MySQL, поддерживается аутентификация на основе маркеров.

Для настройки и использования аутентификации Azure Active Directory применяется приведенный ниже процесс.

1. При необходимости создайте удостоверения пользователей и передайте их в Azure Active Directory.
2. (Необязательно.) Привяжите или измените каталог Active Directory, который сейчас связан с вашей подпиской Azure.
3. Создайте администратора Azure AD для сервера Базы данных Azure для MySQL.
4. Создайте учетные записи пользователей базы данных в базе данных, сопоставленной с удостоверениями Azure AD.
5. Подключитесь к базе данных, получая маркер для удостоверения Azure AD и выполняя вход.

> [!NOTE]
> Узнайте, как создать и заполнить каталог Azure AD, а также настроить Azure AD с помощью Базы данных Azure для MySQL, ознакомившись с разделом [Использование Azure Active Directory для проверки подлинности с помощью MySQL](howto-configure-sign-in-azure-ad-authentication.md).

## <a name="architecture"></a>Architecture

На следующей общей схеме показано, как действует аутентификация Azure AD с использованием Базы данных Azure для MySQL. Стрелки обозначают пути обмена данными.

![Поток аутентификации][1]

## <a name="administrator-structure"></a>Структура администраторов

При использовании аутентификации Azure AD существуют две учетные записи администратора для сервера MySQL: учетная запись первоначального администратора MySQL и учетная запись администратора Azure AD. Создать в пользовательской базе данных первого пользователя автономной базы данных Azure AD может только администратор с учетной записью Azure AD. Администратор Azure AD может использовать для входа имя пользователя Azure AD или имя группы Azure AD. Если учетная запись администратора является учетной записью группы, ее может использовать любой участник группы. По этой причине для одного сервера MySQL может существовать несколько администраторов Azure AD. Использование учетной записи группы в качестве учетной записи администратора повышает управляемость. Это позволяет централизованно добавлять и удалять членов группы в Azure AD, не изменяя пользователей или разрешения на сервере MySQL. За один раз можно настроить только одного администратора Azure AD (пользователя или группу).

![структура администраторов][2]

## <a name="permissions"></a>Разрешения

Чтобы создать пользователей, которые могут проходить аутентификацию в Azure AD, необходим администратор Azure AD. Этот пользователь назначается путем настройки учетной записи администратора Azure AD для конкретного сервера Базы данных Azure для MySQL.

Чтобы создать пользователя базы данных Azure AD, необходимо подключиться с правами администратора Azure AD. Это продемонстрировано в разделе [Использование Azure Active Directory для проверки подлинности с помощью MySQL](howto-configure-sign-in-azure-ad-authentication.md).

Аутентификация Azure AD любого типа возможна только в том случае, если для Базы данных Azure для MySQL создана учетная запись администратора Azure AD. Если учетная запись администратора Azure Active Directory удалена с сервера, то существующие пользователи Azure Active Directory, учетные записи которых были созданы ранее, больше не смогут подключаться к базе данных, используя свои текущие учетные данные Azure Active Directory.

## <a name="connecting-using-azure-ad-identities"></a>Подключение с использованием удостоверений Azure AD

Проверка подлинности Azure Active Directory поддерживает следующие способы подключения к базе данных с помощью удостоверений Azure AD:

- Пароль Azure Active Directory.
- Встроенная служба Azure Active Directory.
- Универсальная служба Azure Active Directory с поддержкой MFA.
- Использование сертификатов приложений или секретов клиента Active Directory
- [Управляемое удостоверение](howto-connect-with-managed-identity.md)

После проверки подлинности в Active Directory выдается маркер. Этот маркер является вашим паролем для входа в систему.

Обратите внимание, что операции управления, такие как добавление новых пользователей, поддерживаются только для ролей пользователей Azure AD на этом этапе.

> [!NOTE]
> Дополнительные сведения о подключении с помощью маркера Active Directory см. в разделе [Использование Azure Active Directory для проверки подлинности с помощью MySQL](howto-configure-sign-in-azure-ad-authentication.md).

## <a name="additional-considerations"></a>Дополнительные сведения

- Azure Active Directoryная проверка подлинности доступна только для MySQL 5,7 и более новых версий.
- Для сервера Базы данных Azure для MySQL одновременно может быть настроен только один администратор Azure AD.
- Изначально только администратор Azure AD для MySQL может подключаться к Базе данных Azure для MySQL, используя учетную запись Azure Active Directory. Затем администратор Active Directory может настроить других пользователей базы данных Azure AD.
- Если пользователь удален из Azure AD, он больше не сможет проходить аутентификацию в Azure AD, поэтому получить маркер доступа для этого пользователя будет невозможно. В этом случае, хотя соответствующий пользователь по-прежнему будет присутствовать в базе данных, он не сможет подключиться к серверу.
> [!NOTE]
> Вход с удаленным пользователем Azure AD возможен до истечения срока действия маркера (60 минут после выдачи маркера).  Если вы также удалите пользователя из Базы данных Azure для MySQL, этот доступ будет немедленно отменен.
- Если администратор Azure AD удален с сервера, этот сервер больше не будет связан с арендатором Azure AD, поэтому для этого сервера будут отключены все имена для входа Azure AD. Добавление нового администратора Azure AD из того же арендатора позволит повторно включить имена для входа Azure AD.
- База данных Azure для MySQL сопоставляет маркеры доступа с пользователем Базы данных Azure для MySQL, используя уникальный идентификатор пользователя Azure AD, а не имя пользователя. Это означает, что если удалить пользователя Azure AD из Azure AD и создать нового пользователя с тем же именем, База данных Azure для MySQL будет считать, что это другой пользователь. Таким образом, если пользователь был удален из Azure AD, а затем добавлен новый пользователь с тем же именем, этот новый пользователь не сможет подключиться как удаленный пользователь.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как создать и заполнить каталог Azure AD, а также настроить Azure AD с помощью Базы данных Azure для MySQL, ознакомившись с разделом [Использование Azure Active Directory для проверки подлинности с помощью MySQL](howto-configure-sign-in-azure-ad-authentication.md).
- Общие сведения об именах для входа и пользователях базы данных для Базы данных Azure для MySQL см. в разделе [Создание пользователей в Базе данных Azure для MySQL](howto-create-users.md).

<!--Image references-->

[1]: ./media/concepts-azure-ad-authentication/authentication-flow.png
[2]: ./media/concepts-azure-ad-authentication/admin-structure.png
