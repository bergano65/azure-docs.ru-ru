---
title: Частная ссылка — база данных Azure для MySQL
description: Узнайте, как работает частная связь для базы данных Azure для MySQL.
author: kummanish
ms.author: manishku
ms.service: mysql
ms.topic: conceptual
ms.date: 03/10/2020
ms.openlocfilehash: f780bf946e81e9873a1828f9d697f69c81cef513
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "84509327"
---
# <a name="private-link-for-azure-database-for-mysql"></a>Частная ссылка для базы данных Azure для MySQL

Приватный канал позволяет подключаться к различным службам PaaS в Azure через частную конечную точку. Приватный канал Azure, по сути, предоставляет службы Azure в частной виртуальной сети (VNet). Доступ к ресурсам PaaS можно получить, используя частный IP-адрес, как и любой другой ресурс в виртуальной сети.

Чтобы получить список служб PaaS, поддерживающих функции закрытых ссылок, ознакомьтесь с [документацией по](https://docs.microsoft.com/azure/private-link/index)частному каналу. Частная конечная точка — это частный IP-адрес в определенной [виртуальной сети](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview) и подсети.

> [!NOTE]
> Эта функция доступна во всех регионах Azure, где база данных Azure для MySQL поддерживает общего назначения и оптимизированные для памяти ценовые категории.

## <a name="data-exfiltration-prevention"></a>Предотвращение кражи данных

Data ex-фильтрация в базе данных Azure для MySQL — когда полномочный пользователь, например администратор базы данных, может извлекать данные из одной системы и перемещать их в другое расположение или систему за пределами Организации. Например, пользователь перемещает данные в учетную запись хранения, принадлежащую третьей стороне.

Рассмотрим ситуацию с пользователем с MySQL Workbench в виртуальной машине Azure, которая подключается к серверу базы данных Azure для MySQL, подготовленному в западной части США. В приведенном ниже примере показано, как ограничить доступ к открытым конечным точкам в базе данных Azure для MySQL с помощью средств управления доступом к сети.

* Отключите весь трафик службы Azure к базе данных Azure для MySQL через общедоступную конечную точку, установив флажок *Разрешить службам Azure* отключить. Убедитесь, что IP-адреса или диапазоны не разрешены для доступа к серверу через [правила брандмауэра](https://docs.microsoft.com/azure/mysql/concepts-firewall-rules) или [конечные точки службы виртуальной сети](https://docs.microsoft.com/azure/mysql/concepts-data-access-and-security-vnet).

* Разрешите трафик только в базу данных Azure для MySQL, используя частный IP-адрес виртуальной машины. Дополнительные сведения см. в статьях, посвященных [конечной точке службы](concepts-data-access-and-security-vnet.md) и [правилам брандмауэра виртуальной сети](howto-manage-vnet-using-portal.md).

* На виртуальной машине Azure ограничьте область исходящего подключения, используя группы безопасности сети (NSG) и теги службы, как показано ниже:

    * Укажите правило NSG, разрешающее трафик для *тега службы = SQL. WestUs* — разрешает подключение к базе данных Azure для MySQL в западной части США
    * Укажите правило NSG (с более высоким приоритетом) для запрета трафика для *тега службы = SQL* — запрет подключений для обновления базы данных Azure для MySQL во всех регионах.</br></br>

После завершения установки виртуальная машина Azure может подключаться только к базе данных Azure для MySQL в регионе "Западная часть США". Однако подключение не ограничено одной базой данных Azure для MySQL. Виртуальная машина по-прежнему может подключаться к любой базе данных Azure для MySQL в регионе "Западная часть США", включая базы данных, которые не входят в подписку. Хотя мы сократили масштабы кражи данных в приведенном выше сценарии до определенного региона, мы не полностью устранили ее.</br>

С помощью частного канала теперь можно настроить такие элементы управления доступом к сети, как группы безопасности сети, чтобы ограничить доступ к частной конечной точке. Затем отдельные ресурсы Azure PaaS сопоставляются с конкретными частными конечными точками. Вредоносная программа предварительной оценки может получить доступ только к сопоставленному ресурсу PaaS (например, базе данных Azure для MySQL) и другим ресурсам.

## <a name="on-premises-connectivity-over-private-peering"></a>Локальные подключения через частный пиринг

При подключении к общедоступной конечной точке из локальных компьютеров необходимо добавить IP-адрес в брандмауэр на основе IP-адресов, используя правило брандмауэра уровня сервера. Хотя эта модель отлично подходит для предоставления доступа к отдельным компьютерам для рабочих нагрузок разработки или тестирования, управлять ею в рабочей среде сложно.

С помощью закрытой ссылки можно включить локальный доступ к частной конечной точке с помощью [Express Route](https://azure.microsoft.com/services/expressroute/) (ER), частного пиринга или [VPN-туннеля](https://docs.microsoft.com/azure/vpn-gateway/). Затем они могут отключить доступ через общедоступную конечную точку и не использовать брандмауэр на основе IP-адресов.

> [!NOTE]
> Иногда база данных Azure для MySQL и подсеть виртуальной сети относятся к разным подпискам. В этих случаях необходимо обеспечить следующую конфигурацию:
> - Убедитесь, что в обеих подписках зарегистрирован поставщик ресурсов **Microsoft. дбформискл** . Дополнительные сведения см. в разделе [resource-manager-registration][resource-manager-portal]

## <a name="configure-private-link-for-azure-database-for-mysql"></a>Настройка частной ссылки для базы данных Azure для MySQL

### <a name="creation-process"></a>Процесс создания

Для включения закрытой ссылки требуются частные конечные точки. Это можно сделать с помощью следующих руководств.

* [Портал Azure](https://docs.microsoft.com/azure/mysql/howto-configure-privatelink-portal)
* [CLI](https://docs.microsoft.com/azure/mysql/howto-configure-privatelink-cli)

### <a name="approval-process"></a>Процесс утверждения
После того как администратор сети создаст закрытую конечную точку (PE), администратор MySQL может управлять подключением к базе данных Azure для MySQL с помощью подключения к частной конечной точке (PEC). Такое разделение обязанностей между администратором сети и АДМИНИСТРАТОРом базы данных полезно для управления подключением к службе "Служба хранилища Azure для MySQL". 

* Перейдите к ресурсу сервера базы данных Azure для MySQL в портал Azure. 
    * Выберите подключения частной конечной точки в левой области.
    * Отображает список всех подключений к частным конечным точкам (ПЕКС)
    * Соответствующая частная конечная точка (PE) создана

![Выбор закрытого портала конечной точки](media/concepts-data-access-and-security-private-link/select-private-link-portal.png)

* Выберите отдельное PEC из списка, щелкнув его.

![Выберите закрытую конечную точку, ожидающие утверждения](media/concepts-data-access-and-security-private-link/select-private-link.png)

* Администратор сервера MySQL может одобрить или отклонить PEC и при необходимости добавить короткий текст ответа.

![Выберите сообщение частной конечной точки](media/concepts-data-access-and-security-private-link/select-private-link-message.png)

* После утверждения или отклонения список будет отражать соответствующее состояние вместе с текстом ответа.

![выберите конечное состояние частной конечной точки](media/concepts-data-access-and-security-private-link/show-private-link-approved-connection.png)

## <a name="use-cases-of-private-link-for-azure-database-for-mysql"></a>Варианты использования частной ссылки для базы данных Azure для MySQL

Клиенты могут подключаться к частной конечной точке из той же виртуальной сети, одноранговой виртуальной сети в том же регионе или через подключение между виртуальными сетями в разных регионах. Кроме того, клиенты могут подключаться из локальной среды с помощью ExpressRoute, частного пиринга или VPN-туннелирования. Ниже приведена упрощенная схема, на которой показаны распространенные варианты использования.

![Выберите Общие сведения о конечной точке частного назначения](media/concepts-data-access-and-security-private-link/show-private-link-overview.png)

### <a name="connecting-from-an-azure-vm-in-peered-virtual-network-vnet"></a>Подключение из виртуальной машины Azure в одноранговой виртуальной сети (VNet)
Настройте [пиринг виртуальных сетей](https://docs.microsoft.com/azure/virtual-network/tutorial-connect-virtual-networks-powershell) , чтобы установить подключение к базе данных Azure для MySQL с виртуальной машины Azure в одноранговой виртуальной сети.

### <a name="connecting-from-an-azure-vm-in-vnet-to-vnet-environment"></a>Подключение из виртуальной машины Azure в среде виртуальных сетей
Настройте [подключение VPN-шлюза](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal) между виртуальными сетями, чтобы установить подключение к базе данных Azure для MySQL с виртуальной машины Azure в другом регионе или в подписке.

### <a name="connecting-from-an-on-premises-environment-over-vpn"></a>Подключение из локальной среды через VPN
Чтобы установить подключение из локальной среды к базе данных Azure для MySQL, выберите и реализуйте один из вариантов:

* [Подключение "точка — сеть"](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-point-to-site-rm-ps)
* [VPN-подключение типа "сеть —сеть"](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell)
* [Канал ExpressRoute](https://docs.microsoft.com/azure/expressroute/expressroute-howto-linkvnet-portal-resource-manager)

## <a name="private-link-combined-with-firewall-rules"></a>Использование Приватного канала совместно с правилами брандмауэра

При использовании Приватного канала совместно с правилами брандмауэра возможны следующие ситуации и результаты.

* Если не настроить какие бы то ни было правила брандмауэра, по умолчанию трафик не будет доступен для базы данных Azure для MySQL.

* Если вы настраиваете общедоступный трафик или конечную точку службы и создаете частные конечные точки, то для разных типов входящего трафика применяется соответствующий тип правила брандмауэра.

* Если вы не настраиваете общий трафик или конечную точку службы и не создаете частные конечные точки, то база данных Azure для MySQL доступна только через частные конечные точки. Если не настроить общедоступный трафик или конечную точку службы после того, как все утвержденные частные конечные точки будут отклонены или удалены, трафик не сможет получить доступ к базе данных Azure для MySQL.

## <a name="deny-public-access-for-azure-database-for-mysql"></a>Запрет общего доступа для базы данных Azure для MySQL

Если вы хотите использовать только частные конечные точки для доступа к своей базе данных Azure для MySQL, можно отключить настройку всех общедоступных конечных точек (например, [правил брандмауэра](concepts-firewall-rules.md) и [конечных точек службы виртуальной](concepts-data-access-and-security-vnet.md)сети), установив для параметра запретить общедоступную **сеть доступ** к серверу базы данных. 

Если для этого параметра задано значение *Да*, для базы данных Azure для MySQL разрешены только подключения через частные конечные точки. Если для этого параметра установлено значение *нет*, клиенты могут подключаться к базе данных Azure для MySQL на основе параметров брандмауэра или конечной точки службы виртуальной сети. Кроме того, после установки значения "доступ к частной сети" клиенты не смогут добавлять и обновлять существующие правила брандмауэра и "правила конечной точки службы виртуальной сети".

> [!Note]
> Эта функция доступна во всех регионах Azure, где база данных Azure для PostgreSQL-Single Server поддерживает общего назначения и ценовые категории, оптимизированные для памяти.
>
> Этот параметр не влияет на конфигурации SSL и TLS для базы данных Azure для MySQL.

Сведения о настройке **запрета доступа к** общедоступной сети для базы данных Azure для MySQL с портал Azure см. в разделе [Настройка запрета доступа к](howto-deny-public-network-access.md)общедоступной сети.

## <a name="next-steps"></a>Дальнейшие шаги

Дополнительные сведения о функциях безопасности базы данных Azure для MySQL см. в следующих статьях:

* Сведения о настройке брандмауэра для базы данных Azure для MySQL см. в разделе [Поддержка брандмауэра](https://docs.microsoft.com/azure/mysql/concepts-firewall-rules).

* Сведения о настройке конечной точки службы виртуальной сети для базы данных Azure для MySQL см. в статье [Настройка доступа из виртуальных сетей](https://docs.microsoft.com/azure/mysql/concepts-data-access-and-security-vnet).

* Общие сведения о подключении к базе данных Azure для MySQL см. в статье [Архитектура подключения базы данных Azure для MySQL](https://docs.microsoft.com/azure/mysql/concepts-connectivity-architecture) .

<!-- Link references, to text, Within this same GitHub repo. -->
[resource-manager-portal]: ../azure-resource-manager/management/resource-providers-and-types.md