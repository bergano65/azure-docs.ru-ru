---
title: Общие сведения о непрерывности бизнес-процессов с помощью базы данных Azure для гибкого сервера MySQL
description: Узнайте о принципах обеспечения непрерывности бизнес-процессов с помощью базы данных Azure для гибкого сервера MySQL
author: kummanish
ms.author: manishku
ms.service: mysql
ms.topic: conceptual
ms.date: 09/21/2020
ms.openlocfilehash: 0c1afaa7d2d7971b2570914aa7c69fa7c666ae46
ms.sourcegitcommit: ae6e7057a00d95ed7b828fc8846e3a6281859d40
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2020
ms.locfileid: "92107850"
---
# <a name="overview-of-business-continuity-with-azure-database-for-mysql---flexible-server-preview"></a>Общие сведения о непрерывности бизнес-процессов с помощью базы данных Azure для MySQL — гибкого сервера (Предварительная версия)

> [!IMPORTANT]
> Сейчас предоставляется общедоступная предварительная версия Гибкого сервера Базы данных Azure для MySQL.

База данных Azure для гибкого сервера MySQL обеспечивает возможности обеспечения непрерывности бизнес-процессов, которые защищают ваши базы данных в случае запланированной и незапланированной аварии. Такие функции, как автоматическое резервное копирование и высокий уровень доступности, разменяют различные уровни защиты от сбоев с различными временем восстановления и рисками потери данных. При проектировании приложения для защиты от сбоев следует учитывать целевое время восстановления (RTO) и целевую точку восстановления (RPO) для каждого приложения. RTO — это отказоустойчивость, а RPO — допуск потери данных после нарушения работы службы базы данных.

В таблице ниже показаны функции, предлагаемые гибким сервером.


| **Компонент** | **Описание** | **Ограничения** |
| ---------- | ----------- | ------------ |
| **Восстановление & резервного копирования** | Гибкий сервер автоматически выполняет ежедневное резервное копирование файлов базы данных и постоянно создает резервные копии журналов транзакций. Резервные копии могут храниться в течение любого времени в диапазоне от 1 до 35 дней. Вы сможете восстановить сервер базы данных до любой точки во времени в течение срока хранения резервной копии. Время восстановления будет зависеть от размера восстанавливаемых данных и времени на выполнение восстановления журнала. Дополнительные сведения см. в статье [Основные понятия — резервное копирование и восстановление](./concepts-backup-restore.md) . |Данные резервного копирования остаются в пределах региона |
| **Локальная избыточная резервная копия** | Гибкие резервные копии сервера автоматически и безопасно хранятся в локальном избыточном хранилище в пределах региона и в той же зоне доступности. Локально избыточное резервное копирование реплицирует файлы данных резервных копий сервера три раза в одном физическом расположении в основном регионе. Локально избыточное хранилище резервных копий обеспечивает устойчивость объектов не менее 99,999999999% (11 девяти) в течение заданного года. Дополнительные сведения см. в статье [Основные понятия — резервное копирование и восстановление](./concepts-backup-restore.md) .| Применимо во всех регионах |
| **Высокий уровень доступности с избыточностью в пределах зоны** | Гибкий сервер может быть развернут в режиме высокого уровня доступности, который развертывает основной и резервный серверы в двух разных зонах доступности в пределах одного региона. Это защищает от сбоев на уровне зоны, а также помогает сократить время простоя приложения во время запланированных и незапланированных событий простоя. Данные с сервера-источника синхронно реплицируются в резервную реплику. Во время любого события простоя сервер базы данных автоматически переключается на резервную реплику. Дополнительные сведения см. в разделе [Основные понятия — высокий уровень доступности](./concepts-high-availability.md) . | Поддерживается в уровнях вычислений "общий назначение" и "оптимизировано для памяти". Доступно только в регионах, где доступны несколько зон.|
| **Общие папки ценовой категории "Премиум"** | Файлы базы данных хранятся в высокоустойчивых и надежных файловых ресурсах Azure уровня "Премиум", которые обеспечивают избыточность данных с помощью трех копий реплики, хранящихся в зоне доступности, с возможностью автоматического восстановления данных. Дополнительные сведения см. в разделе [Общие файловые ресурсы](../../storage/files/storage-how-to-create-premium-fileshare.md) уровня "Премиум". | Данные, хранящиеся в зоне доступности |

> [!IMPORTANT]
> В период действия предварительной версии не предлагаются соглашения об уровне обслуживания для времени бездействия, RTO и RPO. Сведения, приведенные на этой странице, предназначены только для целей планирования.

## <a name="planned-downtime-mitigation"></a>Запланированное снижение времени простоя
Ниже приведены некоторые плановые сценарии обслуживания, которые приводят к простою:

| **Сценарий** | **Process**|
| :------------ | :----------- |
| **Масштабирование вычислений (пользователь)**| При выполнении операции масштабирования вычислений выполняется подготовка нового гибкого сервера с помощью масштабируемой конфигурации вычислений. На существующем сервере базы данных разрешено выполнение активных контрольных точек, подключение клиентов, прекращение всех незафиксированных транзакций, а затем завершение работы. Затем хранилище прикрепляется к новому серверу и запускается база данных, которая выполняет восстановление, если это необходимо, прежде чем принимать клиентские подключения. |
| **Новое развертывание программного обеспечения (Azure)** | Новые компоненты или исправления ошибок автоматически происходят в рамках планового обслуживания службы, и вы можете запланировать выполнение этих действий. Дополнительные сведения см. в [документации](https://aka.ms/servicehealthpm), а также на [портале](https://aka.ms/servicehealthpm) . |
| **Обновления дополнительных версий (Azure)** | База данных Azure для MySQL автоматически запланирует серверы баз данных до дополнительной версии, определенной Azure. Это происходит в рамках планового обслуживания службы. Это приведет к короткому простою в секундах, а сервер базы данных автоматически перезапускается с новой дополнительной версией. Дополнительные сведения см. в [документации](https://docs.microsoft.com/azure/mysql/concepts-monitoring#planned-maintenance-notification), а также на [портале](https://aka.ms/servicehealthpm).|

Если гибкий сервер настроен на **высокий уровень доступности с избыточностью зоны**, гибкий сервер сначала выполняет операции на резервном сервере, а затем на сервере-источнике без отработки отказа. Дополнительные сведения см. в разделе [Основные понятия — высокий уровень доступности](./concepts-high-availability.md) .

##  <a name="unplanned-downtime-mitigation"></a>Незапланированное снижение времени простоя

Незапланированные простои могут возникать в результате непредвиденных сбоев, включая базовый сбой оборудования, сетевые проблемы и программные ошибки. Если сервер базы данных неожиданно завершает работу, если он настроен с высоким уровнем доступности [HA], то резервная реплика активируется. В противном случае автоматически подготавливается новый сервер базы данных. Хотя незапланированные простои не могут быть устранены, гибкий сервер сокращает время простоя, автоматически выполняя операции восстановления на уровне сервера базы данных и уровня хранилища, не требуя вмешательства человека.

### <a name="unplanned-downtime-failure-scenarios-and-service-recovery"></a>Незапланированный простой: сценарии сбоя и восстановление службы

Ниже приведены некоторые незапланированные сценарии сбоя и процесс восстановления.

| **Сценарий** | **Процесс восстановления [non-HA]** | **Процесс восстановления [HA]** |
| :---------- | ---------- | ------- |
| **Сбой сервера базы данных** | Если сервер базы данных не работает из-за некоторой базовой ошибки оборудования, активные соединения удаляются, а все порядковых транзакции прерываются. Azure попытается перезапустить сервер базы данных. Если это будет выполнено, выполняется восстановление базы данных. Если перезагрузка завершается неудачно, сервер базы данных будет пытаться перезапуститься на другом физическом узле.  <br /> <br /> Время восстановления (RTO) зависит от различных факторов, включая действия во время сбоя, такие как большие транзакции и объем операций восстановления, выполняемых в процессе запуска сервера базы данных. <br /> <br /> Приложения, использующие базы данных MySQL, должны быть созданы таким образом, чтобы они определяли и повторно пропустили соединения и неудачные транзакции.  При повторной попытке приложения подключения направляются на только что созданный сервер базы данных. | Если обнаружен сбой сервера базы данных, активируется резервный сервер базы данных, что сокращает время простоя. Дополнительные сведения см. на [странице концепции высокой доступности](concepts-high-availability.md) . Значение RTO должно быть 60-120 s, а RPO = 0 |
| **Сбой хранилища** | Приложения не видят никакого влияния на связанные с хранилищем проблемы, такие как сбой диска или повреждение физического блока. Поскольку данные хранятся в 3 копиях, копия данных обрабатывается оставшимся хранилищем. Повреждение блоков автоматически исправляется. Если копия данных потеряна, автоматически создается новая копия данных. | Для неустранимых ошибок гибкий сервер выполняет отработку отказа на резервную реплику, чтобы сократить время простоя. Дополнительные сведения см. на [странице концепции высокой доступности](./concepts-high-availability.md) . |
| **Ошибки логических или пользовательских пользователей** | Восстановление после ошибок пользователя, таких как случайно удаленные таблицы или неправильно обновленные данные, включает в себя выполнение [восстановления на момент времени](concepts-backup-restore.md) (PITR) путем восстановления данных до момента времени, предшествующего возникновению ошибки.<br> <br>  Если вы хотите восстановить только подмножество баз данных или определенные таблицы, а не все базы данных на сервере базы данных, можно восстановить сервер базы данных в новом экземпляре, экспортировать таблицы с помощью [pg_dump](https://www.postgresql.org/docs/current/app-pgdump.html), а затем использовать [pg_restore](https://www.postgresql.org/docs/current/app-pgrestore.html) для восстановления этих таблиц в базе данных. | Эти ошибки пользователей не защищаются с высокой доступностью из-за того, что все операции пользователя реплицируются в ждущий режим. |
| **Сбой зоны доступности** | Хотя это редкий случай, если вы хотите выполнить восстановление после сбоя на уровне зоны, вы можете выполнять восстановление на момент времени, используя резервную копию и выбрав настраиваемую точку восстановления, чтобы получить актуальные данные. В другой зоне будет развернут новый гибкий сервер. Время, затраченное на восстановление, зависит от предыдущей резервной копии и количества восстанавливаемых журналов транзакций. | Гибкий сервер выполняет автоматическую отработку отказа на резервный сайт. Дополнительные сведения см. на [странице концепции высокой доступности](./concepts-high-availability.md) . |
| **Сбой региона** | Функции репликации и геовосстановления в разных регионах пока не поддерживаются в предварительной версии. | |


> [!IMPORTANT]
>  **Невозможно**   восстановить удаленные серверы. Если вы удалите сервер, все связанные с ним базы данных также будут удалены без возможности восстановления. Используйте [блокировку ресурсов Azure](https://docs.microsoft.com/azure/azure-resource-manager/management/lock-resources)   , чтобы предотвратить случайное удаление сервера.


## <a name="next-steps"></a>Дальнейшие действия

-   Сведения о [высокой доступности с избыточностью зоны](./concepts-high-availability.md)
-   Сведения о [резервном копировании и восстановлении](./concepts-backup-restore.md)
