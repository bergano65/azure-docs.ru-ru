---
title: Резервное копирование и восстановление — портал Azure — база данных Azure для MySQL
description: В этой статье описывается, как восстановить сервер в базе данных Azure для MySQL с помощью портала Azure.
author: savjani
ms.author: pariks
ms.service: mysql
ms.topic: how-to
ms.date: 6/30/2020
ms.openlocfilehash: 9bc31cf8fee2669634ff366caac77cb090baf075
ms.sourcegitcommit: a43a59e44c14d349d597c3d2fd2bc779989c71d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "96000306"
---
# <a name="how-to-backup-and-restore-a-server-in-azure-database-for-mysql-using-the-azure-portal"></a>Как создать резервную копию сервера в службе "База данных Azure для MySQL" и восстановить его с помощью портала Azure

## <a name="backup-happens-automatically"></a>Резервное копирование выполняется автоматически
Чтобы обеспечить возможность восстановления, для серверов службы "База данных Azure для MySQL" периодически выполняется резервное копирование. С помощью этой функции можно восстановить сервер и все его базы данных до более ранней точки во времени на новом сервере.

## <a name="prerequisites"></a>Предварительные требования
Вот что вам нужно, чтобы выполнить инструкции, приведенные в этом руководстве:
- [Сервер базы данных Azure для MySQL и база данных](quickstart-create-mysql-server-database-using-azure-portal.md)

## <a name="set-backup-configuration"></a>Настройка конфигурации резервного копирования

При создании сервер можно настроить для локально избыточного или геоизбыточного резервного копирования. Для это воспользуйтесь окном **Ценовая категория**.

> [!NOTE]
> После создания сервера тип избыточности (локальная или географическая) изменить нельзя.
>

Если вы создаете сервер на портале Azure, тип резервного копирования (**локально избыточное** или **геоизбыточное**) задается в окне **Ценовая категория**. Кроме того, в этом окне указывается **срок хранения резервных копий** — период (в днях), в течение которого должны храниться резервные копии.

   :::image type="content" source="./media/howto-restore-server-portal/pricing-tier.png" alt-text="Окно &quot;Ценовая категория&quot; — выбор типа избыточности для резервного копирования":::

Дополнительные сведения о настройке этих значений при создании см. в кратком руководстве [Создание базы данных Azure для сервера MySQL с помощью портала Azure](quickstart-create-mysql-server-database-using-azure-portal.md).

Вот как изменить на сервере срок хранения резервной копии:
1. Войдите на [портал Azure](https://portal.azure.com/).
2. Выберите сервер базы данных Azure для MySQL. Откроется страница **Обзор**.
3. В меню в разделе **Параметры** выберите **Ценовая категория**. С помощью ползунка можно изменить **срок хранения резервных копий** в диапазоне от 7 до 35 дней.
На приведенном ниже снимке экрана он увеличен до 34 дней.
:::image type="content" source="./media/howto-restore-server-portal/3-increase-backup-days.png" alt-text="Увеличенный срок хранения резервных копий":::

4. Нажмите кнопку **ОК**, чтобы подтвердить изменение.

Срок хранения резервных копий определяет, насколько раннюю точку во времени можно задать для восстановления, так как это зависит от доступных резервных копий. Восстановление до точки во времени описано в следующем разделе. 

## <a name="point-in-time-restore"></a>Восстановление на момент времени
Служба "База данных Azure для MySQL" позволяет восстановить сервер до точки во времени и создать его копию. Можно использовать этот новый сервер для восстановления данных или направить на него клиентские приложения.

Например, если таблица была случайно удалена сегодня в полдень, ее можно восстановить до момента сразу перед полуднем и получить отсутствующие таблицы и данные из новой копии сервера. Восстановление до точки во времени выполняется на уровне сервера, а не на уровне базы данных.

Чтобы восстановить сервер до точки во времени, сделайте следующее:
1. На портале Azure выберите нужный сервер базы данных Azure для MySQL. 

2. На панели инструментов на странице **Обзор** для сервера выберите **Восстановить**.

   :::image type="content" source="./media/howto-restore-server-portal/2-server.png" alt-text="База данных Azure для MySQL: кнопка &quot;Восстановление&quot; на странице &quot;Обзор&quot;":::

3. Заполните форму "Восстановление", указав следующие сведения.

   :::image type="content" source="./media/howto-restore-server-portal/3-restore.png" alt-text="База данных Azure для MySQL: информация для восстановления":::
   - **Точка восстановления.** Выберите точку во времени, до которой нужно восстановить сервер.
   - **Целевой сервер.** Укажите имя для нового сервера.
   - **Расположение.** Невозможно выбрать регион. По умолчанию он совпадает с исходным сервером.
   - **Ценовая категория.** При восстановлении до точки во времени эти параметры изменить нельзя. Она совпадает с ценовой категорией исходного сервера. 

4. Чтобы восстановить сервер до выбранной точки во времени, нажмите кнопку **OК**. 

5. После завершения восстановления найдите созданный сервер, чтобы убедиться, что данные были восстановлены, как и ожидалось.

Имя и пароль администратора сервера для входа на сервер, созданный путем восстановления до точки во времени, будут теми же, что и для существующего сервера в выбранной точке во времени. Пароль можно изменить на странице **Обзор** для нового сервера.

Кроме того, после завершения операции восстановления есть два параметра сервера, которые сбрасываются в значения по умолчанию (и не копируются с сервера-источника) после операции восстановления.
*   time_zone — это значение, которое будет иметь значение **система** по умолчанию
*   event_scheduler — event_scheduler на восстановленном сервере имеет значение **Off** .

Необходимо скопировать значение с основного сервера и установить его на восстановленном сервере, перестроив [параметр сервера](howto-server-parameters.md) .

На новом сервере, созданном во время восстановления, нет конечных точек службы виртуальной сети, которые настроены на исходном сервере. Для этого нового сервера правила нужно настроить отдельно. Правила брандмауэра восстанавливаются с исходного сервера.

## <a name="geo-restore"></a>Геовосстановление
Если вы настроили сервер для геоизбыточного резервного копирования, из резервной копии можно создать новый сервер. Его можно создать в любом регионе, где доступна служба "База данных Azure для MySQL".  

1. Нажмите кнопку **Создать ресурс** (+) в левом верхнем углу окна портала. Выберите **Базы данных** > **База данных Azure для MySQL**.

   :::image type="content" source="./media/howto-restore-server-portal/1_navigate-to-mysql.png" alt-text="Перейдите к базе данных Azure для MySQL.":::
 
2. Укажите подписку, группу ресурсов и имя нового сервера. 

3. Выберите **резервное копирование** в качестве **источника данных**. Это действие загружает раскрывающееся меню, содержащее список серверов с включенными географически избыточными резервными копиями.
   
   :::image type="content" source="./media/howto-restore-server-portal/3-geo-restore.png" alt-text="Выберите источник данных.":::
    
   > [!NOTE]
   > Сразу после создания сервер может быть еще не готов к географическому восстановлению. Заполнение метаданных может занять несколько часов.
   >

4. Выберите раскрывающийся список **резервная копия** .
   
   :::image type="content" source="./media/howto-restore-server-portal/4-geo-restore-backup.png" alt-text="Выберите раскрывающееся меню резервное копирование.":::

5. Выберите исходный сервер для восстановления.
   
   :::image type="content" source="./media/howto-restore-server-portal/5-select-backup.png" alt-text="Выберите резервное копирование.":::

6. По умолчанию сервер будет иметь значения для параметра количество **виртуальных ядер**, **срок хранения резервной** копии, **параметр избыточности резервной копии**, **Версия подсистемы** и **учетные данные администратора**. Выберите **Continue** (Продолжить). 
   
   :::image type="content" source="./media/howto-restore-server-portal/6-accept-backup.png" alt-text="Продолжайте резервное копирование.":::

7. Заполните оставшиеся поля формы в соответствии со своими предпочтениями. Вы можете выбрать любое **расположение**.

    Выбрав расположение, можно выбрать параметр **настроить сервер** , чтобы обновить **поколение вычислений** (если оно доступно в выбранном регионе), число **виртуальных ядер**, **срок хранения резервной копии** и **избыточность резервной копии**. Изменить **ценовую категорию** ("Базовый", "Общего назначения" или "С оптимизацией для операций в памяти") и объем **хранилища** во время восстановления нельзя.

   :::image type="content" source="./media/howto-restore-server-portal/7-create.png" alt-text="Форма заливки."::: 

8. Выберите **Просмотр и создание** , чтобы просмотреть выбранные элементы. 

9. Щелкните **Создать**, чтобы подготовить сервер. Это может занять несколько минут.

Имя и пароль администратора сервера для входа на сервер, созданный путем геовосстановления, будут теми же, что и для существующего сервера в момент, когда было инициировано восстановление. Пароль можно изменить на странице **Обзор** для нового сервера.

На новом сервере, созданном во время восстановления, нет конечных точек службы виртуальной сети, которые настроены на исходном сервере. Для этого нового сервера правила нужно настроить отдельно. Правила брандмауэра восстанавливаются с исходного сервера.

## <a name="next-steps"></a>Дальнейшие действия
- Дополнительные сведения о [резервных копиях](concepts-backup.md) службы
- Дополнительные сведения о [репликах](concepts-read-replicas.md)
- Дополнительные сведения о возможностях обеспечения [непрерывности бизнес-процессов](concepts-business-continuity.md)