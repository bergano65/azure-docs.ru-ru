---
title: Повышение производительности приложений Azure с помощью помощника
description: Используйте рекомендации по производительности в помощнике по Azure для повышения скорости и скорости реагирования критически важных для бизнеса приложений.
ms.topic: article
ms.date: 01/29/2019
ms.openlocfilehash: 45fb1f8844067cb34b415c3897db3b1233ab5c7a
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85124492"
---
# <a name="improve-the-performance-of-azure-applications-by-using-azure-advisor"></a>Повышение производительности приложений Azure с помощью помощника по Azure

Рекомендации по повышению производительности в Azure Advisor помогут повысить скорость и быстроту реагирования критически важных для бизнеса приложений. Получить рекомендации Помощника по производительности можно на вкладке **Производительность** панели мониторинга Помощника.

## <a name="reduce-dns-time-to-live-on-your-traffic-manager-profile-to-fail-over-to-healthy-endpoints-faster"></a>Сократите срок жизни DNS в профиле диспетчера трафика, чтобы ускорить отработку отказа на работоспособные конечные точки

Вы можете использовать [параметры срока жизни (TTL)](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-performance-considerations) в профиле диспетчера трафика Azure, чтобы указать, как быстро переключать конечные точки, если заданная конечная точка перестает отвечать на запросы. При сокращении значений TTL клиенты будут направляться в работоспособные конечные точки быстрее.

Помощник Azure определяет профили диспетчера трафика, для которых настроено более длинное значение TTL. Рекомендуется настроить срок жизни 20 секунд или 60 секунд в зависимости от того, настроен ли профиль для [Быстрая отработка отказа](https://azure.microsoft.com/roadmap/fast-failover-and-tcp-probing-in-azure-traffic-manager/).

## <a name="improve-database-performance-by-using-sql-database-advisor"></a>Повышение производительности базы данных с помощью SQL Помощник по базам данных

Помощник по Azure предоставляет согласованное сводное представление с рекомендациями для всех ресурсов Azure. Он интегрируется с SQL Помощник по базам данных, чтобы получить рекомендации по повышению производительности баз данных.SQL Помощник по базам данных оценивает производительность баз данных путем анализа журнала использования. Затем он предлагает рекомендации, которые лучше всего подходят для выполнения типичной рабочей нагрузки базы данных.

> [!NOTE]
> Перед тем как вы сможете получить рекомендации, ваша база данных должна использоваться примерно в неделю, и в течение этой недели должна быть определена соответствующая активность. Помощник по базам данных SQL обеспечивает более эффективную оптимизацию при стабильном потоке запросов, чем на основе случайных всплесков активности.

Дополнительные сведения см. в разделе [SQL помощник по базам данных](https://azure.microsoft.com/documentation/articles/sql-database-advisor/).

## <a name="upgrade-your-storage-client-library-to-the-latest-version-for-better-reliability-and-performance"></a>Обновление клиентской библиотеки хранилища до последней версии для повышения надежности и производительности

Последняя версия пакета SDK клиентской библиотеки хранилища содержит исправления проблем, о которых сообщили клиенты, и заранее идентифицированные с помощью нашего процесса контроля качества. Последняя версия также обеспечивает оптимизацию надежности и производительности вместе с новыми функциями, которые могут улучшить общий опыт использования службы хранилища Azure. Advisor предоставляет рекомендации и инструкции, необходимые для обновления до последней версии пакета SDK, если вы используете устаревшую версию. Рекомендации для поддерживаемых языков: C++ и .NET.

## <a name="improve-app-service-performance-and-reliability"></a>Повышение надежности и производительности службы приложений

Помощник Azure интегрирует рекомендации по улучшению работы службы приложений и обнаруживает соответствующие возможности платформы. Ниже приведены примеры рекомендаций службы приложений.
* Обнаружение экземпляров, в которых ресурсы памяти или ЦП исчерпаны средами выполнения приложений с параметрами устранения рисков.
* Обнаружение экземпляров, где совместное размещение ресурсов, таких как веб-приложения и базы данных, может повысить производительность и снизить затраты.

Дополнительные сведения см. в статье рекомендации [по использованию службы приложений Azure](https://azure.microsoft.com/documentation/articles/app-service-best-practices/).

## <a name="use-managed-disks-to-prevent-disk-io-throttling"></a>Использование управляемых дисков для предотвращения регулирования дискового ввода-вывода

Advisor определяет виртуальные машины, которые принадлежат к учетной записи хранения, к которой достигнут целевой объект масштабируемости. Это условие делает эти виртуальные машины восприимчивыми к регулированию ввода-вывода. Помощник рекомендует использовать управляемые диски для предотвращения снижения производительности.

## <a name="improve-the-performance-and-reliability-of-virtual-machine-disks-by-using-premium-storage"></a>Повышение производительности и надежности дисков виртуальных машин с помощью хранилища класса Premium

Advisor определяет виртуальные машины со стандартными дисками, которые имеют большой объем транзакций в вашей учетной записи хранения. Рекомендуется обновить до дисков уровня "Премиум". 

Хранилище Azure Premium обеспечивает поддержку дисков с высокой производительностью и малой задержкой для виртуальных машин с интенсивной рабочей нагрузкой ввода-вывода. Диски виртуальной машины, использующие учетные записи хранения класса Premium, хранят данные на твердотельных накопителях (SSD). Для наилучшей производительности приложения рекомендуется перенести все диски виртуальных машин, требующие высокой скорости операций ввода-вывода в секунду, в хранилище класса Premium.

## <a name="remove-data-skew-on-your-sql-data-warehouse-tables-to-increase-query-performance"></a>Удаление неравномерного распределения данных в таблицах хранилища данных SQL для повышения производительности запросов

Отклонение данных может привести к ненужным перемещениям данных или узким местам ресурсов при выполнении рабочей нагрузки. Advisor определяет отклонение данных распределения, превышающее 15%. Рекомендуется повторно распространить данные и повторно посетить выбранный вами ключ распределения таблицы. См. дополнительные сведения об [определении и устранении неравномерного распределения](https://docs.microsoft.com/azure/sql-data-warehouse/sql-data-warehouse-tables-distribute#how-to-tell-if-your-distribution-column-is-a-good-choice).

## <a name="create-or-update-outdated-table-statistics-in-your-sql-data-warehouse-tables-to-increase-query-performance"></a>Создание или обновление устаревшей статистики таблицы в таблицах хранилища данных SQL для повышения производительности запросов

Advisor определяет таблицы без актуальной [статистики таблицы](https://docs.microsoft.com/azure/sql-data-warehouse/sql-data-warehouse-tables-statistics) и рекомендует создавать или обновлять статистику. Оптимизатор запросов в хранилище данных SQL Azure использует актуальную статистику для оценки количества элементов или числа строк в результатах запроса. Эти оценки позволяют оптимизатору запросов создавать план запроса, чтобы обеспечить максимальную производительность.

## <a name="improve-mysql-connection-management"></a>Улучшение управления подключениями MySQL

Анализ Advisor может указывать, что приложение, подключающиеся к серверу MySQL, может не управлять подключениями эффективно. Это условие может привести к ненужному потреблению ресурсов и общей большей задержке приложения. Чтобы улучшить управление подключениями, рекомендуем уменьшить количество кратковременных подключений и устранить неактивные подключения. Эти улучшения можно внести, настроив пул подключений на стороне сервера, например Проксискл.


## <a name="scale-up-to-optimize-cache-utilization-on-your-sql-data-warehouse-tables-to-increase-query-performance"></a>Масштабирование для оптимизации использования кэша в таблицах Хранилища данных SQL для повышения производительности запросов

Помощник Azure определяет, имеет ли таблица хранилища данных SQL высокий процент использования кэша и низкий процент попаданий. Это условие указывает на вытеснение с большим кэшем, что может повлиять на производительность экземпляра хранилища данных SQL. Advisor рекомендует масштабировать экземпляр хранилища данных SQL, чтобы обеспечить достаточную емкость кэша для рабочей нагрузки.

## <a name="convert-sql-data-warehouse-tables-to-replicated-tables-to-increase-query-performance"></a>Преобразование таблиц Хранилища данных SQL в реплицированные таблицы для повышения производительности запросов

Advisor определяет таблицы, которые не реплицируются, но это выгодно для преобразования. Предполагается, что вы преобразуете эти таблицы. Рекомендации основываются на следующих.
- Размер реплицированной таблицы. 
- Количество столбцов. 
- Тип распределения таблицы. 
- Количество секций в таблице хранилища данных SQL. 

В рекомендации по контексту могут быть предоставлены дополнительные эвристики. Дополнительные сведения о том, как эта рекомендация определяется, см. в статье [рекомендации по хранилищу данных SQL](https://docs.microsoft.com/azure/sql-data-warehouse/sql-data-warehouse-concept-recommendations#replicate-tables). 

## <a name="migrate-your-storage-account-to-azure-resource-manager-to-get-the-latest-azure-features"></a>Перенесите учетную запись хранения в Azure Resource Manager, чтобы получить новейшие функции Azure.

Перенесите модель развертывания учетной записи хранения в Azure Resource Manager, чтобы воспользоваться преимуществами:
- Развертывание шаблонов.
- Дополнительные параметры безопасности.
- Возможность обновления до учетной записи GPv2, позволяющей использовать новейшие функции службы хранилища Azure. 

Advisor определяет все автономные учетные записи хранения, использующие классическую модель развертывания, и рекомендует переход на модель развертывания диспетчер ресурсов.

> [!NOTE]
> Классические оповещения в Azure Monitor были прекращены в августе 2019. Мы советуем обновить классическую учетную запись хранения, чтобы использовать Resource Manager для сохранения функциональности оповещений на новой платформе. Дополнительные сведения см. в разделе [выбытие классических оповещений](https://docs.microsoft.com/azure/azure-monitor/platform/monitoring-classic-retirement#retirement-of-classic-monitoring-and-alerting-platform).

## <a name="design-your-storage-accounts-to-prevent-reaching-the-maximum-subscription-limit"></a>Разработайте учетные записи хранения, чтобы не допустить достижения максимального лимита подписки.

В регионе Azure поддерживается не более 250 учетных записей хранения на подписку. По достижении этого предела вы не сможете создавать учетные записи хранения в этой комбинации региона или подписки. Advisor проверяет подписки и предоставляет рекомендации по проектированию для уменьшения количества учетных записей хранения для любой подписки или региона, близкого к максимальному пределу.

## <a name="consider-increasing-the-size-of-your-vpn-gateway-sku-to-address-high-p2s-use"></a>Рассмотрите возможность увеличения размера SKU VPN-шлюза, чтобы решить высокий P2S использования.

Каждый SKU VPN-шлюза Azure может поддерживать только указанное число одновременных подключений P2S. Если число подключений приближается к лимиту шлюза, то может произойти сбой дополнительных попыток подключения. При увеличении размера шлюза вы сможете поддерживать больше одновременных пользователей P2S. Помощник предоставляет рекомендации и инструкции по увеличению размера шлюза.

## <a name="consider-increasing-the-size-of-your-vpn-gateway-sku-to-address-high-cpu"></a>Рассмотрите возможность увеличения размера SKU VPN-шлюза для обеспечения высокой нагрузки на ЦП.

При высокой нагрузке по трафику VPN-шлюз может удалять пакеты в связи с высокой загрузкой ЦП. Рассмотрите возможность обновления номера SKU VPN-шлюза. Увеличение размера VPN-шлюза гарантирует, что подключения не будут отбрасываться вследствие высокой загрузки ЦП. Advisor предоставляет рекомендации для упреждающего решения этой проблемы. 

## <a name="increase-batch-size-when-loading-to-maximize-load-throughput-data-compression-and-query-performance"></a>Увеличение размера пакета при загрузке для увеличения пропускной способности загрузки, сжатия данных и производительности запросов

Advisor определяет, можно ли увеличить производительность и пропускную способность, увеличив размер пакета при загрузке в базу данных. Можно использовать инструкцию COPY. Если вы не можете использовать инструкцию COPY, попробуйте увеличить размер пакета при использовании таких служебных программ, как API SQLBulkCopy или BCP. Хорошим общим правилом является использование размера пакета в диапазоне от 100 000 до 1 000 000 строк. Увеличение размера пакета увеличит пропускную способность, сжатие данных и производительность запросов.

## <a name="co-locate-the-storage-account-in-the-same-region-to-minimize-latency-when-loading"></a>Совместное размещение учетной записи хранения в том же регионе для снижения задержки при загрузке

Advisor определяет, выполняется ли загрузка из региона, отличного от пула SQL. Для снижения задержки при загрузке данных рассмотрите возможность загрузки из учетной записи хранения, находящегося в том же регионе, что и пул SQL. Это изменение поможет снизить задержку и повысить производительность загрузки.

## <a name="use-a-supported-kubernetes-version"></a>Использовать поддерживаемую версию Kubernetes

Advisor обнаруживает неподдерживаемые версии Kubernetes.

## <a name="optimize-the-performance-of-your-azure-database-for-mysql-azure-database-for-postgresql-and-azure-database-for-mariadb-servers"></a>Оптимизируйте производительность базы данных Azure для MySQL, базы данных Azure для PostgreSQL и серверов базы данных Azure для MariaDB

### <a name="fix-the-cpu-pressure-of-your-azure-database-for-mysql-azure-database-for-postgresql-and-azure-database-for-mariadb-servers-with-cpu-bottlenecks"></a>Исправьте нагрузку на ЦП базы данных Azure для MySQL, базы данных Azure для PostgreSQL и серверов базы данных Azure для MariaDB с узкими местами ЦП.
Высокий уровень использования ЦП в течение продолжительного периода времени может привести к низкой производительности запросов для рабочей нагрузки. Увеличение размера ЦП поможет оптимизировать среду выполнения запросов к базе данных и повысить общую производительность. Advisor определяет серверы с высокой загрузкой ЦП, которые, скорее всего, работают с ограниченными ресурсами ЦП и рекомендуют масштабировать вычислительные ресурсы.

### <a name="reduce-memory-constraints-on-your-azure-database-for-mysql-azure-database-for-postgresql-and-azure-database-for-mariadb-servers-or-move-to-a-memory-optimized-sku"></a>Сократите ограничения памяти для баз данных Azure для MySQL, базы данных Azure для PostgreSQL и серверов базы данных Azure для MariaDB или перейдите к SKU, оптимизированному для памяти.
Низкий коэффициент попадания в кэш может привести к снижению производительности запросов и увеличению числа операций ввода-вывода в секунду. Это состояние может быть вызвано недопустимым планом запроса или рабочей нагрузкой, интенсивно используемой для памяти. Исправление плана запроса или [увеличение объема памяти](https://docs.microsoft.com/azure/postgresql/concepts-pricing-tiers) базы данных Azure для PostgreSQL, базы данных Azure для MySQL или сервера базы данных Azure для MariaDB поможет оптимизировать выполнение рабочей нагрузки базы данных. Помощник по Azure определяет серверы, затрагиваемые этим большим объемом обработки буферного пула. Рекомендуется выполнить одно из следующих действий. 
- Исправление плана запроса
- Переход на SKU с большим объемом памяти 
- Увеличьте размер хранилища, чтобы получить больше операций ввода-вывода.

### <a name="use-an-azure-database-for-mysql-or-azure-database-for-postgresql-read-replica-to-scale-out-reads-for-read-intensive-workloads"></a>Использование базы данных Azure для MySQL или базы данных Azure для PostgreSQL чтения реплики для масштабирования операций чтения для рабочих нагрузок с интенсивным чтением
Advisor использует эвристику на основе рабочей нагрузки, например отношение операций чтения для записи на сервере за последние семь дней для обнаружения рабочих нагрузок с интенсивным чтением. Служба "база данных Azure для PostgreSQL" или "база данных Azure для MySQL" с высоким коэффициентом чтения и записи может привести к появлению конфликтов ЦП или памяти и появлению медленных запросов. Добавление [реплики](https://docs.microsoft.com/azure/postgresql/howto-read-replicas-portal) поможет масштабировать операции чтения на сервере реплики и предотвратить ограничения ЦП или памяти на сервере-источнике. Помощник определяет серверы с рабочими нагрузками с интенсивным чтением и рекомендует добавить [реплику чтения](https://docs.microsoft.com/azure/postgresql/concepts-read-replicas)   для разгрузки некоторых рабочих нагрузок чтения.


### <a name="scale-your-azure-database-for-mysql-azure-database-for-postgresql-or-azure-database-for-mariadb-server-to-a-higher-sku-to-prevent-connection-constraints"></a>Масштабирование базы данных Azure для MySQL, базы данных Azure для PostgreSQL или сервера базы данных Azure для MariaDB до более высокого SKU для предотвращения ограничений подключения
Каждое новое подключение к серверу базы данных занимает память. Производительность сервера базы данных снижается в случае сбоя подключений к серверу из-за [верхнего предела](https://docs.microsoft.com/azure/postgresql/concepts-limits) памяти. Помощник по Azure определяет серверы, работающие со многими сбоями подключения. Рекомендуется обновить ограничения подключения сервера, чтобы предоставить серверу больше памяти, выполнив одно из следующих действий.
- Увеличение масштаба вычислений. 
- Используйте ресурсы SKU, оптимизированные для памяти, которые имеют больше вычислений на ядро.

## <a name="scale-your-cache-to-a-different-size-or-sku-to-improve-cache-and-application-performance"></a>Масштабирование кэша до другого размера или SKU для улучшения производительности кэша и приложений

Экземпляры кэша работают лучше, если они не выполняются при высокой нагрузке на память, высокой нагрузке сервера или высокой пропускной способности сети. Эти условия могут привести к невозможности реагирования, потере данных или стать недоступными. Advisor определяет экземпляры кэша в этих условиях. Рекомендуется выполнить одно из следующих действий.
- Примените рекомендации, чтобы снизить нагрузку на память, нагрузку на сервер или пропускную способность сети.
- Масштабировать до другого размера или SKU с большей емкостью.

## <a name="add-regions-with-traffic-to-your-azure-cosmos-db-account"></a>Добавление регионов с трафиком в учетную запись Azure Cosmos DB

Advisor обнаруживает Azure Cosmos DB учетных записей, имеющих трафик из региона, который в настоящее время не настроен. Рекомендуется добавить этот регион. Это повышает задержку запросов, поступающих из этого региона, и обеспечивает доступность в случае простоя региона. [Дополнительные сведения о распределении глобальных данных с помощью Azure Cosmos DB.](https://aka.ms/cosmos/globaldistribution)

## <a name="configure-your-azure-cosmos-db-indexing-policy-by-using-custom-included-or-excluded-paths"></a>Настройка политики индексирования Azure Cosmos DB с помощью пользовательских включенных или исключаемых путей

Advisor определяет Azure Cosmos DB контейнеры, которые используют политику индексирования по умолчанию, но могут воспользоваться преимуществами пользовательской политики индексирования. Это определение основано на шаблоне рабочей нагрузки. Политика индексирования по умолчанию индексирует все свойства. Пользовательская политика индексирования с явными включенными или исключенными путями, используемыми в фильтрах запросов, может уменьшить число получателей, которое будет использоваться для индексирования. [Дополнительные сведения об изменении политик индекса.](https://aka.ms/cosmosdb/modify-index-policy)

## <a name="set-your-azure-cosmos-db-query-page-size-maxitemcount-to--1"></a>Установка Azure Cosmos DB размера страницы запроса (Макситемкаунт) в значение-1 

Помощник Azure определяет Azure Cosmos DB контейнеры, использующие размер страницы запроса 100. Для ускорения сканирования рекомендуется использовать размер страницы-1. [Дополнительные сведения о Макситемкаунт.](https://aka.ms/cosmosdb/sql-api-query-metrics-max-item-count)

## <a name="how-to-access-performance-recommendations-in-advisor"></a>Как получить доступ к рекомендациям по производительности в Advisor

1. Войдите на [портал Azure](https://portal.azure.com) и откройте [Помощник](https://aka.ms/azureadvisordashboard).

2.  На панели мониторинга Advisor перейдите на вкладку **Performance (производительность** ).

## <a name="next-steps"></a>Дальнейшие шаги

Чтобы узнать больше о рекомендациях Помощника, ознакомьтесь с приведенными ниже материалами.

* [Общие сведения об Azure Advisor](advisor-overview.md)
* [Начало работы с Помощником](advisor-get-started.md)
* [Рекомендации по стоимости помощника](advisor-cost-recommendations.md)
* [Рекомендации по обеспечению надежности Advisor](advisor-high-availability-recommendations.md)
* [Рекомендации по безопасности Advisor](advisor-security-recommendations.md)
* [Рекомендации для оперативной работы Advisor](advisor-operational-excellence-recommendations.md)
* [REST API Advisor](https://docs.microsoft.com/rest/api/advisor/)
