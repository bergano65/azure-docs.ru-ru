---
title: Поддержка зон доступности для сред службы приложений
description: Узнайте, как развернуть среды службы приложений, чтобы приложения были избыточными в зоне.
author: ccompy
ms.assetid: 24e3e7eb-c160-49ff-8d46-e947818ef186
ms.topic: article
ms.date: 07/15/2020
ms.author: ccompy
ms.custom: seodec18
ms.openlocfilehash: 1b32ae55030cc24c8892b204ff7330269993a483
ms.sourcegitcommit: 3d79f737ff34708b48dd2ae45100e2516af9ed78
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "87098567"
---
# <a name="availability-zone-support-for-app-service-environments"></a>Поддержка зон доступности для сред службы приложений

Среды службы приложений (ASE) можно развернуть в Зоны доступности (AZ).  Клиенты могут развернуть внутренний балансировщик нагрузки (ILB) среды ASE в определенном AZ в регионе Azure. Если закрепить ILB ASE к определенному AZ, ресурсы, используемые ILB ASE, будут либо прикреплены к указанному AZ, либо развернуты в зоне с избыточным способом.  

ILB ASE, явно развернутый в AZ, считается ресурсом зональные, так как ILB ASE закрепляется в определенной зоне. Следующие зависимости ILB ASE будут закреплены в указанной зоне:

- IP-адрес внутренней подсистемы балансировки нагрузки ASE
- ресурсы вычислений, используемые ASE для управления и запуска веб-приложений

Удаленное хранилище файлов для веб-приложений, развернутых на зональные ILB ASE, использует хранилище, избыточное в виде зоны (ZRS).

Если шаги, описанные в этой статье, не выполнены, ILB среды ASE не развертывается автоматически с зональные. Вы не можете закрепить внешний ASE с общедоступным IP-адресом для определенной зоны доступности. 

Зональные ILB среды ASE можно создать в любом из следующих регионов:

- Центральная часть США
- Восточная часть США
- восточная часть США 2
- Восточная часть США 2 ((EUAP))
- Центральная Франция 
- Восточная Япония
- Северная Европа
- Западная Европа
- Юго-Восточная Азия
- южная часть Соединенного Королевства
- Западная часть США 2

Приложения, развернутые в зональные ILB ASE, продолжают работать и обслуживают трафик на этом ASE, даже если другие зоны в том же регионе пристрадает к сбою.  Возможны такие поведения, которые не относятся к среде выполнения, включая; масштабирование плана службы приложений, создание приложений, Настройка приложений и публикация приложений могут быть затронуты из-за сбоя в других зонах доступности. Развернутое в зоне развертывание зональные ILB ASE только гарантирует непрерывную работу уже развертываемых приложений.

## <a name="how-to-deploy-an-app-service-environment-in-an-availability-zone"></a>Развертывание Среда службы приложений в зоне доступности ##

Зональные ILB среды ASE должен быть создан с помощью шаблонов ARM. После создания зональные ILB ASE с помощью шаблона ARM его можно просматривать и взаимодействовать с помощью портал Azure и интерфейса командной строки.  Шаблон ARM необходим только для первоначального создания зональные ILB ASE.

Единственное изменение, необходимое в шаблоне ARM для указания зональные ILB ASE, — это новое свойство ***Zones*** . Свойство ***Zones*** должно иметь значение "1", "2" или "3" в зависимости от логической зоны доступности, в которую будет закрепляться ASE ilB.

В примере фрагмента шаблона ARM ниже показано новое свойство ***Zones*** , указывающее, что ilB ASE должен быть закреплен в зоне 2.

```
   "resources": [
      {
         "type": "Microsoft.Web/hostingEnvironments",
         "kind": "ASEV2",
         "name": "yourASENameHere",
         "apiVersion": "2015-08-01",
         "location": "your location here",
         "zones": [
            "2"
         ],
         "properties": {
         "name": "yourASENameHere",
         "location": "your location here",
         "ipSslAddressCount": 0,
         "internalLoadBalancingMode": "3",
         "dnsSuffix": "contoso-internal.com",
         "virtualNetwork": {
             "Id": "/subscriptions/your-subscription-id-here/resourceGroups/your-resource-group-here/providers/Microsoft.Network/virtualNetworks/your-vnet-name-here",
             "Subnet": "yourSubnetNameHere"
          }
         }
      }
    ]
```

Чтобы сделать зону приложений избыточной, необходимо развернуть два зональные ILB среды ASE. Два зональные ILB среды ASE должны находиться в разных зонах доступности. Затем необходимо развернуть приложения в каждом из ILB среды ASE. После создания приложений необходимо настроить решение для балансировки нагрузки. Рекомендуемым решением будет развертывание вышестоящего [шлюза приложений](https://docs.microsoft.com/azure/application-gateway/application-gateway-autoscaling-zone-redundant) из зональные ilB среды ASE. 

## <a name="in-region-data-residency"></a>В области данных местонахождение ##

ILB среды ASE, развернутый в зоне доступности, будет хранить данные клиентов только в том регионе, где развернута зональные ILB ASE. Содержимое файла веб-сайта, а также параметры и секреты, предоставляемые клиентом в службе приложений, остаются в пределах региона, в котором развернута зональные ILB ASE.

Клиенты гарантируют местонахождение данных в одном регионе, выполнив действия, описанные выше в разделе "развертывание Среда службы приложений в зоне доступности". Настроив Среда службы приложений в соответствии с этими шагами, Среда службы приложений, развернутые в зоне доступности, удовлетворяют требованиям местонахождение данных региона, включая те, что указаны в [центр управления безопасностью Azure](https://azuredatacentermap.azurewebsites.net/).

Клиенты могут проверить, правильно ли настроена Среда службы приложений для хранения данных в одном регионе, выполнив следующие действия. 

1. С помощью [Обозреватель ресурсов](https://resources.azure.com)перейдите к ресурсу ARM для среда службы приложений.  Среды ASE перечислены в разделе *providers/Microsoft. Web/hostingEnvironments*.
2. Если свойство *Zones* существует в представлении синтаксиса языка ARM JSON и содержит однозначный массив JSON со значением "1", "2" или "3", то ASE зоналли развернут и данные клиента остаются в одном регионе.
2. Если свойство *Zones* не существует или свойство не имеет допустимого значения зоны, как указано ранее, то ASE не является зоналли развернутым, а данные клиента не хранятся в монопольном режиме в одном регионе.


