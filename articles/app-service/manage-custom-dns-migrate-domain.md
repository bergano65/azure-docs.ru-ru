---
title: Перенос активного DNS-имени в Службу приложений Azure | Документация Майкрософт
description: Узнайте, как перенести DNS-имя, которое уже назначено работающему сайту, в службу приложений Azure без простоев.
services: app-service
documentationcenter: ''
author: cephalin
manager: gwallace
tags: top-support-issue
ms.assetid: 10da5b8a-1823-41a3-a2ff-a0717c2b5c2d
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.topic: article
ms.date: 10/21/2019
ms.author: cephalin
ms.custom: seodec18
ms.openlocfilehash: 172003b13807720df2431a3610947b36d8303fed
ms.sourcegitcommit: c22327552d62f88aeaa321189f9b9a631525027c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73470362"
---
# <a name="migrate-an-active-dns-name-to-azure-app-service"></a>Перенос активного DNS-имени в службу приложений Azure

В этой статье показано, как перенести активное DNS-имя в [службу приложений Azure](../app-service/overview.md) без простоев.

При переносе работающего сайта и его DNS-имени в службу приложений такое DNS-имя уже обслуживает реальный трафик. Чтобы избежать простоя при разрешении DNS-имен во время миграции, можно предварительно привязать активное DNS-имя к приложению службы приложений.

Если вас не беспокоит простой при разрешении DNS-имен, обратитесь к разделу [Сопоставление существующего настраиваемого DNS-имени со Службой приложений Azure](app-service-web-tutorial-custom-domain.md).

## <a name="prerequisites"></a>Технические условия

Для работы с этим руководством:

- [Убедитесь, что приложение службы приложений не находится в ценовой категории "Бесплатный"](app-service-web-tutorial-custom-domain.md#checkpricing).

## <a name="bind-the-domain-name-preemptively"></a>Заблаговременная привязка доменного имени

Заблаговременно привязывая личный домен, вы выполняете обе из приведенных ниже задач перед внесением каких-либо изменений в записи DNS:

- проверка принадлежности домена;
- включение доменного имени для приложения.

Когда впоследствии вы перенесете настраиваемое DNS-имя из старого приложения в приложение службы приложений, разрешение DNS-имен будет выполняться без простоев.

[!INCLUDE [Access DNS records with domain provider](../../includes/app-service-web-access-dns-records.md)]

### <a name="create-domain-verification-record"></a>Создание записи для проверки домена

Чтобы проверить принадлежность домена, добавьте запись типа TXT. Запись типа TXT выполняет сопоставление из _awverify.&lt;поддомен>_ в _&lt;имя_приложения>.azurewebsites.net_. 

Требуемая запись типа TXT зависит от записи DNS, которую требуется перенести. Примеры см. в следующей таблице (`@` обычно обозначает корневой домен):

| Пример записи DNS | Узел, для которого задается TXT | Значение TXT |
| - | - | - |
| \@ (root) | _awverify_ | _&lt;имя_приложения>.azurewebsites.net_ |
| www (поддомен) | _awverify.www_ | _&lt;имя_приложения>.azurewebsites.net_ |
| \* (с подстановочным знаком) | _awverify.\*_ | _&lt;имя_приложения>.azurewebsites.net_ |

На странице записей DNS запомните тип DNS-имени, которое требуется перенести. Служба приложений поддерживает сопоставление из записей CNAME и записей A.

> [!NOTE]
> Для некоторых поставщиков, например CloudFlare, `awverify.*` не является допустимой записью. Вместо нее используйте только `*`.

> [!NOTE]
> Записи `*` с подстановочными знаками не позволяют проверять поддомены с существующей записью CNAME. Возможно, понадобится явным образом создать запись типа TXT для каждого поддомена.


### <a name="enable-the-domain-for-your-app"></a>Включение домена для приложения

В левой области навигации страницы приложения на [портале Azure](https://portal.azure.com) выберите **Личные домены**. 

![Меню личных доменов](./media/app-service-web-tutorial-custom-domain/custom-domain-menu.png)

На странице **Личные домены** щелкните значок **+** рядом с пунктом **Добавить имя узла**.

![Добавление имени узла](./media/app-service-web-tutorial-custom-domain/add-host-name-cname.png)

Введите полное доменное имя, для которого вы добавили запись типа TXT, например `www.contoso.com`. Для домена с подстановочным знаком (например, \*.contoso.com) можно использовать любое DNS-имя, которое совпадает с доменом с подстановочным знаком. 

Выберите **Проверка**.

После этого активируется кнопка **Добавить имя узла**. 

Убедитесь, что в качестве значения параметра **Тип записи имени узла** задан тип записи DNS, которую необходимо перенести.

Выберите **Добавить имя узла**.

![Добавление DNS-имени в приложение](./media/app-service-web-tutorial-custom-domain/validate-domain-name-cname.png)

Возможно, потребуется некоторое время для того, чтобы новое имя узла отобразилось на странице **Личные домены** вашего приложения. Попробуйте обновить браузер, чтобы обновить данные.

![Запись CNAME добавлена](./media/app-service-web-tutorial-custom-domain/cname-record-added.png)

Теперь DNS-имя включено в приложении Azure. 

## <a name="remap-the-active-dns-name"></a>Изменение сопоставления активного DNS-имени

Теперь осталось только изменить сопоставление вашей активной записи DNS, чтобы она указывала на службу приложений. В настоящий момент она по-прежнему указывает на ваш старый веб-сайт.

<a name="info"></a>

### <a name="copy-the-apps-ip-address-a-record-only"></a>Копирование IP-адреса приложения (только запись A)

Если выполняется сопоставление записи CNAME, пропустите этот раздел. 

Чтобы повторно сопоставить запись A, требуется внешний IP-адрес приложения службы приложений, который указан на странице **Личные домены**.

Закройте страницу **Добавить имя узла**, щелкнув значок **X** в правом верхнем углу. 

На странице **Личные домены** скопируйте IP-адрес приложения.

![Переход к приложению Azure на портале](./media/app-service-web-tutorial-custom-domain/mapping-information.png)

### <a name="update-the-dns-record"></a>Обновление записи DNS

Вернитесь на страницу записей DNS вашего поставщика домена и выберите запись DNS для повторного сопоставления.

В примере с корневым доменом `contoso.com` повторно сопоставьте запись A или запись CNAME, как показано в примерах в следующей таблице: 

| Пример полного доменного имени | Тип записи | Узел | Значение |
| - | - | - | - |
| contoso.com (корневой домен) | A | `@` | IP-адрес из раздела [Копирование IP-адреса приложения](#info). |
| веб-\.contoso.com (подсистема) | CNAME | `www` | _&lt;имя_приложения>.azurewebsites.net_ |
| \*.contoso.com (с подстановочным знаком) | CNAME | _\*_ | _&lt;имя_приложения>.azurewebsites.net_ |

Сохраните параметры.

Разрешение запросов DNS должно начаться в приложении службы приложений сразу после распространения DNS.

## <a name="active-domain-in-azure"></a>Активный домен в Azure

Вы можете перенести активный личный домен в Azure, между подписками или в рамках одной подписки. Однако такой перенос без простоя требует, чтобы исходное приложение и целевое приложение назначили один и тот же личный домен в определенное время. Поэтому необходимо убедиться, что два приложения не развернуты в одной и той же единице развертывания (внутреннее название — веб-пространство). Доменное имя может быть назначено только одному приложению в каждой единице развертывания.

Вы можете найти единицу развертывания для приложения, просмотрев доменное имя URL-адреса FTP/S `<deployment-unit>.ftp.azurewebsites.windows.net`. Проверьте и убедитесь, что единица развертывания отличается между исходным и целевым приложениями. Единица развертывания приложения определяется [планом службы приложений](overview-hosting-plans.md) , в котором он находится. Он выбирается случайным образом в Azure при создании плана и не может быть изменен. В Azure только два плана находятся в одной и той же единице развертывания при [их создании в той же группе ресурсов *и* одном регионе](app-service-plan-manage.md#create-an-app-service-plan), но нет логики, чтобы убедиться в том, что планы находятся в разных единицах развертывания. Единственным способом создания плана в другой единице развертывания является создание плана в новой группе ресурсов или регионе до тех пор, пока вы не получите другую единицу развертывания.

## <a name="next-steps"></a>Дальнейшие действия

Узнайте о том, как привязать настраиваемый SSL-сертификат к службе приложений.

> [!div class="nextstepaction"]
> [Привязка SSL-сертификата к службе приложений Azure](configure-ssl-bindings.md)
