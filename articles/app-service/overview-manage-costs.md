---
title: Планирование управления затратами для службы приложений
description: Узнайте, как планировать и управлять затратами для службы приложений Azure с помощью анализа затрат в портал Azure.
ms.custom: subject-cost-optimization
ms.service: app-service
ms.topic: how-to
ms.date: 01/01/2021
ms.openlocfilehash: 9d742606435f62d48446bb8ad56ece7a31b76e47
ms.sourcegitcommit: 78ecfbc831405e8d0f932c9aafcdf59589f81978
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2021
ms.locfileid: "98736227"
---
# <a name="plan-and-manage-costs-for-azure-app-service"></a>Планирование и управление затратами для службы приложений Azure

<!-- Check out the following published examples:
- [https://docs.microsoft.com/azure/cosmos-db/plan-manage-costs](../cosmos-db/plan-manage-costs.md)
- [https://docs.microsoft.com/azure/storage/common/storage-plan-manage-costs](../storage/common/storage-plan-manage-costs.md)
- [https://docs.microsoft.com/azure/machine-learning/concept-plan-manage-cost](../machine-learning/concept-plan-manage-cost.md)
-->

<!-- Note for Azure service writer: Links to Cost Management articles are full URLS with the ?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn campaign suffix. Leave those URLs intact. They're used to measure traffic to Cost Management articles.
-->

<!-- Note for Azure service writer: Modify the following for your service. -->

В этой статье описывается планирование и управление затратами для службы приложений Azure. Сначала вы используете калькулятор цен Azure, чтобы помочь спланировать затраты на службу приложений, прежде чем добавлять ресурсы для службы для оценки затрат. После добавления ресурсов Azure ознакомьтесь с оценочными затратами. После начала работы с ресурсами службы приложений используйте функции [управления затратами](../cost-management-billing/index.yml?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) для установки бюджетов и отслеживания затрат. Вы также можете просматривать прогнозные затраты и выявление тенденций расходов для выявления областей, в которых может потребоваться выполнить действия. Стоимость службы приложений Azure — это лишь часть ежемесячных затрат в счете Azure. Хотя в этой статье объясняется, как спланировать и управлять затратами для службы приложений, вы оплачиваете все службы и ресурсы Azure, используемые в вашей подписке Azure, включая сторонние службы.

## <a name="relevant-costs-for-app-service"></a>Важные затраты на службу приложений

Служба приложений работает в инфраструктуре Azure, которая начисляется стоимость. Важно понимать, что дополнительная инфраструктура может начислять затраты. Необходимо управлять этими затратами при внесении изменений в развернутые ресурсы.

### <a name="costs-that-accrue-with-azure-app-service"></a>Затраты, которые начисляются с помощью службы приложений Azure

В зависимости от того, какая функция используется в службе приложений, могут быть созданы следующие ресурсы для начисления затрат:

- **План службы приложений**  Требуется для размещения приложения службы приложений.
- **Изолированный уровень**  Для среды службы приложений требуется [Виртуальная сеть](../virtual-network/index.yml) .
- **Резервное копирование**  Для создания резервных копий требуется [учетная запись хранения](../storage/index.yml) .
- **Журналы диагностики**  Вы можете выбрать [учетную запись хранения](../storage/index.yml) в качестве параметра ведения журнала или интегрировать ее с [Azure log Analytics](../azure-monitor/log-query/log-analytics-tutorial.md).
- **Сертификаты службы приложений**  Сертификаты, приобретаемые в Azure, должны храниться в [Azure Key Vault](../key-vault/index.yml).

Другие ресурсы затрат для службы приложений (см. Дополнительные сведения о [ценах на службу приложений](https://azure.microsoft.com/pricing/details/app-service/) ):

- [Домены службы приложений](manage-custom-dns-buy-domain.md)  При включении автоматического продления подписка на регистрацию в домене наследуется ежегодно.
- [Сертификаты службы приложений](configure-ssl-certificate.md#import-an-app-service-certificate)  Одноразовая оплата во время покупки. При наличии нескольких поддоменов для обеспечения безопасности можно снизить затраты, приобретя один подстановочный сертификат вместо нескольких стандартных сертификатов.
- [Привязки сертификатов на основе IP-адресов](configure-ssl-bindings.md#create-binding)  Привязка настраивается для сертификата на уровне приложения. Затраты начисляются для каждой привязки. Для уровня **Standard** и выше первая привязка на основе IP не заряжена.

### <a name="costs-that-might-accrue-after-resource-deletion"></a>Затраты, которые могут быть начислены после удаления ресурса

При удалении всех приложений в плане службы приложений план продолжит начислять расходы на основе настроенной ценовой категории и количества экземпляров. Чтобы избежать нежелательной оплаты, удалите план или масштабируйте его на **бесплатный** уровень.

После удаления ресурсов службы приложений Azure ресурсы из связанных служб Azure могут продолжать существовать. Они продолжают начислять затраты до тех пор, пока вы не удалите их. Например:

- Виртуальная сеть, созданная для плана службы приложений **изолированного** уровня.
- Учетные записи хранения, созданные для хранения резервных копий или журналов диагностики
- Key Vault, созданные для хранения сертификатов службы приложений
- Журналы аналитических пространств, созданные для отправки журналов диагностики
- Для службы приложений еще не истек срок действия [резервирования экземпляра или штампа](#azure-reservations)

### <a name="using-monetary-credit-with-azure-app-service"></a>Использование денежного кредита в службе приложений Azure

Вы можете платить за службу приложений Azure с помощью предоплаты Azure (ранее называлось денежным обязательством). Однако вы не можете использовать предварительную оплату Azure для оплаты за продукты и услуги сторонних производителей, в том числе из Azure Marketplace.

## <a name="estimate-costs"></a>Оценка затрат

Простой способ оценки и оптимизации затрат на службу приложений — это использование [калькулятора цен Azure](https://azure.microsoft.com/pricing/calculator/).

Чтобы использовать калькулятор цен, щелкните **служба приложений** на вкладке **продукты** . Затем прокрутите экран вниз, чтобы работать с калькулятором. На следующем снимке экрана приведен пример, который не отражает текущие цены.

![Пример, в котором показана оценочная стоимость в калькуляторе цен Azure](media/overview-manage-costs/pricing-calculator.png)

### <a name="review-estimated-costs-in-the-azure-portal"></a>Просмотр предполагаемых затрат на портале Azure

При создании приложения службы приложений или плана службы приложений можно увидеть оценочные затраты.

Чтобы создать приложение и просмотреть оценочную цену, сделайте следующее:

1. На странице Создание прокрутите вниз до **плана службы приложений** и щелкните **создать**.
1. Укажите имя и нажмите кнопку **ОК**.
1. Рядом с полем **SKU и размер** выберите **изменить размер**.
1. Ознакомьтесь с оценочной ценой, показанной в сводке. На следующем снимке экрана приведен пример, который не отражает текущие цены.

    ![Обзор оценочных затрат для каждой ценовой категории на портале](media/overview-manage-costs/pricing-estimates.png)

Если у вашей подписки Azure есть предельная сумма расходов, Azure не позволит вам тратить деньги на сумму кредита. При создании и использовании ресурсов Azure используются ваши кредиты. При достижении лимита кредита развернутые ресурсы отключаются в оставшейся части этого расчетного периода. Вы не можете изменить лимит кредита, но можете удалить его. Дополнительные сведения об ограничениях расходов см. в статье [предельная сумма расходов в Azure](../cost-management-billing/manage/spending-limit.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).

## <a name="optimize-costs"></a>Оптимизация затрат

На базовом уровне приложения службы приложений начисляются по плану службы приложений, в котором они размещены. Затраты, связанные с развертыванием службы приложений, зависят от нескольких основных факторов:

- **Ценовая**  Категория  В ином случае называется SKU плана службы приложений. Более высокие уровни предоставляют больше ядер ЦП, памяти, хранилища, функций или их сочетаний.
- Выделенные уровни **количества экземпляров** (базовый и более поздние) можно масштабировать, и каждый масштабируемый экземпляр начисляется затратами.
- **Плата за отметку**  В изолированном уровне фиксированная плата начисляется в среде службы приложений независимо от количества размещенных приложений или экземпляров рабочих ролей.

План службы приложений может содержать более одного приложения. В зависимости от развертывания можно сэкономить затраты на размещение большего количества приложений в одном из планов службы приложений (т. е. размещение приложений в нескольких планах службы приложений).

Дополнительные сведения см. в разделе [Общие сведения о плане службы приложений](overview-hosting-plans.md) .

### <a name="non-production-workloads"></a>Рабочие нагрузки, не являющиеся производственными

Чтобы протестировать службу приложений или решение при начислении небольших или минимальных затрат, можно начать с использования двух ценовых категорий на уровне начального уровня — " **бесплатный** " и " **Общий**", которые размещаются на общих экземплярах. Чтобы протестировать приложение на выделенных экземплярах с повышенной производительностью, можно выполнить обновление до уровня " **базовый** ", поддерживающего приложения Windows и Linux. 

> [!NOTE]
> **Цены на разработку и тестирование Azure**  Для тестирования подготовительных рабочих нагрузок, для которых требуются более высокие уровни (все уровни, кроме **изолированных**), подписчики Visual Studio также могут воспользоваться преимуществами [цен на разработку и тестирование Azure](https://azure.microsoft.com/pricing/dev-test/), которые предлагают значительные скидки.
>
> Уровень " **бесплатный** " и " **Общий** ", а также ценовые скидки для разработки и тестирования Azure не содержат соглашения об уровне обслуживания с финансовыми гарантиями.

### <a name="production-workloads"></a>Производственные рабочие нагрузки

Производственные рабочие нагрузки поставляются с рекомендацией по выделенной ценовой категории **Standard** или выше. Хотя цена наступает на более высокие уровни, она также предоставляет больше ресурсов памяти, хранилища и более производительного оборудования, что обеспечивает более высокую плотность приложений на каждый вычислительный экземпляр. Это приводит к уменьшению числа экземпляров для того же числа приложений и, следовательно, более низкой стоимости. Фактически, уровень **Premium v3** (самый высокий **неизолированный** ) является наиболее экономичным способом обслуживания приложения в масштабе. Чтобы добавить к экономии, можно получить подробную скидку на [резервирование уровня "Премиум v3](#azure-reservations)".

> [!NOTE]
> **Premium v3** поддерживает как контейнеры Windows, так и контейнеры Linux. 

Выбрав нужную ценовую категорию, вы должны сделать неактивные экземпляры минимальными. В масштабном развертывании можно тратить деньги на использование недостаточного числа вычислений. Необходимо [настроить автоматическое масштабирование](../azure-monitor/platform/autoscale-get-started.md), доступное на уровне **стандартный** и выше. Создавая расписаний горизонтального масштабирования, а также правила горизонтального масштабирования на основе метрик, вы платите только за те экземпляры, которые действительно необходимы в любой конкретный момент времени.

### <a name="azure-reservations"></a>Резервирования Azure

Если вы планируете использовать известное минимальное количество вычислительных экземпляров в течение одного года или более, следует воспользоваться преимуществами уровня **Premium v3** и радикально снизить стоимость экземпляра за счет резервирования этих экземпляров с шагом в 1 год или 3 года. Месячная экономия затрат может составлять до 55% на каждый экземпляр. Возможны два типа резервирования:

- **Windows (или независимая от платформы)**  Может применяться к экземплярам Windows или Linux в подписке.
- **Только для Linux**  Применяется только к экземплярам Linux в подписке.

Цены на зарезервированные экземпляры применяются к применимым экземплярам в подписке вплоть до количества зарезервированных экземпляров. Зарезервированные экземпляры относятся к оплате и не привязаны к конкретным экземплярам вычислений. Если вы запускаете меньшее количество экземпляров, чем вы резервируете в любой момент в течение периода резервирования, вы по-прежнему платите за зарезервированные экземпляры. Если вы запускаете больше экземпляров, чем вы резервируете в любой момент в течение периода резервирования, вы оплачиваете нормальную стоимость дополнительных экземпляров.

**Изолированный** уровень (среда службы приложений) также поддерживает резервирование на 1 год и 3 года по сниженным ценам. Дополнительные сведения см. [в разделе как скидки на резервирование применяются к](../cost-management-billing/reservations/reservation-discount-app-service-isolated-stamp.md)отметкам служба приложений (цен. Категория "изолированный") Azure.

## <a name="monitor-costs"></a>Мониторинг затрат

При использовании ресурсов Azure со службой приложений издержки взимается плата. Затраты на единицу использования ресурсов Azure зависят от временных интервалов (секунды, минуты, часы и дни). Как только начнется использование службы приложений, издержки будут затратны, и вы сможете просмотреть затраты в [анализе затрат](../cost-management-billing/costs/quick-acm-cost-analysis.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).

При использовании анализа затрат вы просматриваете затраты на службы приложений в графиках и таблицах для различных временных интервалов. Некоторые примеры относятся к дню, текущему и предыдущему месяцу и году. Вы также можете просматривать затраты по бюджету и прогнозируемым затратам. Переключение на более длительные представления с течением времени может помочь определить тенденции расходов. И вы видите, где может произойти чрезмерная трата. Если вы создали бюджеты, можно легко увидеть, где они превышаются.
    
Чтобы просмотреть затраты на службу приложений в анализе затрат:

1. Войдите на портал Azure.
2. Откройте область в портал Azure и выберите **анализ затрат** в меню. Например, перейдите к разделу **подписки**, выберите подписку из списка, а затем в меню выберите  **анализ затрат** . Выберите **область** , чтобы переключиться на другую область в анализе затрат.
3. По умолчанию стоимость служб показана на первой кольцевой диаграмме. Выберите область диаграммы с меткой служба приложений.

Фактические месячные затраты отображаются при первоначальном открытии анализа затрат. Ниже приведен пример, показывающий все ежемесячные затраты на использование.

![Пример, демонстрирующий накопленные затраты для подписки](media/overview-manage-costs/all-costs.png)

Чтобы уменьшить затраты на одну службу, например службу приложений, щелкните **Добавить фильтр** , а затем выберите **имя службы**. Затем выберите **служба приложений**.

Ниже приведен пример, показывающий затраты только на службу приложений.

![Пример, в котором показаны накопленные затраты для ServiceName](media/overview-manage-costs/service-specific-costs.png)

В предыдущем примере вы видите текущие затраты на службу. Также показаны затраты на регионы Azure (расположения) и стоимость службы приложений по группам ресурсов. Здесь вы можете исследовать затраты самостоятельно.

## <a name="create-budgets"></a>Создание бюджетов

<!-- Note to Azure service writer: Modify the following as needed for your service. -->

Вы можете создавать [бюджеты](../cost-management-billing/costs/tutorial-acm-create-budgets.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) для управления затратами и создавать [оповещения](../cost-management-billing/costs/cost-mgt-alerts-monitor-usage-spending.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) , которые автоматически уведомляют заинтересованных лиц о трате аномалий и чрезмерной трате рисков. Оповещения основываются на расходах по сравнению с пороговыми значениями бюджета и затрат. Бюджеты и оповещения создаются для подписок Azure и групп ресурсов, поэтому они полезны в рамках общей стратегии мониторинга затрат. 

Бюджеты можно создавать с помощью фильтров для конкретных ресурсов или служб в Azure, если требуется дополнительная детализация в мониторинге. Фильтры помогают предотвратить случайное создание новых ресурсов, изменяющих дополнительные деньги. Дополнительные сведения о параметрах фильтра, доступных при создании бюджета, см. в разделе [Параметры группы и фильтра](../cost-management-billing/costs/group-filter.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).

## <a name="export-cost-data"></a>Экспорт данных о затратах

Вы также можете [экспортировать данные о затратах](../cost-management-billing/costs/tutorial-export-acm-data.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) в учетную запись хранения. Это полезно, если вам или другим пользователям нужно выполнить больше анализа данных за затраты. Например, Группа финансов может анализировать данные с помощью Excel или Power BI. Вы можете экспортировать затраты на ежедневное, еженедельное или ежемесячное расписание и задать настраиваемый диапазон дат. Для извлечения наборов данных о затратах рекомендуется экспортировать данные о затратах.

## <a name="next-steps"></a>Следующие шаги

- Узнайте больше о том, как цены работают со службой хранилища Azure. См. [цены на Службу приложений](https://azure.microsoft.com/pricing/details/app-service/).
- Узнайте [, как оптимизировать инвестиции в облако с помощью службы "Управление затратами Azure](../cost-management-billing/costs/cost-mgt-best-practices.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn)".
- Дополнительные сведения об управлении затратами с помощью [анализа затрат](../cost-management-billing/costs/quick-acm-cost-analysis.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).
- Узнайте, как [предотвратить непредвиденные затраты](../cost-management-billing/cost-management-billing-overview.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).
- Пройдите курс обучения по [управлению затратами](/learn/paths/control-spending-manage-bills?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) .

<!-- Insert links to other articles that might help users save and manage costs for you service here.

Create a table of contents entry for the article in the How-to guides section where appropriate. -->