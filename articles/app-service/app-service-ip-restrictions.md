---
title: Запрет IP-адресов клиентов в Службе приложений Azure | Документация Майкрософт
description: Как использовать ограничения доступа со службой приложений Azure
author: ccompy
manager: stefsch
editor: ''
services: app-service\web
documentationcenter: ''
ms.assetid: 3be1f4bd-8a81-4565-8a56-528c037b24bd
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 07/30/2018
ms.author: ccompy
ms.custom: seodec18
ms.openlocfilehash: bb6ab29f02282a394e3f93e41682ceaec5208b75
ms.sourcegitcommit: 43b85f28abcacf30c59ae64725eecaa3b7eb561a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59357618"
---
# <a name="azure-app-service-static-access-restrictions"></a>Ограничения статических доступа к службе приложений Azure #

Ограничения доступа позволяют определять приоритет упорядоченный разрешает или запрещает список IP-адресов, которые могут получить доступ к приложению. Список разрешений может содержать IPv4- и IPv6-адреса. Если он содержит одну или несколько записей, то действует неявный запрет на все адреса в конце этого списка.

Возможность ограничения доступа работает со всеми рабочие нагрузки, которые включают; размещенное в службе веб-приложений, приложений API, приложения под управлением Linux, приложения-контейнеры Linux и функции.

При запросе к приложению, из IP-адрес сравнивается с списке ограничений доступа. Если доступ с этого адреса запрещен правилами в списке, служба возвращает код состояния [HTTP 403](https://en.wikipedia.org/wiki/HTTP_403).

Возможность ограничения доступа реализуется в ролях переднего плана службы приложений, которые являются вышестоящего рабочих узлов, где выполняется код. Таким образом ограничения доступа действуют списки управления сетевым доступом.  

![процесс ограничения доступа](media/app-service-ip-restrictions/ip-restrictions-flow.png)

В течение времени возможность ограничения доступа на портале был уровень поверх ipSecurity возможности в службах IIS. Эта возможность ограничения доступа отличается. IpSecurity по-прежнему можно настроить в файле web.config приложения, но переднего плана на основе правил ограничения доступа применяются перед любой трафик достигнет IIS.

## <a name="adding-and-editing-access-restriction-rules-in-the-portal"></a>Добавление и изменение правил ограничения доступа на портале ##

Чтобы добавить правило ограничения доступа к приложению, используйте меню, чтобы открыть **сети**>**ограничения доступа** и щелкнуть **настроить ограничения доступа**

![Сетевые возможности службы приложений](media/app-service-ip-restrictions/ip-restrictions.png)  

В пользовательском Интерфейсе ограничения доступа можно просмотреть список правил ограничения доступа, определили для своего приложения.

![Список ограничений доступа](media/app-service-ip-restrictions/ip-restrictions-browse.png)

Если правила были настроены, как показано на рисунке, то ваше приложение будет принимать только трафик с адреса 131.107.159.0/24 и отклонять трафик с любого другого IP-адреса.

Вы можете щелкнуть **[+] добавить** добавить новое правило ограничения доступа. После добавления правило немедленно вступает в действие. Правила применяются в порядке возрастания приоритета, начиная с наименьшего числа. После добавления даже одного правила действует неявный запрет всего, что было разрешено на текущий момент.

![Добавить правило ограничения доступа](media/app-service-ip-restrictions/ip-restrictions-add.png)

В нотации CIDR для IPv4- и IPv6-адресов должна быть указана нотация IP-адреса. Чтобы указать точный адрес, можно использовать формат 1.2.3.4/32, где первые четыре октета представляют IP-адрес, а /32 — маску. Нотацией CIDR IPv4 для всех адресов является 0.0.0.0/0. Чтобы узнать больше о нотации CIDR, можно прочитать раздел [Бесклассовая адресация](https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing).  

Можно щелкнуть любую строку, чтобы изменить существующее правило ограничения доступа. Изменения вступают в силу немедленно, включая изменения порядка приоритетов.

![изменить правило ограничения доступа](media/app-service-ip-restrictions/ip-restrictions-edit.png)

Чтобы удалить правило, щелкните **...** для правила и выберите **Удалить**.

![удалить правило ограничения доступа](media/app-service-ip-restrictions/ip-restrictions-delete.png)

Можно также ограничить доступ развертывания на вкладке "Далее". Чтобы добавить, изменить или удалить каждому правилу, выполните тот же шаг, как описано выше.

![Список ограничений доступа](media/app-service-ip-restrictions/ip-restrictions-scm-browse.png)

## <a name="programmatic-manipulation-of-access-restriction-rules"></a>Программные манипуляции правила ограничения доступа ##

В настоящее время нет интерфейса командной строки или PowerShell для ограничения доступа к новым возможностям, но значения могут быть установлены вручную с помощью операции PUT о конфигурации приложения в диспетчере ресурсов. Например, можно использовать resources.azure.com и изменить блок ipSecurityRestrictions, чтобы добавить необходимый код JSON.

Эти сведения в Resource Manager находятся здесь:

management.azure.com/subscriptions/**ИД_подписки**/resourceGroups/**группы_ресурсов**/providers/Microsoft.Web/sites/**имя_веб-приложения**/config/web?api-version=2018-02-01

Ниже показан синтаксис JSON для приведенного выше примера.

    "ipSecurityRestrictions": [
      {
        "ipAddress": "131.107.159.0/24",
        "action": "Allow",
        "tag": "Default",
        "priority": 100,
        "name": "allowed access"
      }
    ],

## <a name="function-app-ip-restrictions"></a>Ограничения IP-адрес приложения функции

Ограничения IP-адресов доступны для обоих приложений-функций с ту же функциональность, что планы службы приложений. Обратите внимание на то, что IP-адреса ограничения приведет к отключению редактор кода портала для всех запрещенных IP-адресов.

[Дополнительные сведения](../azure-functions/functions-networking-options.md#inbound-ip-restrictions)