---
title: Настройка приложений на портале
description: Узнайте, как настроить общие параметры для приложения службы приложений в портал Azure. Параметры приложения, строки подключения, платформа, стек языка, контейнер и т. д.
keywords: служба приложений Azure, веб-приложение, параметры приложения, переменные среды
ms.assetid: 9af8a367-7d39-4399-9941-b80cbc5f39a0
ms.topic: article
ms.date: 08/13/2019
ms.custom: seodec18
ms.openlocfilehash: 45de3b79263fd43a93fcea73c271ede4bc5f96fe
ms.sourcegitcommit: 265f1d6f3f4703daa8d0fc8a85cbd8acf0a17d30
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2019
ms.locfileid: "74671965"
---
# <a name="configure-an-app-service-app-in-the-azure-portal"></a>Настройка приложения службы приложений в портал Azure

В этом разделе объясняется, как настроить общие параметры для веб-приложений, серверной части для мобильных устройств или приложения API с помощью [портале Azure].

## <a name="configure-app-settings"></a>Настройка параметров приложения

В службе приложений параметры приложения являются переменными, передаваемыми как переменные среды в код приложения. Для приложений и пользовательских контейнеров Linux служба приложений передает параметры приложения в контейнер с помощью флага `--env`, чтобы задать переменную среды в контейнере.

В [портале Azure]перейдите на страницу управления приложением. В меню слева приложения щелкните **конфигурация** > **Параметры приложения**.

![Параметры приложения](./media/configure-common/open-ui.png)

Для разработчиков ASP.NET и ASP.NET Core Установка параметров приложения в службе приложений выполняется так же, как и в `<appSettings>` в *файле Web. config* или *appSettings. JSON*, но значения в службе приложений переопределяются в *файле Web. config* или *appSettings. JSON*. Параметры разработки (например, локальный пароль MySQL) можно использовать в *файле Web. config* или *appSettings. JSON*, но в службе приложений могут быть защищены рабочие секреты (например, пароль базы данных MySQL в Azure). Этот же код использует параметры разработки при локальной отладке и использует свои рабочие секреты при развертывании в Azure.

Другие стеки языков, аналогично, получают параметры приложения в виде переменных среды во время выполнения. Инструкции по стеку для конкретного языка см. в следующих статьях:

- [ASP.NET Core](containers/configure-language-dotnetcore.md#access-environment-variables)
- [Node.js](containers/configure-language-nodejs.md#access-environment-variables)
- [PHP](containers/configure-language-php.md#access-environment-variables)
- [Python](containers/how-to-configure-python.md#access-environment-variables)
- [Java](containers/configure-language-java.md#data-sources)
- [Ruby](containers/configure-language-ruby.md#access-environment-variables)
- [Пользовательские контейнеры](containers/configure-custom-container.md#configure-environment-variables)

Параметры приложения всегда шифруются при хранении.

> [!NOTE]
> Параметры приложения можно также разрешить из [Key Vault](/azure/key-vault/) с помощью [Key Vault ссылок](app-service-key-vault-references.md).

### <a name="show-hidden-values"></a>Показывать скрытые значения

По умолчанию для обеспечения безопасности значения параметров приложения скрыты на портале. Чтобы увидеть скрытое значение параметра приложения, щелкните поле **значение** этого параметра. Чтобы просмотреть значения всех параметров приложения, нажмите кнопку **Показать значение** .

### <a name="add-or-edit"></a>Добавить или изменить

Чтобы добавить новый параметр приложения, щелкните **создать параметр приложения**. В диалоговом окне можно [прикрепить параметр к текущему слоту](deploy-staging-slots.md#which-settings-are-swapped).

Чтобы изменить параметр, нажмите кнопку " **изменить** " справа.

По завершении нажмите кнопку **Обновить**. Не забудьте нажать кнопку **сохранить** назад на странице **Конфигурация** .

> [!NOTE]
> В контейнере Linux по умолчанию или в пользовательском контейнере Linux любая вложенная структура ключей JSON в имени параметра приложения, например `ApplicationInsights:InstrumentationKey`, должна быть настроена в службе приложений как `ApplicationInsights__InstrumentationKey` для имени ключа. Иными словами, любые `:` должны быть заменены `__` (двойное подчеркивание).
>

### <a name="edit-in-bulk"></a>Изменить в групповой операции

Чтобы добавить или изменить параметры приложения в групповой операции, нажмите кнопку **Расширенное редактирование** . По завершении нажмите кнопку **Обновить**. Не забудьте нажать кнопку **сохранить** назад на странице **Конфигурация** .

Параметры приложения имеют следующее форматирование JSON:

```json
[
  {
    "name": "<key-1>",
    "value": "<value-1>",
    "slotSetting": false
  },
  {
    "name": "<key-2>",
    "value": "<value-2>",
    "slotSetting": false
  },
  ...
]
```

## <a name="configure-connection-strings"></a>Настройка строк подключения

В [портале Azure]перейдите на страницу управления приложением. В меню слева приложения щелкните **конфигурация** > **Параметры приложения**.

![Параметры приложения](./media/configure-common/open-ui.png)

Для разработчиков ASP.NET и ASP.NET Core установка строк подключения в службе приложений выполняется так же, как и в `<connectionStrings>` в *файле Web. config*, но значения, заданные в службе приложений, переопределяются в *файле Web. config*. Можно использовать параметры разработки (например, файл базы данных) в файле *Web. config* и рабочих секретах (например, учетные данные базы данных SQL) в службе приложений. Этот же код использует параметры разработки при локальной отладке и использует свои рабочие секреты при развертывании в Azure.

Для других стеков языков лучше использовать [Параметры приложения](#configure-app-settings) , так как для доступа к значениям строкам подключения требуется специальное форматирование в переменных ключах. Вот одно исключение. Однако при настройке строк подключения в приложении резервное копирование некоторых типов баз данных Azure выполняется вместе с приложением. Дополнительные сведения см. в разделе [что получает резервное копирование](manage-backup.md#what-gets-backed-up). Если эта автоматическая архивация не нужна, используйте параметры приложения.

Во время выполнения строки подключения доступны в виде переменных среды с префиксом со следующими типами соединений:

* SQL Server: `SQLCONNSTR_`
* MySQL: `MYSQLCONNSTR_`
* База данных SQL: `SQLAZURECONNSTR_`
* Пользовательская: `CUSTOMCONNSTR_`

Например, можно получить доступ к строке подключения MySql с именем *connectionstring1* в качестве переменной среды `MYSQLCONNSTR_connectionString1`. Инструкции по стеку для конкретного языка см. в следующих статьях:

- [ASP.NET Core](containers/configure-language-dotnetcore.md#access-environment-variables)
- [Node.js](containers/configure-language-nodejs.md#access-environment-variables)
- [PHP](containers/configure-language-php.md#access-environment-variables)
- [Python](containers/how-to-configure-python.md#access-environment-variables)
- [Java](containers/configure-language-java.md#data-sources)
- [Ruby](containers/configure-language-ruby.md#access-environment-variables)
- [Пользовательские контейнеры](containers/configure-custom-container.md#configure-environment-variables)

Строки подключения всегда шифруются при хранении.

> [!NOTE]
> Строки подключения можно также разрешить из [Key Vault](/azure/key-vault/) с помощью [Key Vault ссылок](app-service-key-vault-references.md).

### <a name="show-hidden-values"></a>Показывать скрытые значения

По умолчанию значения для строк подключения скрыты на портале для обеспечения безопасности. Чтобы увидеть скрытое значение строки подключения, просто щелкните поле **значение** этой строки. Чтобы просмотреть значения всех строк подключения, нажмите кнопку **Показать значение** .

### <a name="add-or-edit"></a>Добавить или изменить

Чтобы добавить новую строку подключения, нажмите кнопку **создать строку подключения**. В диалоговом окне можно [прикрепить строку подключения к текущему слоту](deploy-staging-slots.md#which-settings-are-swapped).

Чтобы изменить параметр, нажмите кнопку " **изменить** " справа.

По завершении нажмите кнопку **Обновить**. Не забудьте нажать кнопку **сохранить** назад на странице **Конфигурация** .

### <a name="edit-in-bulk"></a>Изменить в групповой операции

Чтобы добавить или изменить строки подключения в групповой операции, нажмите кнопку **Расширенное редактирование** . По завершении нажмите кнопку **Обновить**. Не забудьте нажать кнопку **сохранить** назад на странице **Конфигурация** .

Строки подключения имеют следующее форматирование JSON:

```json
[
  {
    "name": "name-1",
    "value": "conn-string-1",
    "type": "SQLServer",
    "slotSetting": false
  },
  {
    "name": "name-2",
    "value": "conn-string-2",
    "type": "PostgreSQL",
    "slotSetting": false
  },
  ...
]
```

<a name="platform"></a>
<a name="alwayson"></a>

## <a name="configure-general-settings"></a>Настройка общих параметров

В [портале Azure]перейдите на страницу управления приложением. В меню слева приложения щелкните **конфигурация** > **Параметры приложения**.

![Общие параметры](./media/configure-common/open-general.png)

Здесь можно настроить некоторые общие параметры для приложения. Для некоторых параметров необходимо выполнить [масштабирование до более высоких](manage-scale-up.md)ценовых категорий.

- **Параметры стека**: программный стек для запуска приложения, включая версии языка и пакета SDK. Для приложений Linux и настраиваемых приложений-контейнеров можно также задать необязательную команду запуска или файл.
- **Параметры платформы**: позволяет настраивать параметры для платформы размещения, включая:
    - **Разрядность: 32**-разрядная или 64-разрядная.
    - **Протокол WebSocket**: например, для [ASP.NET SignalR] или [Socket.IO](https://socket.io/).
    - **Always on**: Обеспечьте загрузку приложения даже при отсутствии трафика. Он необходим для непрерывных веб-заданий или для веб-заданий, запускаемых с помощью выражения CRON.
    - **Версия управляемого конвейера**: [режим конвейера]IIS. Если у вас есть устаревшее приложение, для которого требуется более старая версия IIS, задайте **классический** .
    - **Версия HTTP**: значение **2,0** , чтобы включить поддержку протокола [HTTPS/2](https://wikipedia.org/wiki/HTTP/2) .
    > [!NOTE]
    > Большинство современных браузеров поддерживают протокол HTTP/2 только через TLS, а для незашифрованного трафика продолжает использоваться протокол HTTP/1.1. Чтобы обеспечить подключение клиентских браузеров к приложению с помощью HTTP/2, [Защитите настраиваемое DNS-имя с помощью привязки SSL в службе приложений Azure](configure-ssl-bindings.md).
    - **Сопоставление arr**. в развертывании с несколькими экземплярами убедитесь, что клиент направляется на один и тот же экземпляр в течение сеанса. Этот параметр можно установить в значение **Off** для приложений без отслеживания состояния.
- **Отладка**. Включите удаленную отладку для приложений [ASP.NET](troubleshoot-dotnet-visual-studio.md#remotedebug), [ASP.NET Core](/visualstudio/debugger/remote-debugging-azure)или [node. js](containers/configure-language-nodejs.md#debug-remotely) . Этот параметр автоматически отключается через 48 часов.
- **Входящие сертификаты клиентов**: требовать [взаимной проверки подлинности](app-service-web-configure-tls-mutual-auth.md)сертификаты клиентов.

## <a name="configure-default-documents"></a>Настройка документов по умолчанию

Этот параметр предназначен только для приложений Windows.

В [портале Azure]перейдите на страницу управления приложением. В меню слева приложения щелкните **конфигурация** > **документы по умолчанию**.

![Общие параметры](./media/configure-common/open-documents.png)

Документом по умолчанию является веб-страница, отображаемая по корневому URL-адресу веб-сайта. Используется первый найденный файл в списке. Чтобы добавить новый документ по умолчанию, нажмите кнопку **создать документ**. Не забудьте нажать кнопку **сохранить**.

Если приложение использует модули, которые маршрутизируются по URL-адресу вместо использования статического содержимого, нет необходимости использовать документы по умолчанию.

## <a name="configure-path-mappings"></a>Настройка сопоставлений путей

В [портале Azure]перейдите на страницу управления приложением. В меню слева приложения щелкните **конфигурация** > **сопоставления путей**.

![Общие параметры](./media/configure-common/open-path.png)

На странице **сопоставления путей** отображаются разные моменты, основанные на типе ОС.

### <a name="windows-apps-uncontainerized"></a>Приложения Windows (неконтейнерные)

Для приложений Windows можно настроить сопоставления обработчика IIS и виртуальные приложения и каталоги.

Сопоставления обработчиков позволяют добавить обработчики пользовательских скриптов для обработки запросов к конкретным расширениям файлов. Чтобы добавить пользовательский обработчик, нажмите кнопку **создать обработчик**. Настройте обработчик следующим образом:

- **Расширение**. Расширение файла, которое требуется обработано, например *\*. php* или *handler. FCGI*.
- **Обработчик скриптов**. Абсолютный путь к обработчику скрипта. Запросы к файлам, которые соответствуют расширению файла, обрабатываются обработчиком скриптов. Используйте путь `D:\home\site\wwwroot` для указания корневого каталога веб-приложения.
- **Аргументы**. Необязательные аргументы командной строки для обработчика скриптов.

Для каждого приложения используется корневой путь по умолчанию (`/`), сопоставленный с `D:\home\site\wwwroot`, где код развертывается по умолчанию. Если корневой каталог приложения находится в другой папке или в репозитории имеется несколько приложений, вы можете изменить или добавить здесь виртуальные приложения и каталоги. Щелкните **создать виртуальное приложение или каталог**.

Чтобы настроить виртуальные приложения и каталоги, укажите каждый виртуальный каталог и соответствующий физический путь относительно корня веб-сайта (`D:\home`). Или установите флажок **Приложение** , чтобы отметить виртуальный каталог как приложение.

### <a name="containerized-apps"></a>Контейнерные приложения

Вы можете [Добавить пользовательское хранилище для контейнерного приложения](containers/how-to-serve-content-from-azure-storage.md). Контейнерные приложения включают все приложения Linux, а также настраиваемые контейнеры Windows и Linux, выполняющиеся в службе приложений. Щелкните **создать подключение к службе хранилища Azure** и настройте настраиваемое хранилище следующим образом.

- **Имя**: отображаемое имя.
- **Параметры конфигурации**: **базовый** или **Расширенный**.
- **Учетные записи хранения**. учетная запись хранения с нужным контейнером.
- **Тип хранилища**: **большие двоичные объекты Azure** или **файлы Azure**.
  > [!NOTE]
  > Приложения контейнеров Windows поддерживают только файлы Azure.
- **Контейнер хранилища**: для базовой конфигурации — нужного контейнера.
- **Имя общего ресурса**: для дополнительной конфигурации — имя общей папки.
- **Ключ доступа**: для расширенной настройки — ключ доступа.
- **Путь подключения**: абсолютный путь в контейнере для подключения пользовательского хранилища.

Дополнительные сведения см. [в статье обслуживание содержимого из службы хранилища Azure в службе приложений на платформе Linux](containers/how-to-serve-content-from-azure-storage.md).

## <a name="configure-language-stack-settings"></a>Настройка параметров языкового стека

Для приложений Linux см.:

- [ASP.NET Core](containers/configure-language-dotnetcore.md)
- [Node.js](containers/configure-language-nodejs.md)
- [PHP](containers/configure-language-php.md)
- [Python](containers/how-to-configure-python.md)
- [Java](containers/configure-language-java.md)
- [Ruby](containers/configure-language-ruby.md)

## <a name="configure-custom-containers"></a>Настройка пользовательских контейнеров

См. статью [Настройка пользовательского контейнера Linux для службы приложений Azure](containers/configure-custom-container.md) .

## <a name="next-steps"></a>Дальнейшие действия

- [Настройка личного доменного имени в службе приложений Azure]
- [Настройка промежуточных сред в службе приложений Azure]
- [Защита пользовательского доменного имени с помощью привязки SSL в Службе приложений Azure](configure-ssl-bindings.md)
- [Включить журналы диагностики](troubleshoot-diagnostic-logs.md)
- [Масштабирование приложения в службе приложений Azure]
- [Основы мониторинга в службе приложений Azure]
- [Изменение параметров applicationHost. config с помощью файла applicationHost. xdt](https://github.com/projectkudu/kudu/wiki/Xdt-transform-samples)

<!-- URL List -->

[ASP.NET SignalR]: https://www.asp.net/signalr
[портале Azure]: https://portal.azure.com/
[Настройка личного доменного имени в службе приложений Azure]: ./app-service-web-tutorial-custom-domain.md
[Настройка промежуточных сред в службе приложений Azure]: ./deploy-staging-slots.md
[How to: Monitor web endpoint status]: https://go.microsoft.com/fwLink/?LinkID=279906
[Основы мониторинга в службе приложений Azure]: ./web-sites-monitor.md
[режим конвейера]: https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture#Application
[Масштабирование приложения в службе приложений Azure]: ./manage-scale-up.md
