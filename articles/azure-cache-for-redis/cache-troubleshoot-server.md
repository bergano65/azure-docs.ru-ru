---
title: Устранение неполадок, связанных с кэшем Azure для Redis на стороне сервера | Документация Майкрософт
description: Сведения об устранении распространенных проблем на стороне сервера с кэшем Azure для Redis
services: cache
documentationcenter: ''
author: yegu-ms
manager: maiye
editor: ''
ms.assetid: ''
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache
ms.devlang: na
ms.topic: article
ms.date: 10/18/2019
ms.author: yegu
ms.openlocfilehash: 4310c31f2a59ae30b7317d043dc6d92b93fee050
ms.sourcegitcommit: 8e271271cd8c1434b4254862ef96f52a5a9567fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/23/2019
ms.locfileid: "72819618"
---
# <a name="troubleshoot-azure-cache-for-redis-server-side-issues"></a>Устранение неполадок в кэше Azure для Redis неполадок на стороне сервера

В этом разделе обсуждаются проблемы, возникающие из-за состояния кэша Azure для Redis или виртуальных машин, на которых размещается.

- [Нехватка памяти на сервере Redis](#memory-pressure-on-redis-server)
- [Высокая загрузка ЦП или нагрузка на сервер](#high-cpu-usage-or-server-load)
- [Длительно выполняемые команды](#long-running-commands)
- [Ограничение пропускной способности на стороне сервера](#server-side-bandwidth-limitation)

> [!NOTE]
> Шаги по устранению проблем в этой статье также включают в себя указания по выполнению команд Redis и мониторингу различных метрик производительности. Дополнительные сведения и указания см. в разделе [Дополнительные сведения](#additional-information).
>

## <a name="memory-pressure-on-redis-server"></a>Нехватка памяти на сервере Redis

Нехватка памяти на сервере кэширования служит причиной всевозможных проблем с производительностью, которые вызывают задержку обработки запросов. При попадании в нехватку памяти система может выполнить страничную загрузку данных на диск. Именно _ошибки страниц_ существенно замедляют работу системы. Нехватка памяти может возникнуть по следующим причинам.

- Кэш заполняется данными рядом с максимальной емкостью.
- Redis представляет большую фрагментацию памяти. Эта фрагментация чаще всего вызывается хранением больших объектов, так как Redis оптимизирован для небольших объектов.

Redis предоставляет две статистики через команду [info](https://redis.io/commands/info) , которая поможет определить эту ошибку: "used_memory" и "used_memory_rss". [Эти метрики можно просмотреть](cache-how-to-monitor.md#view-metrics-with-azure-monitor) с помощью портала.

Существует несколько возможных изменений, которые можно выполнить, чтобы обеспечить работоспособность использования памяти.

- [Настройте политику памяти](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) и параметры времени завершения срока действия ключей. Эта политика может быть недостаточной, если имеется фрагментация.
- [Настройте значение maxmemory-reserved](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) , которого будет достаточно, чтобы компенсировать фрагментацию памяти.
- Разбейте большие кэшированные объекты на меньшие связанные объекты.
- [Создавайте оповещения](cache-how-to-monitor.md#alerts) о метриках, например об используемой памяти, чтобы получать уведомления о возможных последствиях.
- [Масштабирование](cache-how-to-scale.md) до большего размера кэша с большим объемом памяти.

## <a name="high-cpu-usage-or-server-load"></a>Высокая загрузка ЦП или нагрузка на сервер

Высокая нагрузка на сервер или использование ЦП означает, что сервер не может своевременно обрабатывать запросы. Сервер может медленно реагировать на запросы и не может поддерживать скорость запросов.

[Отслеживайте метрики](cache-how-to-monitor.md#view-metrics-with-azure-monitor) , такие как загрузка ЦП или сервера. Понаблюдайте за пиками загрузки ЦП, которые соответствуют времени ожидания.

Существует несколько изменений, которые можно выполнить для снижения высокой нагрузки на сервер:

- Выясните, что вызывает пиковые выпуски ЦП, такие как [длительные команды](#long-running-commands) , указанные ниже, или сбой страницы из-за высокой нехватки памяти.
- [Создавайте оповещения](cache-how-to-monitor.md#alerts) о таких метриках, как загрузка ЦП или сервера, чтобы получать уведомления о возможных последствиях.
- [Масштабирование](cache-how-to-scale.md) до большего размера кэша с большим объемом ресурсов ЦП.

## <a name="long-running-commands"></a>Длительно выполняемые команды

Некоторые команды Redis больше затрат на выполнение, чем другие. В [документации по командам Redis](https://redis.io/commands) показано время сложности каждой команды. Так как обработка команд Redis является однопотоковой, команда, которая занимает время выполнения, блокирует все остальные, которые поступают после него. Вы должны ознакомиться с командами, которые вы выдаете серверу Redis, чтобы понять их влияние на производительность. Например, команда [Keys](https://redis.io/commands/keys) часто используется, не зная, что это операция O (N). Вы можете избежать ключей с помощью [сканирования](https://redis.io/commands/scan) , чтобы уменьшить пиковые пики.

С помощью команды [SLOWLOG](https://redis.io/commands/slowlog) можно измерять ресурсоемкие команды, выполняемые на сервере.

## <a name="server-side-bandwidth-limitation"></a>Ограничение пропускной способности на стороне сервера

Различные размеры кэша имеют разную пропускную способность сети. Если сервер превышает доступную пропускную способность, данные не будут отправляться клиенту как можно быстрее. Время ожидания запросов клиентов истекло, так как сервер не может быстро отправить данные на клиент.

Метрики "чтение кэша" и "запись в кэш" можно использовать для просмотра объема используемой пропускной способности на стороне сервера. [Эти метрики можно просмотреть](cache-how-to-monitor.md#view-metrics-with-azure-monitor) на портале.

Чтобы устранить ситуации, в которых использование пропускной способности сети близко к максимальной емкости:

- Измените поведение вызова клиента, чтобы снизить потребность в сети.
- [Создавайте оповещения](cache-how-to-monitor.md#alerts) о метриках, таких как чтение кэша или запись в кэш, чтобы получать уведомления в начале возможных последствий.
- [Масштабирование](cache-how-to-scale.md) до большего размера кэша с большей емкостью пропускной способности сети.

## <a name="additional-information"></a>Дополнительные сведения

- [Устранение неполадок, связанных с кэшем Azure для Redis на стороне клиента](cache-troubleshoot-client.md)
- [Какое предложение и размер кэша Redis для Azure мне следует использовать?](cache-faq.md#what-azure-cache-for-redis-offering-and-size-should-i-use)
- [Как измерить и протестировать производительность моего кэша?](cache-faq.md#how-can-i-benchmark-and-test-the-performance-of-my-cache)
- [Как отслеживать кэш Redis для Azure?](cache-how-to-monitor.md)
- [Как выполнять команды Redis?](cache-faq.md#how-can-i-run-redis-commands)
