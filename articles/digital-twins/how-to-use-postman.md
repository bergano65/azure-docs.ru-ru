---
title: Отправка запросов с помощью Postman
titleSuffix: Azure Digital Twins
description: Узнайте, как настроить и использовать POST для тестирования интерфейсов API цифровых двойников Azure.
ms.author: baanders
author: baanders
ms.service: digital-twins
services: digital-twins
ms.topic: how-to
ms.date: 11/10/2020
ms.openlocfilehash: 5dbe161af172b65919328fca0b272f3b658f1b32
ms.sourcegitcommit: c4246c2b986c6f53b20b94d4e75ccc49ec768a9a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/04/2020
ms.locfileid: "96600495"
---
# <a name="how-to-use-postman-to-send-requests-to-the-azure-digital-twins-apis"></a>Как использовать POST для отправки запросов в интерфейсы API цифровых двойников Azure

[POST](https://www.getpostman.com/) представляет собой средство тестирования, предоставляющее основные функциональные возможности HTTP-запросов в пользовательском интерфейсе на настольном компьютере и подключаемом модуле. Его можно использовать для создания HTTP-запросов и их отправки в [интерфейсы API двойников для Azure Digital](how-to-use-apis-sdks.md).

В этой статье описывается, как настроить [клиент отправки RESTful](https://www.getpostman.com/) для взаимодействия с API-интерфейсами Azure Digital двойников, выполнив следующие действия.

1. Используйте [Azure CLI](/cli/azure/install-azure-cli?view=azure-cli-latest&preserve-view=true) , чтобы получить токен носителя, который будет использоваться для выполнения запросов API в POST.
1. Настройте коллекцию POST и настройте клиент Posting Client на использование токена носителя для проверки подлинности.
1. Используйте настроенное сообщение POST, чтобы создать и отправить запрос к API цифровых двойников Azure.

## <a name="prerequisites"></a>Предварительные требования

Чтобы продолжить использовать POST для доступа к API-интерфейсам двойников для Azure Digital, необходимо настроить экземпляр Azure Digital двойников и скачать POST. Соответствующие действия описаны далее в разделе.

### <a name="set-up-azure-digital-twins-instance"></a>Настройка экземпляра Azure Digital Twins

[!INCLUDE [digital-twins-prereq-instance.md](../../includes/digital-twins-prereq-instance.md)]

### <a name="download-postman"></a>Загрузка публикации

Затем скачайте настольную версию поступающего клиента. Перейдите по адресу [*www.getpostman.com/apps*](https://www.getpostman.com/apps) и следуйте инструкциям на экране, чтобы скачать приложение.

## <a name="get-bearer-token"></a>Получение токена носителя

Теперь, когда вы настроили POST и свой экземпляр Digital двойников для Azure, вам потребуется получить маркер носителя, который направляет запросы, которые можно использовать для авторизации в Azure Digital двойников API.

Получить этот маркер можно несколькими способами. В этой статье используется [Azure CLI](/cli/azure/install-azure-cli?view=azure-cli-latest&preserve-view=true) для входа в учетную запись Azure и получения маркера.

Если Azure CLI [установлен локально](/cli/azure/install-azure-cli?view=azure-cli-latest&preserve-view=true), можно запустить командную строку на компьютере, чтобы выполнить следующие команды.
В противном случае можно открыть [Azure Cloud Shell](https://shell.azure.com) окно в браузере и выполнить в нем команды.

1. Сначала убедитесь, что вы выполнили вход в Azure с соответствующими учетными данными, выполнив следующую команду:

    ```azurecli-interactive
    az login
    ```

1. Затем используйте команду [AZ Account Get-Access-Token](https://docs.microsoft.com/cli/azure/account?view=azure-cli-latest&preserve-view=true#az_account_get_access_token) , чтобы получить токен носителя с доступом к службе Digital двойников.

    ```azurecli-interactive
    az account get-access-token --resource 0b07f429-9f4b-4714-9392-cc5e8e80c8b0
    ```

1. Скопируйте значение `accessToken` в результат и сохраните его для использования в следующем разделе. Это **значение токена** , которое вы будете предоставлять для проверки подлинности запросов.

    :::image type="content" source="media/how-to-use-postman/console-access-token.png" alt-text="Представление локального окна консоли, в котором отображается результат команды AZ Account Get-Access-Token. Одно из полей в результате называется accessToken, а его примерное значение — начиная с клю — выделяется.":::

>[!TIP]
>Этот токен действителен не менее пяти минут и не может превышать 60 минут. Если вы исчерпали время, выделенное для текущего маркера, можно повторить шаги, описанные в этом разделе, чтобы получить новый.

## <a name="set-up-postman-collection-and-authorization"></a>Настройка коллекции и авторизации после публикации

Затем настройте POST для выполнения запросов API.
Эти действия выполняются в локальном почтовом приложении, поэтому вы можете открыть приложение POST на своем компьютере.

### <a name="create-a-postman-collection"></a>Создание коллекции Postman

Запросы в POST-данных сохраняются в **коллекциях** (группы запросов). При создании коллекции для группирования запросов можно одновременно применить общие параметры к нескольким запросам. Это может значительно упростить авторизацию, если вы планируете создать несколько запросов к API цифровых двойников Azure, так как достаточно настроить проверку подлинности только один раз для всей коллекции.

1. Чтобы создать коллекцию, нажмите кнопку *+ New Collection (+ создать коллекцию* ).

    :::image type="content" source="media/how-to-use-postman/postman-new-collection.png" alt-text="Просмотр недавно открытого окна POST. Кнопка &quot;создать коллекцию&quot; выделена":::

1. В следующем окне *Создание коллекции* введите **имя** и **Описание** (необязательно) для коллекции.

Затем перейдите к следующему разделу, чтобы добавить в коллекцию токен носителя для авторизации.

### <a name="add-authorization-token-and-finish-collection"></a>Добавление маркера авторизации и завершение сбора

1. В диалоговом окне *Создание новой коллекции* перейдите на вкладку *авторизация* . Здесь вы поместите **значение маркера** , полученное в разделе " [получение токена носителя](#get-bearer-token) ", чтобы использовать его для всех запросов API в коллекции.

    :::image type="content" source="media/how-to-use-postman/postman-authorization.png" alt-text="Окно публикации &quot;Создание новой коллекции&quot;, в котором отображается вкладка &quot;Авторизация&quot;.":::

1. Задайте *тип* _**OAuth 2,0**_ и вставьте маркер доступа в поле *маркер доступа* .

    :::image type="content" source="media/how-to-use-postman/postman-paste-token.png" alt-text="Окно публикации &quot;Создание новой коллекции&quot;, в котором отображается вкладка &quot;Авторизация&quot;. Выбран тип &quot;OAuth 2,0&quot;, и поле маркер доступа, в котором можно вставлять значение маркера доступа, выделяется.":::

1. После того как вы вставили маркер носителя, нажмите кнопку *создать* , чтобы завершить создание коллекции.

Теперь новую коллекцию можно просмотреть в главном представлении после публикации в разделе *коллекции*.

:::image type="content" source="media/how-to-use-postman/postman-post-collection.png" alt-text="Представление основного окна POST. Созданная коллекция будет выделена на вкладке коллекции.":::

## <a name="create-a-request"></a>Создание запроса

После выполнения описанных выше действий можно создавать запросы к API-интерфейсам цифровых двойника Azure.

1. Чтобы создать запрос, нажмите кнопку *+ создать* .

    :::image type="content" source="media/how-to-use-postman/postman-new-request.png" alt-text="Представление основного окна POST. Кнопка &quot;создать&quot; выделена":::

1. Выберите *запрос*.

    :::image type="content" source="media/how-to-use-postman/postman-new-request-2.png" alt-text="Просмотрите параметры, которые можно выбрать, чтобы создать что-то новое. Параметр &quot;запрос&quot; выделен":::

1. Это действие открывает окно *Сохранить запрос* , где можно ввести имя запроса, присвоить ему необязательное описание и выбрать коллекцию, частью которой он является. Заполните сведения и сохраните запрос в созданной ранее коллекции.

    :::row:::
        :::column:::
            :::image type="content" source="media/how-to-use-postman/postman-save-request.png" alt-text="Представление окна &quot;сохранить запрос&quot;, в котором можно заполнить указанные поля. Кнопка &quot;сохранить в коллекции Azure Digital двойников&quot; выделена":::
        :::column-end:::
        :::column:::
        :::column-end:::
    :::row-end:::

Теперь вы можете просмотреть запрос в коллекции и выбрать его для получения редактируемых сведений.

:::image type="content" source="media/how-to-use-postman/postman-request-details.png" alt-text="Представление основного окна POST. Коллекция Digital двойников для Azure развернута, а запрос &quot;запрос двойников&quot; выделен. Сведения о запросе отображаются в центре страницы." lightbox="media/how-to-use-postman/postman-request-details.png":::

### <a name="set-request-details"></a>Задание сведений о запросе

Чтобы отправить запрос POST к одному из интерфейсов API цифровых двойников Azure, вам потребуется URL-адрес API и сведения о необходимых сведениях. Эти сведения можно найти в [справочной документации по цифровым двойников REST API Azure](/rest/api/azure-digitaltwins/).

Чтобы продолжить работу с примером запроса, в этой статье будет использоваться API запросов (и его [Справочная документация](/rest/api/digital-twins/dataplane/query/querytwins)) для запроса всех цифровых двойников в экземпляре.

1. Получите URL-адрес запроса и тип из справочной документации. Для API запроса это *POST `https://digitaltwins-name.digitaltwins.azure.net/query?api-version=2020-10-31`*.
1. В окне Post настройте тип запроса и введите URL-адрес запроса, заполняя в URL-адресе заполнители в соответствии с требованиями. Здесь вы будете использовать **имя узла** экземпляра из раздела [*предварительных требований*](#prerequisites) .
    
   :::image type="content" source="media/how-to-use-postman/postman-request-url.png" alt-text="В сведениях о новом запросе URL-адрес запроса из справочной документации был заполнен в поле URL-адрес запроса." lightbox="media/how-to-use-postman/postman-request-url.png":::
    
1. Убедитесь, что параметры, показанные для запроса на вкладке *params* , соответствуют описанным в справочной документации. Для этого запроса в Post `api-version` параметр был автоматически заполнен при вводе URL-адреса запроса на предыдущем шаге. Для API запросов это единственный обязательный параметр, поэтому этот шаг выполняется.
1. На вкладке *авторизация* задайте *тип* *наследовать проверку подлинности от родительского*. Это означает, что этот запрос будет использовать проверку подлинности, настроенную ранее для всей коллекции.
1. Убедитесь, что заголовки, отображаемые для запроса на вкладке *заголовки* , соответствуют описанным в справочной документации. Для этого запроса несколько заголовков были заполнены автоматически. Для API запроса ни один из параметров заголовка не является обязательным, поэтому этот шаг выполняется.
1. Убедитесь, что текст, отображаемый для запроса на вкладке *Body* , соответствует требованиям, описанным в справочной документации. Для API запроса текст JSON необходим для предоставления текста запроса. Ниже приведен пример тела запроса, который запрашивает все цифровые двойников в экземпляре:

   :::image type="content" source="media/how-to-use-postman/postman-request-body.png" alt-text="В сведениях о новом запросе отображается вкладка Body (тело). Он содержит необработанный текст JSON с запросом SELECT * FROM ДИГИТАЛТВИНС."lightbox="media/how-to-use-postman/postman-request-body.png":::

   Дополнительные сведения о создании запросов Azure Digital двойников см. в разделе [*инструкции. запрос к графу двойника*](how-to-query-graph.md).

1. Просмотрите справочную документацию по любым другим полям, которые могут потребоваться для вашего типа запроса. Для API запросов все требования теперь выполнены в запросе POST, поэтому этот шаг выполняется.
1. Используйте кнопку *Send (отправить* ), чтобы отправить завершенный запрос.
   :::image type="content" source="media/how-to-use-postman/postman-request-send.png" alt-text="Рядом с подробными сведениями о новом запросе кнопка Отправить выделена." lightbox="media/how-to-use-postman/postman-request-send.png":::

После отправки запроса сведения об ответе появятся в окне Posting под запросом. Можно просмотреть код состояния ответа и любой основной текст.

:::image type="content" source="media/how-to-use-postman/postman-request-response.png" alt-text="Ниже приведены подробные сведения о отправленном запросе. Существует состояние 200 OK и основной текст, описывающий цифровые двойников, которые были возвращены запросом." lightbox="media/how-to-use-postman/postman-request-response.png":::

Вы также можете сравнить ответ с ожидаемыми данными ответа, указанными в справочной документации, чтобы проверить результат или получить дополнительные сведения о возникших ошибках.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об API-интерфейсах Digital двойников см. в статье [*Использование интерфейсов API и пакетов SDK для цифровых двойников Azure*](how-to-use-apis-sdks.md)или в [справочной документации по интерфейсам API](/rest/api/azure-digitaltwins/).