---
title: Непрерывная интеграция и доставка для рабочей области синапсе
description: Узнайте, как использовать непрерывную интеграцию и доставку для развертывания изменений в рабочей области из одной среды (разработки, тестирования, рабочей) в другой среде.
services: synapse-analytics
author: liud
ms.service: synapse-analytics
ms.topic: conceptual
ms.date: 11/20/2020
ms.author: liud
ms.reviewer: pimorano
ms.openlocfilehash: 2f2221ad10a2e07a3443cab9f957c8ec26969a3b
ms.sourcegitcommit: 2e9643d74eb9e1357bc7c6b2bca14dbdd9faa436
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "96031415"
---
# <a name="continuous-integration-and-delivery-for-azure-synapse-workspace"></a>Непрерывная интеграция и доставка для рабочей области Azure синапсе

## <a name="overview"></a>Обзор

Непрерывная интеграция (CI) — это процесс автоматизации сборки и тестирования кода каждый раз, когда член команды фиксирует изменения в системе управления версиями. Непрерывное развертывание (CD) — это процесс создания, тестирования, настройки и развертывания из нескольких тестов или промежуточных сред в рабочей среде.

Для рабочей области Azure синапсе непрерывная интеграция и доставка (CI/CD) перемещают все сущности из одной среды (разработки, тестирования, производства) в другую. Для продвижения рабочей области в другую рабочую область существуют две части: использование [шаблонов Azure Resource Manager](https://docs.microsoft.com/azure/azure-resource-manager/templates/overview) для создания или обновления ресурсов рабочей области (пулов и рабочих областей); Миграция артефактов (скрипты SQL, записная книжка, определение задания Spark, конвейеры, наборы данных и т. д.) с помощью средств синапсе CI/CD в Azure DevOps. 

В этой статье рассматривается использование конвейера выпуска Azure для автоматизации развертывания рабочей области синапсе в нескольких средах.

## <a name="pre-requirements"></a>Предварительные требования

-   В рабочей области, используемой для разработки, настроен репозиторий Git в студии, см. раздел [система управления версиями в синапсе Studio](source-control.md).
-   Проект Azure DevOps был подготовлен для выполнения конвейера выпуска.

## <a name="set-up-a-release-pipelines"></a>Настройка конвейеров выпуска

1.  В [Azure DevOps](https://dev.azure.com/)откройте проект, созданный для выпуска.

1.  В левой части страницы выберите **Конвейеры**, а затем **Выпуски**.

    ![Выбор параметров "Конвейеры", "Выпуски"](media/create-release-1.png)

1.  Выберите **Новый конвейер** или, если у вас есть конвейеры, выберите **Новый**, а затем **Создать конвейер выпуска**.

1.  Выберите шаблон **Пустое задание**.

    ![Выбор шаблона "Пустое задание"](media/create-release-select-empty.png)

1.  В поле **Имя этапа** введите имя своей среды.

1.  Щелкните **Добавить артефакт**, а затем выберите репозиторий Git, настроенный с помощью среды разработки синапсе Studio. Выберите репозиторий Git, который использовался для управления шаблоном ARM пулов и рабочей области. Если вы используете GitHub в качестве источника, необходимо создать подключение к службе для учетной записи GitHub и опрашивающего репозитория. Дополнительные сведения о [подключении службы](https://docs.microsoft.com/azure/devops/pipelines/library/service-endpoints) 

    ![Добавить ветвь публикации](media/release-creation-github.png)

1.  Выберите ветвь шаблона ARM для обновления ресурсов. Для поля **Версия по умолчанию** выберите **Последний из ветви по умолчанию**.

    ![Добавить шаблон ARM](media/release-creation-arm-branch.png)

1.  Выберите [опубликовать ветвь](source-control.md#configure-publishing-settings) репозитория для поля **Ветвь по умолчанию**. По умолчанию эта ветвь публикации имеет значение `workspace_publish`. Для поля **Версия по умолчанию** выберите **Последний из ветви по умолчанию**.

    ![Добавление артефакта](media/release-creation-publish-branch.png)

## <a name="set-up-a-stage-task-for-arm-resource-create-and-update"></a>Настройка задачи этапа для создания и обновления ресурсов ARM 

Добавьте задачу развертывания Azure Resource Manager для создания или обновления ресурсов, включая рабочую область и пулы:

1. В представлении этапа выберите **Просмотр задач этапа**.

    ![Представлении этапа](media/release-creation-stage-view.png)

1. Создайте задачу. Найдите **Развертывание шаблона ARM** и нажмите кнопку **Добавить**.

1. В задаче развертывание выберите подписку, группу ресурсов и расположение для целевой рабочей области. При необходимости предоставьте учетные данные.

1. В списке **Действие** выберите **Create or update resource group** (Создание или изменение группы ресурсов).

1. Нажмите кнопку с многоточием ( **…** ) рядом с полем **Шаблон**. Поиск шаблона Azure Resource Manager целевой рабочей области

1. Выберите **…** рядом с полем **Параметры шаблона** для выбора файла параметров.

1. Выберите **…** рядом с полем **переопределить параметры шаблона** и введите значения требуемых параметров для целевой рабочей области. 

1. В поле **Режим развертывания** выберите **Добавочные**.
    
    ![Развертывание рабочей области и пулов](media/pools-resource-deploy.png)

1. Используемых Добавьте **Azure PowerShell** для назначения роли предоставить и обновить рабочую область. Если для создания рабочей области синапсе используется конвейер выпуска, необходимо добавить субъект-службу конвейера в качестве администратора рабочей области по умолчанию. Вы можете запустить PowerShell, чтобы предоставить другим учетным записям доступ к рабочей области. 
    
    ![предоставление разрешения](media/release-creation-grant-permission.png)

 > [!WARNING]
> В режиме полного развертывания ресурсы, которые существуют в группе ресурсов, но не указаны в новом шаблоне диспетчер ресурсов, будут **удалены**. Дополнительные сведения см. в разделе [режимы развертывания Azure Resource Manager](https://docs.microsoft.com/azure/azure-resource-manager/templates/deployment-modes) .

## <a name="set-up-a-stage-task-for-artifacts-deployment"></a>Настройка задачи этапа для развертывания артефактов 

Для развертывания других элементов в рабочей области синапсе, таких как DataSet, скрипт SQL, записная книжка, определение задания Spark, поток данных, конвейер, связанная служба, учетные данные и IR (Integration Runtime), используйте [рабочую область синапсе Build & Release](https://marketplace.visualstudio.com/items?itemName=PraveenMathamsetty.synapsecicd-deploy) Task.  

1. Убедитесь, что участнику службы "конвейер Azure DevOps" предоставлено разрешение подписки, а также назначено как администратор рабочей области для целевой рабочей области. 

1. Создайте задачу. Выполните поиск по запросу **рабочие области синапсе Build & Release**, а затем нажмите кнопку **Добавить**.

1.  В задаче укажите связанные сведения о репозитории Git **workspace_publish** и выберите группу ресурсов, регион, имя и облачную среду для целевой рабочей области. При необходимости укажите параметры и значения.

    ![Развертывание рабочей области синапсе](media/create-release-artifacts-deployment.png)

> [!IMPORTANT]
> В сценариях CI/CD тип среды выполнения интеграции (IR) в разных средах должен совпадать. Например, если у вас есть локальная среда IR в среде разработки, ей необходим также тип "Локальная" в других средах, таких как рабочая и тестовая. Аналогично, если вы совместно используете среды выполнения интеграции в нескольких средах, необходимо настроить их в качестве связанных локальных сред во всех средах (разработки, тестирования и рабочей).

## <a name="create-release-for-deployment"></a>Создать выпуск для развертывания 

После сохранения всех изменений можно выбрать **создать выпуск** , чтобы вручную создать выпуск. Сведения об автоматизации создания выпусков см. в статье [Триггеры выпуска](https://docs.microsoft.com/azure/devops/pipelines/release/triggers).

   ![Выбор параметра "Создать выпуск"](media/release-creation-manually.png)

## <a name="best-practices-for-cicd"></a>Рекомендации для CI/CD

Если вы используете интеграцию Git с рабочей областью синапсе и используете конвейер CI/CD, который перемещает изменения из разработки в тест, а затем в рабочую среду, мы рекомендуем следующие рекомендации:

-   **Интеграция Git.** Настройка только рабочей области разработки синапсе с помощью интеграции с Git. Изменения в рабочих областях тестов и рабочих областей развертываются с помощью CI/CD и не требуют интеграции с Git.
-   **Подготовка пулов перед миграцией артефактов**. Если вы подключаете пулы к скрипту или записной книжке SQL в рабочей области "Разработка", ожидается одно и то же имя пулов в разных средах. 
-   **Другие**. Ознакомьтесь с [другими](/azure/data-factory/continuous-integration-deployment#best-practices-for-cicd) рекомендациями

## <a name="unsupported-features"></a>Неподдерживаемые функции

- Синапсе Studio не допускает отбора фиксаций или выборочной публикации ресурсов. 
- Синапсе Studio не поддерживает настройку сообщения о фиксации.
- Действие удаления будет зафиксировано в Git напрямую

