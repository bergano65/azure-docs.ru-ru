---
title: Система управления версиями в синапсе Studio
description: Узнайте, как настроить систему управления версиями в Azure синапсе Studio.
services: synapse-analytics
author: liud
ms.service: synapse-analytics
ms.topic: conceptual
ms.date: 11/20/2020
ms.author: liud
ms.reviewer: pimorano
ms.openlocfilehash: b7248a3a66e0eeca4d86568f80af82bf2d89701f
ms.sourcegitcommit: 2e9643d74eb9e1357bc7c6b2bca14dbdd9faa436
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "96031359"
---
# <a name="source-control-in-azure-synapse-studio"></a>Система управления версиями в Azure синапсе Studio

По умолчанию авторы Azure синапсе Studio напрямую применяют к службе синапсе. Однако этот интерфейс имеет следующие ограничения.

- Синапсе Studio не включает временное хранилище для хранения изменений. Единственный способ сохранить изменения и поделиться ими с помощью **публикации** , и все изменения публикуются непосредственно в службе синапсе.

- Синапсе Studio не оптимизирована для совместной работы и управления версиями.

Чтобы обеспечить возможность управления версиями, синапсе Studio позволяет связать рабочую область с репозиторием Git, Azure DevOps или GitHub. В этой статье описано, как настроить и работать в рабочей области синапсе с включенным репозиторием Git. Также мы выделим некоторые рекомендации и руководство по устранению неполадок.

> [!NOTE]
> Интеграция Azure синапсе Studio Git недоступна в облаке Azure для государственных организаций.

## <a name="configure-git-repository-in-synapse-studio"></a>Настройка репозитория Git в синапсе Studio 

После запуска синапсе Studio можно настроить репозиторий Git в рабочей области. Рабочая область синапсе Studio может быть связана только с одним репозиторием Git за раз. 

### <a name="configuration-method-1-authoring-canvas"></a>Метод конфигурации 1. Создание холста

На холсте разработки синапсе Studio откройте раскрывающееся меню **синапсе Live** и выберите **настроить репозиторий кода**.

![Настройка параметров репозитория кода из разработки](media/configure-repo-1.png)

### <a name="configuration-method-2-management-hub"></a>Метод конфигурации 2. Центр управления

Перейдите в центр управления синапсе Studio. Выберите **Конфигурация Git** в разделе **система управления версиями** . Если нет подключенного репозитория, нажмите кнопку **настроить**.

![Настройка параметров репозитория кода из центра управления](media/configure-repo-2.png)

> [!NOTE]
> Пользователи, которым предоставлены роли участников рабочей области, владельца или более высокого уровня, могут настраивать, изменять параметры и отключать репозиторий Git в Azure синапсе Studio. 

Вы можете подключить репозиторий Git Azure DevOps или GitHub в рабочей области.

## <a name="connect-with-azure-devops-git"></a>Подключение с помощью Azure DevOps Git 

Рабочую область синапсе можно связать с репозиторием Azure DevOps для управления исходным кодом, совместной работы, контроля версий и т. д. Если у вас нет репозитория Azure DevOps, выполните [эти инструкции](/azure/devops/organizations/accounts/create-organization-msa-or-work-student) , чтобы сначала создать ресурсы репозитория.

### <a name="azure-devops-git-repository-settings"></a>Параметры репозитория Git для Azure DevOps

При подключении к репозиторию Git сначала выберите тип репозитория Azure DevOps Git, а затем выберите один клиент Azure AD из раскрывающегося списка и нажмите кнопку **продолжить**.

![Настройка параметров репозитория кода](media/connect-with-azuredevops-repo-selected.png)

В области Конфигурация отображаются следующие параметры Azure DevOps Git:

| Параметр | Описание | Значение |
|:--- |:--- |:--- |
| **Тип репозитория** | Тип репозитория кода Azure Repos.<br/> | Azure DevOps Git или GitHub |
| **Azure Active Directory** | Имя вашего клиента Azure AD. | `<your tenant name>` |
| **Учетная запись Azure DevOps** | Название вашей организации Azure Repos. Название организации Azure Repos можно найти по адресу `https://{organization name}.visualstudio.com`. [Войдите в свою организацию Azure Repos](https://www.visualstudio.com/team-services/git/) и получите доступ к профилю Visual Studio, чтобы просмотреть свои репозитории и проекты. | `<your organization name>` |
| **Имя проекта** | Имя проекта Azure Repos. Имя проекта Azure Repos можно найти по адресу `https://{organization name}.visualstudio.com/{project name}`. | `<your Azure Repos project name>` |
| **Имя репозитория** | Имя репозитория кода Azure Repos. Проекты Azure Repos содержат репозитории Git, которые управляют исходным кодом по мере роста проекта. Создайте репозиторий либо используйте репозиторий, который уже имеется в проекте. | `<your Azure Repos code repository name>` |
| **Ветвь совместной работы** | Ветвь вашей совместной работы в Azure Repos, которая используется для публикации. По умолчанию используется `master`. Измените этот параметр, если нужно опубликовать ресурсы из другой ветви. Можно выбрать существующие ветви или создать новые | `<your collaboration branch name>` |
| **Корневая папка** | Корневая папка в ветви совместной работы Azure Repos. | `<your root folder name>` |
| **Импорт существующих ресурсов в репозиторий** | Указывает, следует ли импортировать существующие ресурсы из синапсе Studio в репозиторий Azure Repos Git. Установите флажок, чтобы импортировать ресурсы рабочей области (кроме пулов) в соответствующий репозиторий Git в формате JSON. Это действие экспортирует каждый ресурс по отдельности. Если этот флажок не установлен, существующие ресурсы не импортируются. | Флажок установлен (по умолчанию) |
| **Импортировать ресурс в эту ветвь** | Выберите ветвь, в которую будут импортированы ресурсы (скрипт SQL, записная книжка, определение задания Spark, набор данных, объект DataFlow и т. д.). 

Можно также использовать ссылку на репозиторий, чтобы быстро указать репозиторий Git, с которым вы хотите подключиться. 

### <a name="use-a-different-azure-active-directory-tenant"></a>Использование другого клиента Azure Active Directory

Репозиторий Git Azure Repos можно создать в другом клиенте Azure Active Directory. Чтобы указать другой клиент Azure AD, у вас должны быть права администратора для подписки Azure, которую вы используете. Дополнительные сведения см. в разделе [Изменение администратора подписки](https://docs.microsoft.com/azure/cost-management-billing/manage/add-change-subscription-administrator#assign-a-subscription-administrator) .

> [!IMPORTANT]
> Чтобы подключиться к другому Azure Active Directory, пользователь, вошедший в систему, должен быть частью Active Directory. 

### <a name="use-your-personal-microsoft-account"></a>Использование личной учетной записи Майкрософт

Чтобы использовать личную учетную запись Майкрософт для интеграции с Git, можно связать личный репозиторий Azure с Active Directory вашей организации.

1. Добавление личной учетной записи Майкрософт в Active Directory вашей организации в качестве гостя. Дополнительные сведения см. в статье [Добавление пользователей службы совместной работы B2B на портале Azure](https://docs.microsoft.com/azure/active-directory/external-identities/add-users-administrator).

2. Войдите на портал Azure с помощью личной учетной записи Майкрософт. Перейдите в Active Directory вашей организации.

3. Перейдите к разделу Azure DevOps, где находится личный репозиторий. Выберите репозиторий и подключитесь к Active Directory.

После выполнения этих шагов настройки ваш личный репозиторий будет доступен при настройке интеграции с Git в синапсе Studio.

Дополнительные сведения о подключении репозитория Azure Active Directory вашей организации см. в статье о [подключении организации Azure DevOps к Azure Active Directory](/azure/devops/organizations/accounts/connect-organization-to-azure-ad).

## <a name="connect-with-github"></a>Подключение с помощью GitHub 

 Рабочую область можно связать с репозиторием GitHub для управления исходным кодом, совместной работы и контроля версий. Если у вас нет учетной записи GitHub или репозитория, создайте их, следуя [этим инструкциям](https://github.com/join).

Интеграция GitHub с синапсе Studio поддерживает общедоступный GitHub (т. е [https://github.com](https://github.com) .) и GitHub Enterprise. Вы можете использовать как общедоступные, так и частные репозитории GitHub, если у вас есть разрешение на чтение и запись в репозитории в GitHub.

### <a name="github-settings"></a>Параметры GitHub

При подключении к репозиторию Git сначала выберите тип репозитория GitHub, а затем укажите свою учетную запись GitHub или URL-адрес сервера GitHub Enterprise, если вы используете GitHub Enterprise Server, и нажмите кнопку **продолжить**.

![Параметры репозитория GitHub](media/connect-with-github-repo-1.png)

Область настройки содержит следующие параметры репозитория кода GitHub:

| **Параметр** | **Описание**  | **Значение**  |
|:--- |:--- |:--- |
| **Тип репозитория** | Тип репозитория кода Azure Repos. | GitHub |
| **Use GitHub Enterprise** (Использовать GitHub Enterprise) | Флажок для выбора GitHub Enterprise. | Не установлен (по умолчанию) |
| **GitHub Enterprise URL** (URL-адрес GitHub Enterprise) | Корневой URL-адрес GitHub Enterprise (должен быть HTTPS для локального сервера GitHub Enterprise). Например: `https://github.mydomain.com`. Требуется только в том случае, если установлен флажок **Use GitHub Enterprise** (Использовать GitHub Enterprise). | `<your GitHub enterprise url>` |                                                           
| **Учетная запись GitHub** | Имя учетной записи GitHub. Это имя можно определить по URL-адресу: https:\//github.com/{имя учетной записи}/{имя репозитория}. При переходе на эту страницу вам предложат ввести учетные данные OAuth GitHub для вашей учетной записи GitHub. | `<your GitHub account name>` |
| **Имя репозитория**  | Имя репозитория кода GitHub. Учетные записи GitHub содержат репозитории Git для управления исходным кодом. Создайте репозиторий либо используйте уже имеющийся в учетной записи. | `<your repository name>` |
| **Ветвь совместной работы** | Ветвь вашей совместной работы в GitHub, которая используется для публикации. По умолчанию используется главная ветвь. Измените этот параметр, если нужно опубликовать ресурсы из другой ветви. | `<your collaboration branch>` |
| **Корневая папка** | Корневая папка в ветви совместной работы GitHub. |`<your root folder name>` |
| **Импорт существующих ресурсов в репозиторий** | Указывает, следует ли импортировать существующие ресурсы из синапсе Studio в репозиторий Git. Установите флажок, чтобы импортировать ресурсы рабочей области (кроме пулов) в соответствующий репозиторий Git в формате JSON. Это действие экспортирует каждый ресурс по отдельности. Если этот флажок не установлен, существующие ресурсы не импортируются. | Установлен (по умолчанию) |
| **Импортировать ресурс в эту ветвь** | Выберите ветвь, в которой импортируются ресурсы (скрипт SQL, записная книжка, определение задания Spark, набор данных и т. д.). 

### <a name="github-organizations"></a>Организации GitHub

Для подключения к Организации GitHub необходимо, чтобы организация предоставляла разрешение на синапсе Studio. Пользователь с разрешениями администратора в Организации должен выполнить следующие действия.

#### <a name="connecting-to-github-for-the-first-time"></a>Первое подключение к GitHub

Если вы впервые подключаетесь к GitHub из синапсе Studio, выполните следующие действия, чтобы подключиться к Организации GitHub.

1. В области Конфигурация Git введите название организации в поле *учетная запись GitHub* . Отобразится запрос на вход в GitHub. 

1. Войдите, используя свои учетные данные пользователя.

1. Вам будет предложено авторизовать синапсе как приложение под названием *Azure синапсе*. На этом экране вы увидите возможность предоставить синапсе разрешение на доступ к Организации. Если вы не видите параметр для предоставления разрешения, попросите администратора вручную предоставить разрешение через GitHub.

После выполнения этих действий Рабочая область сможет подключаться к общедоступным и частным репозиториям в Организации. Если не удается подключиться, попробуйте очистить кэш браузера и повторить попытку.

## <a name="version-control"></a>Управление версиями

Системы управления версиями (также известные как _система управления_ версиями) позволяют разработчикам совместно работать над кодом и отслеживанию изменений. Система управления версиями — это важный инструмент для проектов с несколькими разработчиками.

### <a name="creating-feature-branches"></a>Создание ветвей функциональностей

Каждый репозиторий Git, связанный с синапсе Studio, имеет ветвь совместной работы. ( `main` или `master` является ветвью совместной работы по умолчанию). Пользователи также могут создавать ветви функциональностей. Для этого нужно щелкнуть **+ New Branch** (Создать ветвь) в раскрывающемся списке ветвей. В появившейся области создания ветви введите имя ветви функциональности.

![Создание ветви](media/create-new-branch.png)

Когда вы будете готовы объединить изменения из ветви функциональности в ветвь совместной работы, щелкните раскрывающийся список ветвей и выберите **Create pull request** (Создать запрос на вытягивание). Это действие выполняет переход к поставщику Git, где можно создавать запросы на вытягивание, выполнять проверку кода и объединять изменения в ветви совместной работы. Вы можете публиковать только в службе синапсе из ветви совместной работы. 

![Создание нового запроса на вытягивание](media/create-pull-request.png)

### <a name="configure-publishing-settings"></a>Настройка параметров публикации

По умолчанию синапсе Studio создает шаблоны рабочих областей и сохраняет их в ветви с именем `workspace_publish` . Чтобы создать настраиваемую ветвь публикации, добавьте файл `publish_config.json` в корневую папку в ветви совместной работы. При публикации синапсе Studio считывает этот файл, ищет поле `publishBranch` и сохраняет файлы шаблонов рабочих областей в указанном расположении. Если ветвь не существует, синапсе Studio автоматически создаст ее. Пример того, как выглядит этот файл, приведен ниже:

```json
{
    "publishBranch": "workspace_publish"
}
```

Azure синапсе Studio может одновременно иметь только одну ветвь публикации. При указании новой ветви публикации Предыдущая ветвь публикации не будет удалена. Если же вы хотите удалить предыдущую ветвь публикации, сделайте это вручную.

### <a name="publish-code-changes"></a>Публикация изменений кода

После объединения изменений в ветви совместной работы нажмите кнопку **опубликовать** , чтобы вручную опубликовать изменения кода в ветви совместной работы в службе синапсе.

![Публикация изменений](media/gitmode-publish.png)

Откроется боковая область, где вы подтвердите, что ветвь публикации и ожидающие изменения верны. Проверив изменения, нажмите кнопку **ОК**, чтобы подтвердить публикацию.

![Подтверждение использования правильной ветви публикации](media/publish-change.png)

> [!IMPORTANT]
> Ветвь совместной работы не отражает то, что развертывается в службе. Изменения в ветви совместной работы *должны* быть опубликованы вручную.

## <a name="switch-to-a-different-git-repository"></a>Переход на другой репозиторий Git

Чтобы переключиться на другой репозиторий Git, перейдите на страницу конфигурации Git в центре управления в **системе управления версиями**. Выберите **Отключить**. 

![Значок Git](media/remove-repository.png)

Введите имя рабочей области и нажмите кнопку " **Отключить** ", чтобы удалить репозиторий Git, связанный с рабочей областью.

После удаления связи с текущим репозиторием можно настроить параметры Git для использования другого репозитория, а затем импортировать существующие ресурсы в новый репозиторий.

> [!IMPORTANT]
> Удаление конфигурации Git из рабочей области не приводит к удалению чего-либо из репозитория. Рабочая область синапсе будет содержать все опубликованные ресурсы. Вы можете продолжить изменение рабочей области непосредственно для службы.

## <a name="best-practices-for-git-integration"></a>Рекомендации по интеграции Git

-   **Разрешения**. После подключения репозитория Git к рабочей области любой пользователь, который может получить доступ к репозиторию Git с любой ролью в рабочей области, сможет обновлять артефакты, такие как скрипт SQL, записная книжка, определение задания Spark, набор данных, потоки и конвейеры в режиме Git. Обычно не нужно, чтобы у каждого члена группы имелись разрешения на обновление рабочей области. Предоставляйте доступ к репозиторию Git только для авторов синапсе артефактов рабочей области. 
-   **Совместная работа**. Не рекомендуется разрешать прямые возвраты в ветвь совместной работы. Это ограничение может помочь предотвратить ошибки, так как при каждом возврате будет выполнен процесс проверки запроса на вытягивание, описанный в разделе [Создание ветвей функциональностей](source-control.md#creating-feature-branches).
-   **Синапсе в режиме реального времени**. После публикации в режиме Git все изменения будут отражены в режиме синапсе Live. В режиме синапсе в реальном времени публикация отключена. Кроме того, вы можете просматривать и запускать артефакты в реальном режиме, если предоставлено правильное разрешение. 
-   **Изменение артефактов в студии**. Синапсе Studio является единственным местом, в котором можно включить управление версиями рабочей области и автоматически синхронизировать изменения в Git. Любые изменения через пакет SDK, PowerShell, не будут синхронизироваться с Git. При включении Git рекомендуется всегда изменять артефакт в студии.

## <a name="troubleshooting-git-integration"></a>Устранение неполадок интеграции Git

### <a name="access-to-git-mode"></a>Доступ к режиму Git 

Если Вам предоставлено разрешение для репозитория Git GitHub, связанного с рабочей областью, но вы не можете получить доступ к режиму Git: 

1. Очистите кэш и обновите страницу. 

1. Войдите в свою учетную запись GitHub.

### <a name="stale-publish-branch"></a>Устаревшая ветвь публикации

Если ветвь Publish не синхронизирована с ветвью совместной работы и содержит неактуальные ресурсы, несмотря на последние публикации, попробуйте выполнить следующие действия.

1. Удалите текущий репозиторий Git.

1. Перенастройте Git с теми же параметрами, но убедитесь, что установлен флажок **импортировать существующие ресурсы в репозиторий** , и выберите ту же ветвь.  

1. Создайте запрос на вытягивание, чтобы выполнить слияние с ветвью совместной работы и применить в ней изменения. 


## <a name="next-steps"></a>Следующие шаги

* Сведения о реализации непрерывной интеграции и развертывания см. в разделе [Непрерывная интеграция и доставка (CI/CD)](continuous-integration-deployment.md).