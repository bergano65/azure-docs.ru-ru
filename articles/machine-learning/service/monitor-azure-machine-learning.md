---
title: Мониторинг Машинное обучение Azure | Документация Майкрософт
description: Узнайте, как использовать Azure Monitor для просмотра, анализа и создания оповещений о метриках из Машинное обучение Azure.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.reviewer: larryfr
ms.author: aashishb
author: aashishb
ms.date: 11/04/2019
ms.openlocfilehash: 0a28292ac95dca7b46d9f82c32b9881c18d74b87
ms.sourcegitcommit: 5a8c65d7420daee9667660d560be9d77fa93e9c9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2019
ms.locfileid: "74123543"
---
# <a name="monitoring-azure-machine-learning"></a>Мониторинг Машинное обучение Azure

В этой статье описываются данные мониторинга, созданные Машинное обучение Azure. Здесь также описывается, как можно использовать Azure Monitor для анализа данных и определения предупреждений.

> [!TIP]
> Сведения в этом документе предназначены главным образом для администраторов, так как он описывает мониторинг службы Машинное обучение Azure. Если вы являетесь анализуом данных или разработчиком и хотите отслеживать сведения, относящиеся к выполнению обучения модели, см. следующие документы:
>
> * [Запуск, отслеживание и отмена обучающих запусков](how-to-manage-runs.md)
> * [Метрики журнала для учебных запусков](how-to-track-experiments.md)
> * [Мониторинг икспериментс с помощью Млфлов](how-to-use-mlflow.md)
> * [Визуализация запусков с помощью TensorBoard](how-to-monitor-tensorboard.md)

## <a name="azure-monitor"></a>Azure Monitor

Машинное обучение Azure записывает данные мониторинга с помощью Azure Monitor, который представляет собой полную службу мониторинга стека в Azure. Azure Monitor предоставляет полный набор функций для мониторинга ресурсов Azure. Он также может отслеживать ресурсы в других облаках и в локальной среде.

Начните с статьи [Azure Monitor обзор](/azure/azure-monitor/overview), в которой представлен обзор возможностей мониторинга. Следующие разделы посвящены этой информации путем предоставления конкретных ОО с помощью Azure Monitor с Машинное обучение Azure.

Сведения о затратах, связанных с Azure Monitor, см. в разделе [использование и оценка затрат](/azure/azure-monitor/platform/usage-estimated-costs). Сведения о времени, которое требуется для отображения данных в Azure Monitor, см. в разделе [время приема данных журнала](/azure/azure-monitor/platform/data-ingestion-time).

## <a name="monitoring-data-from-azure-machine-learning"></a>Мониторинг данных из Машинное обучение Azure

Машинное обучение Azure собирает данные мониторинга тех же типов, что и другие ресурсы Azure, которые описаны в разделе [мониторинг данных из ресурсов Azure](/azure/azure-monitor/insights/monitor-azure-resource#monitoring-data). Подробный справочник по журналам и метрикам, созданным Машинное обучение Azure, см. в [справочнике по данным мониторинга машинное обучение Azure](monitor-resource-reference.md) .

## <a name="analyzing-metric-data"></a>Анализ данных метрик

Вы можете анализировать метрики для Машинное обучение Azure, открыв **метрики** из меню **Azure Monitor** . Дополнительные сведения об использовании этого средства см. в статье [Приступая к работе с Azure обозреватель метрик](/azure/azure-monitor/platform/metrics-getting-started) .

Все метрики для Машинное обучение Azure находятся в **рабочей области машинное обучение службы**пространства имен.

![обозреватель метрик с выбранной рабочей областью службы Машинное обучение](media/monitor-azure-machine-learning/metrics.png)

### <a name="filtering-and-splitting"></a>Фильтрация и разбиение

Для метрик, поддерживающих измерения, фильтры можно применять с помощью значения измерения. Например, фильтрация **активных ядер** для **имени кластера** `cpu-cluster`. 

Можно также разделить метрику по измерению, чтобы визуализировать, как разные сегменты метрики сравниваются друг с другом. Например, можно разделить **тип шага конвейера** для просмотра числа типов шагов, используемых в конвейере.

Дополнительные сведения о фильтрации и разбиении см. в разделе [Advanced Features of Azure Monitor](/azure/azure-monitor/platform/metrics-charts).

## <a name="alerts"></a>Оповещения

Вы можете получить доступ к оповещениям для Машинное обучение Azure, открыв **оповещения** в меню **Azure Monitor** . Дополнительные сведения о создании оповещений см. в статье [Создание, просмотр и Управление оповещениями метрик с помощью Azure Monitor](/azure/azure-monitor/platform/alerts-metric) .

В следующей таблице перечислены распространенные и Рекомендуемые правила оповещений метрик для Машинное обучение Azure.

| Тип оповещения | Условие | ОПИСАНИЕ |
|:---|:---|:---|
| Сбой развертывание модели | Тип агрегирования: Total, оператор: больше, пороговое значение: 0 | При сбое развертывания одной или нескольких моделей |
| Процент использования квоты | Тип агрегирования: Average, оператор: больше, пороговое значение: 90| Когда процент использования квоты превышает 90% |
| Неиспользуемые узлы | Тип агрегирования: Total, оператор: больше, пороговое значение: 0 | При наличии одного или нескольких неиспользуемых узлов |

## <a name="configuration"></a>Параметр Configuration

> [!IMPORTANT]
> __Метрики для машинное обучение Azure не требуют настройки__, они собираются автоматически и доступны в обозреватель метрик для мониторинга и оповещений.

Вы можете добавить параметр диагностики для настройки следующих функций:

* Заархивируйте данные журнала и метрики в учетную запись хранения Azure.
* Потоковая передача данных журнала и метрик в концентратор событий Azure.
* Отправка сведений о журнале и метриках в Azure Monitor Log Analytics.

Для включения этих параметров требуются дополнительные службы Azure (учетная запись хранения, концентратор событий или Log Analytics), что может привести к увеличению затрат. Чтобы рассчитать оценочную стоимость, посетите [Калькулятор цен Azure](https://azure.microsoft.com/pricing/calculator).

Дополнительные сведения о создании параметров диагностики см. в статье [Создание параметров диагностики для сбора журналов и метрик платформы в Azure](/azure/azure-monitor/platform/diagnostic-settings).

Для Машинное обучение Azure можно настроить следующие журналы:

| Категория | ОПИСАНИЕ |
|:---|:---|
| амлкомпутеклустеревент | События из Машинное обучение Azure вычисление кластеров. |
| амлкомпутеклустернодивент | События из узлов в кластере Машинное обучение Azure COMPUTE. |
| амлкомпутежобевент | События из заданий, выполняемых на Машинное обучение Azure вычислений. |

> [!NOTE]
> При включении метрик в параметре диагностики сведения об измерении в настоящее время не включаются в данные, передаваемые в учетную запись хранения, в концентратор событий или в log Analytics.

## <a name="analyzing-log-data"></a>Анализ данных журнала

Использование Azure Monitor Log Analytics требует создания диагностической конфигурации и включения __отправки сведений в log Analytics__. Дополнительные сведения см. в разделе [конфигурации](#configuration) .

Данные в журналах Azure Monitor хранятся в таблицах, где каждая таблица имеет собственный набор уникальных свойств. Машинное обучение Azure хранит данные в следующих таблицах:

| таблица | ОПИСАНИЕ |
|:---|:---|
| амлкомпутеклустеревент | События из Машинное обучение Azure вычисление кластеров. |
| амлкомпутеклустернодивент | События из узлов в кластере Машинное обучение Azure COMPUTE. |
| амлкомпутежобевент | События из заданий, выполняемых на Машинное обучение Azure вычислений. |

> [!IMPORTANT]
> При выборе **журналов** в меню машинное обучение Azure log Analytics открывается с областью запроса, заданной в текущей рабочей области. Это означает, что запросы журнала будут содержать только данные из этого ресурса. Если требуется выполнить запрос, включающий данные из других баз данных или из других служб Azure, выберите **журналы** в меню **Azure Monitor** . Дополнительные сведения см. [в разделе Область запроса журнала и временной диапазон в Azure Monitor log Analytics](/azure/azure-monitor/log-query/scope/) .

Подробные справочные сведения о журналах и метриках см. в разделе [машинное обучение Azure мониторинге справочника по данным](monitor-resource-reference.md).

### <a name="sample-queries"></a>Примеры запросов

Ниже приведены запросы, которые можно использовать для мониторинга ресурсов Машинное обучение Azure. 

+ Получение невыполненных заданий за последние пять дней:

    ```Kusto
    AmlComputeJobEvent
    | where TimeGenerated > ago(5d) and EventType == "JobFailed"
    | project  TimeGenerated , ClusterId , EventType , ExecutionState , ToolType
    ```

+ Получение записей для определенного имени задания:

    ```Kusto
    AmlComputeJobEvent
    | where JobName == "automl_a9940991-dedb-4262-9763-2fd08b79d8fb_setup"
    | project  TimeGenerated , ClusterId , EventType , ExecutionState , ToolType
    ```

+ Получение событий кластера за последние пять дней для кластеров, в которых размер виртуальной машины Standard_D1_V2:

    ```Kusto
    AmlComputeClusterEvent
    | where TimeGenerated > ago(4d) and VmSize == "STANDARD_D1_V2"
    | project  ClusterName , InitialNodeCount , MaximumNodeCount , QuotaAllocated , QuotaUtilized
    ```

+ Получение узлов, выделенных за последние восемь дней:

    ```Kusto
    AmlComputeClusterNodeEvent
    | where TimeGenerated > ago(8d) and NodeAllocationTime  > ago(8d)
    | distinct NodeId
    ```

## <a name="next-steps"></a>Дополнительная информация

- Справочные сведения о журналах и метриках см. в разделе [машинное обучение Azure мониторинг данных](monitor-resource-reference.md).
- Сведения о работе с квотами, связанными с Машинное обучение Azure, см. в статье [Управление квотами и их запрос для ресурсов Azure](how-to-manage-quotas.md).
- Дополнительные сведения о мониторинге ресурсов Azure см. в статье [мониторинг ресурсов Azure с помощью Azure Monitor](/azure/azure-monitor/insights/monitor-azure-resource).
