---
title: Обучение и развертывание моделей из VS Code
titleSuffix: Azure Machine Learning service
description: Сведения о расширении Azure Machine Learning for Visual Studio Code и о том, как начать обучение и развертывание моделей машинного и глубокого обучения с помощью Службы машинного обучения Azure в Visual Studio Code.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.author: shwinne
author: swinner95
ms.date: 12/04/2018
ms.custom: seodec18
ms.openlocfilehash: 409d1bb30dc956bb19e9a37212d93990d1401e7b
ms.sourcegitcommit: 898b2936e3d6d3a8366cfcccc0fccfdb0fc781b4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/30/2019
ms.locfileid: "55240120"
---
# <a name="use-visual-studio-code-to-train-and-deploy-machine-learning-models"></a>Использование Visual Studio Code для обучения и развертывания моделей машинного обучения

Из этой статьи вы узнаете, как использовать расширение **Azure Machine Learning for Visual Studio Code** для обучения и развертывания моделей машинного обучения и глубокого обучения с помощью Службы машинного обучения Azure в Visual Studio Code.

Служба "Машинное обучение Azure" предоставляет поддержку для выполнения экспериментов локально и на удаленных целевых объектах вычислений. Для каждого эксперимента вы можете отслеживать множество запусков, которые можно выполнять как угодно часто с целью итеративной проверки разных методик, гиперпараметров и т. п. Службу "Машинное обучение Azure" можно использовать для отслеживания пользовательских метрик и экспериментов, обеспечивая повторяемость и возможность проверки для задач обработки и анализа данных.

Также вы можете развернуть эти модели для тестирования и производственных задач.

## <a name="prerequisites"></a>Предварительные требования

+ Если у вас еще нет подписки Azure, создайте бесплатную учетную запись Azure, прежде чем начинать работу. Опробуйте [бесплатную или платную версию Службы машинного обучения Azure](http://aka.ms/AMLFree).

+ Установите расширение [Azure Machine Learning for VS Code](how-to-vscode-tools.md).

+ [Пакет SDK службы "Машинного обучения Azure" для Python](how-to-vscode-tools.md), установленный в VS Code.

## <a name="create-and-manage-compute-targets"></a>Создание целевых объектов вычислений и управление ими

Расширение Azure Machine Learning for VS Code позволяет подготовить данные, обучить модели и развернуть их как локально, так и на удаленных целевых объектах вычислений.

Это расширение поддерживает несколько удаленных целевых объектов вычислений для службы "Машинное обучение Azure". См. [полный список целевых объектов вычислений](how-to-set-up-training-targets.md), поддерживаемых службой "Машинное обучения Azure".

### <a name="create-compute-targets-for-azure-machine-learning-in-vs-code"></a>Создание целевых объектов вычислений для службы "Машинное обучение Azure" с помощью VS Code

**Чтобы создать целевой объект вычислений, выполните следующие действия:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

2. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure". В примере, показанном на анимированном изображении, имя подписки — Free Trial, а рабочее пространство — TeamWorkspace.

3. В узле рабочей области щелкните правой кнопкой мыши узел **Compute** (Вычисления) и выберите **Create Compute** (Создать вычислительный ресурс).

4. Выберите из списка тип целевого объекта вычислений.

5. На панели "Палитра команд" выберите размер виртуальной машины.

6. На панели "Палитра команд" введите имя целевого объекта вычислений в поле.

7. Настройте дополнительные свойства в файле конфигурации JSON, который откроется в новой вкладке. Вы можете указать свойства, например максимальное количество узлов.

8. Завершив настройку целевого объекта вычислений, щелкните **Отправить** в правом нижнем углу.

Ниже приведен пример создания Вычислительной среды Машинного обучения Azure (AMLCompute): [![Создание Вычислительной среды AML в VS Code](./media/vscode-tools-for-ai/CreateARemoteCompute.gif)](./media/vscode-tools-for-ai/CreateARemoteCompute.gif#lightbox)

#### <a name="the-run-configuration-file"></a>Файл конфигурации запуска

Расширение для VS Code автоматически создает локальные целевые объекты вычислений и конфигурацию запуска для сред **local** и **docker** на локальном компьютере. Файл конфигурации запуска находится в связанном целевом объекте вычислений.

Здесь представлен фрагмент файла с конфигурацией локального запуска по умолчанию. Вы должны самостоятельно установить все библиотеки и зависимости, поскольку по умолчанию установлена `userManagedDependencies: True`. Теперь локальные запуски экспериментов будут использовать окружение Python по умолчанию, которое настроено в расширении VS Code для Python.

```yaml
# user_managed_dependencies = True indicates that the environment will be user managed. False indicates that Azure Machine Learning service will manage the user environment.
    userManagedDependencies: True
# The python interpreter path
    interpreterPath: python
# Path to the conda dependencies file to use for this run. If a project
# contains multiple programs with different sets of dependencies, it may be
# convenient to manage those environments with separate files.
    condaDependenciesFile: aml_config/conda_dependencies.yml
# Docker details
    docker:
# Set True to perform this run inside a Docker container.
    enabled: false
```

## <a name="train-and-tune-models"></a>Обучение и тонкая настройка моделей

Работа со службой "Машинное обучение Azure для VS Code" (предварительная версия) позволяет выполнять быструю итерации кода, пошаговое выполнение и отладку, а также использовать любую систему управления версиями.

**Чтобы запустить локальный эксперимент с помощью службы "Машинное обучение Azure", выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

1. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure".

1. В узле рабочей области разверните узел **Вычисление** и щелкните правой кнопкой мыши **Run Config** (Выполнить конфигурацию) для вычислительного ресурса, который вы хотите использовать.

1. Щелкните **Run Experiment** (Выполнить эксперимент).

1. Выберите в проводнике выполняемый сценарий.

1. Щелкните **View Experiment Run** (Просмотр выполнения эксперимента), чтобы открыть встроенный портал службы "Машинное обучение Azure", где вы сможете отслеживать запуски и просматривать обученные модели.

Ниже приведен пример локального выполнения эксперимента. [![Локальное выполнение эксперимента](./media/vscode-tools-for-ai/RunExperimentLocally.gif)](./media/vscode-tools-for-ai/RunExperimentLocally.gif#lightbox)

### <a name="use-remote-computes-for-experiments-in-vs-code"></a>Использование удаленных вычислительных ресурсов для экспериментов в VS Code

Чтобы использовать для обучения удаленный целевой объект вычислений, создайте файл конфигурации запуска. Этот файл указывает службе "Машинное обучение Azure" не только место выполнения эксперимента, но и метод подготовки среды.

#### <a name="the-conda-dependencies-file"></a>Файл зависимостей conda

По умолчанию создается новая среда conda, которая управляет устанавливаемыми зависимостями. Но сами зависимости следует включить в файл `aml_config/conda_dependencies.yml`.

Ниже представлен фрагмент файла aml_config/conda_dependencies.yml, используемого по умолчанию.
Вы можете добавить в файл конфигурации дополнительные зависимости.

```yaml
# The dependencies defined in this file will be automatically provisioned for runs with userManagedDependencies=False.

name: project_environment
dependencies:
  # The python interpreter version.

  # Currently Azure Machine Learning service only supports 3.5.2 and later.

- python=3.6.2
- tensorflow

- pip:
    # Required packages for Azure Machine Learning service execution, history, and data preparation.

  - --index-url https://azuremlsdktestpypi.azureedge.net/sdk-release/Preview/E7501C02541B433786111FE8E140CAA1
  - --extra-index-url https://pypi.python.org/simple
  - azureml-defaults

```

**Чтобы запустить эксперимент на целевом объекте удаленных вычислений с помощью службы "Машинное обучение Azure", выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

1. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure".

1. Щелкните правой кнопкой мыши в окне редактора ваш сценарий Python и выберите **AML: Run as Experiment in Azure** (AML: Выполнение эксперимента в Azure).

1. На палитре команд выберите целевой объект вычислений.

1. На палитре команд введите в поле имя конфигурации запуска.

1. Внесите изменение в файл the conda_dependencies.yml, чтобы указать зависимости среды выполнения эксперимента, а затем щелкните в нижнем правом углу экрана кнопку **Отправить**.

1. Щелкните **View Experiment Run** (Просмотр выполнения эксперимента), чтобы открыть встроенный портал службы "Машинное обучение Azure", где вы сможете отслеживать запуски и просматривать обученные модели.

Ниже приведен пример выполнения эксперимента на целевом объекте удаленных вычислений. [![Выполнение эксперимента в удаленной целевой среде](./media/vscode-tools-for-ai/runningOnARemoteTarget.gif)](./media/vscode-tools-for-ai/runningOnARemoteTarget.gif#lightbox)


## <a name="deploy-and-manage-models"></a>Развертывание моделей и управление ими
Служба "Машинное обучение Azure" позволяет развертывать модели машинного обучения и управлять ими в облаке и на пограничных устройствах.

### <a name="register-your-model-to-azure-machine-learning-from-vs-code"></a>Регистрация модели в службе "Машинное обучение Azure" с помощью VS Code

После того как вы завершили обучение модели, ее можно зарегистрировать в рабочей области.
Зарегистрированные модели можно отслеживать и развертывать.

**Чтобы зарегистрировать модель, выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

1. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure".

1. В узле рабочей области щелкните правой кнопкой мыши **Models** (Модели) и выберите **Register Model** (Зарегистрировать модель).

1. На палитре команд введите в поле имя модели.

1. Выберите в списке, нужно ли отправить **model file** (файл модели для одной модели) или **model folder** (папку модели для моделей с несколькими файлами, например Tensorflow).

1. Выберите папку или файл.

1. Завершив настройку свойств модели, щелкните **Отправить** в правом нижнем углу.

Пример регистрации вашей модели в AML. [![Регистрация модели в AML](./media/vscode-tools-for-ai/RegisteringAModel.gif)](./media/vscode-tools-for-ai/RegisteringAModel.gif#lightbox)


### <a name="deploy-your-service-from-vs-code"></a>Развертывание службы с помощью VS Code

С помощью VS Code веб-службу можно развернуть в следующих расположениях:
+ экземпляр контейнера Azure (ACI) — для тестирования;
+ служба Azure Kubernetes (AKS) — для производственных задач.

Контейнеры ACI для тестирования не нужно создавать заранее, так как они создаются автоматически. Но кластеры AKS нужно обязательно настраивать заранее.

См. дополнительные сведения [о развертывании в службе "Машинное обучение Azure"](how-to-deploy-and-where.md).

**Чтобы развернуть веб-службу, выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

1. В представлении дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure".

1. В узле рабочей области, разверните узел **Models** (Модели).

1. Щелкните правой кнопкой мыши модель, которую вы намерены развернуть, и выберите в контекстном меню команду **Deploy Service from Registered Model** (Развернуть службу из зарегистрированной модели).

1. На палитре команд из списка выберите целевой объект вычислений для развертывания службы.

1. На палитре команд введите в поле имя для этой службы.

1. На палитре команд нажмите клавишу ВВОД на клавиатуре, чтобы выбрать файл сценария.

1. На палитре команд нажмите клавишу ВВОД на клавиатуре, чтобы выбрать файл зависимости.

1. Завершив настройку свойств службы, щелкните **Отправить** в правом нижнем углу. В этом файле свойства службы можно указать локальный файл Docker или файл schema.json, который требуется использовать.

Теперь веб-служба развернута.

Приведем пример развертывания веб-службы. [![Развертывание веб-службы](./media/vscode-tools-for-ai/CreatingAnImage.gif)](./media/vscode-tools-for-ai/CreatingAnImage.gif#lightbox)

## <a name="next-steps"></a>Дополнительная информация

Пошаговые инструкции по обучению с помощью Машинного обучения без VS Code вы найдете в разделе [Руководство по обучению модели классификации изображений с помощью Службы машинного обучения Azure](tutorial-train-models-with-aml.md).

Пошаговые инструкции по редактированию, запуску и отладке кода Python на локальном компьютере см. в [руководстве Hello World по языку Python](https://code.visualstudio.com/docs/python/python-tutorial).
