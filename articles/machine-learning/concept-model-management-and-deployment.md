---
title: 'Млопс: Управление моделями в МАШИНном обучении'
titleSuffix: Azure Machine Learning
description: 'Сведения об управлении моделями с помощью Машинное обучение Azure (Млопс). Развертывание моделей, управление ими и их мониторинг для их постоянного улучшения. '
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.reviewer: jmartens
author: jpe316
ms.author: jordane
ms.date: 03/17/2020
ms.custom: seodec18
ms.openlocfilehash: 12d86f9415f7f5b813d2dce8eb3ad4bb63dec30c
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "82929763"
---
# <a name="mlops-model-management-deployment-and-monitoring-with-azure-machine-learning"></a>Млопс: Управление моделями, развертывание и мониторинг с помощью Машинное обучение Azure

В этой статье вы узнаете, как использовать Машинное обучение Azure для управления жизненным циклом моделей. В Машинное обучение Azure используется подход Машинное обучениеных операций (Млопс). Млопс улучшает качество и согласованность решений машинного обучения. 

## <a name="what-is-mlops"></a>Что собой представляет MLOps?

Машинное обучение операции (Млопс) основаны на [DevOps](https://azure.microsoft.com/overview/what-is-devops/) принципов и методиках, повышающих эффективность рабочих процессов. Например, непрерывная интеграция, Доставка и развертывание. Млопс применяет эти принципы к процессу машинного обучения с целью:

* Более быстрая эксперимент и разработка моделей
* Более быстрое развертывание моделей в рабочей среде
* Контроль качества

Машинное обучение Azure предоставляет следующие возможности Млопс:

- **Создание воспроизводимых конвейеров машинного обучения**. Машинное обучение Конвейеры позволяют определить повторяемые и многократно используемые шаги для процессов подготовки данных, обучения и оценки.
- **Создание повторно используемых программных сред** для обучения и развертывания моделей.
- **Регистрация, Упаковка и развертывание моделей из любого места**. Также можно отслеживание связанных метаданных, необходимых для использования модели.
- **Запишите данные управления для комплексного жизненного цикла машинного обучения**. Записанные в журнал данные могут включать пользователей, которые публикуют модели, причины внесения изменений и время развертывания или использования моделей в рабочей среде.
- **Уведомлять и оповещать о событиях в жизненном цикле машинного обучения**. Например, выполнение эксперимента, регистрация модели, развертывание модели и обнаружение отклонения данных.
- **Мониторинг приложений ml для работы и проблем, связанных с машинным**обучением. Сравните входные данные модели между обработкой и выводом, изучите метрики, зависящие от модели, и предоставьте мониторинг и оповещения в инфраструктуре машинного обучения.
- **Автоматизируйте сквозной жизненный цикл машинного обучения с помощью машинное обучение Azure и Azure pipelines**. С помощью конвейеров можно часто обновлять модели, тестировать новые модели и непрерывно выбросить новые модели машинного обучения вместе с другими приложениями и службами.

## <a name="create-reproducible-ml-pipelines"></a>Создание воспроизводимых конвейеров машинного обучения

Используйте конвейеры машин из Машинное обучение Azure, чтобы объединить все шаги, связанные с процессом обучения модели.

Конвейер машинного обучения может содержать шаги из процесса подготовки данных к извлечению компонентов в настройку параметров для оценки модели. Дополнительные сведения см. в разделе [конвейеры машинного обучения](concept-ml-pipelines.md).

Если вы используете [конструктор](concept-designer.md) для создания конвейеров машинного обучения, вы можете в любой момент нажать кнопку **"..."** в правом верхнем углу страницы конструктора, а затем выбрать **клонировать**. Клонирование конвейера позволяет перебирать проект конвейера без потери старых версий.  

## <a name="create-reusable-software-environments"></a>Создание повторно используемых программных сред

Машинное обучение Azure среды позволяют относить и воспроизводить программные зависимости проектов по мере их развития. Среды позволяют обеспечить воспроизводимость сборок без ручных конфигураций программного обеспечения.

Среды описывают зависимости PIP и Conda для проектов и могут использоваться как для обучения, так и для развертывания моделей. Дополнительные сведения см. в разделе [что такое машинное обучение Azure среды](concept-environments.md).

## <a name="register-package-and-deploy-models-from-anywhere"></a>Регистрация, Упаковка и развертывание моделей из любого места

### <a name="register-and-track-ml-models"></a>Регистрация и трассировка моделей машинного обучения

Регистрация модели позволяет хранить и изменять модели в облаке Azure в рабочей области. Модель реестра позволяет легко организовывать и отслеживать ваши обученные модели.

> [!TIP]
> Зарегистрированная модель — это логический контейнер для одного или нескольких файлов, составляющих эту модель. Например, если ваша модель хранится в нескольких файлах, их можно зарегистрировать как единую модель рабочей области Машинного обучения Azure. После регистрации вы сможете скачать или развернуть зарегистрированную модель, чтобы получить все зарегистрированные в ней файлы.

Зарегистрированные модели идентифицируются по имени и версии. При регистрации модели с уже существующим именем реестр увеличивает номер версии. Во время регистрации можно указать дополнительные теги метаданных. Затем эти теги используются при поиске модели. Машинное обучение Azure поддерживает любую модель, которую можно загрузить с помощью Python 3.5.2 или более поздней версии.

> [!TIP]
> Кроме того, можно регистрировать модели, обученные за пределами Машинное обучение Azure.

Нельзя удалить зарегистрированную модель, используемую в активном развертывании.
Дополнительные сведения см. в разделе "Регистрация модели" статьи [Развертывание моделей с помощью Службы машинного обучения Azure](how-to-deploy-and-where.md#registermodel).

### <a name="profile-models"></a>Модели профилей

Машинное обучение Azure поможет вам понять требования к ЦП и памяти службы, которая будет создана при развертывании модели. Профилирование проверяет службу, которая выполняет модель, и возвращает такие сведения, как загрузка ЦП, использование памяти и задержка ответа. Он также предоставляет рекомендации по ЦП и памяти на основе использования ресурсов.
Дополнительные сведения см. в разделе Профилирование раздела [Развертывание моделей](how-to-deploy-and-where.md#profilemodel).

### <a name="package-and-debug-models"></a>Модели упаковки и отладки

Перед развертыванием модели в рабочей среде она упаковывается в образ DOCKER. В большинстве случаев создание изображений происходит автоматически в фоновом режиме во время развертывания. Образ можно указать вручную.

При возникновении проблем с развертыванием можно выполнить развертывание в локальной среде разработки для устранения неполадок и отладки.

Дополнительные сведения см. в разделе [Развертывание моделей](how-to-deploy-and-where.md#registermodel) и [Устранение неполадок развертываний](how-to-troubleshoot-deployment.md).

### <a name="convert-and-optimize-models"></a>Преобразование и оптимизация моделей

Преобразование модели для [открытия обмена нейронными сетями](https://onnx.ai) (ONNX) может повысить производительность. В среднем преобразование в ONNX может привести к увеличению производительности в 2 раза.

Дополнительные сведения о ONNX с Машинное обучение Azure см. в статье [Создание и ускорение моделей ML](concept-onnx.md) .

### <a name="use-models"></a>Использование моделей

Обученные модели машинного обучения развертываются как веб-службы в облаке или локально. Также можно развернуть модели на Azure IoT Edge устройствах. В развертываниях используются ЦП, GPU или программируемые для полей массивы шлюзов (FPGA). Модели также можно использовать из Power BI.

При использовании модели в качестве веб-службы или устройства IoT Edge вы предоставляете следующие элементы:

* Модели, используемые для оценки данных, передаваемых службе или устройству.
* Скрипт входа. Этот скрипт принимает запросы, использует модели для оценки данных и возвращает ответ.
* Среда Машинное обучение Azure, описывающая зависимости PIP и Conda, необходимые для скрипта моделей и входа.
* Любые дополнительные активы, такие как текст, данные и т. д., необходимые для скрипта моделей и входа.

Вы также предоставляете конфигурацию целевой платформы развертывания. Например, тип семейства виртуальных машин, объем доступной памяти и число ядер при развертывании в службе Azure Kubernetes.

При создании образа также добавляются компоненты, необходимые для Машинное обучение Azure. Например, ресурсы, необходимые для запуска веб-службы и взаимодействия с IoT Edge.

#### <a name="batch-scoring"></a>Пакетная оценка
Пакетная Оценка поддерживается через конвейеры ML. Дополнительные сведения см. [в статье пакетные прогнозы для больших данных](how-to-use-parallel-run-step.md).

#### <a name="real-time-web-services"></a>Веб-службы в режиме реального времени

Вы можете использовать модели в **веб-службах** со следующими целевыми объектами вычислений:

* Экземпляр контейнера Azure
* Служба Azure Kubernetes
* Локальная среда разработки

Чтобы развернуть модель как веб-службу, необходимо предоставить следующие элементы:

* Модель или ансамблей моделей.
* Зависимости, необходимые для использования модели. Например, скрипт, принимающий запросы и вызывающий модель, conda зависимости и т. д.
* Конфигурация развертывания, описывающая способ и место развертывания модели.

Дополнительные сведения см. в разделе [Развертывание моделей](how-to-deploy-and-where.md).

#### <a name="controlled-rollout"></a>Управляемое развертывание

При развертывании в службе Azure Kubernetes можно использовать управляемый выпуск, чтобы включить следующие сценарии.

* Создание нескольких версий конечной точки для развертывания
* Выполните A/B-тестирование, направляя трафик в разные версии конечной точки.
* Переключение между версиями конечных точек путем обновления процента трафика в конфигурации конечной точки.

Дополнительные сведения см. в разделе [контролируемый выпуск моделей машинного обучения](how-to-deploy-azure-kubernetes-service.md#deploy-models-to-aks-using-controlled-rollout-preview).

#### <a name="iot-edge-devices"></a>Устройства IoT Edge

Модели с устройствами Интернета вещей можно использовать с помощью **модулей Azure IOT Edge**. IoT Edge модули развертываются на аппаратном устройстве, что позволяет выводить на экран или оценивать модель на устройстве.

Дополнительные сведения см. в разделе [Развертывание моделей](how-to-deploy-and-where.md).

### <a name="analytics"></a>Аналитика

Microsoft Power BI поддерживает использование моделей машинного обучения для аналитики данных. Дополнительные сведения см. [в разделе интеграция машинное обучение Azure в Power BI (Предварительная версия)](https://docs.microsoft.com/power-bi/service-machine-learning-integration).

## <a name="capture-the-governance-data-required-for-capturing-the-end-to-end-ml-lifecycle"></a>Сбор данных управления, необходимых для сбора комплексного жизненного цикла машинного обучения

Служба машинного обучения Azure позволяет отслеживать сквозной журнал всех активов машинного обучения с помощью метаданных.

- Azure ML [интегрируется с Git](how-to-set-up-training-targets.md#gitintegration) , чтобы отнести сведения о репозитории, ветви или фиксации вашего кода.
- [Наборы данных машинного обучения Azure](how-to-create-register-datasets.md) помогают отслеживанию, профилированию и версии.
- [Интерпретируемость](how-to-machine-learning-interpretability.md) позволяет объяснить модели, обеспечить соответствие нормативным требованиям и понять, как модели прибывают к результату для заданных входных данных.
- В журнале выполнения машинного обучения Azure хранится моментальный снимок кода, данных и вычислений, используемых для обучения модели.
- В реестре модели машинного обучения Azure записываются все метаданные, связанные с вашей моделью (которые обучены с помощью эксперимента, где выполняется развертывание, если ее развертывания являются работоспособными).
- [Интеграция с Azure](how-to-use-event-grid.md) позволяет работать с событиями в жизненном ЦИКЛе машинного обучения. Например, события регистрации модели, развертывания, смещения данных и обучения (запуск).

> [!TIP]
> Хотя некоторые сведения о моделях и наборах данных регистрируются автоматически, можно добавлять дополнительные сведения с помощью __тегов__. При поиске зарегистрированных моделей и наборов данных в рабочей области можно использовать теги в качестве фильтра.
>
> Связывание набора данных с зарегистрированной моделью является необязательным шагом. Сведения об обращении к набору данных при регистрации модели см. в разделе Справочник по классам [модели](https://docs.microsoft.com/python/api/azureml-core/azureml.core.model(class)?view=azure-ml-py) .


## <a name="notify-automate-and-alert-on-events-in-the-ml-lifecycle"></a>Уведомлять, автоматизировать и оповещать о событиях в жизненном цикле машинного обучения
Служба машинного обучения Azure публикует ключевые события в Azure EventGrid, которые можно использовать для уведомления и автоматизации событий в жизненном цикле машинного обучения. Дополнительные сведения см. в [этом документе](how-to-use-event-grid.md).


## <a name="monitor-for-operational--ml-issues"></a>Мониторинг проблем с операционными &ми машинного обучения

Мониторинг позволяет понять, какие данные отправляются в модель, и какие прогнозы она возвращает.

Эти сведения помогут вам понять, как используется модель. Собранные входные данные также могут быть полезны при обучении будущих версий модели.

Дополнительные сведения см. в статье [Сбор данных для моделей в рабочей среде](how-to-enable-data-collection.md).

## <a name="retrain-your-model-on-new-data"></a>Переобучение модели на новых данных

Часто требуется проверить модель, обновить ее или даже переучить с нуля, когда вы получаете новые сведения. Иногда получение новых данных является ожидаемой частью домена. В других случаях, как описано в разделе [Обнаружение смещения данных (Предварительная версия) в наборах](how-to-monitor-datasets.md), производительность модели может снизиться, например, изменения конкретного датчика, естественные изменения данных, например сезонные эффекты, или функции, переопределяющие их связь с другими функциями. 

Нет универсального ответа на "Разделы справки узнать, следует ли переучить?" Однако ранее обсуждаемые средства для событий и мониторинга Azure ML являются хорошими отправными точками для автоматизации. После того как вы решили переучить, вам нужно: 

- Предварительная обработка данных с помощью повторяющегося автоматизированного процесса
- Обучение новой модели
- Сравните выходные данные новой модели с теми, которые относятся к старой модели.
- Используйте предопределенные критерии, чтобы выбрать, следует ли заменить старую модель 

Тема описанных выше действий заключается в том, что переобучение должно быть автоматизированным, а не нерегламентированным. [Машинное обучение Azure конвейеров](concept-ml-pipelines.md) — хороший ответ на создание рабочих процессов, касающихся подготовки данных, обучения, проверки и развертывания. Прочтите раздел [переобучение моделей с помощью машинное обучение Azure конструктора (Предварительная версия)](how-to-retrain-designer.md) , чтобы увидеть, как конвейеры и конструктор машинное обучение Azure помещаются в сценарий повторного обучения. 

## <a name="automate-the-ml-lifecycle"></a>Автоматизация жизненного цикла машинного обучения 

Вы можете использовать GitHub и Azure Pipelines для создания процесса непрерывной интеграции, который обучает модель. В типичном сценарии, когда анализу данных проверяет изменение в репозитории Git для проекта, конвейер Azure начнет обучающий запуск. Затем результаты выполнения можно просмотреть, чтобы увидеть характеристики производительности обученной модели. Также можно создать конвейер, который развертывает модель как веб-службу.

[Расширение машинное обучение Azure](https://marketplace.visualstudio.com/items?itemName=ms-air-aiagility.vss-services-azureml) упрощает работу с Azure pipelines. Он предоставляет следующие усовершенствования Azure Pipelines.

* Включает выбор рабочей области при определении подключения к службе.
* Разрешает активацию конвейеров выпуска обученными моделями, созданными в конвейере обучения.

Дополнительные сведения об использовании Azure Pipelines с Машинное обучение Azure см. по следующим ссылкам:

* [Непрерывная интеграция и развертывание моделей ML с Azure Pipelines](/azure/devops/pipelines/targets/azure-machine-learning) 
* [Машинное обучение Azure](https://aka.ms/mlops) репозиторий млопс.
* [Машинное обучение Azure](https://github.com/Microsoft/MLOpspython) репозиторий млопсписон.

Фабрику данных Azure также можно использовать для создания конвейера приема данных, который готовит данные для использования в процессе обучения. Дополнительные сведения см. в разделе [конвейер приема данных](how-to-cicd-data-ingestion.md).

## <a name="next-steps"></a>Дальнейшие шаги

Дополнительные сведения см. в следующих ресурсах:

+ [Как &, где развертывать модели](how-to-deploy-and-where.md) с машинное обучение Azure

+ [Учебник. Развертывание модели классификации изображений в ACI](tutorial-deploy-models-with-aml.md).

+ [Репозиторий комплексных примеров Млопс](https://github.com/microsoft/MLOps)

+ [CI/CD моделей машинного обучения с Azure Pipelines](/azure/devops/pipelines/targets/azure-machine-learning)

+ Создание клиентов, [использующих развернутую модель](how-to-consume-web-service.md)

+ [Машинное обучение с поддержкой масштабирования](/azure/architecture/data-guide/big-data/machine-learning-at-scale)

+ [Эталонные архитектуры Azure ии & рекомендации](https://github.com/microsoft/AI)
