---
title: Реконструирование признаков при обработке и анализе данных — командный процесс обработки и анализа данных
description: Сведения о конструировании признаков и его роли в процессе улучшения данных машинного обучения.
services: machine-learning
author: marktab
manager: marktab
editor: marktab
ms.service: machine-learning
ms.subservice: team-data-science-process
ms.topic: conceptual
ms.date: 05/14/2020
ms.author: tdsp
ms.custom: seodec18, previous-author=deguhath, previous-ms.author=deguhath, contperfq4
ms.openlocfilehash: c31cf0e5c655f53e8838c92f5463d3a85c2f6f65
ms.sourcegitcommit: 0b80a5802343ea769a91f91a8cdbdf1b67a932d3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2020
ms.locfileid: "83836827"
---
# <a name="feature-engineering-in-data-science"></a>Проектирование признаков при обработке и анализе данных

В этой статье вы узнаете о конструировании признаков и его роли в улучшении данных в машинном обучении. Ознакомьтесь с демонстрационными примерами, взятыми из экспериментов [Студия машинного обучения Azure (классическая)](../studio/what-is-ml-studio.md). 

* **Проектирование признаков**. Процесс создания новых функций из необработанных данных для повышения эффективности возможностей прогнозирования алгоритма обучения. Для конструирования признаков требуется дополнительная информация, которая не так очевидна в исходном наборе признаков.
* **Выбор признаков**. В этом процессе выбирается ключевое подмножество признаков с целью сокращения размерности задачи обучения.

Как правило, **конструирование признаков** сначала применяется для создания дополнительных признаков, а затем выполняется **выбор признаков**, чтобы исключить несоответствующие, избыточные или сильно коррелирующие признаки.

Проектирование и выбор признаков являются частью [этапа моделирования](lifecycle-modeling.md) командного процесса обработки и анализа данных (TDSP). Дополнительные сведения о TDSP и жизненном цикле обработки и анализа данных см. в разделе [Что такое TDSP?](overview.md)

## <a name="what-is-feature-engineering"></a>Что такое конструирование признаков?

Обучающие данные состоят из матрицы, включающей строки и столбцы. Каждая строка в матрице является наблюдением или записью. Столбцы каждой строки представляют собой признаки, описывающие каждую запись. Признаки, указанные в схеме эксперимента, должны характеризовать закономерности в данных.

Несмотря на то, что многие поля необработанных данных можно использовать непосредственно для обучения модели, часто бывает необходимо создать дополнительные (сконструированные) признаки для расширенного набора данных для обучения.

Сконструированные признаки, совершенствующие обучение, содержат сведения, которые лучше выделяют закономерности в данных. Это довольно творческий процесс. Обоснованные и эффективные решения часто требуют знания предметной области.

## <a name="example-1-add-temporal-features-for-a-regression-model"></a>Пример 1: Добавление временных признаков для регрессионной модели

Воспользуемся экспериментом [Прогнозирование спроса на прокат велосипедов](https://gallery.azure.ai/Experiment/Regression-Demand-estimation-4) в Студии машинного обучения Azure (классическая), чтобы продемонстрировать процесс конструирования признаков для задачи регрессии. Цель этого эксперимента — прогноз спроса на количество сдаваемых напрокат велосипедов в конкретный день/месяц/час.

### <a name="bike-rental-dataset"></a>Набор данных по прокату велосипедов

[Набор данных по прокату велосипедов UCI](http://archive.ics.uci.edu/ml/datasets/Bike+Sharing+Dataset/) основан на реальных данных от компании в США. Он представляет собой количество сдаваемых напрокат велосипедов в определенный час дня в 2011–2012 гг. и содержит 17 379 строк и 17 столбцов.

Набор необработанных признаков содержит погодные условия (температура, влажность и скорость ветра) и тип дня (праздник/будний день). Поле для прогнозирования определяет количество велосипедов, сдаваемых напрокат в течение указанного часа, в диапазоне от 1 до 977.

### <a name="create-a-feature-engineering-experiment"></a>Создание эксперимента по конструированию признаков

Для создания эффективных признаков в обучающих данных строятся четыре регрессионные модели с использованием одного и того же алгоритма, но с четырьмя разными обучающими наборами данных. Четыре набора данных представляют те же необработанные входные данные, но с увеличиваемым номером набора признаков. Эти признаки сгруппированы в четыре категории:

1. А = «погода» + «праздник» + «рабочий день» + «выходной день» для прогнозируемого дня
2. Б = количество велосипедов, которые сданы напрокат в каждый из предыдущих 12 часов
3. В = количество велосипедов, которые были сданы напрокат в каждый из предыдущих 12 дней в течение одного и того же часа
4. Г = количество велосипедов, которые были сданы напрокат в каждую из предыдущих 12 недель в течение одного и того же часа и дня

Помимо набора признаков А, который уже существует в исходных необработанных данных, другие три набора признаков создаются в процессе реконструирования признаков. Набор признаков Б охватывает новейший спрос на велосипеды. Набор признак В спрос на велосипеды в конкретный час. Набор признаков Г охватывает спрос на велосипеды в определенный час и определенный день недели. Четыре набора обучающих данных содержат наборы признаков А, А + Б, А + Б + В и A + Б + В + Г, соответственно.

### <a name="feature-engineering-using-studio-classic"></a>Проектирование признаков с помощью Студии (классическая)

В эксперименте со Студией (классическая) эти четыре набора обучающих данных формируются через четыре ветви предварительно обработанного входного набора данных. За исключением крайней левой ветви, каждая из этих ветвей содержит модуль [Выполнить сценарий R](https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/), в котором производные признаки (набор признаков Б, В и Г) реконструируются и добавляются в импортируемый набор данных.

На следующем рисунке показан сценарий R, используемый для создания набора признаков Б во второй слева ветви.

![создание признаков](./media/create-features/addFeature-Rscripts.png)

### <a name="results"></a>Результаты

Сравнение результатов производительности четырех моделей приведено в таблице ниже. 

![сравнение результатов](./media/create-features/result1.png)

Наилучшие результаты даются набором признаков А + Б + В. Частота ошибок уменьшается, когда в обучающие данные включается дополнительный набор признаков. Он подтверждает предположение, что набор признаков Б + В предоставляет дополнительные данные для задачи регрессии. Однако добавление набора признаков Г не дает дополнительного сокращения частоты ошибок.

## <a name="example-2-create-features-for-text-mining"></a><a name="example2"></a> Пример 2. Создание признаков для интеллектуального анализа текста

Конструирование признаков широко применяется в задачах, связанных с интеллектуальным анализом текста, например в классификации документов и анализе тональностей. Поскольку отдельные части необработанного текста обычно служат входными данными, для создания признаков, связанных с частотой вхождения слова или фразы, необходим процесс конструирования признаков.

### <a name="feature-hashing"></a>Хэширование признаков

Для выполнения этой задачи вызывается метод [хэширования признаков](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/feature-hashing), чтобы эффективно превратить произвольные признаки текста в индексы. Вместо того чтобы сопоставлять каждый признак текста (слова или фразы) для определенного индекса, этот метод применяет хэш-функции к признакам и непосредственному использованию их хэш-значений как индексов.

В Студии (классическая) есть модуль [хэширования признаков](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/feature-hashing), с помощью которого удобнее создавать признаки слов и фраз. На рисунке ниже показан пример использования данного модуля. Входной набор данных содержит два столбца: рейтинг книги от 1 до 5 и содержимое фактической рецензии. Задача этого модуля состоит в извлечении множества новых признаков, чтобы показать частоту вхождения соответствующих слов в рецензии на определенную книгу. Чтобы использовать этот модуль, сделайте следующее:

* Сначала выберите столбец, содержащий входной текст («Col2» в этом примере).
* Затем для Hashing bitsize установите значение 8, означающее, что будет создано 2^8 = 256 признаков. Слова и фразы всего текста будут хэшированы на 256 индексов. Параметр Hashing bitsize меняется в диапазоне от 1 до 31. Слова и фразы с меньшей вероятностью хэшируются с тем же индексом при росте значения параметра.
* После этого задайте для параметра N-grams значение 2. Этот значение возвращает частоту вхождения униграмм (признаков для каждого отдельного слова) и биграмм (признаков для каждой пары смежных слов) во входном тексте. Параметр N-grams меняется от 0 до 10, определяя максимальное количество последовательно идущих слов, которые включены в признак.  

![Модуль «Хэширование признаков»](./media/create-features/feature-Hashing1.png)

На следующем рисунке показано, на что похожи эти новые признаки.

![Пример «Хэширование признаков»](./media/create-features/feature-Hashing2.png)

## <a name="conclusion"></a>Заключение
Реконструированные и выбранные признаки повышают эффективность процесса обучения, который пытается извлечь ключевые сведения, содержащиеся в данных. Они также дают возможность повысить возможности этих моделей, чтобы точнее классифицировать входные данные и более надежно предсказывать нужные результаты.

Реконструирование и выбор признаков можно также объединять, чтобы сделать процесс обучения более алгоритмизируемым. Этого можно достичь путем расширения и сокращения числа признаков, необходимых для калибровки или обучения модели. С точки зрения математики выбранные признаки являются минимальным набором независимых переменных, которые определяют структуры в данных и затем успешно прогнозируют результаты.

Не всегда обязательно выполнять конструирование или выбор признаков. Это зависит от собранных данных, выбранного алгоритма и цели эксперимента.

## <a name="next-steps"></a>Дальнейшие действия

Сведения о создании характеристик для данных в определенных средах см. в таких статьях:

* [Создание характеристик для данных в SQL Server](create-features-sql-server.md)
* [Создание признаков для данных в кластере Hadoop с помощью запросов Hive](create-features-hive.md)