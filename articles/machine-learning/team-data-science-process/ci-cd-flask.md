---
title: Создание конвейера непрерывной интеграции в Azure — командный процесс обработки и анализа данных
description: DevOps для приложений искусственного интеллекта (ИИ). Создание конвейера непрерывной интеграции в Azure с помощью Docker и Kubernetes
services: machine-learning
author: marktab
manager: cgronlun
editor: cgronlun
ms.service: machine-learning
ms.component: team-data-science-process
ms.topic: article
ms.date: 05/22/2018
ms.author: tdsp
ms.custom: seodec18, previous-author=jainr, previous-ms.author=jainr
ms.openlocfilehash: a3c570d3d22742afcbba86f35a9dd1f6a85c0b8f
ms.sourcegitcommit: 78ec955e8cdbfa01b0fa9bdd99659b3f64932bba
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2018
ms.locfileid: "53134290"
---
# <a name="creating-continous-integration-pipeline-on-azure-using-docker-kubernetes-and-python-flask-application"></a>Создание конвейера непрерывной интеграции в Azure с помощью приложения Docker, Kubernetes или Flask Python
Для приложения AI существуют часто используемые два рабочих потока, создаваемые модели машинного обучения с помощью обработки и анализа данных и разработчики приложений, которые создают приложение и предоставляют его для потребления конечным пользователям. В этой статье будет продемонстрирована реализация конвейера непрерывной интеграции (CI) или непрерывной доставки (CD) для приложения AI. AI-приложение является сочетанием кода приложения, который внедрен в модель предварительного машинного обучения (ML). Из этой статьи вы узнаете, как извлекать предварительно обработанную модель из частной учетной записи хранения BLOB-объектов (вместо нее можно использовать учетную запись AWS S3). В этой статье будут использованы простые примеры веб-приложения Flask Python.

> [!NOTE]
> Это один из нескольких способов выполнения CI/CD. У средств и других необходимых требований, упомянутых ниже, существуют альтернативы. Они будут публиковаться по мере разработки дополнительного содержимого.
>
>

## <a name="github-repository-with-document-and-code"></a>Код и документы репозитория GitHub
Исходный код можно скачать с [GitHub](https://github.com/Azure/DevOps-For-AI-Apps). Более подробное руководство доступно [здесь](https://github.com/Azure/DevOps-For-AI-Apps/blob/master/Tutorial.md).

## <a name="pre-requisites"></a>Предварительные требования
Ниже приведены условия, необходимые для выполнения описанного конвейера CI/CD:
* [организация Azure DevOps](https://docs.microsoft.com/azure/devops/organizations/accounts/create-organization-msa-or-work-student);
* [Интерфейс командной строки Azure](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest)
* [развернутый кластер Kubernetes в службе контейнеров Azure](https://docs.microsoft.com/azure/container-service/kubernetes/container-service-tutorial-kubernetes-deploy-cluster);
* [Учетная запись Реестра контейнеров Azure (ACR)](https://docs.microsoft.com/azure/container-registry/container-registry-get-started-portal)
* [установленный Kubectl для запуска команд в кластере Kubernetes](https://kubernetes.io/docs/tasks/tools/install-kubectl/). Он понадобится, чтобы получить конфигурацию кластера ACS. 
* Репозиторий, скопированный в учетную запись GitHub.

## <a name="description-of-the-cicd-pipeline"></a>Описание конвейера CI/CD
Для каждого нового события конвейер запускается, проводит набор тестов, и если они окажутся успешными, он принимает последнюю сборку, а затем упаковывает ее в контейнер Docker. Затем с помощью службы контейнеров Azure (ACS) выполняется развертывание контейнера, а образы безопасно хранятся в реестре контейнеров Azure (ACR). По умолчанию ACS, которая управляет кластером контейнера, работает в Kubernetes, но его можно заменить на Docker, Swarm или Mesos.

Приложение безопасно извлекает последнюю версию модели из учетной записи службы хранилища Azure и упаковывает ее в качестве части приложения. Развернутое приложение содержит код приложения и модель машинного обучения, которая упакована как единый контейнер. Это отделяет разработчиков приложений и специалистов по обработке и анализу данных и позволяет убедиться, что их рабочее приложение всегда использует последний код вместе с последней моделью машинного обучения.

Архитектура конвейера приведена ниже. 

![Архитектура](./media/ci-cd-flask/Architecture.PNG?raw=true)

## <a name="steps-of-the-cicd-pipeline"></a>Этапы конвейера CI/CD
1. Разработчики работают над кодом приложения в выбранной ими интегрированной среде разработки (IDE).
2. Затем они передают код выбранной системе управления версиями для проверки (в Azure DevOps присутствует качественная поддержка различных систем управления версиями).
3. В свою очередь, специалисты по анализу и обработке данных отдельно работают над разработкой моделей разработчиков.
4. После получения удовлетворительных результатов они публикуют модель в репозитории моделей. Для этого используется учетная запись хранилища BLOB-объектов. 
5. Сборка запускается в Azure DevOps на основе результатов фиксации в GitHub.
6. Конвейер сборки Azure DevOps извлекает последнюю модель из контейнера BLOB-объектов и создает новый контейнер.
7. Azure DevOps отправляет изображение в частный репозиторий изображений в Реестре контейнеров Azure.
8. Конвейер выпуска будет запущен согласно установленному расписанию (ночью).
9. Последняя версия изображения будет извлечена из ACR и развернута в кластере Kubernetes в ACS.
10. Пользовательский запрос приложения проходит через DNS-сервер.
11. DNS-сервер передает запрос балансировщику нагрузки и отправляет ответ пользователю.

## <a name="next-steps"></a>Дополнительная информация
* Чтобы соответствовать требованиям и реализовать конвейер CI/CD для собственного приложения, обратитесь к [руководству](https://github.com/Azure/DevOps-For-AI-Apps/blob/master/Tutorial.md).

## <a name="references"></a>Ссылки
* [Командный процесс обработки и анализа данных (TDSP)](https://aka.ms/tdsp).
* [Документация по службам машинного обучения Azure (предварительная версия)](https://docs.microsoft.com/azure/machine-learning/service/)
* [Azure DevOps](https://www.visualstudio.com/vso/)
* [Общие сведения о предварительной версии службы Azure Kubernetes (AKS)](https://docs.microsoft.com/azure/aks/intro-kubernetes)
