---
title: Использование веб-службы в Excel
titleSuffix: Azure Machine Learning Studio (classic)
description: Машинное обучение Azure Studio (классическая модель) упрощает вызов веб-служб непосредственно из Excel без необходимости написания кода.
services: machine-learning
ms.service: machine-learning
ms.subservice: studio
ms.topic: conceptual
author: xiaoharper
ms.author: amlstudiodocs
ms.custom: seodec18
ms.date: 02/01/2018
ms.openlocfilehash: afa6430a76650b08f979687e2a1e5c7b53c89180
ms.sourcegitcommit: c22327552d62f88aeaa321189f9b9a631525027c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73493260"
---
# <a name="consuming-an-azure-machine-learning-studio-classic-web-service-from-excel"></a>Использование веб-службы Машинное обучение Azure Studio (классической) из Excel

 Машинное обучение Azure Studio (классическая модель) упрощает вызов веб-служб непосредственно из Excel без необходимости написания кода.

При использовании Excel 2013 (или более поздней версии) или Excel Online рекомендуется также использовать [надстройку Excel](excel-add-in-for-web-services.md).



## <a name="steps"></a>Действия
Опубликуйте веб-службу. [Учебник 3. Развертывание модели кредитных рисков](tutorial-part3-credit-risk-deploy.md) объясняет, как это сделать. В настоящее время функция книги Excel поддерживается только для служб обработки запросов и ответов с один выходом (то есть с одной меткой оценки). 

После создания веб-службы щелкните раздел **ВЕБ-СЛУЖБЫ** в левой части студии, а затем выберите веб-службу, которую нужно использовать в Excel.

**Классическая веб-служба**

1. На вкладке **Панель мониторинга** веб-службы есть строка для службы обработки **Запрос — ответ**. Если бы в этой службе был один выход, в строке отобразилась бы ссылка **Загрузить книгу Excel** .

    ![Загрузка книги Excel с помощью портала веб-служб Studio (классическая модель)](./media/consuming-from-excel/excellink.png)
2. Щелкните **Download Excel Workbook**(Скачать книгу Excel).

**Новая веб-служба**

1. На портале веб-служб Машинного обучения Azure выберите **Consume**(Использование).
2. На странице "Consume" (Использование) в разделе **Web service consumption options** (Параметры использования веб-службы) щелкните значок Excel.

**Использование книги**

1. Откройте книгу.
2. Отобразится предупреждение системы безопасности. Нажмите кнопку **Разрешить изменение**.

    ![Включение редактирования для удаления предупреждения безопасности защищенного представления](./media/consuming-from-excel/enableeditting.png)
3. Отобразится предупреждение системы безопасности. Нажмите кнопку **Включить содержимое** , чтобы запустить макросы в электронной таблице.

    ![Включить содержимое, чтобы отклонить предупреждение системы безопасности об отключении макросов](./media/consuming-from-excel/enablecontent.png)
4. После включения макросов будет создана таблица. Синие столбцы представляют собой входные данные, или **ПАРАМЕТРЫ**, для веб-службы RRS. Обратите внимание на выходные данные службы RRS ( **ПРОГНОЗИРУЕМЫЕ ЗНАЧЕНИЯ** ), отмеченные зеленым цветом. После заполнения всех столбцов для указанной строки книга автоматически вызывает API оценки и отображает результаты оценки.

    ![Таблица для входных параметров и результирующих прогнозируемых значений](./media/consuming-from-excel/sampletable.png)
5. Чтобы оценить несколько строк, заполните вторую строку данными, и вы получите прогнозируемые значения. Можно даже вставить несколько строк одновременно.

Для лучшей визуализации данных к прогнозируемым значениям можно применять все функции Excel (графики, Power Map, условное форматирование и пр.).

## <a name="sharing-your-workbook"></a>Предоставление общего доступа к книге
Для выполнения макросов в электронную таблицу должен входить ключ API. Это означает, что общий доступ к книге нужно предоставлять только тем организациям и людям, которым вы доверяете.

## <a name="automatic-updates"></a>автоматические обновления,
Служба RRS вызывается в двух следующих случаях:

1. когда впервые встречается строка, содержащая значения во всех столбцах **ПАРАМЕТРЫ**
2. в любое время при изменении значения в любом столбце **Параметры** в строке, содержащей значения во всех столбцах **Параметры**.