---
title: Миграция аналитики из Excel
titleSuffix: Azure Machine Learning Studio (classic)
description: Сравнение моделей линейной регрессии в Excel и в Машинное обучение Azure Studio (классическая модель)
services: machine-learning
ms.service: machine-learning
ms.subservice: studio
ms.topic: conceptual
author: xiaoharper
ms.author: amlstudiodocs
ms.custom: previous-author=heatherbshapiro, previous-ms.author=hshapiro
ms.date: 03/20/2017
ms.openlocfilehash: 533d58508f4788e90b0a3daa800e1149f5cba8b1
ms.sourcegitcommit: c22327552d62f88aeaa321189f9b9a631525027c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73492865"
---
# <a name="migrate-analytics-from-excel-to-azure-machine-learning-studio-classic"></a>Перенос аналитики из Excel в Машинное обучение Azure Studio (классическая модель)

> *Кейт Барони* (Kate Baroni) и *Бен Боутмен* (Ben Boatman) — архитекторы корпоративных решений в Научно-инновационном центре анализа данных корпорации Майкрософт. В этой статье описывается процесс переноса существующего набора регрессионного анализа в облачное решение с помощью Машинное обучение Azure Studio (классическая модель).

## <a name="goal"></a>Цель

У нашего проекта было две цели: 

1. Использование прогнозной аналитики для увеличения точности проекции ежемесячных доходов организации. 
2. Используйте классическую версию Машинное обучение Azure Studio для подтверждения, оптимизации, повышения скорости и масштабирования результатов. 

Как и множество других компаний, наша организация прогнозирует свой ежемесячный доход. Наша небольшая группа бизнес-аналитиков была создана с использованием классической версии Машинное обучение Azure Studio для поддержки процесса и повышения точности прогнозов. Несколько месяцев группа занималась сбором данных из нескольких источников и статистическим анализом атрибутов данных, который позволил определить ключевые атрибуты, относящиеся к прогнозированию продаж услуг. Дальнейшие действия состояли в создании прототипов моделей статистической регрессии для данных в Excel. Спустя несколько недель мы получили модель регрессии для Excel, которая превзошла возможности современных процессов отраслевого и финансового прогнозирования. Это стало базовым результатом прогноза. 

Затем мы предприняли следующий шаг по переносу прогнозной аналитики в классическую версию Studio, чтобы узнать, как классическая версия Studio может улучшить прогнозную производительность.

## <a name="achieving-predictive-performance-parity"></a>Достижение соответствия производительности прогнозирования
Первым приоритетом было достижение соответствия между классической версией моделей регрессии Studio и Excel. Учитывая одни и те же данные и разбиение для обучающих и проверочных данных, мы хотели добиться прогнозной производительности по четности между Excel и классической версией Studio. Сначала нам не удалось выполнить эту задачу. Модель Excel, которая является классической моделью Studio (классическая модель). Ошибка возникла из-за недостатка в понимании параметра базового инструмента в классической версии Studio. После синхронизации с классической версией группы разработчиков Studio мы получили более полное представление о базовом параметре, требуемом для наших наборов данных, и получить данные о четности между двумя моделями. 

### <a name="create-regression-model-in-excel"></a>Создание регрессионной модели в Excel
Наш метод регрессии в Excel использует стандартную модель линейной регрессии, доступную в пакете анализа Excel. 

Мы вычислили *среднюю абсолютную погрешность в процентах* и использовали это значение в качестве меры производительности модели. Создание рабочей модели с использованием Excel заняло 3 месяца. Мы выбрали большую часть обучения в классической версии эксперимента Studio, которая в конечном итоге была полезна в понимании требований.

### <a name="create-comparable-experiment-in-studio-classic"></a>Создание сравнимого эксперимента в студии (классическая модель)
Мы соблюдаем эти действия, чтобы создать наш эксперимент в классической версии Studio: 

1. Передан набор данных в виде CSV-файла в классической версии Studio (очень маленький файл)
2. Создан новый эксперимент и использован модуль [Выбор столбцов в наборе данных][select-columns] для выбора тех же функций данных, которые использовались в Excel 
3. Использует модуль [Split Data (разделить данные][split] ) (с режимом *относительных выражений* ) для разделения данных на те же наборы данных для обучения, которые были сделаны в Excel 
4. Эксперименты с модулем [линейной регрессии][linear-regression] (только параметры по умолчанию), документированы и сравнение результатов с моделью регрессии Excel

### <a name="review-initial-results"></a>Просмотр изначальных результатов
Сначала модель Excel четко выполнит модель Studio (классической). 

|  | Excel | Studio (классическая модель) |
| --- |:---:|:---:|
| Производительность | | |
| <ul style="list-style-type: none;"><li>Скорректированный коэффициент детерминации R-квадрат</li></ul> |0,96 |Недоступно |
| <ul style="list-style-type: none;"><li>Коэффициент <br />определения</li></ul> |Недоступно |0,78<br />(низкая точность) |
| Средняя абсолютная погрешность |9 500 000 долл. США |19 400 000 долл. США |
| Средняя абсолютная погрешность (в %) |6,03 % |12,2 % |

Когда мы объяснили принцип выполнения процесса и показали полученные результаты разработчикам и специалистам по обработке и анализу данных из группы разработки машинного обучения, они нам тут же дали несколько полезных советов. 

* При использовании модуля [линейной регрессии][linear-regression] в классической версии Studio предоставляются два метода:
  * метод градиентного спуска в режиме онлайн — может подойти для крупномасштабных проблем;
  * метод наименьших квадратов — наиболее распространенный метод линейной регрессии. Это самый оптимальный выбор для небольших наборов данных.
* Для повышения производительности следует рассмотреть возможность изменения параметра «Вес регуляризации L2». Его значение по умолчанию — 0,001. Чтобы повысить производительность, для небольшого набора данных мы установили значение 0,005. 

### <a name="mystery-solved"></a>Решение найдено!
Когда мы применили рекомендации, мы выдаете ту же базовую производительность в классической версии Studio, что и в Excel: 

|  | Excel | Studio (классическая модель) (начальная) | Studio (классическая модель) с или по меньшей мере квадраты |
| --- |:---:|:---:|:---:|
| Значение с подписью |Фактические значения (числовые) |—||— |—||— |
| Ученик |Excel -> "Анализ данных" -> "Регрессия" |Линейная регрессия |Линейная регрессия |
| Параметры ученика |Недоступно |Значения по умолчанию |Метод наименьших квадратов<br />L2 = 0,005 |
| Набор данных |26 строк, 3 признака, 1 метка. Все значения числовые. |—||— |—||— |
| Разделение: обучение |Обучение Excel выполнено по первым 18 строкам, тестирование — по последним 8 строкам. |—||— |—||— |
| Разделение: тестирование |Формула регрессии Excel применяется к последним 8 строкам. |—||— |—||— |
| **Производительность** | | | |
| Скорректированный коэффициент детерминации R-квадрат |0,96 |Недоступно | |
| Коэффициент детерминации |Недоступно |0,78 |0,952049 |
| Средняя абсолютная погрешность |9 500 000 долл. США |19 400 000 долл. США |9 500 000 долл. США |
| Средняя абсолютная погрешность (в %) |<span style="background-color: 00FF00;"> 6,03 %</span> |12,2 % |<span style="background-color: 00FF00;"> 6,03 %</span> |

Кроме того, мы получили хорошие результаты сравнения коэффициентов Excel и веса признаков в обученной модели Azure:

|  | Коэффициенты Excel | Весовые коэффициенты компонентов Azure |
| --- |:---:|:---:|
| Отрезок/смещение |19470209,88 |19328500 |
| Признак А |0,832653063 |0,834156 |
| Признак Б |11071967,08 |11007300 |
| Признак В |25383318,09 |25140800 |

## <a name="next-steps"></a>Следующие шаги
Мы хотели использовать веб-службу машинного обучения в Excel. Наши бизнес-аналитики полагаются на Excel, и нам нужно было найти способ вызвать веб-службу машинного обучения из строки данных Excel, чтобы она вернула спрогнозированное значение в Excel. 

Мы также хотели оптимизировать нашу модель с помощью параметров и алгоритмов, доступных в классической версии Studio.

### <a name="integration-with-excel"></a>Интеграция с Excel
Наше решение должно было привести в действие модель регрессии машинного обучения за счет создания веб-службы из обученной модели. Мы создали веб-службу за несколько минут и смогли вызвать ее прямо из Excel, чтобы получить спрогнозированное значение дохода. 

В разделе *Web Services Dashboard* (Панель мониторинга веб-служб) содержится книга Excel, которую можно скачать. Эта книга предварительно отформатирована с помощью API веб-службы, и в нее внедрена информация о схемах. Чтобы скачать книгу, щелкните *Download Excel Workbook* (Скачать книгу Excel). Она откроется, и ее можно будет сохранить на локальном компьютере. 

![Скачивание книги Excel с панели мониторинга "веб-службы"](./media/linear-regression-in-azure/machine-learning-linear-regression-in-azure-1.png)

Пока книга открыта, скопируйте предопределенные параметры в синий раздел «Параметры», показанный ниже. После ввода параметров Excel вызовет веб-службу машинного обучения, а в зеленом разделе "Спрогнозированные значения" отобразятся спрогнозированные оцененные метки. Книга продолжит создавать спрогнозированные значения параметров для всех элементов строк, введенных в разделе «Параметры», на основе обученной модели. Дополнительные сведения об использовании этой функции см. в статье [Использование веб-службы Машинного обучения Azure в Excel](consuming-from-excel.md). 

![Шаблон книги Excel, соединяющий развернутую веб-службу](./media/linear-regression-in-azure/machine-learning-linear-regression-in-azure-2.png)

### <a name="optimization-and-further-experiments"></a>Оптимизация и дальнейшие эксперименты
Определив необходимую модель Excel, мы приступили к оптимизации модели линейной регрессии машинного обучения. Мы использовали [Выбор компонентов на основе фильтра][filter-based-feature-selection] модуля, чтобы улучшить выбор начальных элементов данных, и это позволило нам повысить производительность 4,6% в среднем на абсолютную ошибку. Для будущих проектов мы будем использовать эту функцию, которая позволит сэкономить недели в проходе по атрибутам данных, чтобы найти правильный набор функций, которые будут использоваться для моделирования. 

Далее мы планируем включить в наш эксперимент дополнительные алгоритмы, такие как [Байеса][bayesian-linear-regression] или [повышенные деревья принятия решений][boosted-decision-tree-regression] , чтобы сравнить производительность. 

Если вы хотите поэкспериментировать с регрессией, попробуйте использовать пример набора данных регрессии энергетического КПД. Он отлично подходит для этого и содержит множество числовых атрибутов. Набор данных предоставляется как часть образцов наборов данных в классической версии Studio. Вы можете использовать множество модулей обучения для прогнозирования отопительной нагрузки или нагрузки по охлаждению. В таблице ниже сравнена производительность различных регрессионных моделей обучения и набора данных энергетического КПД для прогнозирования целевой переменной нагрузки по охлаждению: 

| Модель | Средняя абсолютная погрешность | Среднеквадратическая погрешность | Относительная абсолютная погрешность | Относительная среднеквадратическая погрешность | Коэффициент детерминации |
| --- | --- | --- | --- | --- | --- |
| Увеличивающееся дерево принятия решений |0,930113 |1,4239 |0,106647 |0,021662 |0,978338 |
| Линейная регрессия (метод градиентного спуска) |2,035693 |2,98006 |0,233414 |0,094881 |0,905119 |
| Регрессия нейронной сети |1,548195 |2,114617 |0,177517 |0,047774 |0,952226 |
| Линейная регрессия (метод наименьших квадратов) |1,428273 |1,984461 |0,163767 |0,042074 |0,957926 |

## <a name="key-takeaways"></a>Общие выводы
Мы узнали многое от выполнения регрессии Excel и классической версии Studio в параллельном режиме. Создание базовой модели в Excel и ее сравнение с моделями с помощью Машинное обучение [линейной регрессии][linear-regression] позволили нам изучить Studio (классическая модель), а мы обнаружили возможности для повышения производительности выбора данных и модели. 

Мы также обнаружили, что рекомендуется использовать [Выбор компонентов на основе фильтров][filter-based-feature-selection] для ускорения будущих проектов прогнозирования. Применив выбор компонентов к данным, можно создать улучшенную модель в классической версии Studio с более высокой общей производительностью. 

Возможность передачи прогнозной аналитической аналитики из классической версии Studio в Excel систематической позволяет значительно увеличить возможность успешного предоставления результатов широкой аудитории бизнес-пользователей. 

## <a name="resources"></a>Ресурсы
Ниже перечислены некоторые ресурсы, которые помогут вам в работе с регрессией. 

* Регрессия в Excel. Если вы никогда не работали с регрессией в Excel, это руководство упростит задачу: [https://www.excel-easy.com/examples/regression.html](https://www.excel-easy.com/examples/regression.html).
* Сравнение регрессии и прогнозирования. Тайлер Чессмен (Tyler Chessman) написал статью в блоге, в которой он рассказывает, как спрогнозировать временные ряды в Excel. [https://www.itprotoday.com/sql-server/understanding-time-series-forecasting-concepts](https://www.itprotoday.com/sql-server/understanding-time-series-forecasting-concepts) 
* Линейная регрессия по методу наименьших квадратов. Недостатки, проблемы и ошибки. Введение в регрессию и ее обсуждение см. по ссылке [https://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](https://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/).

<!-- Module References -->
[bayesian-linear-regression]: https://msdn.microsoft.com/library/azure/ee12de50-2b34-4145-aec0-23e0485da308/
[boosted-decision-tree-regression]: https://msdn.microsoft.com/library/azure/0207d252-6c41-4c77-84c3-73bdf1ac5960/
[filter-based-feature-selection]: https://msdn.microsoft.com/library/azure/918b356b-045c-412b-aa12-94a1d2dad90f/
[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/
[select-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/

