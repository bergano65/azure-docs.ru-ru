---
title: 'Кластеризация по K-средних: Справочник по модулям'
titleSuffix: Azure Machine Learning service
description: Узнайте, как использовать модуль кластеризации K-средних в службе Машинное обучение Azure для обучения моделей кластеризации.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: xiaoharper
ms.author: zhanxia
ms.date: 05/06/2019
ms.openlocfilehash: 7de2978fee80cf3acd078ef8ee5f235fab21713e
ms.sourcegitcommit: 07700392dd52071f31f0571ec847925e467d6795
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2019
ms.locfileid: "70128700"
---
# <a name="module-k-means-clustering"></a>Модуль: Кластеризация методом K-средних

В этой статье описывается, как использовать модуль *кластеризации k-средних* в машинное обучение Azure Studio для создания обученной модели кластеризации с k-средних. 
 
K-средние — это один из самых простых и наиболее известных неконтролируемых алгоритмов обучения. Алгоритм можно использовать для различных задач машинного обучения, таких как: 

* [Обнаружение аномальных данных](https://msdn.microsoft.com/magazine/jj891054.aspx).
* Кластеризация текстовых документов.
* Анализ наборов данных перед использованием других методов классификации или регрессии. 

Чтобы создать модель кластеризации, сделайте следующее:

* Добавьте этот модуль в эксперимент.
* Подключение набора данных.
* Задайте параметры, например количество кластеров, метрику расстояния, используемую при создании кластеров, и т. д. 
  
После настройки параметров модуля вы подключаете обученную модель к [модели обучения](train-clustering-model.md). Поскольку алгоритм K-средних является неконтролируемым методом обучения, столбец меток является необязательным. 

+ Если данные содержат метку, можно использовать значения меток для пошагового выбора кластеров и оптимизации модели. 

+ Если данные не имеют метки, алгоритм создает кластеры, представляющие возможные категории, основываясь исключительно на данных.  

##  <a name="understand-k-means-clustering"></a>Общие сведения о кластеризации с помощью K-средних
 
Как правило, кластеризация использует итеративные методы для группирования вариантов в наборе данных в кластеры, имеющие аналогичные характеристики. Эти группирования удобно использовать для просмотра данных, определения аномалий в данных и, в конечном итоге, для выполнения прогнозов. Модели кластеризации также могут помочь определить связи в наборе данных, которые не могут быть логически производными при просмотре или простое наблюдение. По этим причинам кластеризация часто используется на ранних этапах задач машинного обучения для изучения данных и обнаружения непредвиденных корреляций.  
  
 При настройке модели кластеризации с помощью метода K-средних необходимо указать целевое число *K* , которое указывает количество *средневзвешенных* в модели. Центроид — это точка, представляющая каждый кластер. Алгоритм K-средних назначает каждую входящую точку данных одному из кластеров, уменьшая сумму квадратов внутри кластера. 
 
При обработке обучающих данных алгоритм K-средние значения начинается с начального набора случайно выбранных средневзвешенных. Средневзвешенных служат в качестве отправных точек для кластеров и применяют алгоритм Ллойд для итеративного уточнения их расположений. Алгоритм K-средних прекращает создание и уточнение кластеров, если он удовлетворяет одному или нескольким из следующих условий:  
  
-   Средневзвешенных стабилизация, что означает, что назначения кластеров для отдельных точек больше не меняются, и алгоритм сходится в решении.  
  
-   Алгоритм завершил выполнение указанного числа итераций.  
  
 После завершения обучения используйте модуль [назначение данных в кластеры](assign-data-to-clusters.md) , чтобы назначить новые варианты одному из кластеров, найденных с помощью алгоритма K-средних. Назначение кластера выполняется путем вычисления расстояния между новым вариантом и центроид каждого кластера. Каждый новый вариант назначается кластеру с ближайшим центроид.  

## <a name="configure-the-k-means-clustering-module"></a>Настройка модуля кластеризации K-средних
  
1.  Добавьте модуль **кластеризации K-средних** в эксперимент.  
  
2.  Чтобы указать, как должна быть обучена модель, выберите параметр **создать режим преподавателя** .  
  
    -   **Один параметр**: Если точно известно, какие параметры вы хотите использовать в модели кластеризации, можно указать в качестве аргументов конкретный набор значений.  
  
3.  В поле **число средневзвешенных**введите число кластеров, с которых должен начинаться алгоритм.  
  
     В модели не гарантируется, что это количество кластеров будет таким же. Алгоритм начинается с этого количества точек данных и выполняет итерации для поиска оптимальной конфигурации.  
  
4.  Инициализация свойств используется для указания алгоритма, который используется для определения первоначальной конфигурации кластера.  
  
    -   **Первые N**: Некоторое начальное количество точек данных выбирается из набора данных и используется в качестве начального. 
    
         Этот метод также называется *методом подделки*.  
  
    -   **Случайный**: Алгоритм случайным образом помещает точку данных в кластер, а затем вычисляет начальное среднее, чтобы быть центроидом случайных назначенных точек кластера. 

         Этот метод также называется методом *случайного секционирования* .  
  
    -   **K-средние + +** : Это метод по умолчанию для инициализации кластеров.  
  
         Алгоритм **k-средних + +** был предложен в 2007 на Дэвида Артур и Сергеем вассилвитскии, чтобы избежать низкой кластеризации по стандартному алгоритму K-средних. **K-средние + +** улучшаются по стандарту k-средних с помощью другого метода выбора начальных центров кластера.  
  
    
5.  Для **начального числа случайных чисел**при необходимости введите значение, которое будет использоваться в качестве начального значения для инициализации кластера. Это значение может существенно повлиять на выбор кластера.  
  
6.  Вполе Метрика выберите функцию, используемую для измерения расстояния между векторами кластера или между новыми точками данных и случайным образом выбранным центроид. Машинное обучение Azure поддерживает следующие метрики расстояний кластера:  
  
    -   **Евклидово**: Евклидово расстояние обычно используется как мера кластерной точечной диаграммы для кластеризации на основе K-средних. Эта метрика является предпочтительной, так как уменьшает среднее расстояние между точками и средневзвешенных.
  
7.  Для **итераций**введите, сколько раз алгоритм должен пройти по обучающим данным перед тем, как завершит выбор средневзвешенных.  
  
     Этот параметр можно настроить для балансировки точности относительно времени обучения.  
  
8.  Для параметра **режим назначения метки**выберите параметр, указывающий, как должен обрабатываться столбец меток, если он есть в наборе данных.  
  
     Поскольку кластеризация с K-средних является методом неконтролируемого машинного обучения, метки необязательны. Однако если в наборе данных уже есть столбец меток, эти значения можно использовать для выбора кластеров, или можно указать, что значения будут игнорироваться.  
  
    -   **Пропустить столбец меток**: Значения в столбце Метка игнорируются и не используются при построении модели.
  
    -   **Заполнение отсутствующих значений**: Значения столбца меток используются в качестве функций, помогающих в построении кластеров. Если в каких-либо строках отсутствует метка, значение добавленные с помощью других функций.  
  
    -   **Перезаписывать из ближайшего в центр**: Значения столбца меток заменяются прогнозируемыми значениями меток с использованием метки точки, ближайшей к текущему центроид.  

8.  Выберите параметр **нормализация функций** , если требуется нормализовать функции перед обучением.
  
     При применении нормализации до начала обучения точки данных нормализуются в `[0,1]` минмакснормализер.

10. Обучение модели.  
  
    -   Если присвоить параметру **CREATE инструктора** значение **Single**, добавьте набор данных с тегами и обучите модель с помощью модуля [обучение модели кластеризации](train-clustering-model.md) .  
  
### <a name="results"></a>Результаты

После завершения настройки и обучения модели вы получите модель, которую можно использовать для создания оценок. Однако существует несколько способов обучения модели, а также несколько способов просмотра и использования результатов. 

#### <a name="capture-a-snapshot-of-the-model-in-your-workspace"></a>Запись моментального снимка модели в рабочей области

Если вы использовали модуль « [обучение модели кластеризации](train-clustering-model.md) », выполните следующие действия.

1. Щелкните правой кнопкой мыши модуль **обучение модели кластеризации** .

2. Выберите **обученная модель**, а затем выберите **Сохранить как обученную модель**.

Сохраненная модель представляет обучающие данные на момент сохранения модели. Если впоследствии вы обновите обучающие данные, используемые в эксперименте, это не приведет к обновлению сохраненной модели. 

#### <a name="see-the-clustering-result-dataset"></a>Просмотр результирующего набора кластеризации 

Если вы использовали модуль « [обучение модели кластеризации](train-clustering-model.md) », выполните следующие действия.

1. Щелкните правой кнопкой мыши модуль **обучение модели кластеризации** .

2. Выберите **набор данных результаты**и нажмите кнопку **визуализировать**.

### <a name="tips-for-generating-the-best-clustering-model"></a>Советы по созданию лучшей модели кластеризации  

Известно, что процесс *заполнения* , используемый во время кластеризации, может значительно повлиять на модель. Заполнение означает начальное размещение точек в потенциальных средневзвешенных.
 
Например, если набор данных содержит много выбросов, а выбросы выбираются для заполнения кластеров, другие точки данных не будут хорошо соответствовать этому кластеру, а кластер может быть одноэлементным. То есть у него может быть только одна точка.  
  
Эту проблему можно избежать двумя способами:  
  
-   Измените число средневзвешенных и попробуйте использовать несколько начальных значений.  
  
-   Создайте несколько моделей, изменив метрику или просматривая больше.  
  
Как правило, при использовании моделей кластеризации возможна ситуация, когда любая заданная конфигурация приведет к созданию локально оптимизированного набора кластеров. Иными словами, набор кластеров, возвращаемых моделью, подходит только к текущим точкам данных и не является обобщенным для других данных. Если используется другая первоначальная конфигурация, метод K-средних может найти другую, возможно, старшую конфигурацию. 
