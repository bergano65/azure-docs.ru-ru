---
title: Статья об известных проблемах и ошибках, связанных с использованием Azure Database Migration Service | Документация Майкрософт
description: Узнайте, как устранять распространенные известные проблемы и ошибки, связанные с использованием Azure Database Migration Service.
services: database-migration
author: HJToland3
ms.author: jtoland
manager: craigg
ms.reviewer: craigg
ms.service: dms
ms.workload: data-services
ms.custom: mvc
ms.topic: article
ms.date: 06/18/2019
ms.openlocfilehash: a72a0e26c2af34942faaa6a7e62feef86082e196
ms.sourcegitcommit: 18061d0ea18ce2c2ac10652685323c6728fe8d5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69034821"
---
# <a name="troubleshoot-common-azure-database-migration-service-issues-and-errors"></a>Устранение распространенных проблем и ошибок Azure Database Migration Service

В этой статье описаны некоторые распространенные проблемы и ошибки, которые Azure Database Migration Service могут быть доступны пользователям. В этой статье также содержатся сведения о том, как устранить эти проблемы и ошибки.

## <a name="migration-activity-in-queued-state"></a>Действие миграции в состоянии очереди

При создании новых действий в проекте Azure Database Migration Service действия остаются в состоянии очереди.

| Причина:         | Разрешение |
| ------------- | ------------- |
| Эта проблема возникает, когда экземпляр Azure Database Migration Service достиг максимальной емкости для текущих задач, выполняемых параллельно. Любое новое действие помещается в очередь до тех пор, пока емкость не станет доступной. | Проверка того, что экземпляр службы миграции данных выполняет действия между проектами. Можно продолжить создание новых действий, которые автоматически добавляются в очередь для выполнения. Как только все существующие действия выполняются, начинается следующее действие в очереди, и состояние меняется на состояние выполняется автоматически. Вам не нужно предпринимать никаких дополнительных действий, чтобы начать миграцию действия в очереди.<br><br> |

## <a name="max-number-of-databases-selected-for-migration"></a>Максимальное число баз данных, выбранных для миграции

Следующая ошибка возникает при создании действия для проекта миграции базы данных для перемещения в базу данных SQL Azure или управляемый экземпляр базы данных SQL Azure:

* **Ошибка**: Ошибка проверки параметров миграции "," errorDetail ":" для миграции выбрано больше максимального числа объектов "4", чем "Databases".

| Причина:         | Разрешение |
| ------------- | ------------- |
| Эта ошибка отображается, если для одного действия миграции выбрано более четырех баз данных. В настоящее время каждое действие миграции ограничено четырьмя базами данных. | Выберите четыре или меньше баз данных на одно действие миграции. Если необходимо выполнить миграцию более четырех баз данных параллельно, выполните инициализацию другого экземпляра Azure Database Migration Service. В настоящее время каждая подписка поддерживает до двух экземпляров Azure Database Migration Service.<br><br> |

## <a name="errors-for-mysql-migration-to-azure-mysql-with-recovery-failures"></a>Ошибки миграции MySQL в Azure MySQL с ошибками восстановления

При миграции из MySQL в базу данных Azure для MySQL с помощью Azure Database Migration Service действие миграции завершается со следующей ошибкой:

* **Ошибка**: Ошибка миграции базы данных-задача "TaskID" приостановлена из-за [n] успешных сбоев восстановления.

| Причина:         | Разрешение |
| ------------- | ------------- |
| Эта ошибка может возникать, когда у пользователя, выполняющего миграцию, отсутствует роль ReplicationAdmin и (или) привилегии клиента репликации, РЕПЛИКи репликации и SUPER (более ранних версий, чем MySQL 5.6.6).<br><br><br><br><br><br><br><br><br><br><br><br><br> | Убедитесь, что [необходимые привилегии](https://docs.microsoft.com/azure/dms/tutorial-mysql-azure-mysql-online#prerequisites) для учетной записи пользователя правильно настроены в экземпляре базы данных Azure для MySQL. Например, можно выполнить следующие действия, чтобы создать пользователя с именем "мигратеусер" с необходимыми привилегиями:<br>1. Создание пользователя мигратеусер @ "%", ИДЕНТИФИЦИРУЕМого "Secret"; <br>2. Предоставьте всем привилегиям на db_name. * значение "мигратеусер" @ "%", идентифицируемое по "Secret"; Повторите этот шаг, чтобы предоставить доступ к нескольким базам данных. <br>3. Предоставьте ведомую репликацию на *.* в "мигратеусер" @ "%", идентифицируемое по "Secret";<br>4. Предоставьте клиент репликации на *.* в "мигратеусер" @ "%", идентифицируемое по "Secret";<br>5. Права на запись; |

## <a name="error-when-attempting-to-stop-azure-database-migration-service"></a>Ошибка при попытке завершения Azure Database Migration Service

При остановке экземпляра Azure Database Migration Service появляется следующее сообщение об ошибке:

* **Ошибка**: Не удалось отключить службу. Error (Ошибка): {'error':{'code':'InvalidRequest','message':'One or more activities are currently running' (Сейчас выполняется одно или более действий). Чтобы завершить работу службы, дождитесь завершения действий или завершите их вручную и повторите попытку. "}}

| Причина:         | Разрешение |
| ------------- | ------------- |
| Эта ошибка отображается, когда экземпляр службы, который вы пытаетесь отключить, содержит действия, которые все еще выполняются или присутствуют в проектах миграции. <br><br><br><br><br><br> | Убедитесь, что в экземпляре отсутствуют действия, выполняемые Azure Database Migration Service попытке остановки. Вы также можете удалить действия или проекты перед попыткой остановки службы. Следующие шаги иллюстрируют удаление проектов для очистки экземпляра службы миграции путем удаления всех выполняющихся задач:<br>1. Install-Module -Name AzureRM.DataMigration <br>2. Login-AzureRmAccount <br>3. SELECT-AzureRmSubscription-SubscriptionName "\<подимя >" <br> 4. Remove-азурермдатамигратионпрожект- \<Name имя_проекта >- \<ResourceGroupName rgName >- \<ServiceName ServiceName >-делетеруннингтаск |

## <a name="error-when-attempting-to-start-azure-database-migration-service"></a>Ошибка при попытке запуска Azure Database Migration Service

При запуске экземпляра Azure Database Migration Service появляется следующее сообщение об ошибке:

* **Ошибка**: Не удается запустить службу. Ошибка: {' errorDetail ': ' не удалось запустить службу. обратитесь в службу поддержки Майкрософт '}

| Причина:         | Разрешение |
| ------------- | ------------- |
| Эта ошибка отображается при неудачном завершении предыдущего экземпляра. Эта ошибка возникает редко, и группа разработчиков осведомлена о ней. <br> | Удалите экземпляр службы, который не удается запустить, а затем подготавливает новый, чтобы заменить его. |

## <a name="error-restoring-database-while-migrating-sql-to-azure-sql-db-managed-instance"></a>Ошибка при восстановлении базы данных при переносе SQL в управляемый экземпляр базы данных SQL Azure

При выполнении оперативной миграции с SQL Server на управляемый экземпляр базы данных SQL Azure прямую миграцию завершается со следующей ошибкой:

* **Ошибка**: Сбой операции восстановления с идентификатором операции "не выполнено". Код "AuthorizationFailed", сообщение "клиент" clientId "с идентификатором объекта" objectId "не имеет авторизации для выполнения действия" Microsoft. SQL/Locations/Манажеддатабасерестореазуреасинкоператион/Read "over Scope"/Subscriptions/ subscriptionId '. '.

| Причина:         | Разрешение    |
| ------------- | ------------- |
| Эта ошибка означает, что субъект приложения, используемый для оперативной миграции с SQL Server на управляемый экземпляр базы данных SQL Azure, не имеет разрешения на участие в подписке. Некоторые вызовы API с Управляемый экземпляр в настоящее время должны иметь это разрешение в подписке для операции восстановления. <br><br><br><br><br><br><br><br><br><br><br><br><br><br> | `-ObjectId` Используйте командлет `Get-AzureADServicePrincipal` PowerShell с параметром, доступным в сообщении об ошибке, чтобы вывести отображаемое имя используемого идентификатора приложения.<br><br> Проверьте разрешения для этого приложения и убедитесь, что у него есть [роль участника](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#contributor) на уровне подписки. <br><br> Группа инженеров Azure Database Migration Service работает над тем, чтобы ограничить необходимый доступ из текущей роли участия в подписке. Если у вас есть бизнес-требование, которое не позволяет использовать роль Contribute, обратитесь в службу поддержки Azure за дополнительной справкой. |

## <a name="error-when-deleting-nic-associated-with-azure-database-migration-service"></a>Ошибка при удалении сетевого адаптера, связанного с Azure Database Migration Service

При попытке удалить сетевую карту, связанную с Azure Database Migration Service, попытка удаления завершится сбоем со следующей ошибкой:

* **Ошибка**: Не удается удалить сетевую карту, связанную с Azure Database Migration Service, из-за службы DMS, использующей сетевой адаптер

| Причина:         | Разрешение    |
| ------------- | ------------- |
| Эта проблема возникает, когда экземпляр Azure Database Migration Service по-прежнему может присутствовать и использовать сетевую карту. <br><br><br><br><br><br><br><br> | Чтобы удалить эту сетевую карту, удалите экземпляр службы DMS, который автоматически удаляет сетевую карту, используемую службой.<br><br> **Важно!** Убедитесь, что удаляемый экземпляр Azure Database Migration Service не имеет выполняющихся действий.<br><br> После удаления всех проектов и действий, связанных с экземпляром Azure Database Migration Service, можно удалить экземпляр службы. Сетевая карта, используемая экземпляром службы, автоматически очищается в процессе удаления службы. |

## <a name="connection-error-when-using-expressroute"></a>Ошибка подключения при использовании ExpressRoute

При попытке подключения к источнику с помощью ExpressRoute в мастере проектов Azure Database Migration Service происходит сбой после длительного времени ожидания.

| Причина:         | Разрешение    |
| ------------- | ------------- |
| При использовании [ExpressRoute](https://azure.microsoft.com/services/expressroute/)Azure Database Migration Service [требуется](https://docs.microsoft.com/azure/dms/tutorial-sql-server-azure-sql-online) подготовка трех конечных точек службы в подсети виртуальной сети, связанной со службой:<br> --Конечная точка служебной шины<br> --Конечная точка хранилища<br> --Целевая конечная точка базы данных (например, конечная точка SQL, Cosmos DBная конечная точка)<br><br><br><br><br> | [Включите](https://docs.microsoft.com/azure/dms/tutorial-sql-server-azure-sql-online) необходимые конечные точки службы для подключения ExpressRoute между источником и Azure Database Migration Service. <br><br><br><br><br><br><br><br> |

## <a name="lock-wait-timeout-error-when-migrating-a-mysql-database-to-azure-db-for-mysql"></a>Ошибка времени ожидания блокировки при переносе базы данных MySQL в Azure DB для MySQL

При переносе базы данных MySQL в экземпляр базы данных Azure для MySQL с помощью Azure Database Migration Service происходит сбой миграции со следующей ошибкой ожидания блокировки:

* **Ошибка**: Ошибка миграции базы данных-не удалось загрузить файл-не удалось запустить процесс загрузки для файла "n" Реткоде: SQL_ERROR SqlState: HY000 NativeError: 1205 сообщение: [MySQL] [драйвер ODBC] [в MySQL] превышено время ожидания блокировки. Попробуйте перезапустить транзакцию

| Причина:         | Разрешение    |
| ------------- | ------------- |
| Эта ошибка возникает, когда происходит сбой миграции из-за времени ожидания блокировки во время миграции. | Попробуйте увеличить значение параметра сервера **"innodb_lock_wait_timeout"** . Наибольшее допустимое значение — 1073741824. |

## <a name="error-connecting-to-source-sql-server-when-using-dynamic-port-or-named-instance"></a>Ошибка при подключении к исходному SQL Server при использовании динамического порта или именованного экземпляра

При попытке подключения Azure Database Migration Service к источнику SQL Server, который выполняется на именованном или динамическом порте, происходит сбой подключения со следующей ошибкой:

* **Ошибка**:-1-сбой подключения SQL. При подключении к SQL Server произошла ошибка, связанная с сетью или с определенным экземпляром. Сервер не найден или недоступен. Убедитесь, что имя экземпляра указано правильно и что SQL Server настроено для разрешения удаленных подключений. (поставщик: Сетевые интерфейсы SQL, ошибка: 26-ошибка при поиске указанного сервера или экземпляра)

| Причина:         | Разрешение    |
| ------------- | ------------- |
| Эта проблема возникает, когда экземпляр SQL Server источника, который Azure Database Migration Service пытается подключиться к серверу, имеет динамический порт или использует именованный экземпляр. Служба обозреватель SQL Server прослушивает UDP-порт 1434 для входящих подключений к именованному экземпляру или при использовании динамического порта. Динамический порт может измениться каждый раз, SQL Server перезапуска службы. Вы можете проверить динамический порт, назначенный экземпляру, с помощью конфигурации сети в диспетчер конфигурации SQL Server.<br><br><br> |Убедитесь, что Azure Database Migration Service может подключаться к исходной службе обозреватель SQL Server через UDP-порт 1434 и экземпляр SQL Server через динамически назначаемый TCP-порт. |

## <a name="additional-known-issues"></a>Дополнительные известные проблемы

* [Известные проблемы и ограничения миграции при оперативной миграции в базу данных SQL Azure](https://docs.microsoft.com/azure/dms/known-issues-azure-sql-online)
* [Известные проблемы и ограничения миграции при оперативной миграции в базу данных Azure для MySQL](https://docs.microsoft.com/azure/dms/known-issues-azure-mysql-online)
* [Известные проблемы и ограничения миграции при оперативной миграции в базу данных Azure для PostgreSQL](https://docs.microsoft.com/azure/dms/known-issues-azure-postgresql-online)

## <a name="next-steps"></a>Следующие шаги

* Просмотрите статью [Azure Database Migration Service PowerShell](https://docs.microsoft.com/powershell/module/azurerm.datamigration/?view=azurermps-6.13.0#data_migration).
* Ознакомьтесь со статьей [Настройка параметров сервера в базе данных Azure для MySQL с помощью портал Azure](https://docs.microsoft.com/azure/mysql/howto-server-parameters).
* Ознакомьтесь со статьей [Обзор предварительных требований для использования Azure Database Migration Service](https://docs.microsoft.com/azure/dms/pre-reqs).
* См. [вопросы и ответы об использовании Azure Database Migration Service](https://docs.microsoft.com/azure/dms/faq).
