---
title: Использование поставщика ресурсов службы хранилища Azure для доступа к ресурсам управления
description: Поставщик ресурсов службы хранилища Azure — это служба, которая предоставляет доступ к ресурсам управления для службы хранилища Azure. Поставщик ресурсов службы хранилища Azure можно использовать для создания, обновления, управления и удаления ресурсов, таких как учетные записи хранения, частные конечные точки и ключи доступа к учетным записям.
services: storage
author: tamram
ms.service: storage
ms.topic: conceptual
ms.date: 12/12/2019
ms.author: tamram
ms.reviewer: ozgun
ms.subservice: common
ms.openlocfilehash: 634e1866a2c3e30e0750b9e6f4b2b3f93db2f8dc
ms.sourcegitcommit: 0e8a4671aa3f5a9a54231fea48bcfb432a1e528c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/24/2020
ms.locfileid: "87133118"
---
# <a name="use-the-azure-storage-resource-provider-to-access-management-resources"></a>Использование поставщика ресурсов службы хранилища Azure для доступа к ресурсам управления

Azure Resource Manager — это служба развертывания и управления для Azure. Поставщик ресурсов службы хранилища Azure — это служба, которая основана на Azure Resource Manager и предоставляет доступ к ресурсам управления для службы хранилища Azure. Поставщик ресурсов службы хранилища Azure можно использовать для создания, обновления, управления и удаления ресурсов, таких как учетные записи хранения, частные конечные точки и ключи доступа к учетным записям. Дополнительные сведения о Azure Resource Manager см. в разделе Общие сведения о [Azure Resource Manager](/azure/azure-resource-manager/resource-group-overview).

Поставщик ресурсов службы хранилища Azure можно использовать для выполнения таких действий, как создание или удаление учетной записи хранения или получение списка учетных записей хранения в подписке. Чтобы авторизовать запросы к поставщику ресурсов службы хранилища Azure, используйте Azure Active Directory (Azure AD). В этой статье описывается, как назначать разрешения для ресурсов управления, а также приведены примеры, демонстрирующие выполнение запросов к поставщику ресурсов службы хранилища Azure.

## <a name="management-resources-versus-data-resources"></a>Ресурсы управления и ресурсы данных

Корпорация Майкрософт предоставляет два интерфейса API для работы с ресурсами службы хранилища Azure. Эти API образуют базу для всех действий, которые можно выполнять с хранилищем Azure. REST API службы хранилища Azure позволяет работать с данными в учетной записи хранения, включая данные больших двоичных объектов, очередей, файлов и таблиц. Поставщик ресурсов службы хранилища Azure REST API позволяет работать с учетной записью хранения и связанными ресурсами.

Для запроса, считывающего или записывающего данные большого двоичного объекта, требуются разрешения, отличные от разрешений на запрос, выполняющий операцию управления. RBAC обеспечивает детальный контроль над разрешениями для обоих типов ресурсов. При назначении роли RBAC субъекту безопасности необходимо понимать, какие разрешения будут предоставлены субъекту. Подробные справочные сведения о действиях, связанных с каждой встроенной ролью RBAC, см. [в статье встроенные роли в Azure](../../role-based-access-control/built-in-roles.md).

Служба хранилища Azure поддерживает использование Azure AD для авторизации запросов к хранилищу BLOB-объектов и очередей. Сведения о ролях RBAC для операций с данными BLOB-объектов и очередей см. в разделе [авторизация доступа к BLOB-объектам и очередям с помощью Active Directory](storage-auth-aad.md).

## <a name="assign-management-permissions-with-role-based-access-control-rbac"></a>Назначение разрешений управления с помощью управления доступом на основе ролей (RBAC)

Каждая подписка Azure имеет связанную Azure Active Directory, которая управляет пользователями, группами и приложениями. Пользователь, группа или приложение также называются субъектом безопасности в контексте [платформы Microsoft Identity](/azure/active-directory/develop/). Можно предоставить доступ к ресурсам в подписке субъекту безопасности, определенному в Active Directory, с помощью управления доступом на основе ролей (RBAC).

При назначении роли RBAC субъекту безопасности также указывается область, в которой действуют разрешения, предоставленные этой ролью. Для операций управления можно назначить роль на уровне подписки, группы ресурсов или учетной записи хранения. Роль RBAC можно назначить субъекту безопасности с помощью [портал Azure](https://portal.azure.com/), [средств Azure CLI](../../cli-install-nodejs.md), [PowerShell](/powershell/azure/)или [поставщика ресурсов хранилища Azure REST API](/rest/api/storagerp).

Дополнительные сведения см. в статье [что такое управление доступом на основе ролей Azure (Azure RBAC)?](../../role-based-access-control/overview.md) и роли [администратора классической подписки, роли RBAC Azure и роли администратора Azure AD](../../role-based-access-control/rbac-and-directory-admin-roles.md).

### <a name="built-in-roles-for-management-operations"></a>Встроенные роли для операций управления

Azure предоставляет встроенные роли, предоставляющие разрешения на вызов операций управления. Служба хранилища Azure также предоставляет встроенные роли, специально предназначенные для использования с поставщиком ресурсов службы хранилища Azure.

Встроенные роли, предоставляющие разрешения на вызов операций управления хранилищем, включают в себя роли, описанные в следующей таблице.

|    Роль RBAC    |    Описание    |    Включает доступ к ключам учетной записи?    |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| **Владелец** | Может управлять всеми ресурсами хранилища и доступом к ресурсам.  | Да, предоставляет разрешения на просмотр и повторное создание ключей учетной записи хранения. |
| **Участник**  | Может управлять всеми ресурсами хранилища, но не может управлять назначением ресурсов. | Да, предоставляет разрешения на просмотр и повторное создание ключей учетной записи хранения. |
| **Читатель** | Может просматривать сведения об учетной записи хранения, но не может просматривать ключи учетной записи. | Нет. |
| **Участник учетной записи хранения** | Может управлять учетной записью хранения, получать сведения о группах ресурсов и ресурсах подписки, а также создавать развертывания групп ресурсов подписки и управлять ими. | Да, предоставляет разрешения на просмотр и повторное создание ключей учетной записи хранения. |
| **Администратор доступа пользователей** | Может управлять доступом к учетной записи хранения.   | Да, позволяет субъекту безопасности назначать любые разрешения самим и другим пользователям. |
| **Участник виртуальной машины** | Может управлять виртуальными машинами, но не учетной записью хранения, к которой они подключены.   | Да, предоставляет разрешения на просмотр и повторное создание ключей учетной записи хранения. |

Третий столбец в таблице указывает, поддерживает ли встроенная роль **действие Microsoft. Storage/storageAccounts/listkeys/**. Это действие предоставляет разрешения на чтение и повторное создание ключей учетной записи хранения. Разрешения на доступ к ресурсам управления службой хранилища Azure также не включают разрешения на доступ к данным. Однако если у пользователя есть доступ к ключам учетной записи, они смогут использовать ключи учетной записи для доступа к данным службы хранилища Azure через авторизацию с общим ключом.

### <a name="custom-roles-for-management-operations"></a>Пользовательские роли для операций управления

Azure также поддерживает определение пользовательских ролей Azure для доступа к ресурсам управления. Дополнительные сведения о пользовательских ролях см. в статье [пользовательские роли Azure](../../role-based-access-control/custom-roles.md).

## <a name="code-samples"></a>Примеры кода

Примеры кода, демонстрирующие авторизацию и вызов операций управления из библиотек управления хранилищем Azure, см. в следующих примерах.

- [.NET](https://github.com/Azure-Samples/storage-dotnet-resource-provider-getting-started)
- [Java](https://github.com/Azure-Samples/storage-java-manage-storage-accounts)
- [Node.js](https://github.com/Azure-Samples/storage-node-resource-provider-getting-started)
- [Python](https://github.com/Azure-Samples/storage-python-manage)

## <a name="azure-resource-manager-versus-classic-deployments"></a>Azure Resource Manager и классические развертывания

Модель развертывания с помощью Azure Resource Manager и классическая модель представляют собой два разных способа развертывания решений Azure и управления ими. Корпорация Майкрософт рекомендует использовать модель развертывания Azure Resource Manager при создании новой учетной записи хранения. Если это возможно, корпорация Майкрософт также рекомендует повторно создать существующие классические учетные записи хранения с моделью диспетчер ресурсов. Хотя вы можете создать учетную запись хранения с помощью классической модели развертывания, классическая модель является менее гибкой и в конечном итоге будет устаревшей.

Дополнительные сведения о моделях развертывания Azure см. в разделе [Диспетчер ресурсов и классическое развертывание](../../azure-resource-manager/management/deployment-models.md).

## <a name="next-steps"></a>Дальнейшие действия

- [Общие сведения об Azure Resource Manager](/azure/azure-resource-manager/resource-group-overview)
- [Что такое управление доступом на основе ролей в Azure (RBAC)?](../../role-based-access-control/overview.md)
- [Целевые показатели масштабируемости для поставщика ресурсов службы хранилища Azure](scalability-targets-resource-provider.md)
