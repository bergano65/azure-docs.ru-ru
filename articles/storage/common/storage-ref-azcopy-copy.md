---
title: azcopy Copy | Документация Майкрософт
description: В этой статье содержатся справочные сведения о команде azcopy Copy.
author: normesta
ms.service: storage
ms.topic: reference
ms.date: 07/24/2020
ms.author: normesta
ms.subservice: common
ms.reviewer: zezha-msft
ms.openlocfilehash: b9d5a9e071cc1b2ac81e8cacea8c974181fbb3b6
ms.sourcegitcommit: 656c0c38cf550327a9ee10cc936029378bc7b5a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2020
ms.locfileid: "89070400"
---
# <a name="azcopy-copy"></a>azcopy copy

Копирует исходные данные в целевое расположение.

## <a name="synopsis"></a>Краткий обзор

Копирует исходные данные в целевое расположение. Поддерживаются следующие направления.

  - локальный < — > большой двоичный объект Azure (проверка подлинности SAS или OAuth)
  - локальные < — > файлы Azure (проверка подлинности SAS общего доступа или каталога)
  - локальный < > Azure Data Lake Storage Gen 2 (аутентификация SAS, OAuth или проверка подлинности с общим ключом)
  - BLOB-объект Azure (SAS или public) — > большой двоичный объект Azure (проверка подлинности SAS или OAuth)
  - BLOB-объект Azure (SAS или public) — > файлы Azure (SAS)
  - Службы файлов Azure (SAS) — > файлы Azure (SAS)
  - Служба файлов Azure (SAS) — > большой двоичный объект Azure (SAS или OAuth Authentication)
  - Amazon Web Services (AWS) S3 (ключ доступа) — > блочный BLOB-объект Azure (проверка подлинности SAS или OAuth)

Дополнительные сведения см. в разделе "примеры" этой статьи.

## <a name="related-conceptual-articles"></a>Связанные концептуальные статьи

- [Начало работы с AzCopy](storage-use-azcopy-v10.md)
- [Перенос данных с помощью AzCopy и хранилища BLOB-объектов](storage-use-azcopy-blobs.md)
- [Перенос данных с помощью AzCopy и хранилища файлов](storage-use-azcopy-files.md)
- [Configure, optimize, and troubleshoot AzCopy](storage-use-azcopy-configure.md) (Настройка, оптимизация и устранение неполадок с AzCopy)

## <a name="advanced"></a>Продвинутый уровень

AzCopy автоматически определяет тип содержимого файлов при их передаче с локального диска. AzCopy определяет тип содержимого на основе расширения или содержимого файла (если расширение не указано).

Встроенная таблица подстановки является небольшой, но в UNIX она дополняется файлами локальной системы, `mime.types` если они доступны по одному или нескольким из следующих имен:

- /етк/миме.типес
- /etc/apache2/mime.types
- /етк/апаче/миме.типес

В Windows типы MIME извлекаются из реестра. Эта функция может быть отключена с помощью флага. Дополнительные сведения см. в разделе «флаг» этой статьи.

Если задать переменную среды с помощью командной строки, эта переменная будет доступна для чтения в журнале командной строки. Рассмотрите возможность очистки переменных, содержащих учетные данные из журнала командной строки. Чтобы переменные отображались в журнале, можно использовать сценарий, чтобы запросить у пользователя учетные данные и задать переменную среды.

```
azcopy copy [source] [destination] [flags]
```

## <a name="examples"></a>Примеры

Отправка одного файла с помощью проверки подлинности OAuth. Если вы еще не выполнили вход в AzCopy, выполните `azcopy login` команду перед выполнением следующей команды.

```azcopy
azcopy cp "/path/to/file.txt" "https://[account].blob.core.windows.net/[container]/[path/to/blob]"
```
То же, что и выше, но на этот раз можно также вычислить хэш MD5 содержимого файла и сохранить его как свойство Content-MD5 объекта BLOB:

```azcopy
azcopy cp "/path/to/file.txt" "https://[account].blob.core.windows.net/[container]/[path/to/blob]" --put-md5
```

Отправьте один файл с помощью маркера SAS:

```azcopy
azcopy cp "/path/to/file.txt" "https://[account].blob.core.windows.net/[container]/[path/to/blob]?[SAS]"
```

Отправка одного файла с помощью маркера SAS и конвейера (только блочные BLOB-объекты):
  
```azcopy
cat "/path/to/file.txt" | azcopy cp "https://[account].blob.core.windows.net/[container]/[path/to/blob]?[SAS]
```

Отправьте весь каталог с помощью маркера SAS:
  
```azcopy
azcopy cp "/path/to/dir" "https://[account].blob.core.windows.net/[container]/[path/to/directory]?[SAS]" --recursive
```

или

```azcopy
azcopy cp "/path/to/dir" "https://[account].blob.core.windows.net/[container]/[path/to/directory]?[SAS]" --recursive --put-md5
```

Отправьте набор файлов с помощью маркера SAS и подстановочных знаков (*):
 
```azcopy
azcopy cp "/path/*foo/*bar/*.pdf" "https://[account].blob.core.windows.net/[container]/[path/to/directory]?[SAS]"
```

Отправьте файлы и каталоги с помощью маркера SAS и подстановочных знаков (*):

```azcopy
azcopy cp "/path/*foo/*bar*" "https://[account].blob.core.windows.net/[container]/[path/to/directory]?[SAS]" --recursive
```

Скачайте один файл с помощью проверки подлинности OAuth. Если вы еще не выполнили вход в AzCopy, выполните `azcopy login` команду перед выполнением следующей команды.

```azcopy
azcopy cp "https://[account].blob.core.windows.net/[container]/[path/to/blob]" "/path/to/file.txt"
```

Скачайте один файл с помощью маркера SAS:

```azcopy
azcopy cp "https://[account].blob.core.windows.net/[container]/[path/to/blob]?[SAS]" "/path/to/file.txt"
```

Скачайте один файл с помощью маркера SAS, а затем направляете выходные данные в файл (только блочные BLOB-объекты):
 
```azcopy
azcopy cp "https://[account].blob.core.windows.net/[container]/[path/to/blob]?[SAS]" > "/path/to/file.txt"
``` 

Скачайте весь каталог с помощью маркера SAS:
 
```azcopy
azcopy cp "https://[account].blob.core.windows.net/[container]/[path/to/directory]?[SAS]" "/path/to/dir" --recursive
``` 

Примечание об использовании подстановочного знака (*) в URL-адресах:

Существует два поддерживаемых способа использования подстановочных знаков в URL-адресе. 

- Можно использовать один из них сразу после последней косой черты (/) URL-адреса. При использовании подстановочного знака все файлы в каталоге копируются непосредственно в место назначения, не помещая их в подкаталог. 

- Можно также использовать подстановочный знак в имени контейнера, если URL-адрес относится только к контейнеру, а не к большому двоичному объекту. Этот подход можно использовать для получения файлов из подмножества контейнеров. 

Скачайте содержимое каталога без копирования самого содержащего его каталога.
 
```azcopy
azcopy cp "https://[srcaccount].blob.core.windows.net/[container]/[path/to/folder]/*?[SAS]" "/path/to/dir"
```

Скачайте всю учетную запись хранения.

```azcopy
azcopy cp "https://[srcaccount].blob.core.windows.net/" "/path/to/dir" --recursive
```

Скачайте подмножество контейнеров в учетной записи хранения, используя символ-шаблон (*) в имени контейнера.

```azcopy
azcopy cp "https://[srcaccount].blob.core.windows.net/[container*name]" "/path/to/dir" --recursive
```

Скопируйте один большой двоичный объект в другой большой двоичный объект с помощью маркера SAS.

```azcopy
azcopy cp "https://[srcaccount].blob.core.windows.net/[container]/[path/to/blob]?[SAS]" "https://[destaccount].blob.core.windows.net/[container]/[path/to/blob]?[SAS]"
```

Скопируйте один большой двоичный объект в другой большой двоичный объект с помощью маркера SAS и токена проверки подлинности. Необходимо использовать маркер SAS в конце URL-адреса исходной учетной записи, но при входе в AzCopy с помощью команды в качестве целевой учетной записи не требуется такой токен `azcopy login` . 

```azcopy
azcopy cp "https://[srcaccount].blob.core.windows.net/[container]/[path/to/blob]?[SAS]" "https://[destaccount].blob.core.windows.net/[container]/[path/to/blob]"
```

Скопируйте один виртуальный каталог больших двоичных объектов в другой с помощью маркера SAS:

```azcopy
azcopy cp "https://[srcaccount].blob.core.windows.net/[container]/[path/to/directory]?[SAS]" "https://[destaccount].blob.core.windows.net/[container]/[path/to/directory]?[SAS]" --recursive=true
```

Скопируйте все контейнеры больших двоичных объектов, каталоги и большие двоичные объекты из учетной записи хранения в другую с помощью маркера SAS:

```azcopy
azcopy cp "https://[srcaccount].blob.core.windows.net?[SAS]" "https://[destaccount].blob.core.windows.net?[SAS]" --recursive
```

Копирование одного объекта в хранилище BLOB-объектов из Amazon Web Services (AWS) S3 с помощью ключа доступа и маркера SAS. Сначала задайте переменную среды `AWS_ACCESS_KEY_ID` и `AWS_SECRET_ACCESS_KEY` AWS S3 Source.
  
```azcopy
azcopy cp "https://s3.amazonaws.com/[bucket]/[object]" "https://[destaccount].blob.core.windows.net/[container]/[path/to/blob]?[SAS]"
```

Скопируйте весь каталог в хранилище BLOB-объектов из AWS S3 с помощью ключа доступа и маркера SAS. Сначала задайте переменную среды `AWS_ACCESS_KEY_ID` и `AWS_SECRET_ACCESS_KEY` AWS S3 Source.
 
```azcopy
azcopy cp "https://s3.amazonaws.com/[bucket]/[folder]" "https://[destaccount].blob.core.windows.net/[container]/[path/to/directory]?[SAS]" --recursive
```
    
  Дополнительные https://docs.aws.amazon.com/AmazonS3/latest/user-guide/using-folders.html сведения о заполнителье [Folder] см. в разделе.

Скопируйте все контейнеры в хранилище BLOB-объектов из Amazon Web Services (AWS) с помощью ключа доступа и маркера SAS. Сначала задайте переменную среды `AWS_ACCESS_KEY_ID` и `AWS_SECRET_ACCESS_KEY` AWS S3 Source.
 
```azcopy
azcopy cp "https://s3.amazonaws.com/" "https://[destaccount].blob.core.windows.net?[SAS]" --recursive
```

Скопируйте все контейнеры в хранилище BLOB-объектов из области Amazon Web Services (AWS) с помощью ключа доступа и маркера SAS. Сначала задайте переменную среды `AWS_ACCESS_KEY_ID` и `AWS_SECRET_ACCESS_KEY` AWS S3 Source.
 
```azcopy
- azcopy cp "https://s3-[region].amazonaws.com/" "https://[destaccount].blob.core.windows.net?[SAS]" --recursive
```

Скопируйте подмножество контейнеров, используя символ-шаблон (*) в имени контейнера. Как и в предыдущих примерах, вам потребуется ключ доступа и маркер SAS. Убедитесь, что задана переменная среды `AWS_ACCESS_KEY_ID` и `AWS_SECRET_ACCESS_KEY` для AWS S3 Source.

```azcopy
- azcopy cp "https://s3.amazonaws.com/[bucket*name]/" "https://[destaccount].blob.core.windows.net?[SAS]" --recursive
```

## <a name="options"></a>Варианты

**--BACKUP** Активирует Windows "Себаккуппривилеже для отправки" или "Сересторепривилеже для скачивания", чтобы разрешить AzCopy просматривать и читать все файлы независимо от разрешений файловой системы и восстанавливать все разрешения. Требует, чтобы учетная запись, в которой запущен AzCopy, уже имеет эти разрешения (например, имеет права администратора или является членом `Backup Operators` группы). Этот флаг активирует привилегии, которые у учетной записи уже есть.

**--BLOB-тип** строка определяет тип большого двоичного объекта в месте назначения. Используется для отправки больших двоичных объектов и при копировании между учетными записями (по умолчанию `Detect` ). Допустимые значения включают `Detect`, `BlockBlob`, `PageBlob`и `AppendBlob`. При копировании между учетными записями значение приводит к тому, что `Detect` AzCopy использует тип исходного большого двоичного объекта для определения типа целевого большого двоичного объекта. При отправке файла `Detect` определяет, является ли файл VHD или VHDX-файлом, основанным на расширении файла. Если файл является Ether VHD или VHDX-файлом, AzCopy обрабатывает файл как страничный BLOB-объект. (по умолчанию "Обнаружение")

**--Block-BLOB-** передача блочного большого двоичного объекта в хранилище Azure с помощью этого уровня BLOB-объектов. (по умолчанию "нет")

**--Block-Size-МБ** float используйте этот размер блока (указанный в MIB) при отправке в службу хранилища Azure и скачивании из службы хранилища Azure. Значение по умолчанию вычисляется автоматически на основе размера файла. Десятичные дроби разрешены (например: 0,25).

**--Cache-Control** строка задает заголовок Cache-Control. Возвращается при скачивании.

**--Check-length** Проверьте длину файла в месте назначения после перемещения. В случае несоответствия между источником и назначением перемещение помечается как Failed. (значение по умолчанию — `true` )

**--Check-Md5** определяет, насколько строго следует проверять хэши MD5 при скачивании. Доступно только при скачивании. Доступные параметры: `NoCheck` , `LogOnly` , `FailIfDifferent` , `FailIfDifferentOrMissing` . (по умолчанию `FailIfDifferent` ) (по умолчанию "Фаилифдифферент")

**--Content-Disposition** строка задает заголовок Content-Disposition. Возвращается при скачивании.

**--Content-Encoding** строка задайте заголовок Content-Encoding. Возвращается при скачивании.

**--Content — Строка языка** задайте заголовок Content-Language. Возвращается при скачивании.

**--Content-Type** строка указывает тип содержимого файла. Подразумевает отсутствие предположения-типа MIME. Возвращается при скачивании.

**--распаковка** Автоматически распаковать файлы при скачивании, если их кодировка содержимого указывает на то, что они сжаты. Поддерживаемые значения кодировки содержимого: `gzip` и `deflate` . Расширения файлов `.gz` / `.gzip` или `.zz` не требуются, но будут удалены при их наличии.

**--Exclude-атрибуты** строка (только для Windows) исключает файлы, атрибуты которых соответствуют списку атрибутов. Например: A; #D0 Cерверный

**--Exclude-BLOB-тип** строка при необходимости указывает тип большого двоичного объекта ( `BlockBlob` /  `PageBlob` /  `AppendBlob` ), который следует исключить при копировании больших двоичных объектов из контейнера или учетной записи. Использование этого флага неприменимо для копирования данных из службы, не являющейся службой Azure, в службу. Несколько больших двоичных объектов должны отделяться друг от друга `;` . 

**--Строка исключения-путь** исключает эти пути при копировании. Этот параметр не поддерживает подстановочные знаки (*). Проверяет относительный префикс пути (например: `myFolder;myFolder/subDirName/file.pdf` ). При использовании в сочетании с обходом учетной записи пути не включают имя контейнера.

**--исключение-шаблон** строка исключит эти файлы при копировании. Этот параметр поддерживает подстановочные знаки (*).

**--следовать за символических ссылок**  При отправке из локальной файловой системы используйте символические ссылки.

**--Force — if — только для чтения** При перезаписи существующего файла в Windows или службе файлов Azure Принудительная перезапись для работы, даже если у существующего файла установлен атрибут "только для чтения".

Строка **--from-to** дополнительно задает комбинацию назначения источника. Например: `LocalBlob` , `BlobLocal` , `LocalBlobFS` .

**--**  Справка по копированию.

**--include-After** строка включает только те файлы, которые были изменены в или после заданных даты и времени. Значение должно быть в формате ISO8601. Если часовой пояс не указан, предполагается, что значение находится в локальном часовом поясе компьютера, на котором выполняется AzCopy. Например, `2020-08-19T15:04:00Z` для времени в формате UTC или `2020-08-19` для полуночи (00:00) в местном часовом поясе. Как и в AzCopy 10,5, этот флаг применяется только к файлам, а не к папкам, поэтому свойства папки не копируются при использовании этого флага с `--preserve-smb-info` или `--preserve-smb-permissions` .

**--include-Attributes** String (только для Windows) включает файлы, атрибуты которых соответствуют списку атрибутов. Например: A; #D0 Cерверный

Строка **--include-Path** включает в себя только эти пути при копировании. Этот параметр не поддерживает подстановочные знаки (*). Проверяет относительный префикс пути (например: `myFolder;myFolder/subDirName/file.pdf` ).

**--include-шаблон** строки включает в себя только эти файлы при копировании. Этот параметр поддерживает подстановочные знаки (*). Отдельные файлы с помощью `;` .

**— строка списка версий** указывает файл, в котором каждый идентификатор версии указан в отдельной строке. Убедитесь, что источник должен указывать на один большой двоичный объект, и все идентификаторы версий, указанные в файле с помощью этого флага, должны принадлежать только к исходному BLOB-объекту. AzCopy загрузит указанные версии в указанную папку назначения. Дополнительные сведения см. [в статье скачивание предыдущих версий большого двоичного объекта](storage-use-azcopy-blobs.md#download-previous-versions-of-a-blob).

**--строка на уровне журнала** определяет уровень детализации журнала для файла журнала, доступные уровни: сведения (все запросы и ответы), предупреждение (медленные ответы), ошибка (только неудачные запросы) и нет (нет выходных журналов). (по умолчанию `INFO` ). 

**—** Отправка строки метаданных в службу хранилища Azure со следующими парами "ключ — значение" в качестве метаданных.

**--No-Guess-MIME-тип**  Предотвращает обнаружение типа содержимого в AzCopy на основе расширения или содержимого файла.

**--Перезаписать** строку перезаписать конфликтующие файлы и большие двоичные объекты в назначении, если этот флаг установлен в значение true. (по умолчанию `true` ) Возможные значения: `true` , `false` , `prompt` и `ifSourceNewer` . Для назначений, поддерживающих папки, свойства на уровне папки будут перезаписаны. Этот флаг имеет значение `true` или, если запрос был получен в результате положительного ответа. (по умолчанию "true")

**--Page-BLOB —** страничный BLOB-объект, отправляемый в службу хранилища Azure с помощью этого уровня больших двоичных объектов. (по умолчанию `None` ). (по умолчанию "нет")

**--Сохранение-Последнее изменение времени**  Доступно только в том случае, если целевым объектом является файловая система.

**--Preserve — владелец**    Оказывает воздействие только на загрузку и только при `--preserve-smb-permissions` использовании. Если задано значение true (значение по умолчанию), владелец файла и группа сохраняются в файлах для загрузки. Если задано значение false, `--preserve-smb-permissions` все равно сохранит списки ACL, но владелец и группа будут основываться на пользователе, на котором выполняется AzCopy (значение по умолчанию — true).

**--Preserve-SMB-info**   Значение false по умолчанию. Сохраняет сведения о свойстве SMB (время последней записи, время создания, биты атрибутов) между ресурсами, поддерживающими SMB (файлы Windows и Azure). Будут переданы только биты атрибутов, поддерживаемые службой "файлы Azure". все остальные будут пропущены. Этот флаг применяется к файлам и папкам, если только не задан фильтр только для файлов (например, шаблон include). Данные, передаваемые для папок, совпадают с файлами, за исключением времени последней записи, которое никогда не сохранялось для папок.

**--Preserve-SMB-разрешения**   Значение false по умолчанию. Сохраняет списки ACL SMB между ресурсами, которые поддерживаются (файлы Windows и Azure). Для загрузки также потребуется `--backup` флаг для восстановления разрешений, когда новый владелец не будет пользователем, запускающим AzCopy. Этот флаг применяется к файлам и папкам, если только не задан фильтр только для файлов (например, `include-pattern` ).

**--Размещение-MD5**    Создайте хэш MD5 для каждого файла и сохраните хэш как свойство Content-MD5 целевого большого двоичного объекта или файла. (По умолчанию хэш не создается.) Доступно только при отправке.

**--recursive**    Рекурсивный просмотр вложенных каталогов при отправке из локальной файловой системы.

**--S2S-Detect-Source-Changed**   Определить, изменяется ли исходный файл или большой двоичный объект во время чтения. (Этот параметр применяется только к копиям между службами, так как соответствующая проверка постоянно включена для загрузки и загрузки.)

**--S2S-handle-недопустимо — строка метаданных** указывает, как обрабатываются недопустимые ключи метаданных. Доступные варианты: Ексклудеифинвалид, Фаилифинвалид, Ренамеифинвалид. (по умолчанию `ExcludeIfInvalid` ). (по умолчанию "Ексклудеифинвалид")

**--S2S-Preserve-уровень доступа**   Сохранение уровня доступа во время копирования службы в службу. Дополнительные сведения см. в статье [хранилище BLOB-объектов Azure: горячий, холодный и архивный уровни доступа](https://docs.microsoft.com/azure/storage/blobs/storage-blob-storage-tiers) , чтобы гарантировать, что Целевая учетная запись хранения поддерживает настройку уровня доступа. В случаях, когда установка уровня доступа не поддерживается, используйте s2sPreserveAccessTier = false, чтобы обойти копирование уровня доступа. (значение по умолчанию — true).  (по умолчанию true)

**--S2S-Preserve-свойства**   Сохранять полные свойства во время копирования службы в службу. Для AWS S3 и файлов Azure, не являющихся файлами в одном файле, операция List не возвращает полные свойства объектов и файлов. Чтобы сохранить полные свойства, AzCopy должен отправить один дополнительный запрос на объект или файл. (по умолчанию true)

## <a name="options-inherited-from-parent-commands"></a>Параметры, унаследованные от родительских команд

**--Cap-Мбит/с, с плавающей запятой**   Скорость передачи с прописными буквами в мегабит в секунду. Посекундная пропускная способность может немного отличаться от ограничения. Если этот параметр имеет значение 0 или пропущен, пропускная способность не ограничена.

**--выходной** формат строки выходных данных команды. Среди вариантов: Text, JSON. Значение по умолчанию — `text`. ("текст" по умолчанию)

**--Trusted-Microsoft-суффиксы** указывает дополнительные суффиксы домена, в которых могут отправляться Azure Active Directory токены входа.  Значение по умолчанию — `*.core.windows.net;*.core.chinacloudapi.cn;*.core.cloudapi.de;*.core.usgovcloudapi.net`. Все перечисленные здесь значения добавляются к значениям по умолчанию. В целях безопасности следует размещать только Microsoft Azureные домены. Несколько записей разделяются точкой с запятой.

## <a name="see-also"></a>См. также раздел

- [azcopy](storage-ref-azcopy.md)
