---
title: Выберите способ авторизации доступа к данным очереди в портал Azure
titleSuffix: Azure Storage
description: При доступе к данным очередей с помощью портал Azure портал выполняет запросы к службе хранилища Azure, как описано в этой статье. Эти запросы к службе хранилища Azure могут пройти проверку подлинности и авторизоваться с помощью учетной записи Azure AD или ключа доступа к учетной записи хранения.
services: storage
author: tamram
ms.service: storage
ms.topic: how-to
ms.date: 09/08/2020
ms.author: tamram
ms.reviewer: ozguns
ms.subservice: queues
ms.custom: contperfq1
ms.openlocfilehash: 2593f1b7ea4cfabe0243fe6f830d718896e68473
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91715519"
---
# <a name="choose-how-to-authorize-access-to-queue-data-in-the-azure-portal"></a>Выберите способ авторизации доступа к данным очереди в портал Azure

При доступе к данным очередей с помощью [портал Azure](https://portal.azure.com)портал выполняет запросы к службе хранилища Azure, как описано в этой статье. Запрос к службе хранилища Azure можно авторизовать с помощью учетной записи Azure AD или ключа доступа к учетной записи хранения. Портал указывает, какой метод используется, и позволяет переключаться между ними, если у вас есть соответствующие разрешения.  

## <a name="permissions-needed-to-access-queue-data"></a>Разрешения, необходимые для доступа к данным очереди

В зависимости от того, как вы хотите авторизовать доступ к данным очереди в портал Azure, вам потребуются определенные разрешения. В большинстве случаев эти разрешения предоставляются через Управление доступом на основе ролей Azure (Azure RBAC). Дополнительные сведения об Azure RBAC см. в статье [что такое управление доступом на основе ролей Azure (Azure RBAC)](../../role-based-access-control/overview.md).

### <a name="use-the-account-access-key"></a>Использование ключа доступа к учетной записи

Чтобы получить доступ к данным очереди с помощью ключа доступа к учетной записи, необходимо назначить роль Azure, которая включает действие Azure RBAC **(Microsoft. Storage/storageAccounts/listkeys/действие**). Эта роль Azure может быть встроенной или настраиваемой ролью. Встроенные роли, поддерживающие **Microsoft. Storage, storageAccounts/listkeys/Action** , включают:

- Роль [владельца](../../role-based-access-control/built-in-roles.md#owner) Azure Resource Manager
- Роль [участника](../../role-based-access-control/built-in-roles.md#contributor) Azure Resource Manager
- Роль [участника учетной записи хранения](../../role-based-access-control/built-in-roles.md#storage-account-contributor)

При попытке получить доступ к данным очереди в портал Azure портал сначала проверяет, была ли назначена роль с помощью **Microsoft. Storage/storageAccounts/listkeys/Action**. Если вы назначили роль с этим действием, портал использует ключ учетной записи для доступа к данным очереди. Если вы не назначили роль с этим действием, портал пытается получить доступ к данным с помощью учетной записи Azure AD.

> [!NOTE]
> Администратор службы роли администратора классической подписки и Co-Administrator включает в себя эквивалент роли [владельца](../../role-based-access-control/built-in-roles.md#owner) Azure Resource Manager. Роль **владелец** включает все действия, включая **Microsoft. Storage/storageAccounts/listkeys/Action**, поэтому пользователь с одной из этих административных ролей также может получить доступ к данным очереди с помощью ключа учетной записи. Дополнительные сведения см. в статье [Роли классического администратора подписки, роли Azure и роли администратора Azure AD](../../role-based-access-control/rbac-and-directory-admin-roles.md#classic-subscription-administrator-roles).

### <a name="use-your-azure-ad-account"></a>Использование учетной записи Azure AD

Чтобы получить доступ к данным очереди из портал Azure с помощью учетной записи Azure AD, для вас должны быть справедливы обе следующие инструкции:

- Вы назначили роль [читателя](../../role-based-access-control/built-in-roles.md#reader) Azure Resource Manager как минимум на уровне учетной записи хранения или выше. Роль **читателя** предоставляет наиболее ограниченные разрешения, но также приемлема другая роль Azure Resource Manager, которая предоставляет доступ к ресурсам управления учетной записью хранения.
- Вам была назначена встроенная или пользовательская роль, предоставляющая доступ к данным очереди.

Назначение роли **читателя** или другое назначение роли Azure Resource Manager необходимо для того, чтобы пользователь мог просматривать ресурсы управления учетной записью хранения и переходить по ним в портал Azure. Роли Azure, предоставляющие доступ к данным очереди, не предоставляют доступ к ресурсам управления учетной записью хранения. Чтобы получить доступ к данным очереди на портале, пользователю требуются разрешения для навигации по ресурсам учетной записи хранения. Дополнительные сведения об этом требовании см. [в разделе Назначение роли читателя для доступа к порталу](../common/storage-auth-aad-rbac-portal.md#assign-the-reader-role-for-portal-access).

Встроенные роли, которые поддерживают доступ к данным очереди, включают в себя:

- [Участник данных очереди хранилища](../../role-based-access-control/built-in-roles.md#storage-queue-data-contributor): разрешения на чтение, запись и удаление для очередей.
- [Модуль чтения очереди хранилища](../../role-based-access-control/built-in-roles.md#storage-queue-data-reader): разрешения только на чтение для очередей.

Пользовательские роли могут поддерживать различные сочетания тех же разрешений, которые предоставляются встроенными ролями. Дополнительные сведения о создании пользовательских ролей Azure см. в статьях [пользовательские роли Azure](../../role-based-access-control/custom-roles.md) и [Определение ролей для ресурсов Azure](../../role-based-access-control/role-definitions.md).

Вывод списка очередей с ролью администратора классической подписки не поддерживается. Чтобы получить список очередей, пользователю должны быть назначены роль **читателя** Azure Resource Manager, роль **чтения данных очереди хранилища** или роль **участника данных очереди хранилища** .

> [!IMPORTANT]
> Предварительная версия Обозреватель службы хранилища в портал Azure не поддерживает использование учетных данных Azure AD для просмотра и изменения данных очереди. Обозреватель службы хранилища в портал Azure всегда использует ключи учетной записи для доступа к данным. Чтобы использовать Обозреватель службы хранилища в портал Azure, необходимо назначить роль, включающую **Microsoft. Storage/storageAccounts/listkeys/Action**.

## <a name="navigate-to-queues-in-the-azure-portal"></a>Перейдите к очередям в портал Azure

Чтобы просмотреть данные очереди на портале, перейдите к **обзору** учетной записи хранения и щелкните ссылки для **очередей**. Кроме того, можно переходить к разделу **Служба очередей** в меню.

:::image type="content" source="media/authorize-queue-access-portal/queue-access-portal.png" alt-text="Снимок экрана, показывающий, как переходить к данным очереди в портал Azure":::

## <a name="determine-the-current-authentication-method"></a>Определение текущего метода проверки подлинности

При переходе к очереди портал Azure указывает, используется ли в настоящее время ключ доступа к учетной записи или учетная запись Azure AD для проверки подлинности.

### <a name="authenticate-with-the-account-access-key"></a>Проверка подлинности с помощью ключа доступа учетной записи

Если проверка подлинности выполняется с помощью ключа доступа к учетной записи, вы увидите **ключ доступа** , указанный в качестве метода проверки подлинности на портале:

:::image type="content" source="media/authorize-queue-access-portal/auth-method-access-key.png" alt-text="Снимок экрана, показывающий, как переходить к данным очереди в портал Azure":::

Чтобы переключиться на использование учетной записи Azure AD, щелкните ссылку, выделенную на изображении. При наличии соответствующих разрешений через назначенные вам роли Azure вы сможете продолжать работу. Однако если у вас нет нужных разрешений, появится сообщение об ошибке следующего вида:

:::image type="content" source="media/authorize-queue-access-portal/auth-error-azure-ad.png" alt-text="Снимок экрана, показывающий, как переходить к данным очереди в портал Azure":::

Обратите внимание, что в списке нет очередей, если у вашей учетной записи Azure AD нет разрешений на их просмотр. Щелкните ссылку **Переключение на ключ доступа** , чтобы снова использовать ключ доступа для проверки подлинности.

### <a name="authenticate-with-your-azure-ad-account"></a>Пройдите проверку подлинности с учетной записью Azure AD.

Если вы выполняете проверку подлинности с помощью учетной записи Azure AD, вы увидите на портале **учетную запись пользователя Azure AD** , указанную в качестве метода проверки подлинности:

:::image type="content" source="media/authorize-queue-access-portal/auth-method-azure-ad.png" alt-text="Снимок экрана, показывающий, как переходить к данным очереди в портал Azure":::

Чтобы переключиться на использование ключа доступа к учетной записи, щелкните ссылку, выделенную на изображении. Если у вас есть доступ к ключу учетной записи, вы сможете продолжать работу. Однако если у вас отсутствует доступ к ключу учетной записи, портал Azure отображает сообщение об ошибке.

Если у вас нет доступа к ключам учетной записи, очереди не отображаются на портале. Щелкните ссылку **Переключение на учетную запись пользователя Azure AD** , чтобы снова использовать учетную запись Azure AD для проверки подлинности.

## <a name="next-steps"></a>Дальнейшие шаги

- [Проверка подлинности доступа к BLOB-объектам и очередям Azure с помощью Azure Active Directory](../common/storage-auth-aad.md)
- [Используйте портал Azure, чтобы назначить роль Azure для доступа к данным BLOB-объектов и очередей.](../common/storage-auth-aad-rbac-portal.md)
- [Используйте Azure CLI, чтобы назначить роль Azure для доступа к данным BLOB-объектов и очередей.](../common/storage-auth-aad-rbac-cli.md)
- [Использование модуля Azure PowerShell для назначения роли Azure доступа к данным BLOB-объектов и очередей](../common/storage-auth-aad-rbac-powershell.md)
