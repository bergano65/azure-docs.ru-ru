---
title: Восстановление данных большого двоичного объекта из архивного уровня
description: Можно восстановить большие двоичные объекты из архивного хранилища, чтобы получить доступ к данным.
services: storage
author: mhopkins-msft
ms.author: mhopkins
ms.date: 04/08/2020
ms.service: storage
ms.subservice: blobs
ms.topic: conceptual
ms.reviewer: hux
ms.openlocfilehash: cbaa1d34eb8fe44b1c367d8fa3f84687fe7568e2
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "84433176"
---
# <a name="rehydrate-blob-data-from-the-archive-tier"></a>Восстановление данных большого двоичного объекта из архивного уровня

Хотя большой двоичный объект находится на архивном уровне хранилища, он считается автономным и не может быть считан или изменен. Метаданные больших двоичных объектов остаются доступными, что позволяет получить список больших двоичных объектов и их свойств. Чтение и изменение данных большого двоичного объекта доступно только на подключенных уровнях, таких как горячий или холодный уровни. Существуют два варианта получения и доступа к данным, хранящимся на архивном уровне доступа.

1. [Восстановление архивного большого двоичного объекта на подключенном уровне](#rehydrate-an-archived-blob-to-an-online-tier). Восстановите архивный большой двоичный объект на горячем или холодном уровне, изменив его уровень с помощью операции [установки уровня большого двоичного объекта](https://docs.microsoft.com/rest/api/storageservices/set-blob-tier).
2. [Копирование архивного большого двоичного объекта на подключенный уровень](#copy-an-archived-blob-to-an-online-tier). Создайте новую копию архивного большого двоичного объекта, используя операцию [копирования больших двоичных объектов](https://docs.microsoft.com/rest/api/storageservices/copy-blob). Укажите другое имя большого двоичного объекта и целевой уровень — горячий или холодный.

 Дополнительные сведения об уровнях см. в статье [Хранилище BLOB-объектов Azure: горячий, холодный и архивный уровни](storage-blob-storage-tiers.md).

## <a name="rehydrate-an-archived-blob-to-an-online-tier"></a>Восстановление архивного большого двоичного объекта на подключенный уровень

[!INCLUDE [storage-blob-rehydration](../../../includes/storage-blob-rehydrate-include.md)]

## <a name="copy-an-archived-blob-to-an-online-tier"></a>Копирование архивного большого двоичного объекта на подключенный уровень

Если вы не хотите восстановить архивный большой двоичный объект, вы можете выполнить операцию [копирования большого двоичного объекта](https://docs.microsoft.com/rest/api/storageservices/copy-blob). Исходный большой двоичный объект останется без изменений в архиве, а на подключенном горячем или холодном уровне будет создан для работы новый большой двоичный объект. В операции копирования большого двоичного объекта можно также задать для необязательного свойства *x-ms-rehydrate-priority* значение Standard или High, чтобы указать приоритет для создания копии большого двоичного объекта.

Копирование большого двоичного объекта из архива может занять несколько часов в зависимости от выбранного приоритета восстановления. Операция **копирования большого двоичного объекта** считывает большой двоичный объект архива, чтобы создать новый большой двоичный объект на выбранном целевом уровне. Новый большой двоичный объект может быть видимым при перечислении больших двоичных объектов, но его данные не будут доступны до тех пор, пока чтение из исходного архивного объекта не будет завершено и все данные не будут записаны в новый подключенный большой двоичный объект. Новый большой двоичный объект является независимой копией, и любое изменение или удаление данных этого объекта не влияет на исходный архивный большой двоичный объект.

> [!IMPORTANT]
> Не удаляйте исходный большой двоичный объект, пока копирование в место назначения не будет успешно завершено. Если удалить исходный большой двоичный объект, то копирование в конечный большой двоичный объект может не завершиться и он окажется пустым. Чтобы определить состояние операции копирования, можно проверить свойство *x-ms-copy-status*.

Архивные большие двоичные объекты могут быть скопированы только на целевые подключенные уровни в пределах одной учетной записи хранения. Копирование архивного большого двоичного объекта в другой архивный большой двоичный объект не поддерживается. В следующей таблице указаны возможности операции CopyBlob.

|                                           | **Источник на горячем уровне**   | **Источник на холодном уровне** | **Источник на архивном уровне**    |
| ----------------------------------------- | --------------------- | -------------------- | ------------------- |
| **Цель на горячем уровне**                  | Поддерживается             | Поддерживается            | Поддерживается в одной учетной записи; ожидание восстановления.               |
| **Цель на холодном уровне**                 | Поддерживается             | Поддерживается            | Поддерживается в одной учетной записи; ожидание восстановления.               |
| **Цель на архивном уровне**              | Поддерживается             | Поддерживается            | Не поддерживается         |

## <a name="pricing-and-billing"></a>Цены и выставление счетов

Восстановление больших двоичных объектов из архива на горячий или холодный уровень оплачивается как операции чтения и получение данных. Использование высокого приоритета повысит затраты на операции и получение данных по сравнению с стандартным приоритетом. Восстановление с высоким приоритетом отображается как отдельный пункт в счете. Если запрос с высоким приоритетом на возвращение архивного большого двоичного объекта размером в несколько гигабайт занимает более 5 часов, плата за получение с высоким приоритетом взиматься не будет. Однако стандартные тарифы по-прежнему будут действовать, так как восстановление имеет повышенный приоритет по сравнению с другими запросами.

Копирование больших двоичных объектов из архива на горячий или холодный уровень оплачивается как операции чтения и получение данных. Для создания новой копии большого двоичного объекта оплачивается операция записи. При копировании подключенного большого двоичного объекта не взимается плата за раннее удаление, так как исходный большой двоичный объект остается без изменений на уровне архива. Если выбрано получение с высоким приоритетом, взимается соответствующая плата.

Большие двоичные объекты на архивном уровне должны храниться не менее 180 дней. Удаление или восстановление архивных больших двоичных объектов до истечения 180 дней приведет к оплате раннего удаления.

> [!NOTE]
> Дополнительные сведения о ценах на восстановление блочных BLOB-объектов и данных см. на странице с [ценами на службу хранилища Azure](https://azure.microsoft.com/pricing/details/storage/blobs/). Дополнительные сведения о ценах на исходящую передачу данных см. на странице с [ценами на передачу данных](https://azure.microsoft.com/pricing/details/data-transfers/).

## <a name="quickstart-scenarios"></a>Сценарии быстрого запуска

### <a name="rehydrate-an-archive-blob-to-an-online-tier"></a>Восстановление архивного большого двоичного объекта на подключенный уровень
# <a name="portal"></a>[Портал](#tab/azure-portal)
1. Войдите на [портал Azure](https://portal.azure.com).

1. На портале Azure найдите и выберите **Все ресурсы**.

1. Затем выберите учетную запись хранения.

1. Выберите свой контейнер и большой двоичный объект.

1. В разделе **Свойства BLOB-объекта** выберите **Изменение уровня**.

1. Выберите **горячий** или **холодный** уровень доступа. 

1. Выберите приоритет восстановления **Стандартный** или **Высокий**.

1. Щелкните **Сохранить** внизу.

![Изменение уровня учетной записи хранилища](media/storage-tiers/blob-access-tier.png)
![Проверка состояния восстановления](media/storage-tiers/rehydrate-status.png)

# <a name="powershell"></a>[PowerShell](#tab/azure-powershell)
Приведенный ниже сценарий PowerShell можно использовать для изменения уровня архивного большого двоичного объекта. Переменная `$rgName` должна быть инициализирована с помощью имени группы ресурсов. Переменная `$accountName` должна быть инициализирована с помощью имени учетной записи хранения. Переменная `$containerName` должна быть инициализирована с помощью имени контейнера. Переменная `$blobName` должна быть инициализирована с помощью имени большого двоичного объекта. 
```powershell
#Initialize the following with your resource group, storage account, container, and blob names
$rgName = ""
$accountName = ""
$containerName = ""
$blobName = ""

#Select the storage account and get the context
$storageAccount =Get-AzStorageAccount -ResourceGroupName $rgName -Name $accountName
$ctx = $storageAccount.Context

#Select the blob from a container
$blobs = Get-AzStorageBlob -Container $containerName -Blob $blobName -Context $ctx

#Change the blob’s access tier to Hot using Standard priority rehydrate
$blob.ICloudBlob.SetStandardBlobTier("Hot", "Standard")
```
---

### <a name="copy-an-archive-blob-to-a-new-blob-with-an-online-tier"></a>Копирование архивного большого двоичного объекта в новый большой двоичный объект на подключенном уровне
Следующий сценарий PowerShell можно использовать для копирования архивного большого двоичного объекта в новый большой двоичный объект в той же учетной записи хранения. Переменная `$rgName` должна быть инициализирована с помощью имени группы ресурсов. Переменная `$accountName` должна быть инициализирована с помощью имени учетной записи хранения. Переменные `$srcContainerName` и `$destContainerName` должны быть инициализированы с помощью имен контейнеров. Переменные `$srcBlobName` и `$destBlobName` должны быть инициализированы с помощью имен больших двоичных объектов. 
```powershell
#Initialize the following with your resource group, storage account, container, and blob names
$rgName = ""
$accountName = ""
$srcContainerName = ""
$destContainerName = ""
$srcBlobName = ""
$destBlobName = ""

#Select the storage account and get the context
$storageAccount =Get-AzStorageAccount -ResourceGroupName $rgName -Name $accountName
$ctx = $storageAccount.Context

#Copy source blob to a new destination blob with access tier hot using standard rehydrate priority
Start-AzStorageBlobCopy -SrcContainer $srcContainerName -SrcBlob $srcBlobName -DestContainer $destContainerName -DestBlob $destBlobName -StandardBlobTier Hot -RehydratePriority Standard -Context $ctx
```

## <a name="next-steps"></a>Next Steps

* [Узнайте больше об уровнях хранилища BLOB-объектов](storage-blob-storage-tiers.md).
* [Цены на горячий, холодный и архивный уровни в учетных записях хранилища BLOB-объектов и учетных записях GPv2 по регионам](https://azure.microsoft.com/pricing/details/storage/)
* [Управление жизненным циклом хранилища BLOB-объектов Azure (предварительная версия)](storage-lifecycle-management-concepts.md)
* [Проверка сведений о ценах на передачу данных](https://azure.microsoft.com/pricing/details/data-transfers/)
