---
title: Размещение статических веб-сайтов в службе хранилища Azure
description: Размещение статических веб-сайтов в службе хранилища Azure предоставляет экономичное, масштабируемое решение для размещения современных веб-приложений.
services: storage
author: tamram
ms.service: storage
ms.topic: article
ms.date: 02/25/2019
ms.author: tamram
ms.subservice: blobs
ms.openlocfilehash: a72182091721dd6a1104cb8e3495aee1a3b25eb8
ms.sourcegitcommit: 70550d278cda4355adffe9c66d920919448b0c34
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2019
ms.locfileid: "58439397"
---
# <a name="static-website-hosting-in-azure-storage"></a>Размещение статических веб-сайтов в службе хранилища Azure
Учетные записи хранения GPv2 Azure позволяют передавать статическое содержимое (HTML, CSS, JavaScript и файлы изображений) непосредственно из контейнера хранилища с именем *$web*. Преимущества размещения в службе хранилища Azure заключаются в использовании бессерверной архитектуры, в том числе [Функций Azure](/azure/azure-functions/functions-overview) и других служб PaaS.

В отличие от статических веб-сайтов динамические сайты, которые зависят от серверного кода, лучше всего размещать с помощью [службы приложений Azure](/azure/app-service/overview).

## <a name="how-does-it-work"></a>Как это работает?
При включении статического размещения на веб-сайте в вашей учетной записи хранения вы выбираете имя файла по умолчанию и при необходимости указываете путь к настраиваемой странице ошибки 404. После включения этой функции создается контейнер с именем *$web*, если он еще не существует.

Файлы в контейнере *$web* обладают следующими свойствами:

- обслуживаются посредством анонимных запросов;
- доступны только через операции чтения объекта;
- Учитывает регистр.
- из общедоступной сети доступны по следующему шаблону:
    - `https://<ACCOUNT_NAME>.<ZONE_NAME>.web.core.windows.net/<FILE_NAME>`
- из конечной точки хранилища BLOB-объектов доступны по следующему шаблону:
    - `https://<ACCOUNT_NAME>.blob.core.windows.net/$web/<FILE_NAME>`

Для передачи файлов на сервер используйте конечную точку хранилища BLOB-объектов. Например, файл отправленный в это расположение:

```bash
https://contoso.blob.core.windows.net/$web/image.png
```

доступен в браузере по следующему расположению:

```bash
https://contoso.z4.web.core.windows.net/image.png
```

Установленное имя файла по умолчанию используется в корневом каталоге и всех его подкаталогах в случаях, когда имя файла не указано. Если сервер возвращает ошибку 404 и вы не указали путь к документу с сообщением об ошибке, то пользователю возвращается страница 404 по умолчанию.

> [!NOTE]
> Уровень общего доступа по умолчанию для файлов — закрытые. Так как файлы обслуживаются через запросы анонимный доступ, этот параметр учитывается. Общего доступа ко всем файлам, а учитываются разрешения RBAC.

## <a name="cdn-and-ssl-support"></a>Поддержка CDN и SSL

Сведения о том, как сделать доступными статические файлы веб-сайта по протоколу HTTPS, см. в статье [Использование Azure CDN для доступа к BLOB-объектам с пользовательскими доменами по протоколу HTTPS](storage-https-custom-domain-cdn.md). В ходе этого процесса необходимо *указать для CDN конечную точку веб-содержимого*, а не конечную точку BLOB-объекта. Может потребоваться подождать несколько минут, прежде чем содержимое отобразится, так как конфигурация CDN выполняется не мгновенно.

При обновлении вашей статического веб-сайта, не забудьте очистить кэшированное содержимое на пограничных серверах CDN, очистка конечной точки CDN. Дополнительные сведения см. в статье [Очистка конечной точки сети CDN Azure](../../cdn/cdn-purge-endpoint.md).

## <a name="custom-domain-names"></a>Имена пользовательских доменов

Вы можете [настроить личное имя домена для учетной записи службы хранилища Azure](storage-custom-domain-name.md) для предоставления вашего статического веб-сайта через личный домен. Подробные сведения о размещении вашего домена в Azure см. в статье [Размещение домена в Azure DNS](../../dns/dns-delegate-domain-azure-dns.md).

## <a name="pricing"></a>Цены
Размещение статических веб-сайтов осуществляется бесплатно. Дополнительные сведения о ценах на хранилище BLOB-объектов Azure см. на [странице цен](https://azure.microsoft.com/pricing/details/storage/blobs/).

## <a name="quickstart"></a>Быстрый запуск

### <a name="azure-portal"></a>Портал Azure
Сначала зайдите на портал Azure по адресу https://portal.azure.com и выполните следующие действия в вашей учетной записи хранения GPv2:

1. Щелкните **Параметры**
2. Щелкните **Статический веб-сайт**
3. Введите *Имя документа по умолчанию*. (Обычно используется *index.html)*
4. При необходимости введите *путь к документу ошибки* к пользовательской странице ошибки 404. (Обычно используется *404.html)*

![](media/storage-blob-static-website/storage-blob-static-website-portal-config.PNG)

Затем загрузите ресурсы в контейнер *$web* через портал Azure или воспользуйтесь [обозревателем службы хранилища Azure](https://azure.microsoft.com/features/storage-explorer/) для загрузки целого каталога. Убедитесь, что включили файл, соответствующий *имени документа по умолчанию*, который вы ввели при включении функции.

И, наконец, перейдите к конечной веб-точке, чтобы протестировать веб-сайт.

### <a name="azure-cli"></a>Инфраструктура CLI Azure
Установите расширение предварительной версии хранилища:

```azurecli-interactive
az extension add --name storage-preview
```
В случае наличия нескольких подписок установите в CLI подписку учетной записи хранения GPv2, которую вы хотите задействовать:

```azurecli-interactive
az account set --subscription <SUBSCRIPTION_ID>
```
Включите функцию. Не забудьте заменить все значения заполнителей, включая скобки, своими собственными значениями:

```azurecli-interactive
az storage blob service-properties update --account-name <ACCOUNT_NAME> --static-website --404-document <ERROR_DOCUMENT_NAME> --index-document <INDEX_DOCUMENT_NAME>
```
Запрос URL-адреса конечной веб-точки:

```azurecli-interactive
az storage account show -n <ACCOUNT_NAME> -g <RESOURCE_GROUP> --query "primaryEndpoints.web" --output tsv
```

Передайте объекты в контейнер *$web* из исходного каталога. Не забудьте соответствующим образом экранировать ссылку на контейнер *$web* в команде. Например, если вы используете Azure CLI из CloudShell на портале Azure, следует экранировать контейнер *$web* следующим образом:

```azurecli-interactive
az storage blob upload-batch -s <SOURCE_PATH> -d \$web --account-name <ACCOUNT_NAME>
```

## <a name="deployment"></a>Развертывание

Ниже приведены методы, доступные для развертывания содержимого в контейнер хранилища:

- [AzCopy](../common/storage-use-azcopy.md)
- [Обозреватель хранилища](https://azure.microsoft.com/features/storage-explorer/)
- [Azure Pipelines](https://azure.microsoft.com/services/devops/pipelines/)
- [Расширение Visual Studio Code](https://code.visualstudio.com/tutorials/static-website/getting-started)

В любом случае убедитесь, что копирование файлов происходит в контейнер *$web*.

## <a name="metrics"></a>Метрики

Чтобы включить метрики на страницах статического веб-сайта, щелкните **Параметры** > **Мониторинг** > **Метрики**.

Данные метрик создаются с помощью подключения к API для различных метрик. На портале отображаются только элементы API, используемые в течение заданного промежутка времени, чтобы сосредоточиться только на тех элементах, которые возвращают данные. Чтобы убедиться, что можно будет выбрать необходимый элемент API, сначала необходимо расширить временные рамки.

Нажмите кнопку интервала времени, выберите **За последние 24 часа** и нажмите кнопку **Применить**

![Диапазон времени метрик для статических веб-сайтов службы хранилища Azure](./media/storage-blob-static-website/storage-blob-static-website-metrics-time-range.png)

Затем выберите **BLOB-объекты** из раскрывающегося списка *Пространство имен*.

![Пространство имен метрик для статических веб-сайтов службы хранилища Azure](./media/storage-blob-static-website/storage-blob-static-website-metrics-namespace.png)

Затем выберите метрику **Исходящий трафик**.

![Выбор метрики для статических веб-сайтов службы хранилища Azure](./media/storage-blob-static-website/storage-blob-static-website-metrics-metric.png)

Выберите **Сумма** в селекторе *Агрегирование*.

![Агрегирование метрики для статических веб-сайтов службы хранилища Azure](./media/storage-blob-static-website/storage-blob-static-website-metrics-aggregation.png)

Затем щелкните кнопку **Добавить фильтр** и выберите **Имя API** в селекторе *Свойство*.

![Имя API метрики для статических веб-сайтов службы хранилища Azure](./media/storage-blob-static-website/storage-blob-static-website-metrics-api-name.png)

Наконец, установите флажок рядом с полем **GetWebContent** в селекторе *Значения* для заполнения отчета на основе метрик.

![Поле GetWebContent метрики для статических веб-сайтов службы хранилища Azure](./media/storage-blob-static-website/storage-blob-static-website-metrics-getwebcontent.png)

После завершения настройки статистика трафика файлов в контейнере *$web* будет отображаться в панели мониторинга метрик.

## <a name="faq"></a>Часто задаваемые вопросы

**Функция статических веб-сайтов доступна для всех типов учетных записей хранения?**  
Нет, размещение статических веб-сайтов доступно только для стандартных учетных записей хранения общего назначения версии 2 (GPv2).

**Поддерживаются ли в новой конечной веб-точке правила виртуальной сети и брандмауэра службы хранилища?**  
Да, для новой конечной веб-точки действуют правила виртуальной сети и брандмауэра, настроенные для учетной записи хранения.

**Конечная веб-точка чувствительна к регистру?**  
Да, конечная веб-точка чувствительна к регистру так же, как и конечная точка BLOB-объектов. 

## <a name="next-steps"></a>Дальнейшие действия
* [Использование Azure CDN для доступа к BLOB-объектам с помощью личных доменов по протоколу HTTPS](storage-https-custom-domain-cdn.md)
* [Настройка имени личного домена для конечной точки хранилища BLOB-объектов](storage-custom-domain-name.md)
* [Функции Azure](/azure/azure-functions/functions-overview)
* [службе приложений Azure](/azure/app-service/overview)
* [Создание первого бессерверного веб-приложения](https://docs.microsoft.com/azure/functions/tutorial-static-website-serverless-api-with-database)
* [Руководство по размещению домена в Azure DNS](../../dns/dns-delegate-domain-azure-dns.md)
