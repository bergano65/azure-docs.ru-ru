---
title: Устойчивые интерфейсы с внешними процессами с помощью Azure AD B2C | Документация Майкрософт
description: Методы создания устойчивых интерфейсов с внешними процессами
services: active-directory
ms.service: active-directory
ms.subservice: fundamentals
ms.workload: identity
ms.topic: how-to
author: gargi-sinha
ms.author: gasinh
manager: martinco
ms.reviewer: ''
ms.date: 11/30/2020
ms.custom: it-pro
ms.collection: M365-identity-device-management
ms.openlocfilehash: c96856c988cae891e64ddf460d61851102e4666c
ms.sourcegitcommit: a43a59e44c14d349d597c3d2fd2bc779989c71d7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/25/2020
ms.locfileid: "95919815"
---
# <a name="resilient-interfaces-with-external-processes"></a>Устойчивые интерфейсы с внешними процессами

В этой статье мы представили рекомендации по планированию и внедрению API-интерфейсов RESTFUL в пути взаимодействия пользователя и обеспечении более устойчивых к сбоям API приложений.

![На рисунке показаны интерфейсы с внешними компонентами процесса](media/resilient-external-processes/external-processes-architecture.png)

## <a name="ensure-correct-placement-of-the-apis"></a>Обеспечьте правильное размещение API-интерфейсов

Политики идентификации среды (инфраструктура процедур идентификации) позволяют вызывать внешнюю систему с помощью [технического профиля RESTFUL API](https://docs.microsoft.com/azure/active-directory-b2c/restful-technical-profile). Внешние системы не контролируются средой выполнения инфраструктура процедур идентификации и являются потенциальной точкой сбоя.

### <a name="how-to-manage-external-systems-using-apis"></a>Управление внешними системами с помощью API

- При вызове интерфейса для доступа к определенным данным проверьте, будут ли данные принимать решение о проверке подлинности. Оцените, являются ли данные важными для основных функций приложения. Например, электронная коммерция и дополнительная функциональность, например администрирование. Если сведения не нужны для проверки подлинности и требуются только для вторичных сценариев, рассмотрите возможность перемещения вызова в логику приложения.

- Если данные, необходимые для проверки подлинности, относительно статичны и невелики и не имеют других бизнес-причин, которые должны быть внешними из каталога, рассмотрите возможность его наличия в каталоге.

- По возможности удаляйте вызовы API из пути с предварительной проверкой подлинности. Если вы не можете, то необходимо установить для атак типа "отказ в обслуживании" (DoS) и распределенной атаки типа "отказ в обслуживании" (от атак DDoS) перед интерфейсами API. Злоумышленники могут загрузить страницу входа и попытаться перегрузить API с помощью DoS-атак и криппле ваше приложение. Например, при использовании CAPTCHA для входа может помочь последовательность регистрации.

- Используйте [соединители API встроенного потока пользователя для регистрации](https://docs.microsoft.com/azure/active-directory-b2c/api-connectors-overview) везде, где возможно, можно интегрировать с веб-API после входа с помощью поставщика удостоверений или перед созданием пользователя. Так как потоки пользователей уже протестированы, вполне вероятно, что вам не нужно выполнять функциональное тестирование, производительность или масштабирование на уровне потока. Вам по-прежнему нужно тестировать приложения для обеспечения функциональности, производительности и масштабирования.

- [Технические профили](https://docs.microsoft.com/azure/active-directory-b2c/restful-technical-profile) API RESTful в Azure AD не предоставляют никакого поведения кэширования. Вместо этого профиль API RESTFUL реализует логику повтора и время ожидания, встроенное в политику.

- Для API-интерфейсов, которым требуется запись данных, следует поставить задачу в очередь, чтобы выполнять такие задачи в фоновом рабочем процессе. Можно использовать такие службы, как [очереди Azure](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) . Это сделает API эффективно повышать производительность выполнения политики.  

## <a name="api-error-handling"></a>Обработка ошибок API

Поскольку интерфейсы API находятся за пределами Azure AD B2Cной системы, требуется правильная обработка ошибок в техническом профиле. Убедитесь, что конечный пользователь уведомлен соответствующим образом, и приложение может нормально работать с ошибками.

### <a name="how-to-gracefully-handle-api-errors"></a>Как правильно обработать ошибки API

- API может завершиться сбоем по разным причинам, сделать приложение устойчивым к таким сбоям. Если API не может выполнить запрос, [возвращается сообщение об ошибке HTTP 4xx](https://docs.microsoft.com/azure/active-directory-b2c/restful-technical-profile#returning-validation-error-message) . В политике Azure AD B2C постарайтесь правильно обрабатывать недоступность API и, возможно, привести к снижению производительности.

- [Аккуратно обрабатывайте временные ошибки](https://docs.microsoft.com/azure/active-directory-b2c/restful-technical-profile#error-handling). Профиль API RESTFUL позволяет настраивать сообщения об ошибках для различных автоматических [выключателей](https://docs.microsoft.com/azure/architecture/patterns/circuit-breaker).

- Заблаговременно проследите за использованием непрерывной интеграции и непрерывной поставки (CICD), поворачивайте учетные данные доступа API, такие как пароли и сертификаты, используемые [подсистемой технического профиля](https://docs.microsoft.com/azure/active-directory-b2c/restful-technical-profile).

## <a name="api-management---best-practices"></a>Управление API — рекомендации

При развертывании API-интерфейсов RESTFUL и настройке технического профиля RESTFUL, следуя рекомендациям, вы не сможете делать распространенные ошибки и ненужные вещи.

### <a name="how-to-manage-apis"></a>Управление API

- Управление API (APIM) позволяет публиковать, управлять и анализировать интерфейсы API. APIM также поддерживает проверку подлинности для обеспечения безопасного доступа к серверным службам и микрослужбам. Используйте шлюз API для масштабирования развертываний API, кэширования и балансировки нагрузки.

- Рекомендуется получить правильный маркер в начале пути взаимодействия пользователя вместо многократного вызова для каждого API и [обеспечения безопасности API APIM для Azure](https://docs.microsoft.com/azure/active-directory-b2c/secure-api-management?tabs=app-reg-ga).

## <a name="next-steps"></a>Дальнейшие действия

- [Ресурсы устойчивости для разработчиков Azure AD B2C](resilience-b2c.md)
  - [Устойчивая работа конечного пользователя](resilient-end-user-experience.md)
  - [Обеспечение устойчивости с помощью рекомендаций для разработчиков](resilience-b2c-developer-best-practices.md)
  - [Устойчивость с помощью мониторинга и аналитики](resilience-with-monitoring-alerting.md)
- [Устойчивость к сборке в инфраструктуре проверки подлинности](resilience-in-infrastructure.md)
- [Повышение устойчивости проверки подлинности и авторизации в приложениях](resilience-app-development-overview.md)
