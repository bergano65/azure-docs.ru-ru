---
title: Устойчивая работа конечного пользователя с помощью Azure AD B2C | Документация Майкрософт
description: Методы для обеспечения устойчивости в работе конечных пользователей с помощью Azure AD B2C
services: active-directory
ms.service: active-directory
ms.subservice: fundamentals
ms.workload: identity
ms.topic: how-to
author: gargi-sinha
ms.author: gasinh
manager: martinco
ms.reviewer: ''
ms.date: 11/30/2020
ms.custom: it-pro
ms.collection: M365-identity-device-management
ms.openlocfilehash: 4c695466fbd50435a85c63842ceb50ce80765760
ms.sourcegitcommit: 8c3a656f82aa6f9c2792a27b02bbaa634786f42d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/17/2020
ms.locfileid: "97630298"
---
# <a name="resilient-end-user-experience"></a>Устойчивая работа конечного пользователя

Процесс регистрации и входа в систему для конечных пользователей состоит из следующих элементов:

- Интерфейсы, с которыми взаимодействует пользователь, например CSS, HTML и JavaScript

- Пользовательские потоки и пользовательские политики, которые вы создаете, такие как регистрация, вход и изменение профиля.

- Поставщики удостоверений (поставщиков удостоверений) для вашего приложения, такие как имя пользователя или пароль локальной учетной записи, Outlook, Facebook и Google

![На изображении показаны компоненты взаимодействия с конечным пользователем](media/resilient-end-user-experiences/end-user-experience-architecture.png)

## <a name="choose-between-user-flow-and-custom-policy"></a>Выбор между пользовательским потоком и настраиваемой политикой  

Чтобы помочь вам настроить наиболее распространенные задачи идентификации, Azure AD B2C предоставляет встроенные настраиваемые [потоки пользователей](https://docs.microsoft.com/azure/active-directory-b2c/user-flow-overview). Вы также можете создавать собственные [пользовательские политики](https://docs.microsoft.com/azure/active-directory-b2c/custom-policy-overview), которые обеспечивают максимальную гибкость. Однако рекомендуется использовать пользовательские политики только для решения сложных задач.

### <a name="how-to-decide-between-user-flow-and-custom-policy"></a>Выбор между пользовательским потоком и настраиваемой политикой

Выберите встроенный поток пользователя, если бизнес-требования могут быть удовлетворены. Так как корпорация Майкрософт тщательно тестирует тестирование, вы можете уменьшить количество тестов, необходимых для проверки функциональных возможностей на уровне политики, производительности или масштабирования этих потоков пользователей идентификации. Вам по-прежнему нужно тестировать приложения для обеспечения функциональности, производительности и масштабирования.

Если вы [выберете пользовательские политики](https://docs.microsoft.com/azure/active-directory-b2c/custom-policy-get-started) из-за требований бизнеса, убедитесь, что вы выполняете тестирование на уровне политики для функциональной, производительности или масштабирования в дополнение к тестированию на уровне приложения.

См. статью, в которой [сравниваются потоки пользователей и пользовательские политики](https://docs.microsoft.com/azure/active-directory-b2c/custom-policy-overview#comparing-user-flows-and-custom-policies) , которые помогут вам принять решение.

## <a name="choose-multiple-idps"></a>Выбор нескольких поставщиков удостоверений

При использовании [внешнего поставщика удостоверений](https://docs.microsoft.com/azure/active-directory-b2c/technical-overview#external-identity-providers) , такого как Facebook, обязательно используйте резервный план на случай, если внешний поставщик станет недоступным.

### <a name="how-to-set-up-multiple-idps"></a>Как настроить несколько поставщиков удостоверений

В рамках процесса регистрации внешнего поставщика удостоверений включите проверенное утверждение удостоверения, например номер мобильного телефона или адрес электронной почты пользователя. Зафиксируйте проверенные утверждения в базовом экземпляре Azure AD B2C Directory. Если внешний поставщик недоступен, вернитесь к проверенному утверждению удостоверения и вернитесь к номеру телефона в качестве метода проверки подлинности. Другой вариант — отправить пользователю одноразовый секретный код, чтобы разрешить пользователю выполнять вход.

 Чтобы [создать альтернативные пути проверки подлинности](https://github.com/azure-ad-b2c/samples/tree/master/policies/idps-filter), выполните следующие действия.

 1. Настройте политику регистрации, чтобы разрешить регистрацию с помощью локальной учетной записи и внешнего поставщиков удостоверений.

 2. Настройте политику профиля, чтобы разрешить пользователям [связывать другие удостоверения с учетной записью](https://github.com/Azure-Samples/active-directory-b2c-advanced-policies/tree/master/account-linking) после входа.

 3. Уведомлять и разрешить пользователям [переключаться на альтернативные IDP](https://docs.microsoft.com/azure/active-directory-b2c/customize-ui-with-html#configure-dynamic-custom-page-content-uri) во время сбоя.

## <a name="availability-of-multi-factor-authentication"></a>Доступность многофакторной идентификации

При использовании [телефонной службы для многофакторной идентификации (MFA)](https://docs.microsoft.com/azure/active-directory-b2c/phone-authentication)следует рассмотреть альтернативный поставщик услуг. Локальный поставщик Telco или Телефон службы может столкнуться с нарушениями работы службы.

### <a name="how-to-choose-an-alternate-mfa"></a>Выбор альтернативного MFA  

Служба Azure AD B2C использует встроенный поставщик MFA на основе телефона для доставки одноразовых секретных кодов (OTP) на основе времени. Он представляет собой голосовое обращение и текстовое сообщение для предварительно зарегистрированного телефонного номера пользователя. Для различных сценариев доступны следующие альтернативные методы.

При использовании **пользовательских потоков** существует два метода обеспечения устойчивости:

- **Изменение конфигурации потока пользователя**. при обнаружении сбоев в доставке OTP на основе телефона измените метод доставки OTP с телефона на основе электронной почты и повторно разверните поток пользователя, не изменяя приложения.

![снимок экрана, показывающий регистрацию входа](media/resilient-end-user-experiences/create-sign-in.png)

- **Изменение приложений**. для каждой задачи идентификации, такой как регистрация и вход в систему, определите два набора пользовательских потоков. Настройте первый набор для использования OTP на основе телефона и второй для OTP на основе электронной почты. При обнаружении прерывания в доставке OTP на основе телефона измените и повторно разверните приложения, чтобы переключиться с первого набора пользователей на второй, не изменяя последовательность пользователей.  

При использовании **пользовательских политик** существует четыре метода обеспечения устойчивости. Ниже приведен порядок сложности, и необходимо повторно развернуть обновленные политики.

- **Включение выбора пользователем OTP или OTP на основе электронной почты**. Предоставьте пользователям доступ к обоим параметрам и предоставьте пользователям возможность самостоятельно выбрать один из вариантов. Нет необходимости вносить изменения в политики или приложения.

- **Динамически переключаться между одноразовым OTP и OTP на основе электронной почты**. Собирайте сведения по телефону и электронной почте при регистрации. Заранее определите настраиваемую политику, чтобы при нарушении работы на телефоне переключиться с телефона на доставку на основе электронной почты. Нет необходимости вносить изменения в политики или приложения.

- **Использование приложения для проверки подлинности**: обновление настраиваемой политики для использования [приложения для проверки подлинности](https://github.com/azure-ad-b2c/samples/tree/master/policies/custom-mfa-totp). Если в качестве обычного MFA используется одноразовый пароль или OTP на основе электронной почты, повторно разверните пользовательские политики, чтобы переключиться на использование приложения Authenticator.

>[!Note]
>Пользователям необходимо настроить интеграцию приложения для проверки подлинности во время регистрации.

- **Используйте контрольные вопросы**. Если ни один из вышеперечисленных методов не применим, реализуйте контрольные вопросы в качестве резервной копии. Настройте контрольные вопросы для пользователей во время адаптации или редактирования профиля и храните ответы в отдельной базе данных, отличной от каталога. Этот метод не соответствует требованию MFA, например телефону, но предлагает дополнительный «что вам известно».

## <a name="use-a-content-delivery-network"></a>Использование сети доставки содержимого

Сети доставки содержимого (CDN) лучше работают и дешевле, чем хранилища больших двоичных объектов для хранения настраиваемого пользовательского интерфейса потока пользователей. Содержимое веб-страницы быстрее доставляется из географически распределенной сети серверов высокой доступности.  

Периодически проверяйте доступность сети CDN и производительность распространения содержимого с помощью комплексного сценария и нагрузочного тестирования. Если вы планируете появление предстоящего всплесков в связи с повышением или праздничным трафиком, измените оценки для нагрузочного тестирования.
  
## <a name="next-steps"></a>Дальнейшие действия

- [Ресурсы устойчивости для разработчиков Azure AD B2C](resilience-b2c.md)
  
  - [Устойчивые интерфейсы с внешними процессами](resilient-external-processes.md)
  - [Обеспечение устойчивости с помощью рекомендаций для разработчиков](resilience-b2c-developer-best-practices.md)
  - [Устойчивость с помощью мониторинга и аналитики](resilience-with-monitoring-alerting.md)
- [Устойчивость к сборке в инфраструктуре проверки подлинности](resilience-in-infrastructure.md)
- [Повышение устойчивости проверки подлинности и авторизации в приложениях](resilience-app-development-overview.md)
