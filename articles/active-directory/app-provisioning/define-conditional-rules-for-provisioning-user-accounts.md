---
title: Подготовка приложений с использованием фильтров области | Документация Майкрософт
description: Узнайте, как использовать фильтры области, чтобы предотвратить подготовку объектов в приложениях, которые поддерживают автоматическую подготовку пользователей, если эти объекты не отвечают требованиям компании.
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-provisioning
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 09/11/2018
ms.author: mimart
ms.custom: H1Hack27Feb2017
ms.collection: M365-identity-device-management
ms.openlocfilehash: 2c667409f2abb9f1cf89ae3b34f08e0f9eec067e
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "79138541"
---
# <a name="attribute-based-application-provisioning-with-scoping-filters"></a>Подготовка приложений на основе атрибутов с использованием фильтров области
В этой статье объясняется, как с помощью фильтров области задать правила на основе атрибутов, которые управляют подготовкой пользователей для работы с приложением.

## <a name="scoping-filter-use-cases"></a>Варианты использования фильтра области

Фильтр области позволяет указать службе подготовки Azure Active Directory включить или исключить всех пользователей, для которых значение атрибута совпадает с конкретным значением. Например, при подготовке пользователей из Azure AD для приложения SaaS, используемого группой продаж, можно указать, что только пользователи, атрибут "Отдел" которых имеет значение "Продажи", подлежат подготовке.

Фильтры области можно использовать по-разному в зависимости от типа соединителя подготовки.

* **Исходящая подготовка из Azure AD в приложения SaaS**. Если Azure AD является исходной системой, то для определения пользователей, входящих в область подготовки, чаще всего используются [назначения пользователей и групп](../manage-apps/assign-user-or-group-access-portal.md). Эти назначения также используются для включения единого входа и обеспечивают единый метод для управления доступом и подготовкой. Фильтры области можно использовать наряду с назначениями или же вместо них, чтобы фильтровать пользователей на основе значений атрибутов.

    >[!TIP]
    > Для корпоративного приложения можно отключить подготовку на основе назначений, указав значение **Синхронизация всех пользователей и групп** в меню [Область](../app-provisioning/user-provisioning.md#how-do-i-set-up-automatic-provisioning-to-an-application) на странице параметров подготовки. С помощью этого параметра и фильтров области на основе атрибутов можно повысить производительность по сравнению с использованием назначений на основе групп.  

* **Входящая подготовка из приложений HCM в Azure AD и Active Directory**. Если исходной системой является [приложение HCM, например Workday](../saas-apps/workday-tutorial.md), то фильтры области являются основным средством для определения пользователей, которые должны быть подготовлены из приложения HCM в Active Directory или Azure Active Directory.

По умолчанию для соединителей подготовки Azure AD не настроены какие-либо фильтры области на основе атрибутов. 

## <a name="scoping-filter-construction"></a>Создание фильтра области

Фильтр области состоит из одного или нескольких *предложений*. Предложения оценивают атрибуты каждого пользователя и определяют, какие пользователи могут проходить через фильтр области. Например, вы можете создать предложение, требующее, чтобы атрибут пользователя "Штат" имел значение "Нью-Йорк". Тогда только пользователи из штата Нью-Йорк будут подготовлены для работы с приложением. 

Отдельное предложение определяет одно условие для одного значения атрибута. Если в одном фильтре области создается несколько предложений, они вычисляются вместе с применением логического оператора "И". Это означает, что все предложения должны иметь значение true, чтобы пользователь был подготовлен.

Наконец, для одного приложения можно создать несколько фильтров области. При наличии нескольких фильтров области они вычисляются вместе с применением логического оператора "ИЛИ". Это означает, что пользователь будет подготовлен, если для него все предложения в любом из настроенных фильтров области имеют значение true.

Фильтр области вычисляется отдельно для каждого пользователя или группы, обрабатываемой службой подготовки Azure AD.

Рассмотрим пример фильтра области.

![Фильтр области действия](./media/define-conditional-rules-for-provisioning-user-accounts/scoping-filter.PNG) 

Этот фильтр области определяет, что подготовке подлежат только пользователи, которые отвечают следующим условиям:

* они должны находиться в Нью-Йорке;
* они должны работать в отделе разработки;
* идентификатор сотрудника компании должен быть в диапазоне от 1 000 000 до 2 000 000;
* название должности не должно быть пустым или иметь значение NULL.

## <a name="create-scoping-filters"></a>Создание фильтров области
Фильтры области настраиваются как часть сопоставления атрибутов для каждого соединителя подготовки пользователей Azure AD. В приведенной ниже процедуре предполагается, что вы уже настроили автоматическую подготовку для [одного из поддерживаемых приложений](../saas-apps/tutorial-list.md) и добавляете для нее фильтр области.

### <a name="create-a-scoping-filter"></a>Создание фильтра области
1. На [портале Azure](https://portal.azure.com) перейдите в раздел **Azure Active Directory** > **Корпоративные приложения** > **Все приложения**.

2. Выберите приложение, для которого настроена автоматическая подготовка, например ServiceNow.

3. Перейдите на вкладку **Подготовка** .

4. В разделе **сопоставления** выберите сопоставление, для которого вам нужен фильтр области, например "Синхронизация пользователей Azure Active Directory с ServiceNow".

5. Выберите меню **Область исходного объекта**.

6. Выберите **Добавить фильтр области**.

7. Определите предложение, выбрав исходные параметры **Имя атрибута**, **Оператор** и **Значение атрибута** для сопоставления. Поддерживаются следующие операторы:

   а. **Равно**. Предложение возвращает значение true, если оцениваемый атрибут точно совпадает со значением входной строки (с учетом регистра).

   b. **не равно**. Предложение возвращает значение true, если оцениваемый атрибут не совпадает со значением входной строки (с учетом регистра).

   c. **IS TRUE**. Предложение возвращает значение true, если вычисленный атрибут содержит логическое значение true.

   d. **IS FALSE**. Предложение возвращает значение true, если вычисленный атрибут содержит логическое значение false.

   д) **имеет значение NULL**. Предложение возвращает значение true, если вычисленный атрибут имеет пустое значение.

   е) **IS NOT NULL**. Предложение возвращает значение true, если вычисленный атрибут имеет не пустое значение.

   ж. **REGEX MATCH**. Предложение возвращает значение true, если вычисленный атрибут соответствует шаблону регулярного выражения. Пример: шаблон ([1-9][0-9]) соответствует любому числу от 10 до 99.

   h. **NOT REGEX MATCH**. Предложение возвращает значение true, если вычисленный атрибут не соответствует шаблону регулярного выражения.
   
   i. **Greater_Than.** Предложение возвращает значение true, если вычисленный атрибут больше значения. Значение, указанное в фильтре области, должно быть целым числом, а атрибут пользователя должен быть целым числом [0, 1, 2,...]. 
   
   j. **Greater_Than_OR_EQUALS.** Предложение возвращает значение true, если вычисленный атрибут больше или равен значению. Значение, указанное в фильтре области, должно быть целым числом, а атрибут пользователя должен быть целым числом [0, 1, 2,...]. 
   
   k. **Том.** Предложение возвращает значение true, если вычисленный атрибут содержит строковое значение (с учетом регистра), как описано [здесь](https://docs.microsoft.com/dotnet/api/system.string.contains?view=netframework-4.8). 


>[!IMPORTANT] 
> - Фильтр IsMemberOf в настоящее время не поддерживается.
> - Значения EQUALs и NOT EQUALs не поддерживаются для атрибутов с несколькими значениями

9. При необходимости повторите шаги 7–8, чтобы добавить дополнительные предложения для ограничения области.

10. В поле **Название фильтра области** введите имя фильтра области.

11. Щелкните **ОК**.

12. Нажмите кнопку **ОК** еще раз на экране **Фильтры области**. При необходимости повторите шаги 6–11, чтобы добавить еще один фильтр области.

13. Нажмите кнопку **Сохранить** на странице **Сопоставление атрибутов**. 

>[!IMPORTANT] 
> Сохранение нового фильтра области активирует полную синхронизацию для приложения. Все пользователи в исходной системе будут повторно оценены с применением нового фильтра области. Если ранее пользователь приложения сначала соответствовал области для подготовки, а затем перестал соответствовать, его учетная запись в приложении будет отключена или отозвана. Чтобы переопределить это поведение по умолчанию, см. статью [пропуск удаления для учетных записей пользователей, которые выходят за пределы области действия](../app-provisioning/skip-out-of-scope-deletions.md).


## <a name="common-scoping-filters"></a>Общие фильтры области
| Целевой атрибут| Оператор | Значение | Описание|
|----|----|----|----|
|userPrincipalName|СООТВЕТСТВИЕ РЕГУЛЯРНОГО ВЫРАЖЕНИЯ|.\*@domain.com |Все пользователи с userPrincipal, которые имеют домен @domain.com , будут находиться в области подготовки|
|userPrincipalName|НЕ СОПОСТАВЛЯТЬ РЕГУЛЯРНОЕ ВЫРАЖЕНИЕ|.\*@domain.com|Все пользователи с userPrincipal, у которых есть @domain.com домен, будут вне области подготовки|
|department|EQUALS|sales|Все пользователи из отдела продаж находятся в области подготовки|
|воркерид|СООТВЕТСТВИЕ РЕГУЛЯРНОГО ВЫРАЖЕНИЯ|(1[0–9][0–9][0–9][0–9][0–9][0–9]).| Все сотрудники с Воркеридс между 1000000 и 2000000 находятся в области подготовки.|

## <a name="related-articles"></a>Похожие статьи
* [Автоматизация подготовки пользователей и ее отмены в приложениях SaaS](../app-provisioning/user-provisioning.md)
* [Настройка сопоставлений атрибутов для подготовки пользователей для приложений SaaS в Azure Active Directory](../app-provisioning/customize-application-attributes.md)
* [Написание выражений для сопоставления атрибутов](functions-for-customizing-application-data.md)
* [Уведомления о подготовке учетных записей](../app-provisioning/user-provisioning.md)
* [Использование SCIM для автоматической подготовки пользователей и групп Azure Active Directory для приложений](../app-provisioning/use-scim-to-provision-users-and-groups.md)
* [Список руководств по интеграции приложений SaaS](../saas-apps/tutorial-list.md)

