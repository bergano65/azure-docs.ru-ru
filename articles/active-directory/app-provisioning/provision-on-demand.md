---
title: Подготавливает пользователя по запросу с помощью Azure Active Directory
description: Принудительная синхронизация
services: active-directory
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-provisioning
ms.workload: identity
ms.topic: how-to
ms.date: 10/01/2020
ms.author: mimart
ms.reviewer: arvinh
ms.openlocfilehash: f7cbe9e9f81b3b71ee7da2feac2908c36f1777e5
ms.sourcegitcommit: d479ad7ae4b6c2c416049cb0e0221ce15470acf6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2020
ms.locfileid: "91629018"
---
# <a name="on-demand-provisioning"></a>Подготовка по требованию
Используйте подготовку по требованию для подготовки пользователя в приложении за считаные секунды. Помимо прочего, эту возможность можно использовать в следующих целях:

* Быстро устраняйте неполадки конфигурации.
* Проверьте выражения, которые были определены.
* Тестирование фильтров области.

## <a name="how-to-use-on-demand-provisioning"></a>Использование подготовки по требованию

1. Войдите на **портал Azure**.
1. Перейдите ко **всем службам**  >  **корпоративные приложения**.
1. Выберите приложение, а затем перейдите на страницу настройки подготовки.
1. Настройте подготовку, указав учетные данные администратора.
1. Выберите **подготавливать по запросу**.
1. Поиск пользователя по имени, фамилии, отображаемому имени, имени участника-пользователя или адресу электронной почты.
   > [!NOTE]
   > Для облачного приложения для подготовки кадров (Workday/SuccessFactors в AD или Azure AD) входное значение отличается. Для сценария Workday укажите "WID" пользователя в Workday. В случае SuccessFactors укажите "Персонидекстернал" пользователя в SuccessFactors. 
 
1. В нижней части страницы щелкните **готовить** .

:::image type="content" source="media/provision-on-demand/on-demand-provision-user.jpg" alt-text="Снимок экрана, показывающий пользовательский интерфейс портал Azure для подготовки пользователя по запросу.":::

## <a name="understand-the-provisioning-steps"></a>Общие сведения о действиях по подготовке

Процесс подготовки по требованию пытается отобразить действия, которые выполняет служба подготовки при подготовке пользователя. Для предоставления пользователю обычно требуется пять шагов. Один или несколько шагов, описанных в следующих разделах, будут показаны во время подготовки по требованию.

### <a name="step-1-test-connection"></a>Шаг 1. Проверка подключения

Служба подготовки пытается авторизовать доступ к целевому приложению, выполнив запрос "тестового пользователя". Служба подготовки принимает ответ, указывающий, что служба разрешила выполнение шагов по подготовке. Этот шаг отображается только в случае сбоя. Он не отображается во время подготовки по требованию при успешном выполнении этапа.

#### <a name="troubleshooting-tips"></a>Советы по устранению неполадок

* Убедитесь, что в целевое приложение предоставлены допустимые учетные данные, такие как маркер секрета и URL-адрес клиента. Требуемые учетные данные зависят от приложения. Подробные руководства по настройке см. в [списке учебников](../saas-apps/tutorial-list.md). 
* Убедитесь, что целевое приложение поддерживает фильтрацию по соответствующим атрибутам, определенным на панели **сопоставления атрибутов** . Чтобы узнать о поддерживаемых фильтрах, вам может потребоваться ознакомиться с документацией по API, предоставленной разработчиком приложения.
* Для системы для приложений с междоменным управлением идентификацией (SCIM) можно использовать такой инструмент, как POST. Такие средства помогают убедиться, что приложение отвечает на запросы авторизации так, как предполагается служба подготовки Azure Active Directory (Azure AD). Взгляните на [Пример запроса](./use-scim-to-provision-users-and-groups.md#request-3).

### <a name="step-2-import-user"></a>Шаг 2. Импорт пользователя

Затем служба подготовки получает пользователя из исходной системы. Атрибуты пользователя, извлекаемые службой, используются позднее для:

* Оцените, находится ли пользователь в области для подготовки.
* Проверьте целевую систему для существующего пользователя.
* Определите, какие атрибуты пользователя следует экспортировать в целевую систему.

#### <a name="view-details"></a>Подробнее


В разделе **Просмотр сведений** отображаются свойства пользователя, которые были импортированы из исходной системы (например, Azure AD).

#### <a name="troubleshooting-tips"></a>Советы по устранению неполадок

* Импорт пользователя может завершиться ошибкой, если соответствующий атрибут отсутствует в объекте пользователя в исходной системе. Чтобы устранить эту ошибку, попробуйте один из следующих подходов:

  * Обновите объект пользователя, указав значение для соответствующего атрибута.
  * Измените атрибут сопоставления в конфигурации подготовки.

* Если в импортированном списке отсутствует ожидаемый атрибут, убедитесь, что атрибут имеет значение в объекте пользователя в исходной системе. Сейчас служба подготовки не поддерживает подготовку атрибутов null.
* Убедитесь, что страница **сопоставление атрибутов** конфигурации подготовки содержит нужный атрибут.

### <a name="step-3-determine-if-user-is-in-scope"></a>Шаг 3. определение, входит ли пользователь в область

Затем служба подготовки определяет, находится ли пользователь в [области](./how-provisioning-works.md#scoping) для подготовки. Служба учитывает такие аспекты, как:

* Указывает, назначено ли приложение пользователю.
* Указывает, задана ли для области синхронизации значение " **назначено** " или " **синхронизировать все**".
* Фильтры области, определенные в конфигурации подготовки.  

#### <a name="view-details"></a>Подробнее

В разделе **Просмотр сведений** отображаются условия, которые были оценены. Вы можете увидеть одно или несколько из следующих свойств:

* **Активная в исходной системе** указывает, что для свойства пользователь `IsActive` в Azure AD задано значение **true** .
* **Назначено приложению** указывает, что пользователь назначен приложению в Azure AD.
* **Область синхронизация все** указывает, что параметр Scope разрешает всем пользователям и группам в клиенте.
* **Пользователь имеет обязательную роль** указывает, что пользователь имеет необходимые роли для подготовки в приложении. 
* **Фильтры области** также отображаются, если для приложения определены фильтры области. Фильтр отображается в следующем формате: {области заголовка фильтра} {атрибут фильтра области} {оператор фильтра области} {значение фильтра области}.

#### <a name="troubleshooting-tips"></a>Советы по устранению неполадок

* Убедитесь, что определена допустимая роль области. Например, старайтесь не использовать [оператор Greater_Than](./define-conditional-rules-for-provisioning-user-accounts.md#create-a-scoping-filter) с нецелочисленным значением.
* Если у пользователя нет необходимой роли, ознакомьтесь с [советами по подготовке пользователей, назначенных роли доступа по умолчанию](./application-provisioning-config-problem-no-users-provisioned.md#provisioning-users-assigned-to-the-default-access-role).

### <a name="step-4-match-user-between-source-and-target"></a>Шаг 4. Сопоставление пользователя между исходным и целевым элементами

На этом шаге служба пытается сопоставить пользователя, полученного на шаге импорта, с пользователем в целевой системе.

#### <a name="view-details"></a>Подробнее

На странице **Просмотр сведений** отображаются свойства пользователей, которые были сопоставлены в целевой системе. Свойства, отображаемые в области контекста, различаются следующим образом.

* Если в целевой системе не найдено ни одного пользователя, свойства не будут отображаться.
* Если в целевой системе имеется один пользователь, вы увидите свойства соответствующего пользователя из целевой системы.
* Если найдено несколько пользователей, вы увидите свойства обоих соответствующих пользователей.
* Если несколько соответствующих атрибутов являются частью сопоставлений атрибутов, каждый соответствующий атрибут вычисляется последовательно, и отображаются соответствующие пользователи для этого атрибута.

#### <a name="troubleshooting-tips"></a>Советы по устранению неполадок

* Служба подготовки не может сопоставить пользователя в исходной системе с пользователем в целевом объекте. Устраните эту проблему, убедившись, что соответствующий атрибут уникален.
* Убедитесь, что целевое приложение поддерживает фильтрацию по атрибуту, который определен как атрибут сопоставления.  

### <a name="step-5-perform-action"></a>Шаг 5. выполнение действия

Наконец, служба подготовки выполняет действие, например создание, обновление, удаление или пропуск пользователя.

Ниже приведен пример того, что может появиться после успешной подготовки пользователя по требованию.

:::image type="content" source="media/provision-on-demand/success-on-demand-provision.jpg" alt-text="Снимок экрана, показывающий пользовательский интерфейс портал Azure для подготовки пользователя по запросу.":::

#### <a name="view-details"></a>Подробнее

В разделе **Просмотр сведений** отображаются атрибуты, которые были изменены в целевом приложении. Этот экран представляет окончательный результат действия службы подготовки и экспортированных атрибутов. Если этот шаг завершается неудачей, отображаемые атрибуты представляют атрибуты, которые служба подготовки попыталась изменить.

#### <a name="troubleshooting-tips"></a>Советы по устранению неполадок

* Сбои при экспорте изменений могут сильно различаться. Ознакомьтесь с [документацией по подготовке журналов](../reports-monitoring/concept-provisioning-logs.md#error-codes) для распространенных сбоев.

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

* **Нужно ли отключить подготовку для использования подготовки по требованию?** Для приложений, использующих длительный токен носителя или имя пользователя и пароль для авторизации, никаких дополнительных действий не требуется. Приложения, использующие OAuth для авторизации, в настоящее время требуют остановки задания подготовки перед использованием подготовки по требованию. В эту категорию входят такие приложения, как G Suite, Box, Рабочая область на Facebook и временной резерв. Работа выполняется для поддержки подготовки по требованию для всех приложений без необходимости отмены подготовки заданий.

* **Сколько времени занимает подготовка по требованию?** Подготовка по требованию обычно занимает менее 30 секунд.

## <a name="known-limitations"></a>Известные ограничения

В настоящее время существует несколько известных ограничений на подготовку по требованию. Разместите свои [предложения и отзывы](https://aka.ms/appprovisioningfeaturerequest) , чтобы мы могли лучше определить, какие улучшения следует сделать дальше.

> [!NOTE]
> Следующие ограничения относятся к возможности подготовки по требованию. Сведения о том, поддерживает ли приложение группы, удаления или другие возможности, см. в руководстве по этому приложению.

* Приложение Amazon Web Services (AWS) не поддерживает подготовку по требованию. 
* Подготовка групп и ролей по требованию не поддерживается.
* Подготовка по требованию поддерживает отключение пользователей, которые не были назначены в приложении. Однако он не поддерживает отключение или удаление пользователей, которые были отключены или удалены из Azure AD. Эти пользователи не будут отображаться при поиске пользователя.

## <a name="next-steps"></a>Дальнейшие действия

* [Устранение неполадок при подготовке](./application-provisioning-config-problem.md)