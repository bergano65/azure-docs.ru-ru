---
title: Сообщение об ошибке появится на странице приложения после входа в систему | Документация Майкрософт
description: Как устранить проблемы с входом в систему Azure AD, когда приложение возвращает сообщение об ошибке.
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.assetid: ''
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 07/11/2017
ms.author: mimart
ms.reviewer: asteen
ms.collection: M365-identity-device-management
ms.openlocfilehash: 9b8d20b31e96973a492355f0515d0532deea0ac9
ms.sourcegitcommit: b07964632879a077b10f988aa33fa3907cbaaf0e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/13/2020
ms.locfileid: "77185489"
---
# <a name="an-app-page-shows-an-error-message-after-the-user-signs-in"></a>Страница приложения отображает сообщение об ошибке после входа пользователя

В этом сценарии Azure Active Directory (Azure AD) подписывает пользователя в. Но приложение отображает сообщение об ошибке и не дает пользователю завершить последовательность входа. Проблема заключается в том, что приложение не приняло ответ, выданный Azure AD.

Существует несколько возможных причин, по которым приложение не приняло ответ от Azure AD. Если сообщение об ошибке не указывает, что отсутствует в ответе, попробуйте выполнить следующие действия.

-   Если приложение является коллекцией Azure AD, убедитесь, что выполнены действия, описанные в разделе [Отладка единого входа на основе SAML в приложения в Azure AD](https://azure.microsoft.com/documentation/articles/active-directory-saml-debugging).

-   Используйте такой инструмент, как [Fiddler](https://www.telerik.com/fiddler) , для записи запроса SAML, ответа и токена.

-   Отправьте ответ SAML поставщику приложения и спросите, что нет.

## <a name="attributes-are-missing-from-the-saml-response"></a>В ответе SAML отсутствуют атрибуты

Чтобы добавить атрибут в конфигурацию Azure AD, которая будет отправлена в ответе Azure AD, выполните следующие действия.

1. Откройте [**портал Azure**](https://portal.azure.com/) и войдите в систему как глобальный администратор или Соадминистратор.

2. В верхней части области навигации слева выберите **все службы** , чтобы открыть расширение Azure AD.

3. В поле фильтра поиска введите **Azure Active Directory** , а затем выберите **Azure Active Directory**.

4. Выберите **корпоративные приложения** в области навигации Azure AD.

5. Выберите **все приложения** , чтобы просмотреть список приложений.

   > [!NOTE]
   > Если нужное приложение не отображается, используйте элемент управления **Фильтр** в верхней части **списка все приложения**. Задайте для параметра " **Показывать** " значение "все приложения".

6. Выберите приложение, для которого требуется настроить единый вход.

7. После загрузки приложения выберите **единый вход** в области навигации.

8. В разделе **атрибуты пользователя** выберите **Просмотр и изменение всех других атрибутов пользователя**. Здесь можно изменить атрибуты, которые будут отправлены в приложение в токене SAML при входе пользователей в систему.

   Чтобы добавить атрибут, выполните указанные ниже действия.

   1. Нажмите кнопку **Добавить атрибут**. Введите **имя**и выберите **значение** из раскрывающегося списка.

   1.  Нажмите кнопку **Сохранить**. Вы увидите новый атрибут в таблице.

9. Сохраните конфигурацию.

   В следующий раз, когда пользователь войдет в приложение, Azure AD отправит новый атрибут в ответе SAML.

## <a name="the-app-doesnt-identify-the-user"></a>Приложение не определяет пользователя

Вход в приложение завершается сбоем, так как в ответе SAML отсутствует атрибут, например роль. Или происходит сбой, так как приложение ожидает другой формат или значение атрибута **NameID** (идентификатор пользователя).

Если вы используете [автоматическую подготовку пользователей Azure AD](https://docs.microsoft.com/azure/active-directory/manage-apps/user-provisioning) для создания, обслуживания и удаления пользователей в приложении, убедитесь, что пользователь подготовлен для приложения SaaS. Дополнительные сведения см. [в статье отсутствие пользователей, подготовленных к работе с приложением из коллекции Azure AD](../app-provisioning/application-provisioning-config-problem-no-users-provisioned.md).

## <a name="add-an-attribute-to-the-azure-ad-app-configuration"></a>Добавление атрибута в конфигурацию приложения Azure AD

Чтобы изменить значение идентификатора пользователя, сделайте следующее:

1. Откройте [**портал Azure**](https://portal.azure.com/) и войдите в систему как глобальный администратор или Соадминистратор.

2. Выберите **все службы** в верхней части области навигации в левой части окна, чтобы открыть расширение Azure AD.

3. В поле фильтра поиска введите **Azure Active Directory** , а затем выберите **Azure Active Directory**.

4. Выберите **корпоративные приложения** в области навигации Azure AD.

5. Выберите **все приложения** , чтобы просмотреть список приложений.

   > [!NOTE]
   > Если нужное приложение не отображается, используйте элемент управления **Фильтр** в верхней части **списка все приложения**. Задайте для параметра " **Показывать** " значение "все приложения".

6. Выберите приложение, которое требуется настроить для единого входа.

7. После загрузки приложения выберите **единый вход** в области навигации.

8. В разделе **атрибуты пользователя**выберите уникальный идентификатор пользователя из раскрывающегося списка **идентификатор пользователя** .

## <a name="change-the-nameid-format"></a>Изменение формата NameID

Если приложение ожидает для атрибута **NameID** (идентификатор пользователя) другой формат, см. раздел [Editing NameID](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization#editing-nameid) to Change a NameID Format.

Azure AD выбирает формат атрибута **NameID** (идентификатор пользователя) в зависимости от выбранного значения или формата, запрошенного приложением в SAML запросе проверки подлинности. Дополнительные сведения см. в разделе "NameIDPolicy" [протокола SAML единого входа](https://docs.microsoft.com/azure/active-directory/develop/single-sign-on-saml-protocol#nameidpolicy).

## <a name="the-app-expects-a-different-signature-method-for-the-saml-response"></a>Приложение ожидает другой метод подписи для ответа SAML.

Чтобы изменить, какие части маркера SAML имеют цифровую подпись в Azure AD, выполните следующие действия.

1. Откройте [портал Azure](https://portal.azure.com/) и войдите в систему как глобальный администратор или Соадминистратор.

2. Выберите **все службы** в верхней части области навигации в левой части окна, чтобы открыть расширение Azure AD.

3. В поле фильтра поиска введите **Azure Active Directory** , а затем выберите **Azure Active Directory**.

4. Выберите **корпоративные приложения** в области навигации Azure AD.

5. Выберите **все приложения** , чтобы просмотреть список приложений.

   > [!NOTE]
   > Если нужное приложение не отображается, используйте элемент управления **Фильтр** в верхней части **списка все приложения**. Задайте для параметра " **Показывать** " значение "все приложения".

6. Выберите приложение, для которого требуется настроить единый вход.

7. После загрузки приложения выберите **единый вход** в области навигации.

8. В разделе **сертификат подписи SAML**выберите **Показывать дополнительные параметры подписи сертификата**.

9. Выберите **вариант подписывания** для приложения из следующих вариантов:

   * **Ответ SAML Sign**
   * **Ответ и утверждение подписи SAML**
   * **Утверждение знака SAML**

   В следующий раз, когда пользователь войдет в приложение, Azure AD подпишет часть выбранного ответа SAML.

## <a name="the-app-expects-the-sha-1-signing-algorithm"></a>Приложение принимает алгоритм подписывания SHA-1

По умолчанию Azure AD подписывает токен SAML с помощью наиболее безопасного алгоритма. Рекомендуется не изменять алгоритм подписи на *SHA-1* , если только приложению не требуется SHA-1.

Чтобы изменить алгоритм подписи, сделайте следующее:

1. Откройте [портал Azure](https://portal.azure.com/) и войдите в систему как глобальный администратор или Соадминистратор.

2. Выберите **все службы** в верхней части области навигации в левой части окна, чтобы открыть расширение Azure AD.

3. В поле фильтра поиска введите **Azure Active Directory** , а затем выберите **Azure Active Directory**.

4. Выберите **корпоративные приложения** в области навигации Azure AD.

5. Выберите **все приложения** , чтобы просмотреть список приложений.

   > [!NOTE]
   > Если нужное приложение не отображается, используйте элемент управления **Фильтр** в верхней части **списка все приложения**. Задайте для параметра " **Показывать** " значение "все приложения".

6. Выберите приложение, для которого требуется настроить единый вход.

7. После загрузки приложения выберите **единый вход** в области навигации в левой части приложения.

8. В разделе **сертификат подписи SAML**выберите **Показывать дополнительные параметры подписи сертификата**.

9. Выберите **SHA-1** в качестве **алгоритма подписи**.

   В следующий раз, когда пользователь войдет в приложение, Azure AD подпишет токен SAML с помощью алгоритма SHA-1.

## <a name="next-steps"></a>Следующие шаги
[Отладка единого входа на основе SAML в приложения в Azure AD](https://azure.microsoft.com/documentation/articles/active-directory-saml-debugging).
