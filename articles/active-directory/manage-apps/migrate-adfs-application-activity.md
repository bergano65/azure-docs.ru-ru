---
title: Использование отчета о действиях для перемещения AD FS приложений в Azure Active Directory | Документация Майкрософт "
description: Отчет о действиях приложений службы федерации Active Directory (AD FS) (AD FS) позволяет быстро перенести приложения из AD FS в Azure Active Directory (Azure AD). Это средство миграции для AD FS определяет совместимость с Azure AD и предоставляет руководство по миграции.
services: active-directory
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.topic: conceptual
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.date: 11/22/2019
ms.author: mimart
ms.collection: M365-identity-device-management
ms.openlocfilehash: de64385e21604188a5c9002f2e007dad86b2674c
ms.sourcegitcommit: 4c831e768bb43e232de9738b363063590faa0472
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2019
ms.locfileid: "74420436"
---
# <a name="use-the-ad-fs-application-activity-report-preview-to-migrate-applications-to-azure-ad"></a>Использование отчета о действиях приложения (Предварительная версия) AD FS для переноса приложений в Azure AD

Многие организации используют службы федерации Active Directory (AD FS) (AD FS) для предоставления единого входа в облачные приложения. Перемещение AD FS приложений в Azure AD для аутентификации имеет значительные преимущества, особенно с точки зрения управления затратами, управления рисками, повышения производительности, соответствия требованиям и руководства по управлению. Но понимание того, какие приложения совместимы с Azure AD, и определение конкретных шагов миграции может занять много времени.

Отчет о действиях AD FS приложений (Предварительная версия) в портал Azure позволяет быстро узнать, какие приложения могут быть перенесены в Azure AD. Он оценивает все AD FS приложения на совместимость с Azure AD, проверяет наличие проблем и предоставляет рекомендации по подготовке отдельных приложений к миграции. Отчет действия AD FS приложения позволяет:

* **Обнаружение AD FS приложений и область миграции.** В отчете об активности приложений AD FS перечислены все приложения AD FS в Организации и указаны их готовность к миграции в Azure AD.
* **Определение приоритета приложений для миграции.** Получите число уникальных пользователей, выполнивших вход в приложение за последние 1, 7 или 30 дней, чтобы определить важность или риск переноса приложения.
* **Выполнение тестов миграции и устранение проблем.** Служба отчетов автоматически запускает тесты, чтобы определить, готово ли приложение к миграции. Результаты отображаются в отчете об активности приложения AD FS как состояние миграции. Если выявлены потенциальные проблемы с миграцией, вы получите конкретные рекомендации по решению проблем.

Данные действия AD FS приложения доступны пользователям, которым назначены следующие роли администратора: глобальный администратор, читатель отчетов, читатель безопасности, администратор приложения или администратор облачных приложений.

## <a name="prerequisites"></a>предварительным требованиям

* В настоящее время ваша организация должна использовать AD FS для доступа к приложениям.
* Azure AD Connect Health должны быть включены в клиенте Azure AD.
   * [Дополнительные сведения о Azure AD Connect Health](https://docs.microsoft.com/azure/active-directory/hybrid/how-to-connect-health-adfs)
   * [Приступая к настройке Azure AD Connect Health](https://docs.microsoft.com/azure/active-directory/hybrid/how-to-connect-health-agent-install)

## <a name="discover-ad-fs-applications-that-can-be-migrated"></a>Обнаружение AD FS приложений, которые можно перенести 

Отчет о действиях AD FS приложений доступен в портал Azure в разделе Использование Azure AD **& Insights** Reporting. Отчет об активности приложения AD FS анализирует каждое приложение AD FS, чтобы определить, можно ли его перенести как есть или если требуется дополнительная проверка. 

1. Войдите в [портал Azure](https://portal.azure.com) с ролью администратора, которая имеет доступ к AD FS данным о действиях приложений (глобальный администратор, читатель отчетов, читатель безопасности, администратор приложений или администратор облачных приложений).

2. Выберите **Azure Active Directory**, а затем выберите **корпоративные приложения**.

3. В разделе **действие**выберите **Использование & Insights (Предварительная версия)** , а затем выберите **AD FS действие приложения** , чтобы открыть список всех AD FS приложений в вашей организации.

   ![AD FS действия приложения](media/migrate-adfs-application-activity/adfs-application-activity.png)

4. Для каждого приложения в списке действие приложения AD FS просмотрите **состояние миграции**:

   * **Готовность к миграции** означает, что конфигурация приложения AD FS полностью поддерживается в Azure AD и может быть перенесена как есть.

   * **Требования к проверке** означают, что некоторые параметры приложения можно перенести в Azure AD, но необходимо проверить параметры, которые не могут быть перенесены как есть.

   * **Дополнительные шаги необходимы** , если Azure AD не поддерживает некоторые параметры приложения, поэтому приложение нельзя перенести в его текущем состоянии.

## <a name="evaluate-the-readiness-of-an-application-for-migration"></a>Оценка готовности приложения к миграции 

1. В списке действие приложения AD FS щелкните состояние в столбце **состояние миграции** , чтобы открыть сведения о миграции. Вы увидите сводку проверок конфигурации, которые прошли успешно, а также возможные проблемы миграции.

   ![Сведения о миграции](media/migrate-adfs-application-activity/migration-details.png)

2. Щелкните сообщение, чтобы открыть дополнительные сведения о правиле миграции. Полный список тестируемых свойств см. в таблице [AD FS тестов конфигурации приложений](#ad-fs-application-configuration-tests) ниже.

   ![Сведения о правиле миграции](media/migrate-adfs-application-activity/migration-rule-details.png)

### <a name="ad-fs-application-configuration-tests"></a>AD FS тестов конфигурации приложений

В следующей таблице перечислены все тесты конфигурации, выполняемые в AD FS приложениях.

|Результат  |Успех/предупреждение/сбой  |ОПИСАНИЕ  |
|---------|---------|---------|
|Test-Адфсрпаддитионалаусентикатионрулес <br> Для Аддитионалаусентикатион обнаружено по крайней мере одно правило без миграции.       | Успех/предупреждение          | Проверяющая сторона имеет правила для запроса многофакторной проверки подлинности (MFA). Чтобы перейти в Azure AD, преобразовывать эти правила в политики условного доступа. Если вы используете локальный MFA, рекомендуется перейти на Azure MFA. Дополнительные [сведения об условном доступе](https://docs.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks).        |
|Test-Адфсрпаддитионалвсфедендпоинт <br> Аддитионалвсфедендпоинт проверяющей стороны имеет значение true.       | Успех или сбой.          | Проверяющая сторона в AD FS допускает несколько конечных точек утверждений WS-подач. В настоящее время Azure AD поддерживает только одну. Если у вас есть сценарий, в котором этот результат блокирует миграцию, [сообщите нам о](https://feedback.azure.com/forums/169401-azure-active-directory/suggestions/38695621-allow-multiple-ws-fed-assertion-endpoints)ней.     |
|Test-Адфсрпалловедаусентикатионклассреференцес <br> Проверяющая сторона установила Алловедаусентикатионклассреференцес.       | Успех или сбой.          | Этот параметр в AD FS позволяет указать, настроено ли приложение на разрешение только определенных типов проверки подлинности. Для достижения этой возможности рекомендуется использовать условный доступ.  Если у вас есть сценарий, в котором этот результат блокирует миграцию, [сообщите нам о](https://feedback.azure.com/forums/169401-azure-active-directory/suggestions/38695672-allow-in-azure-ad-to-specify-certain-authentication)ней.  Дополнительные [сведения об условном доступе](https://docs.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks).          |
|Test-Адфсрпалвайсрекуиреаусентикатион <br> алвайсрекуиреаусентикатиончеккресулт      | Успех или сбой.          | Этот параметр в AD FS позволяет указать, настроено ли приложение для игнорирования файлов cookie единого входа и **всегда запрашивать проверку подлинности**. В Azure AD можно управлять сеансом проверки подлинности с помощью политик условного доступа для достижения аналогичного поведения. Дополнительные [сведения о настройке управления сеансами проверки подлинности с помощью условного доступа](https://docs.microsoft.com/azure/active-directory/conditional-access/howto-conditional-access-session-lifetime).          |
|Test-Адфсрпаутаупдатинаблед <br> Аутаупдатинаблед проверяющей стороны имеет значение true       | Успех/предупреждение          | Этот параметр в AD FS позволяет указать, настроена ли для AD FS автоматическое обновление приложения на основе изменений в метаданных федерации. Azure AD сейчас не поддерживает этот процесс, но не должен блокировать перенос приложения в Azure AD.           |
|Test-Адфсрпклаимспровидернаме <br> Для проверяющей стороны включено несколько Клаимспровидерс       | Успех или сбой.          | Этот параметр в AD FS вызывает поставщики удостоверений, от которых проверяющая сторона принимает утверждения. В Azure AD можно включить внешнюю совместную работу с помощью Azure AD B2B. Дополнительные [сведения об Azure AD B2B](https://docs.microsoft.com/azure/active-directory/b2b/what-is-b2b).          |
|Test-Адфсрпделегатионаусоризатионрулес      | Успех или сбой.          | Для приложения определены пользовательские правила авторизации делегирования. Это концепция WS-Trust, которую служба Azure AD поддерживает с помощью современных протоколов проверки подлинности, таких как OpenID Connect Connect и OAuth 2,0. Дополнительные [сведения о платформе Microsoft Identity](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc).          |
|Test-Адфсрпимперсонатионаусоризатионрулес       | Успех/предупреждение          | В приложении определены пользовательские правила авторизации олицетворения. Это концепция WS-Trust, которую служба Azure AD поддерживает с помощью современных протоколов проверки подлинности, таких как OpenID Connect Connect и OAuth 2,0. Дополнительные [сведения о платформе Microsoft Identity](https://docs.microsoft.com/azure/active-directory/develop/v2-protocols-oidc).          |
|Test-Адфсрписсуанцеаусоризатионрулес <br> Для Иссуанцеаусоризатион обнаружено по крайней мере одно правило без миграции.       | Успех/предупреждение          | Приложение имеет пользовательские правила авторизации выдачи, определенные в AD FS. Azure AD поддерживает эту функцию с помощью условного доступа Azure AD. Дополнительные [сведения об условном доступе](https://docs.microsoft.com/azure/active-directory/conditional-access/overview). <br> Вы также можете ограничить доступ к приложению по пользователям или группам, назначенным приложению. [Узнайте больше о назначении пользователей и групп для доступа к приложениям](https://docs.microsoft.com/azure/active-directory/manage-apps/methods-for-assigning-users-and-groups).            |
|Test-Адфсрписсуанцетрансформрулес <br> Для Иссуанцетрансформ обнаружено по крайней мере одно правило без миграции.       | Успех/предупреждение          | Приложение имеет пользовательские правила преобразования выдачи, определенные в AD FS. Azure AD поддерживает настройку утверждений, выданных в токене. Дополнительные сведения см. в разделе [Настройка утверждений, выданных в токене SAML для корпоративных приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization).           |
|Test-Адфсрпмониторинженаблед <br> Мониторинженаблед проверяющей стороны имеет значение true.       | Успех/предупреждение          | Этот параметр в AD FS позволяет указать, настроена ли для AD FS автоматическое обновление приложения на основе изменений в метаданных федерации. Azure AD сейчас не поддерживает этот процесс, но не должен блокировать перенос приложения в Azure AD.           |
|Test-Адфсрпнотбефорескев <br> нотбефорескевчеккресулт      | Успех/предупреждение          | AD FS позволяет отклонять время на основе значений NotBefore и Нотонорафтер в токене SAML. Azure AD автоматически обрабатывает это по умолчанию.          |
|Test-Адфсрпрекуестмфафромклаимспровидерс <br> Рекуестмфафромклаимспровидерс проверяющей стороны имеет значение true.       | Успех/предупреждение          | Этот параметр в AD FS определяет поведение MFA, когда пользователь поступает от другого поставщика утверждений. В Azure AD можно включить внешнюю совместную работу с помощью Azure AD B2B. Затем можно применить политики условного доступа для защиты гостевого доступа. Дополнительные сведения об [Azure AD B2B](https://docs.microsoft.com/azure/active-directory/b2b/what-is-b2b) и [условном доступе](https://docs.microsoft.com/azure/active-directory/conditional-access/overview).          |
|Test-Адфсрпсигнедсамлрекуестсрекуиред <br> Сигнедсамлрекуестсрекуиред проверяющей стороны имеет значение true       | Успех или сбой.          | Приложение настраивается в AD FS для проверки подписи в запросе SAML. Azure AD принимает подписанный запрос SAML; Однако подпись не будет проверена. В Azure AD есть различные методы защиты от вредоносных вызовов. Например, Azure AD использует URL-адреса ответа, настроенные в приложении, для проверки запроса SAML. Azure AD будет отправлять маркер только для URL-адресов ответов, настроенных для приложения. Если у вас есть сценарий, в котором этот результат блокирует миграцию, [сообщите нам о](https://feedback.azure.com/forums/169401-azure-active-directory/suggestions/13394589-saml-signature)ней.          |
|Test-Адфсрптокенлифетиме <br> токенлифетимечеккресулт        | Успех/предупреждение         | Приложение настроено на время существования пользовательского маркера. AD FS по умолчанию — один час. Azure AD поддерживает эту функцию с помощью условного доступа. Дополнительные сведения см. в статье [Настройка управления сеансами проверки подлинности с помощью условного доступа](https://docs.microsoft.com/azure/active-directory/conditional-access/howto-conditional-access-session-lifetime).          |
|Проверяющая сторона настроена на шифрование утверждений. Это поддерживается в Azure AD.       | Pass;          | С помощью Azure AD можно зашифровать маркер, отправляемый в приложение. Дополнительные сведения см. в статье [Настройка шифрования маркеров SAML в Azure AD](https://docs.microsoft.com/azure/active-directory/manage-apps/howto-saml-token-encryption).          |
|енкриптеднамеидрекуиредчеккресулт      | Успех или сбой.          | Приложение настроено для шифрования утверждения nameID в токене SAML. С помощью Azure AD можно зашифровать весь токен, отправляемый в приложение. Шифрование конкретных утверждений пока не поддерживается. Дополнительные сведения см. в статье [Настройка шифрования маркеров SAML в Azure AD](https://docs.microsoft.com/azure/active-directory/manage-apps/howto-saml-token-encryption).         |

## <a name="check-the-results-of-claim-rule-tests"></a>Проверка результатов тестов правил утверждений

Если вы настроили правило утверждений для приложения в AD FS, процесс будет детализированным анализом всех правил утверждений. Вы увидите, какие правила утверждений можно переместить в Azure AD, и какие из них необходимо проанализировать.

1. В списке действие приложения AD FS щелкните состояние в столбце **состояние миграции** , чтобы открыть сведения о миграции. Вы увидите сводку проверок конфигурации, которые прошли успешно, а также возможные проблемы миграции.

2. На странице **сведения о правиле миграции** разверните результаты, чтобы просмотреть сведения о потенциальных проблемах миграции и получить дополнительные рекомендации. Подробный список всех проверенных правил утверждений см. в разделе [Проверка результатов в таблице проверки правил утверждений](#check-the-results-of-claim-rule-tests) ниже.

   В приведенном ниже примере показаны сведения о правиле миграции для правила Иссуанцетрансформ. В нем перечислены конкретные части утверждения, которые необходимо просмотреть и устранить, прежде чем можно будет перенести приложение в Azure AD.

   ![Сведения о правиле миграции дополнительные рекомендации](media/migrate-adfs-application-activity/migration-rule-details-guidance.png)

### <a name="claim-rule-tests"></a>Тесты правил утверждений

В следующей таблице перечислены все тесты правил утверждений, которые выполняются в AD FS приложениях.

|Свойство  |ОПИСАНИЕ  |
|---------|---------|
|UNSUPPORTED_CONDITION_PARAMETER      | Оператор Condition использует регулярные выражения для вычисления того, соответствует ли заявка определенному шаблону.  Для достижения аналогичной функциональности в Azure AD можно использовать предварительно определенные преобразования, такие как Ифемпти (), Стартвис (), а также, помимо прочего, Contains (). Дополнительные сведения см. [в статье Настройка утверждений, выданных в токене SAML для корпоративных приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization).          |
|UNSUPPORTED_CONDITION_CLASS      | Оператор Condition имеет несколько условий, которые необходимо вычислить перед выполнением инструкции выдачи. Azure AD может поддерживать эту функцию с помощью функций преобразования утверждения, где можно оценить несколько значений утверждений.  Дополнительные сведения см. [в статье Настройка утверждений, выданных в токене SAML для корпоративных приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization).          |
|UNSUPPORTED_RULE_TYPE      | Не удалось распознать правило утверждения. Дополнительные сведения о настройке утверждений в Azure AD см. в статье [Настройка утверждений, выданных в токене SAML для корпоративных приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization).          |
|CONDITION_MATCHES_UNSUPPORTED_ISSUER      | В инструкции условия используется издатель, который не поддерживается в Azure AD. В настоящее время Azure AD не имеет исходных утверждений от хранилищ, отличающихся Active Directory или Azure AD. Если это мешает вам перенести приложения в Azure AD, [сообщите нам о](https://feedback.azure.com/forums/169401-azure-active-directory/suggestions/38695717-allow-to-source-user-attributes-from-external-dire)них.         |
|UNSUPPORTED_CONDITION_FUNCTION      | Оператор Condition использует агрегатную функцию для выдаче или добавления одного утверждения независимо от числа совпадений.  В Azure AD можно оценить атрибут пользователя, чтобы решить, какое значение следует использовать для утверждения с такими функциями, как Ифемпти (), Стартвис (), Contains (), а также другими. Дополнительные сведения см. [в статье Настройка утверждений, выданных в токене SAML для корпоративных приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization).          |
|RESTRICTED_CLAIM_ISSUED      | В инструкции условия используется утверждение, которое ограничено в Azure AD. Вы можете выдать ограниченное утверждение, но вы не сможете изменить его источник или применить какое-либо преобразование. Дополнительные сведения см. в статье [Настройка утверждений, созданных в токенах для конкретного приложения в Azure AD](https://docs.microsoft.com/azure/active-directory/develop/active-directory-claims-mapping).          |
|EXTERNAL_ATTRIBUTE_STORE      | Инструкция выдачи использует хранилище атрибутов, отличное от Active Directory. В настоящее время Azure AD не имеет исходных утверждений от хранилищ, отличающихся Active Directory или Azure AD. Если этот результат блокирует миграцию приложений в Azure AD, [сообщите нам о](https://feedback.azure.com/forums/169401-azure-active-directory/suggestions/38695717-allow-to-source-user-attributes-from-external-dire)них.          |
|UNSUPPORTED_ISSUANCE_CLASS      | Инструкция выдачи использует ADD для добавления утверждений к входящему набору утверждений. В Azure AD это можно настроить как множественные преобразования утверждений.  Дополнительные сведения см. [в статье Настройка утверждений, выданных в токене SAML для корпоративных приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-claims-mapping).         |
|UNSUPPORTED_ISSUANCE_TRANSFORMATION      | Инструкция выдачи использует регулярные выражения для преобразования значения утверждения, которое необходимо выдавать. Для обеспечения аналогичной функциональности в Azure AD можно использовать предварительно определенные преобразования, такие как Extract (), Trim (), ToLower и др. Дополнительные сведения см. [в статье Настройка утверждений, выданных в токене SAML для корпоративных приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization).          |


## <a name="next-steps"></a>Дополнительная информация

- [Управление приложениями с помощью Azure Active Directory](what-is-application-management.md)
- [Управление доступом к приложениям](what-is-access-management.md)
- [Azure AD Connect и федерация](../hybrid/how-to-connect-fed-whatis.md)
