---
title: Управление сертификатами федерации в Azure AD | Документация Майкрософт
description: Узнайте, как настроить срок действия сертификатов федерации, а также обновлять сертификаты с истекающим сроком действия.
services: active-directory
documentationcenter: ''
author: kenwith
manager: celestedg
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 04/04/2019
ms.author: kenwith
ms.reviewer: jeedes
ms.collection: M365-identity-device-management
ms.openlocfilehash: 1731d5ea5d8db9ea1c5855a32d2daca0387c0bf5
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "84763216"
---
# <a name="manage-certificates-for-federated-single-sign-on-in-azure-active-directory"></a>Управление сертификатами для федеративного единого входа в Azure Active Directory

В этой статье рассматриваются распространенные вопросы и сведения, связанные с сертификатами, которые Azure Active Directory (Azure AD) для установления федеративного единого входа (SSO) к приложениям программного обеспечения как услуги (SaaS). Эти приложения можно добавить из коллекции приложений Azure AD или с помощью шаблона приложения не из коллекции. Настройте приложение для федеративного единого входа.

Эта статья относится только к приложениям, которые настроены для использования единого входа Azure AD с помощью Федерации [язык разметки зявлений системы безопасности (SAML)](https://wikipedia.org/wiki/Security_Assertion_Markup_Language) (SAML).

## <a name="auto-generated-certificate-for-gallery-and-non-gallery-applications"></a>Автоматически созданный сертификат для приложений из коллекции и не из коллекции

Когда вы добавляете новое приложение из коллекции и настраиваете вход на основе SAML (на странице Обзор приложения выбран **единый вход**  >  **SAML** ), Azure AD создает сертификат для приложения, которое действует в течение трех лет. Чтобы скачать активный сертификат в качестве файла сертификата безопасности (**CER**), вернитесь на эту страницу (**Вход на основе SAML**) и выберите ссылку для скачивания в заголовке **сертификата подписи SAML** . Можно выбрать сертификат необработанного (двоичного) или Base64 (Base 64-Encoded Text). Для приложений из коллекции в этом разделе также может отображаться ссылка для скачивания сертификата в виде XML-файла метаданных федерации ( **XML-** файл) в зависимости от требований приложения.

![Параметры скачивания сертификата активного подписи SAML](./media/manage-certificates-for-federated-single-sign-on/active-certificate-download-options.png)

Вы также можете скачать активный или неактивный сертификат, щелкнув значок **изменения** заголовка **сертификата подписи SAML** (карандаш), который отображает страницу **сертификата для подписи SAML** . Нажмите кнопку с многоточием (**...**) рядом с сертификатом, который вы хотите скачать, а затем выберите нужный формат сертификата. Вы можете скачать сертификат в формате расширенной почты (PEM) с помощью дополнительного параметра. Этот формат идентичен Base64, но с расширением **PEM** , которое не распознается в Windows как формат сертификата.

![Параметры скачивания сертификата подписи SAML (активный и неактивный)](./media/manage-certificates-for-federated-single-sign-on/all-certificate-download-options.png)

## <a name="customize-the-expiration-date-for-your-federation-certificate-and-roll-it-over-to-a-new-certificate"></a>Настройка даты окончания срока действия сертификата федерации и его замена новым сертификатом

По умолчанию Azure настраивает срок действия сертификата в течение трех лет, когда он создается автоматически во время настройки единого входа SAML. Так как вы не можете изменить дату сертификата после его сохранения, необходимо выполнить следующие действия:

1. Создайте новый сертификат с требуемой датой.
1. Сохраните новый сертификат.
1. Скачайте новый сертификат в правильном формате.
1. Отправьте новый сертификат в приложение.
1. Сделайте новый сертификат активным на портале Azure Active Directory.

Следующие два раздела помогут выполнить эти действия.

### <a name="create-a-new-certificate"></a>Создание сертификата

Сначала создайте и сохраните новый сертификат с другим сроком действия:

1. Войдите на [портал Azure Active Directory](https://aad.portal.azure.com/). Откроется страница **центра администрирования Azure Active Directory** .
1. В области слева выберите **Корпоративные приложения**. Появится список корпоративных приложений в вашей учетной записи.
1. Выберите затронутое приложение. Откроется страница обзора для приложения.
1. В левой области страницы Обзор приложения выберите **единый вход**.
1. Если появится страница **Выбор метода единого входа** , выберите **SAML**.
1. На странице **Настройка единого входа с помощью SAML-Preview** найдите заголовок **сертификата подписи SAML** и щелкните значок **редактирования** (карандаш). Откроется страница **сертификат подписи SAML** , в которой отображается состояние (**активно** или **неактивно**), Дата окончания срока действия и отпечаток (строка хэша) для каждого сертификата.
1. Выберите **новый сертификат**. Новая строка отображается под списком сертификатов, где Дата окончания срока действия по умолчанию — ровно три года после текущей даты. (Изменения еще не сохранены, поэтому вы по-прежнему можете изменить дату окончания срока действия.)
1. В строке новый сертификат наведите указатель мыши на столбец Дата окончания срока действия и выберите значок **выбора даты** (календарь). Появится элемент управления "Календарь", в котором отображаются дни месяца текущей даты окончания срока действия новой строки.
1. Используйте элемент управления Calendar, чтобы задать новую дату. Можно задать любую дату между текущей датой и тремя годами после текущей даты.
1. Нажмите кнопку **Сохранить**. Теперь новый сертификат отображается со статусом **неактивна**, выбранная дата истечения срока действия и отпечаток.
1. Выберите **X** , чтобы вернуться на страницу **Настройка единого входа с помощью SAML-Preview** .

### <a name="upload-and-activate-a-certificate"></a>Отправка и активация сертификата

Затем Скачайте новый сертификат в правильном формате, отправьте его в приложение и сделайте активным в Azure Active Directory:

1. Просмотрите дополнительные инструкции по настройке входа SAML в приложение одним из следующих.

   - Выберите ссылку в разделе "ссылка на **конфигурацию** ", чтобы просмотреть ее в отдельном окне или на вкладке браузера.
   - Перейдите к заголовку **Настройка** и выберите **Просмотреть** пошаговые инструкции для просмотра на боковой панели.

1. В инструкциях обратите внимание на формат кодирования, необходимый для отправки сертификата.
1. Следуйте инструкциям в разделе [автоматически созданный сертификат для приложений из коллекции и не из коллекции](#auto-generated-certificate-for-gallery-and-non-gallery-applications) . На этом шаге загружается сертификат в формате кодирования, требуемом для передачи приложением.
1. Если вы хотите переключиться на новый сертификат, вернитесь на страницу **сертификата подписи SAML** и в вновь сохраненную строку сертификата нажмите кнопку с многоточием (**...**) и выберите **сделать сертификат активным**. Состояние нового сертификата изменится на **активно**, а ранее активный сертификат изменится на состояние **неактивно**.
1. Далее следуйте инструкциям по настройке входа SAML приложения, которые были показаны ранее, чтобы можно было передать сертификат подписи SAML в правильном формате кодирования.

## <a name="add-email-notification-addresses-for-certificate-expiration"></a>Добавление адресов уведомлений по электронной почте для истечения срока действия сертификата

Azure AD будет отправлять по электронной почте уведомление 60, 30 и 7 дней до истечения срока действия сертификата SAML. Вы можете добавить более одного адреса электронной почты для получения уведомлений. Чтобы указать адреса электронной почты, на которые должны отправляться уведомления:

1. На странице **сертификата подписи SAML** перейдите к заголовку **адреса электронной почты для уведомлений** . По умолчанию в этом заголовке используется только адрес электронной почты администратора, который добавил приложение.
1. Под последним адресом электронной почты введите адрес электронной почты, который должен получить уведомление об истечении срока действия сертификата, и нажмите клавишу ВВОД.
1. Повторите предыдущий шаг для каждого адреса электронной почты, который вы хотите добавить.
1. Для каждого адреса электронной почты, который необходимо удалить, щелкните значок **удаления** (мусор) рядом с адресом электронной почты.
1. Нажмите кнопку **Сохранить**.

Вы получите сообщение электронной почты с уведомлением от aadnotification@microsoft.com. Чтобы избежать отправки сообщения электронной почты в расположение спама, добавьте это сообщение в список контактов.

## <a name="renew-a-certificate-that-will-soon-expire"></a>Обновление сертификата с истекающим сроком действия

Если срок действия сертификата скоро истечет, его можно обновить с помощью процедуры, которая не приводит к длительному простою для пользователей. Чтобы продлить срок действия сертификата, выполните следующие действия.

1. Следуйте инструкциям в разделе [Создание нового сертификата](#create-a-new-certificate) ранее, используя дату, которая пересекается с существующим сертификатом. Эта дата ограничивает время простоя, вызванное истечением срока действия сертификата.
1. Если приложение может автоматически переключать сертификат, установите для нового сертификата значение активно, выполнив следующие действия.
   1. Вернитесь на страницу **сертификата подписи SAML** .
   1. В вновь сохраненной строке сертификата нажмите кнопку с многоточием (**...**), а затем выберите **сделать сертификат активным**.
   1. Пропустите следующие два шага.

1. Если приложение может одновременно работать только с одним сертификатом, выберите интервал простоя для выполнения следующего шага. (В противном случае, если приложение не выберет новый сертификат автоматически, но может работать с несколькими сертификатами для подписи, можно выполнить следующий шаг в любое время.)
1. До истечения срока действия старого сертификата следуйте инструкциям в разделе [Отправка и активация сертификата](#upload-and-activate-a-certificate) выше.
1. Войдите в приложение, чтобы убедиться, что сертификат работает правильно.

## <a name="related-articles"></a>Похожие статьи

- [Руководства по интеграции приложений SaaS с Azure Active Directory](../saas-apps/tutorial-list.md)
- [Управление приложениями с помощью Azure Active Directory](what-is-application-management.md)
- [Единый вход в приложениях в Azure Active Directory](what-is-single-sign-on.md)
- [Отладка единого входа на основе SAML в приложениях в Azure Active Directory](../azuread-dev/howto-v1-debug-saml-sso-issues.md)
