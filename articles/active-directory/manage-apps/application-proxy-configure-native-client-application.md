---
title: Публикация собственных клиентских приложений — Azure AD | Документация Майкрософт
description: В этой статье описано, как включить собственные клиентские приложения для взаимодействия с соединителем прокси приложений Azure AD, чтобы обеспечить безопасный удаленный доступ к локальным приложениям.
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 04/15/2019
ms.author: mimart
ms.reviewer: japere
ms.custom: it-pro
ms.collection: M365-identity-device-management
ms.openlocfilehash: 2cbee6bfcca3ddb356abe9dceab2fca07c152b07
ms.sourcegitcommit: 39da2d9675c3a2ac54ddc164da4568cf341ddecf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2019
ms.locfileid: "73961806"
---
# <a name="how-to-enable-native-client-applications-to-interact-with-proxy-applications"></a>Как включить собственные клиентские приложения для взаимодействия с приложениями прокси-сервера

Для публикации веб-приложений можно использовать прокси приложения Azure Active Directory (Azure AD), но его также можно использовать для публикации собственных клиентских приложений, настроенных с помощью библиотеки аутентификация Azure AD (ADAL). Собственные клиентские приложения отличаются от веб-приложений, так как они устанавливаются на устройство, а веб-приложения предоставляются через браузер.

Для поддержки собственных клиентских приложений прокси приложения принимает токены, выданные Azure AD, которые отправляются в заголовке. Служба прокси приложения выполняет проверку подлинности для пользователей. Это решение не использует маркеры приложения для проверки подлинности.

![Отношение между конечными пользователями, Azure AD и опубликованными приложениями](./media/application-proxy-configure-native-client-application/richclientflow.png)

Для публикации собственных приложений используйте библиотеку аутентификация Azure AD, которая выполняет проверку подлинности и поддерживает множество клиентских сред. Прокси приложения вписывается в [сценарий вызова веб-API собственным приложением](../develop/native-app.md).

В этой статье рассматриваются четыре действия, которые нужно выполнить, чтобы опубликовать собственное приложение с помощью прокси приложения и библиотеки аутентификации Azure AD.

## <a name="step-1-publish-your-proxy-application"></a>Шаг 1. Публикация приложения прокси-сервера

Опубликуйте приложение прокси, как любое другое приложение, и назначьте пользователей, имеющих доступ к вашему приложению. Дополнительные сведения см. в статье [Публикация приложений с помощью прокси приложения Azure AD](application-proxy-add-on-premises-application.md).

## <a name="step-2-register-your-native-application"></a>Шаг 2. Регистрация собственного приложения

Теперь необходимо зарегистрировать приложение в Azure AD следующим образом:

1. Войдите на [портал Azure Active Directory](https://aad.portal.azure.com/). Откроется **панель мониторинга** **центра администрирования Azure Active Directory** .
1. На боковой панели выберите **Azure Active Directory**. Откроется страница Обзор **Azure Active Directory** .
1. На боковой панели "Обзор Azure AD" выберите **Регистрация приложений**. Отобразится список всех регистраций приложений.
1. Выберите **Новая регистрация**. Откроется страница **Регистрация приложения** .

   ![Создание новой регистрации приложения в портал Azure](./media/application-proxy-configure-native-client-application/create.png)

1. В заголовке **имя** укажите отображаемое имя пользователя для приложения.
1. В заголовке **Поддерживаемые типы учетных записей** выберите уровень доступа, используя следующие рекомендации:

   - Чтобы выбрать только те учетные записи, которые являются внутренними для вашей организации, выберите **учетные записи только в этом каталоге Организации**.
   - Чтобы ориентироваться только на бизнес-или учебные клиенты, выберите **учетные записи в любом каталоге Организации**.
   - Чтобы выбрать для широкого набора удостоверений Майкрософт, выберите **учетные записи в любом организационном каталоге и личных учетных записях Майкрософт**.

1. В заголовке **URI перенаправления** выберите **общедоступный клиент (мобильный & Рабочий стол)** , а затем введите URI перенаправления для приложения.
1. Выберите и прочтите **политики платформы Майкрософт**и нажмите кнопку **зарегистрировать**. Будет создана и отображена страница обзора для новой регистрации приложения.

Более подробные сведения о создании регистрации приложения см. в статье [Интеграция приложений с Azure Active Directory](../develop/quickstart-v1-integrate-apps-with-azure-ad.md).

## <a name="step-3-grant-access-to-your-proxy-application"></a>Шаг 3. предоставление доступа к прокси-приложению

Теперь, когда вы зарегистрировали собственное приложение, вы можете предоставить ему доступ к другим приложениям в каталоге, в данном случае для доступа к прокси-приложению. Чтобы обеспечить предоставление собственного приложения для прокси-приложения, выполните следующие действия.

1. На боковой панели страницы регистрация нового приложения выберите **разрешения API**. Откроется страница **разрешения API** для регистрации нового приложения.
1. Выберите **Добавить разрешение**. Откроется страница **разрешения API запроса** .
1. В разделе **Выбор API** выберите **API, используемые моей организацией**. Появится список, содержащий приложения в каталоге, которые предоставляют интерфейсы API.
1. Введите в поле поиска или прокрутите экран, чтобы найти прокси-приложение, опубликованное на [шаге 1. Опубликуйте прокси](#step-1-publish-your-proxy-application)-приложение, а затем выберите прокси-приложение.
1. В разделе **какой тип разрешений приложения требуется?** выберите тип разрешения. Если собственному приложению требуется доступ к API прокси-приложения в качестве пользователя, выполнившего вход, выберите **делегированные разрешения**.
1. В заголовке **Выбор разрешений** выберите нужное разрешение и нажмите кнопку **Добавить разрешения**. На странице **разрешения API** для собственного приложения теперь отображается добавленное приложение прокси и API разрешений.

## <a name="step-4-edit-the-active-directory-authentication-library"></a>Шаг 4. Изменение библиотеки проверки подлинности Active Directory

Измените код собственного приложения с учетом проверки подлинности с помощью библиотеки Active Directory Authentication Library (ADAL). Для этого включите в код следующий текст:

```
// Acquire Access Token from AAD for Proxy Application
AuthenticationContext authContext = new AuthenticationContext("https://login.microsoftonline.com/<Tenant ID>");
AuthenticationResult result = await authContext.AcquireTokenAsync("< External Url of Proxy App >",
        "<App ID of the Native app>",
        new Uri("<Redirect Uri of the Native App>"),
        PromptBehavior.Never);

//Use the Access Token to access the Proxy Application
HttpClient httpClient = new HttpClient();
httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", result.AccessToken);
HttpResponseMessage response = await httpClient.GetAsync("< Proxy App API Url >");
```

Необходимые сведения в примере кода можно найти на портале Azure AD следующим образом.

| Требуется информация | Как найти его на портале Azure AD |
| --- | --- |
| Идентификатор клиента \<> | **Azure Active Directory** **Свойства** >  > **идентификатор каталога** |
| \<внешний URL-адрес > приложения прокси | **Корпоративные приложения** > прокси- *приложение* > **прокси-сервер приложения** > **внешний URL-адрес** |
| \<идентификатор приложения собственного приложения > | **Корпоративные приложения** > **свойства** *собственного приложения* >  > **идентификатор приложения** |
| \<URI перенаправления собственного приложения > | **Azure Active Directory** > **Регистрация приложений** > *собственного приложения* > **URI перенаправления** |
| URL-адрес API прокси-приложения \<> | **Azure Active Directory** > **Регистрация приложений** > **разрешения API** > *собственного приложения* > **API/имя разрешения** |

После редактирования ADAL с помощью этих параметров пользователи могут проходить проверку подлинности в собственных клиентских приложениях, даже если они находятся за пределами корпоративной сети.

## <a name="next-steps"></a>Дополнительная информация

Дополнительные сведения о потоке собственного приложения см. [в разделе собственные приложения в Azure Active Directory](../develop/native-app.md).

Узнайте, как настроить [единый вход для приложений в Azure Active Directory](what-is-single-sign-on.md#choosing-a-single-sign-on-method).
