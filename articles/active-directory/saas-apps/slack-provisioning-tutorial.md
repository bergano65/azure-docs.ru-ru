---
title: Руководство по подготовке пользователей для Slack с помощью Azure AD
description: Узнайте, как настроить Azure Active Directory для автоматической подготовки и отмены подготовки учетных записей пользователей в Slack.
services: active-directory
author: ArvindHarinder1
manager: CelesteDG
ms.service: active-directory
ms.subservice: saas-app-tutorial
ms.workload: identity
ms.topic: tutorial
ms.date: 05/06/2020
ms.author: arvinh
ms.openlocfilehash: 58fe99164c390d8a9435e5aa65e55fe7fca5d6db
ms.sourcegitcommit: 0b9fe9e23dfebf60faa9b451498951b970758103
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/07/2020
ms.locfileid: "94359482"
---
# <a name="tutorial-configure-slack-for-automatic-user-provisioning"></a>Руководство по настройке Slack для автоматической подготовки пользователей

Цель этого учебника — показать, как в Slack и Azure AD необходимо выполнять автоматическую подготовку и отмену подготовки учетных записей пользователей из Azure AD в Slack. Подробные сведения о том, что делает эта служба, как она работает, и часто задаваемые вопросы см. в статье [Автоматическая подготовка пользователей и ее отзыв для приложений SaaS в Azure Active Directory](../app-provisioning/user-provisioning.md). 


## <a name="capabilities-supported"></a>Поддерживаемые возможности
> [!div class="checklist"]
> * Создание пользователей в Slack.
> * Удаление пользователей в Slack, когда доступ им больше не нужен.
> * Синхронизация атрибутов пользователей между Azure AD и Slack.
> * Подготовка групп и членства в группах в Slack.
> * [Единый вход](./slack-tutorial.md) в Slack (рекомендуется).


## <a name="prerequisites"></a>Предварительные требования

Сценарий, описанный в этом учебнике, предполагает, что у вас уже имеется:

* [Клиент Azure AD.](../develop/quickstart-create-new-tenant.md)
* Учетная запись пользователя в Azure AD с [разрешением](../users-groups-roles/directory-assign-admin-roles.md) на настройку подготовки (например, администратор приложений, администратор облачных приложений, владелец приложения или глобальный администратор).
* Клиент Slack с включенным планом уровня [Plus](https://aadsyncfabric.slack.com/pricing) или выше.
* Учетная запись пользователя в Slack с разрешениями администратора группы.

## <a name="step-1-plan-your-provisioning-deployment"></a>Шаг 1. Планирование развертывания для подготовки
1. Узнайте, [как работает служба подготовки](../app-provisioning/user-provisioning.md).
2. Определите, кто будет находиться в [области подготовки](../app-provisioning/define-conditional-rules-for-provisioning-user-accounts.md).
3. Определите, какие данные следует [сопоставлять между Azure AD и Slack](../app-provisioning/customize-application-attributes.md). 

## <a name="step-2-add-slack-from-the-azure-ad-application-gallery"></a>Шаг 2. Добавление Slack из коллекции приложений Azure AD

Добавьте Slack из коллекции приложений Azure AD, чтобы начать управление подготовкой в Slack. Если вы ранее настроили Slack для единого входа, можете использовать то же приложение. Однако при первоначальном тестировании интеграции рекомендуется создать отдельное приложение. Дополнительные сведения о добавлении приложения из коллекции см. [здесь](../manage-apps/add-application-portal.md). 

## <a name="step-3-define-who-will-be-in-scope-for-provisioning"></a>Шаг 3. Определение пользователей для включения в область подготовки 

Служба подготовки Azure AD позволяет определить пользователей, которые будут подготовлены, на основе назначения приложению и (или) атрибутов пользователя или группы. Если вы решили указать, кто именно будет подготовлен к работе в приложении, на основе назначения, можно выполнить следующие [действия](../manage-apps/assign-user-or-group-access-portal.md), чтобы назначить пользователей и группы приложению. Если вы решили указать, кто именно будет подготовлен, на основе одних только атрибутов пользователя или группы, можете использовать фильтр задания области, как описано [здесь](../app-provisioning/define-conditional-rules-for-provisioning-user-accounts.md). 

* При назначении пользователей и групп для Slack необходимо выбрать роль, отличную от роли **Доступ по умолчанию**. Пользователи с ролью "Доступ по умолчанию" исключаются из подготовки и будут помечены в журналах подготовки как не назначенные явно. Кроме того, если эта роль является единственной, доступной в приложении, можно [изменить манифест приложения](../develop/howto-add-app-roles-in-azure-ad-apps.md), чтобы добавить дополнительные роли. 

* Начните с малого. Протестируйте небольшой набор пользователей и групп, прежде чем выполнять развертывание для всех. Если в область подготовки включены назначенные пользователи и группы, проверьте этот механизм, назначив приложению одного или двух пользователей либо одну или две группы. Если в область включены все пользователи и группы, можно указать [фильтр области на основе атрибутов](../app-provisioning/define-conditional-rules-for-provisioning-user-accounts.md).

## <a name="step-4-configure-automatic-user-provisioning-to-slack"></a>Шаг 4. Настройка автоматической подготовки пользователей в Slack 

В этом разделе описывается подключение к API подготовки учетной записи пользователя Azure AD в Slack и настройка подготовки службы для создания, обновления и отмены назначения учетных записей пользователей в Slack на основе назначения пользователей и групп в Azure AD.

### <a name="to-configure-automatic-user-account-provisioning-to-slack-in-azure-ad"></a>Настройка автоматической подготовки учетных записей пользователей Azure AD в Slack.

1. Войдите на [портал Azure](https://portal.azure.com). Выберите **Корпоративные приложения**, а затем **Все приложения**.

    ![Колонка "Корпоративные приложения"](common/enterprise-applications.png)

2. В списке приложений выберите **Slack**.

    ![Ссылка на Slack в списке приложений](common/all-applications.png)

3. Выберите вкладку **Подготовка**.

    ![Снимок экрана: раздел "Управление" с выделенным параметром "Подготовка".](common/provisioning.png)

4. Для параметра **Режим подготовки к работе** выберите значение **Automatic** (Автоматически).

    ![Снимок экрана: раскрывающийся список "Режим подготовки" с выделенным параметром "Автоматически".](common/provisioning-automatic.png)

5. В разделе **Учетные данные администратора** щелкните **Авторизовать**. В новом окне браузера откроется диалоговое окно авторизации Slack.

    ![Снимок экрана с кнопкой авторизации учетных данных администратора.](media/slack-provisioning-tutorial/authorization.png)


6. В новом окне войдите в Slack с использованием учетной записи администратора группы. в открывшемся диалоговом окне авторизации выберите группу Slack, для которой необходимо включить подготовку, а затем выберите **Authorize** (Авторизовать). После завершения вернитесь на портал Azure для завершения настройки подготовки.

    ![Диалоговое окно авторизации](./media/slack-provisioning-tutorial/slackauthorize.png)

7. На портале Azure щелкните **Проверить подключение**, чтобы убедиться, что Azure AD может подключиться к приложению Slack. Если подключение отсутствует, убедитесь, что у учетной записи Slack есть права администратора группы, и повторите шаг "Авторизовать".

8. В поле **Почтовое уведомление** введите адрес электронной почты пользователя или группы, которые должны получать уведомления об ошибках подготовки, а также установите флажок **Отправить уведомление по электронной почте при сбое**.

    ![Почтовое уведомление](common/provisioning-notification-email.png)

9. Щелкните **Сохранить**.

10. В разделе сопоставления выберите **Synchronize Azure Active Directory Users to Slack** (Синхронизировать пользователей Azure Active Directory с Slack).

11. В разделе **Attribute Mappings** (Сопоставления атрибутов) следует просмотреть атрибуты пользователей, которые будут синхронизированы из Azure AD в Slack. Обратите внимание, что атрибуты, которые выбраны в качестве свойств **Matching** (Сопоставление), будут использоваться для сопоставления учетных записей пользователей в Slack для операций обновления. Нажмите кнопку "Сохранить", чтобы подтвердить все изменения.

   |attribute|Тип|
   |---|---|
   |active|Логическое|
   |externalId|Строка|
   |displayName|Строка|
   |name.familyName|Строка|
   |name.givenName|Строка|
   |title|Строка|
   |emails[type eq "work"].value|Строка|
   |userName|Строка|
   |nickName|Строка|
   |addresses[type eq "untyped"].streetAddress|Строка|
   |addresses[type eq "untyped"].locality|Строка|
   |addresses[type eq "untyped"].region|Строка|
   |addresses[type eq "untyped"].postalCode|Строка|
   |addresses[type eq "untyped"].country|Строка|
   |phoneNumbers[type eq "mobile"].value|Строка|
   |phoneNumbers[type eq "work"].value|Строка|
   |roles[primary eq "True"].value|Строка|
   |локаль|Строка|
   |name.honorificPrefix|Строка|
   |photos[type eq "photo"].value|Строка|
   |profileUrl|Строка|
   |timezone|Строка|
   |userType|Строка|
   |urn:scim:schemas:extension:enterprise:1.0.department|Строка|
   |urn:scim:schemas:extension:enterprise:1.0.manager|Справочник|
   |urn:scim:schemas:extension:enterprise:1.0.employeeNumber|Строка|
   |urn:scim:schemas:extension:enterprise:1.0.costCenter|Строка|
   |urn:scim:schemas:extension:enterprise:1.0.organization|Строка|
   |urn:scim:schemas:extension:enterprise:1.0.division|Строка|

12. В разделе **Mappings** (Сопоставления) выберите **Synchronize Azure Active Directory Groups to Slack** (Синхронизировать группы Azure Active Directory со Slack).

13. В разделе **Attribute Mappings** (Сопоставления атрибутов) следует просмотреть атрибуты групп, которые будут синхронизированы из Azure AD в Slack. Обратите внимание, что атрибуты выбран в качестве **сопоставление** свойств будет использоваться для сопоставления групп в Slack для операции обновления. Нажмите кнопку "Сохранить", чтобы подтвердить все изменения.

      |attribute|Тип|
      |---|---|
      |displayName|Строка|
      |members|Справочник|

14. Чтобы настроить фильтры области, ознакомьтесь со следующими инструкциями, предоставленными в [руководстве по фильтрам области](../app-provisioning/define-conditional-rules-for-provisioning-user-accounts.md).

15. Чтобы включить службу подготовки Azure AD для Slack, измените значение параметра **Provisioning Status** (Статус подготовки) на **On** (Включено) в разделе **Настройки**.

    ![Состояние подготовки "Включено"](common/provisioning-toggle-on.png)

16. Определите пользователей и (или) группы для подготовки в Slack, выбрав нужные значения в поле **Область** в разделе **Параметры**.

    ![Область действия подготовки](common/provisioning-scope.png)

17. Когда будете готовы выполнить подготовку, нажмите кнопку **Сохранить**.

    ![Сохранение конфигурации подготовки](common/provisioning-configuration-save.png)

После этого начнется цикл начальной синхронизации всех пользователей и групп, определенных в поле **Область** в разделе **Параметры**. Начальный цикл занимает больше времени, чем последующие циклы. Пока служба подготовки Azure AD запущена, они выполняются примерно каждые 40 минут. 

## <a name="step-5-monitor-your-deployment"></a>Шаг 5. Мониторинг развертывания
После настройки подготовки используйте следующие ресурсы для мониторинга развертывания.

1. Используйте [журналы подготовки](../reports-monitoring/concept-provisioning-logs.md), чтобы определить, какие пользователи были подготовлены успешно или неудачно.
2. Используйте [индикатор выполнения](../app-provisioning/application-provisioning-when-will-provisioning-finish-specific-user.md), чтобы узнать состояние цикла подготовки и приблизительное время до его завершения.
3. Если конфигурация подготовки, вероятно, находится в неработоспособном состоянии, приложение перейдет в карантин. Дополнительные сведения о режимах карантина см. [здесь](../app-provisioning/application-provisioning-quarantine-status.md).

## <a name="troubleshooting-tips"></a>Советы по устранению неполадок

* При настройке атрибута **displayName** в Slack возможно следующее:

  * Значения не полностью уникальны (например, у двух пользователей может быть одно и то же отображаемое имя).

  * Поддержка символов, не принадлежащих английскому языку, пробелов, разных регистров. 
  
  * Допускаются следующие знаки пунктуации: точки, символы подчеркивания, дефисы, апострофы, скобки (например, **( [ { } ] )**) и разделители (например, **, / ;**).
  
  * Свойство displayName не должно включать символ @. При наличии символа @ в журналах подготовки вы можете обнаружить пропущенное событие с описанием "AttributeValidationFailed".

  * Обновление выполняется, только если в рабочей области или организации Slack **включена синхронизации профиля** и указано, что **пользователи не могут изменять свои отображаемые имена**.

* Атрибут **userName** в Slack должен содержать до 21 символа и иметь уникальное значение.

* Slack разрешает сопоставление только с атрибутами **userName** и **email**.  
  
* Распространенные коды ошибок задокументированы в официальной документации Slack по адресу https://api.slack.com/scim#errors.

## <a name="change-log"></a>Журнал изменений

* 16.06.2020 — измененный атрибут DisplayName будет обновляться только при создании нового пользователя.

## <a name="additional-resources"></a>Дополнительные ресурсы

* [Управление подготовкой учетных записей пользователей для корпоративных приложений](../app-provisioning/configure-automatic-user-provisioning-portal.md)
* [Что такое доступ к приложениям и единый вход с помощью Azure Active Directory?](../manage-apps/what-is-single-sign-on.md)

## <a name="next-steps"></a>Дальнейшие действия

* [Сведения о просмотре журналов и получении отчетов о действиях по подготовке](../app-provisioning/check-status-user-account-provisioning.md)