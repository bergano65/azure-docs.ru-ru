---
title: Руководство по интеграции Azure Active Directory с Amazon Business | Документация Майкрософт
description: Узнайте, как настроить единый вход между Azure Active Directory и Amazon Business.
services: active-directory
author: jeevansd
manager: CelesteDG
ms.reviewer: celested
ms.service: active-directory
ms.subservice: saas-app-tutorial
ms.workload: identity
ms.topic: tutorial
ms.date: 07/16/2019
ms.author: jeedes
ms.openlocfilehash: 659cca6979a8d8be7d12c49fe01a9d0a5d7ac58e
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91713753"
---
# <a name="tutorial-integrate-amazon-business-with-azure-active-directory"></a>Руководство по интеграция Amazon Business с Azure Active Directory

В этом учебнике описано, как интегрировать Amazon Business с Azure Active Directory (Azure AD). Интеграция [Amazon Business](https://www.amazon.com/b2b/info/amazon-business?layout=landing) с Azure AD обеспечивает следующие возможности:

* Контроль доступа к Amazon Business с помощью Azure AD.
* Вы можете включить автоматический вход пользователей в Amazon Business с использованием учетных записей Azure AD.
* Централизованное управление учетными записями через портал Azure.

Чтобы узнать больше об интеграции приложений SaaS с Azure AD, прочитайте статью [Что такое доступ к приложениям и единый вход с помощью Azure Active Directory?](https://docs.microsoft.com/azure/active-directory/active-directory-appssoaccess-whatis)

## <a name="prerequisites"></a>Предварительные требования

Чтобы приступить к работе, потребуется следующее.

* Подписка Azure AD. Если у вас нет подписки, [здесь](https://azure.microsoft.com/pricing/free-trial/) вы можете получить бесплатную пробную версию сроком на один месяц.
* подписка Amazon Business с поддержкой единого входа. Перейдите на [страницу Amazon Business](https://www.amazon.com/business/register/org/landing?ref_=ab_reg_mlp), чтобы создать учетную запись Amazon Business.

## <a name="scenario-description"></a>Описание сценария

В рамках этого учебника вы настроите и проверите единый вход Azure AD в имеющейся учетной записи Amazon Business.

* Amazon Business поддерживает **единый вход**, инициированный поставщиком услуг и поставщиком удостоверений
* Amazon Business поддерживает **JIT**-подготовку пользователей

## <a name="adding-amazon-business-from-the-gallery"></a>Добавление Amazon Business из коллекции

Чтобы настроить интеграцию Amazon Business с Azure AD, необходимо добавить его из коллекции в список управляемых приложений SaaS.

1. Войдите на [портал Azure](https://portal.azure.com) с помощью личной учетной записи Майкрософт либо рабочей или учебной учетной записи.
1. В области навигации слева выберите службу **Azure Active Directory**.
1. Перейдите в колонку **Корпоративные приложения** и выберите **Все приложения**.
1. Чтобы добавить новое приложение, выберите **Новое приложение**.
1. В разделе **Добавление из коллекции** в поле поиска введите **Amazon Business**.
1. Выберите **Amazon Business** в области результатов и добавьте это приложение. Подождите несколько секунд, пока приложение не будет добавлено в ваш клиент.

## <a name="configure-and-test-azure-ad-single-sign-on"></a>Настройка и проверка единого входа в Azure AD

Настройте и проверьте единый вход Azure AD Amazon Business с помощью тестового пользователя **B.Simon**.

Чтобы настроить и проверить единый вход Azure AD в Amazon Business, потребуется выполнить действия в следующих стандартных шагах:

1. **[Настройка единого входа Azure AD](#configure-azure-ad-sso)** необходима, чтобы пользователи могли использовать эту функцию.
2. **[Настройка единого входа в Amazon Business](#configure-amazon-business-sso)** необходима, чтобы настроить параметры единого входа на стороне приложения.
3. **[Создание тестового пользователя Azure AD](#create-an-azure-ad-test-user)** требуется для проверки работы единого входа Azure AD с помощью пользователя B.Simon.
4. **[Назначение тестового пользователя Azure AD](#assign-the-azure-ad-test-user)** необходимо, чтобы позволить пользователю B.Simon использовать единый вход Azure AD.
5. **[Создание тестового пользователя Amazon Business](#create-amazon-business-test-user)** требуется, чтобы в Amazon Web Services (AWS) существовал пользователь B.Simon, связанный с одноименным пользователем в Azure AD.
6. **[Проверка единого входа](#test-sso)** позволяет убедиться в правильности конфигурации.

### <a name="configure-azure-ad-sso"></a>Настройка единого входа Azure AD

Выполните следующие действия, чтобы включить единый вход Azure AD на портале Azure.

1. На [портале Azure](https://portal.azure.com/) на странице интеграции с приложением **Amazon Business** найдите раздел **Управление** и выберите **Единый вход**.
1. На странице **Выбрать метод единого входа** выберите **SAML**.
1. На странице **Настройка единого входа с помощью SAML** щелкните значок "Изменить" (значок пера), чтобы открыть диалоговое окно **Базовая конфигурация SAML** и изменить параметры.

   ![Изменение базовой конфигурации SAML](common/edit-urls.png)

1. Если вы хотите настроить в режиме, инициируемом **поставщиком удостоверений**, в разделе **Базовая конфигурация SAML** выполните следующие действия:

    1. В текстовое поле **Идентификатор (сущности)** введите URL-адрес в следующем формате:
    
       | URL-адрес | Регион |
       |-|-|
       | `https://www.amazon.com`| Северная Америка |
       | `https://www.amazon.co.jp`| Восточная Азия |
       | `https://www.amazon.de`| Европа |

    1. В текстовом поле **URL-адрес ответа** введите URL-адрес в одном из таких форматов:
    
       | URL-адрес | Регион |
       |-|-|
       | `https://www.amazon.com/bb/feature/sso/action/3p_redirect?idpid={idpid}`| Северная Америка |
       | `https://www.amazon.co.jp/bb/feature/sso/action/3p_redirect?idpid={idpid}`| Восточная Азия |
       | `https://www.amazon.de/bb/feature/sso/action/3p_redirect?idpid={idpid}`| Европа |

       > [!NOTE]
       > Значение URL-адреса ответа приведено для примера. Вместо него нужно указать фактический URL-адрес ответа. Вы получите значение `<idpid>` из раздела конфигурации единого входа Amazon Business, как описано далее в учебнике. Можно также посмотреть шаблоны в разделе **Базовая конфигурация SAML** на портале Azure.

1. Если вам нужно настроить приложение в режиме, инициированном **поставщиком служб**, добавьте полный URL-адрес, указанный в конфигурации Amazon Business, в поле **URL-адрес для входа** в разделе **Задать дополнительные URL-адреса**.

1. На следующем снимке экрана показан список атрибутов по умолчанию. Измените атрибуты, щелкнув значок **Изменить** в разделе **User Attributes & Claims** (Утверждения и атрибуты пользователя).

    ![Снимок экрана: раздел "Атрибуты и утверждения пользователя" со значениями по умолчанию, такими как "Givenname: user.givenname" и "Emailaddress: user.mail".](media/amazon-business-tutorial/map-attribute3.png)

1. Измените атрибуты и скопируйте значение **пространства имен** этих атрибутов в Блокнот.

    ![Снимок экрана: раздел "Атрибуты и утверждения пользователя" со столбцами для имени и значения утверждения.](media/amazon-business-tutorial/map-attribute4.png)

1. В дополнение к описанному выше приложение Amazon Business ожидает несколько дополнительных атрибутов в ответе SAML. В разделе **User Attributes & Claims** (Утверждения и атрибуты пользователя) в диалоговом окне **Утверждения группы** выполните следующие действия:

    а. Щелкните **значок ручки** рядом с параметром **Группы, возвращенные в утверждении**.

    ![Снимок экрана: раздел "Атрибуты и утверждения пользователя" со значком рядом с выделенным параметром "Группы, возвращенные в утверждении".](./media/amazon-business-tutorial/config04.png)

    ![Снимок экрана: раздел "Утверждения групп" со значениями, описанными в этой процедуре.](./media/amazon-business-tutorial/config05.png)

    b. Установите переключатель **Все группы** в списке.

    c. Выберите **идентификатор группы** в качестве **исходного атрибута**.

    d. Установите флажок **Изменение имени утверждения группы** и введите имя группы в соответствии с требованиями организации.

    д) Выберите команду **Сохранить**.

1. На странице **Настройка единого входа с помощью SAML** в разделе **Сертификат подписи SAML** найдите элемент **XML метаданных** и нажмите кнопку **Скачать**, чтобы скачать сертификат и сохранить его на компьютере.

    ![Ссылка для скачивания сертификата](common/metadataxml.png)

1. Скопируйте требуемые URL-адреса из раздела **Настройка Amazon Business**.

    ![Копирование URL-адресов настройки](common/copy-configuration-urls.png)

### <a name="configure-amazon-business-sso"></a>Настройка единого входа Amazon Business

1. В другом окне веб-браузера войдите на корпоративный веб-сайт Amazon Business с правами администратора.

1. Щелкните значок **профиля пользователя** и выберите пункт **Business Settings** (Бизнес-параметры).

    ![Профиль пользователя](media/amazon-business-tutorial/user-profile.png)

1. В мастере **интеграция систем** выберите **Единый вход (SSO)** .

    ![Единый вход (SSO)](media/amazon-business-tutorial/sso-settings.png)

1. В мастере **настройки единого входа** выберите поставщика в соответствии с требованиями организации и нажмите кнопку **Next** (Далее).

    ![Снимок экрана: страница "Настройка единого входа" с выделенным элементом "Microsoft Azure AD" и кнопкой "Далее".](media/amazon-business-tutorial/default-group1.png)
    
    > [!NOTE]
    > Microsoft ADFS есть в списке параметров. Но эта система не поддерживает единый вход Azure AD.

1. В мастере **значений по умолчанию для новой учетной записи пользователя** выберите **Default Group** (Группа по умолчанию), а затем — **Default Buying Role** (Роль покупателя по умолчанию) в соответствии с ролью пользователя в организации и нажмите кнопку **Next** (Далее).

    ![Снимок экрана: страница "Значения по умолчанию для новой учетной записи пользователя" с выделенным элементом "Единый вход (Майкрософт)", параметром "Податель заявки" и кнопкой "Далее".](media/amazon-business-tutorial/dafault-group2.png)

1. В мастере **отправки файла метаданных** нажмите кнопку **Browse** (Обзор) для отправки **XML-файла метаданных**, скачанного с портала Azure, и нажмите кнопку **Upload** (Отправить).

    ![Снимок экрана: страница "Отправка файла метаданных", с которой можно перейти к XML-файлу и отправить его.](media/amazon-business-tutorial/connection-data1.png)

1. После отправки скачанного файла метаданных поля в разделе **Connection data** (Данные подключения) будут заполняться автоматически. После этого нажмите кнопку **Next** (Далее).

    ![Снимок экрана: страница "Данные подключения", где можно указать идентификатор Azure AD, URL-адрес входа и сертификат подписи SAML.](media/amazon-business-tutorial/connection-data2.png)

1. В мастере **отправка оператора атрибута** нажмите кнопку **Skip** (Пропустить).

    ![Снимок экрана: страница "Отправка оператора атрибута", с которой можно перейти к оператору атрибута, но в этом случае выбрана кнопка "Пропустить".](media/amazon-business-tutorial/map-attribute1.png)

1. В мастере **сопоставления атрибутов** добавьте поля требования, щелкнув **+Add a field** (+Добавить поле). Добавьте значения атрибутов, включая пространство имен, скопированное из раздела**User Attributes & Claims** (Атрибуты и утверждения пользователя) портала Azure в поле **SAML AttributeName** (Имя атрибута SAML) и нажмите кнопку **Next** (Далее).

    ![Снимок экрана: страница "Сопоставление атрибутов", на котором можно изменить параметры "Данные Amazon" и "Имена атрибутов SAML".](media/amazon-business-tutorial/map-attribute2.png)

1. В мастере **данных подключения Amazon** нажмите кнопку **Next** (Далее).

    ![Снимок экрана: страница "Данные подключения Amazon", где можно нажать кнопку "Далее", чтобы продолжить.](media/amazon-business-tutorial/amazon-connect.png)

1. Проверьте **состояние** настроенных шагов и нажмите кнопку **Start testing** (Начать тестирование).

    ![Снимок экрана: раздел "Сведения о подключении единого входа" с кнопкой "Начать тестирование".](media/amazon-business-tutorial/sso-connection1.png)

1. В мастере **проверки подключения единого входа** нажмите кнопку **Test** (Проверка).

    ![Снимок экрана: страница "Проверка подключения единого входа" с кнопкой "Проверить".](media/amazon-business-tutorial/sso-connection2.png)

1. В мастере **URL-адрес, инициируемый поставщиком удостоверений** перед нажатием кнопки **Activate** (Активировать) скопируйте значение, заданное для **idpid**, и вставьте его в параметр **idpid** в **URL-адресе ответа** в разделе**Базовая конфигурация SAML** на портале Azure.

    ![Снимок экрана: страница "URL-адрес, инициируемый поставщиком удостоверений", где можно получить URL-адрес, необходимый для тестирования, а затем нажать кнопку "Активировать".](media/amazon-business-tutorial/sso-connection3.png)

1. В мастере **Are you ready to switch to active SSO?** (Вы готовы переключиться на активный единый вход?) установите флажок **I have fully tested SSO and am ready to go live** (Я полностью проверил единый вход и готов к переходу в динамический режим) и нажмите кнопку **Switch to active** (Перейти в состояние "Активно").

    ![Снимок экрана: страница "Вы готовы переключиться на активный единый вход?", где можно нажать кнопку "Перейти в состояние «Активно»".](media/amazon-business-tutorial/sso-connection4.png)

1. Наконец, в разделе **SSO Connection details** (Сведения о подключении единого входа) **состояние** отображается как **Активно**.

    ![Снимок экрана: раздел "Сведения о подключении единого входа", где состояние отображается как "Активно".](media/amazon-business-tutorial/sso-connection5.png)
    
    > [!NOTE]
    > Если вам нужно настроить приложение в режиме, инициированном **поставщиком служб** выполните описанное ниже действие. Вставьте URL-адрес для входа с представленного выше снимка экрана в текстовое поле **URL-адрес для входа** в разделе **Задать дополнительные URL-адреса** на портале Azure. Используйте следующий формат:
    >
    > `https://www.amazon.<TLD>/bb/feature/sso/action/start?domain_hint=<uniqueid>`
    
### <a name="create-an-azure-ad-test-user"></a>Создание тестового пользователя Azure AD

В этом разделе описано, как на портале Azure создать тестового пользователя с именем B.Simon.

> [!NOTE]
> При необходимости администраторам нужно создать тестовых пользователей в клиенте. Ниже показано, как создать тестового пользователя.

1. На портале Azure в области слева выберите **Azure Active Directory**, **Пользователи**, а затем — **Все пользователи**.
1. В верхней части экрана выберите **Новый пользователь**.
1. В разделе **Свойства пользователя** выполните следующие действия.
   1. В поле **Имя** введите `B.Simon`.  
   1. В поле **Имя пользователя** введите username@companydomain.extension. Например, `B.Simon@contoso.com`.
   1. Установите флажок **Показать пароль** и запишите значение, которое отображается в поле **Пароль**.
   1. Нажмите кнопку **Создать**.

### <a name="create-an-azure-ad-security-group-in-the-azure-portal"></a>Создание группы безопасности на портале Azure

1. Щелкните **Azure Active Directory > Все группы**.

    ![Снимок экрана: меню портала Azure с выделенным пунктом "Azure Active Directory" и элементом "Все группы" на панели "Группы".](./media/amazon-business-tutorial/all-groups-tab.png)

1. Щелкните **Новая группа**.

    ![Снимок экрана: кнопка "Создать группу".](./media/amazon-business-tutorial/new-group-tab.png)

1. Заполните поля **Тип группы**, **Имя группы**, **Описание группы** и **Тип членства**. Щелкните стрелку, чтобы выбрать членов группы. Найдите или щелкните члена, которого необходимо добавить в группу. Щелкните **Выбрать**, чтобы добавить выбранных членов, и нажмите кнопку **Создать**.

    ![Снимок экрана: панель "Группа" с параметрами, включая параметр выбора членов и приглашения внешних пользователей.](./media/amazon-business-tutorial/group-information.png)

### <a name="assign-the-azure-ad-test-user"></a>Назначение тестового пользователя Azure AD

В этом разделе описано, как включить единый вход в Azure для пользователя B.Simon, предоставив ему доступ к Amazon Business.

1. На портале Azure выберите **Корпоративные приложения**, а затем — **Все приложения**.
1. В списке приложений выберите **Amazon Business**.
1. На странице "Обзор" приложения найдите раздел **Управление** и выберите **Пользователи и группы**.

   ![Ссылка "Пользователи и группы"](common/users-groups-blade.png)

1. Выберите **Добавить пользователя**, а в диалоговом окне **Добавление назначения** выберите **Пользователи и группы**.

    ![Снимок экрана: кнопка "Добавить пользователя".](common/add-assign-user.png)

1. В диалоговом окне **Пользователи и группы** выберите **B.Simon** в списке пользователей, а затем в нижней части экрана нажмите кнопку **Выбрать**.
1. Если ожидается, что в утверждении SAML будет получено какое-либо значение роли, то в диалоговом окне **Выбор роли** нужно выбрать соответствующую роль для пользователя из списка и затем нажать кнопку **Выбрать**, расположенную в нижней части экрана.
1. В диалоговом окне **Добавление назначения** нажмите кнопку **Назначить**.

    >[!NOTE]
    > Если вы не назначите пользователей в Azure AD, появится следующая ошибка.

    ![Снимок экрана: сообщение об ошибке, информирующее о невозможности выполнить вход.](media/amazon-business-tutorial/assign-user.png)

### <a name="assign-the-azure-ad-security-group-in-the-azure-portal"></a>Назначение группы безопасности на портале Azure

1. На портале Azure выберите **Корпоративные приложения**, **Все приложения**, а затем — **Amazon Business**.

    ![Колонка "Корпоративные приложения"](common/enterprise-applications.png)

2. В списке приложений введите и выберите **Amazon Business**.

    ![Ссылка на Amazon Business в списке приложений](common/all-applications.png)

3. В меню слева выберите **Пользователи и группы**.

    ![Ссылка "Пользователи и группы"](common/users-groups-blade.png)

4. Нажмите кнопку **Добавить пользователя**.

    ![Область "Добавление назначения"](common/add-assign-user.png)

5. Найдите группу безопасности, которую вы хотите использовать, затем щелкните ее, чтобы добавить в раздел "Выбор элементов". Щелкните **Выбрать** и нажмите кнопку **Назначить**.

    ![Поиск группы безопасности](./media/amazon-business-tutorial/assign-group.png)

    > [!NOTE]
    > Проверяйте уведомления в строке меню, чтобы узнать о том, что группа для корпоративного приложения на портале Azure успешно назначена.

### <a name="create-amazon-business-test-user"></a>Создание тестового пользователя Amazon Business

В этом разделе описано, как в приложении Amazon Business создать пользователя с именем B.Simon. Приложение Amazon Business поддерживает JIT-подготовку пользователей. Эта функция включена по умолчанию. В этом разделе никакие действия с вашей стороны не требуются. Если пользователь еще не существует в Amazon Business, он создается после проверки подлинности.

### <a name="test-sso"></a>Проверка единого входа

В этом разделе описано, как проверить конфигурацию единого входа Azure AD с помощью панели доступа.

Щелкнув плитку Amazon Business на панели доступа, вы автоматически войдете в приложение Amazon Business, для которого настроили единый вход. См. дополнительные сведения о [панели доступа](https://docs.microsoft.com/azure/active-directory/active-directory-saas-access-panel-introduction)

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Список учебников по интеграции приложений SaaS с Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-saas-tutorial-list)

- [Что такое доступ к приложениям и единый вход с помощью Azure Active Directory?](https://docs.microsoft.com/azure/active-directory/active-directory-appssoaccess-whatis)

- [Что представляет собой условный доступ в Azure Active Directory?](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)
