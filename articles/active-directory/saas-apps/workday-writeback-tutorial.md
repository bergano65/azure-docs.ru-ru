---
title: Руководство по настройке обратной записи для Workday в Azure Active Directory | Документация Майкрософт
description: Сведения о том, как настроить обратную запись из Azure AD в Workday
services: active-directory
author: cmmdesai
manager: CelesteDG
ms.service: active-directory
ms.subservice: saas-app-tutorial
ms.topic: tutorial
ms.workload: identity
ms.date: 10/14/2020
ms.author: chmutali
ms.openlocfilehash: 3a623a487dd31caf8c85b18771d90e3a6306df68
ms.sourcegitcommit: 4e70fd4028ff44a676f698229cb6a3d555439014
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "98954010"
---
# <a name="tutorial-configure-attribute-writeback-from-azure-ad-to-workday"></a>Руководство по настройке обратной записи из Azure AD в Workday
Это руководство предназначено для демонстрации процесса, который нужно выполнить для настройки обратной записи атрибутов из Azure AD в Workday. Приложение подготовки обратной записи в Workday поддерживает присвоение значений следующим атрибутам Workday:
* рабочий адрес электронной почты; 
* имя пользователя в Workday;
* номер стационарного рабочего телефона (включая код страны, код города, номер и добавочный номер);
* флаг основного номера стационарного рабочего телефона;
* номер мобильного рабочего телефона (включая код страны, код города, номер);
* флаг основного номера мобильного рабочего телефона.

## <a name="overview"></a>Обзор

Выполнив настройку интеграции входящей подготовки с помощью приложения подготовки [Workday для локальной службы AD](workday-inbound-tutorial.md) или [Workday для Azure AD](workday-inbound-cloud-only-tutorial.md), вы можете по желанию настроить в приложении Workday Writeback запись контактной информации, например рабочего адреса электронной почты и номера телефона, в Workday. 

### <a name="who-is-this-user-provisioning-solution-best-suited-for"></a>Кому это решение подготовки пользователей подходит лучше всего?

Это решение подготовки пользователей в Workday Writeback идеально подходит для:

* организаций, использующих Microsoft 365 и желающих выполнять обратную запись достоверных атрибутов, которыми управляет ИТ-служба (например, адреса электронной почты и имени пользователя), в Workday.

## <a name="configure-integration-system-user-in-workday"></a>Настройка пользователя системы интеграции в Workday

Сведения о создании учетной записи пользователя системы интеграции Workday с разрешениями на получение данных рабочих ролей см. в разделе [Настройка пользователя системы интеграции в Workday](workday-inbound-tutorial.md#configure-integration-system-user-in-workday). 

## <a name="configuring-azure-ad-attribute-writeback-to-workday"></a>Настройка обратной записи атрибута Azure AD в Workday

Ниже приведены инструкции по настройке обратной записи адресов электронной почты и имени пользователя из Azure Active Directory в Workday.

* [Добавление приложения соединителя обратной записи и создание подключения к Workday](#part-1-adding-the-writeback-connector-app-and-creating-the-connection-to-workday)
* [Настройка сопоставлений атрибутов обратной записи](#part-2-configure-writeback-attribute-mappings)
* [Включение и запуск подготовки пользователей](#enable-and-launch-user-provisioning)

### <a name="part-1-adding-the-writeback-connector-app-and-creating-the-connection-to-workday"></a>Часть 1. Добавление приложения соединителя обратной записи и создание подключения к Workday

**Настройка соединителя обратной записи Workday:**

1. Перейдите к <https://portal.azure.com>.

2. На портале Azure найдите и выберите **Azure Active Directory**.

3. Щелкните **Корпоративные приложения**, а затем — **Все приложения**.

4. Выберите **Добавить приложение**, а затем выберите категорию **Все**.

5. Выполните поиск по условию **Обратная запись Workday** и добавьте это приложение из коллекции.

6. После добавления приложения и отображения экрана сведений о приложении выберите **Подготовка**.

7. Для параметра **Режим** **подготовки к работе** выберите значение **Автоматически**.

8. В разделе **Учетные данные администратора** заполните поля следующим образом.

   * **Имя пользователя администратора** — введите имя пользователя учетной записи системы интеграции Workday с указанием имени домена клиента. Это должно выглядеть примерно так: *имя_пользователя\@contoso4*

   * **Пароль администратора** — введите пароль учетной записи системы интеграции Workday.

   * **URL-адрес клиента** — введите URL-адрес конечной точки веб-служб Workday для вашего клиента. Значение должно иметь следующий вид: `https://wd3-impl-services1.workday.com/ccx/service/contoso4/Human_Resources`, где *contoso4* заменяется правильным именем клиента, а *wd3-impl* — правильной строкой среды (если необходимо).

   * **Электронная почта для уведомлений** — введите адрес электронной почты и установите флажок "send email if failure occurs" (Отправлять по электронной почте в случае сбоя).

   * Нажмите кнопку **Проверить подключение**. Если проверка подключения выполнена успешно, нажмите кнопку **Сохранить** в верхней части. В случае неудачи дважды проверьте правильность URL-адреса и учетных данных Workday в приложении Workday.

### <a name="part-2-configure-writeback-attribute-mappings"></a>Часть 2. Настройка сопоставлений атрибутов обратной записи

В этом разделе описывается настройка потока атрибутов обратной записи из Azure AD в Workday. 

1. На вкладке "Подготовка" в разделе **Сопоставления** щелкните имя сопоставления.

2. В поле **Область исходного объекта** можно выбрать, для каких групп пользователей в Azure Active Directory нужно выполнять обратную запись. Область по умолчанию — "все пользователи в Azure AD".

3. В разделе **Сопоставление атрибутов**, обновите соответствующий идентификатор, чтобы указать атрибут в Azure Active Directory, где хранится идентификатор рабочей роли или идентификатор сотрудника для Workday. Распространенный метод сопоставления заключается в синхронизации ИД работника или ИД сотрудника Workday с extensionAttribute1-15 в Azure AD. Затем этот атрибут используется в Azure AD для обратного сопоставления пользователей в Workday.

4. Обычно сопоставляется атрибут Azure AD *userPrincipalName* с атрибутом Workday *UserID*, а атрибут *mail* Azure AD с атрибутом Workday *EmailAddress*. 

     >[!div class="mx-imgBorder"]
     >![Портал Azure](./media/workday-inbound-tutorial/workday-writeback-mapping.png)

5. Выполните приведенную ниже процедуру, чтобы сопоставить атрибуты номера телефона в Azure AD и Workday. 

     | Атрибут номера телефона Workday | Ожидаемое значение | Рекомендации по сопоставлению |
     |-------------------------|----------------|------------------|
     | WorkphoneLandlineIsPrimary | true/false | Константа или выражение сопоставления, которые возвращают строковое значение true или false. |
     | WorkphoneLandlineCountryCodeName | [Трехсимвольный код страны по стандарту ISO 3166-1](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3) | Сопоставление констант или выражений, которое возвращает трехсимвольный код страны. |
     | WorkphoneLandlineCountryCodeNumber | [Международный телефонный код страны](https://en.wikipedia.org/wiki/List_of_country_calling_codes) | Сопоставление констант или выражений, которое возвращает допустимы телефонный код страны (без символа +). |
     | WorkphoneLandlineNumber | Полный номер телефона, включая код города | Сопоставляется с атрибутом *telephoneNumber*. С помощью регулярных выражений следует удалить все пробелы, скобки и код страны. См. пример ниже. |
     | WorkphoneLandlineExtension | Добавочный номер | Если атрибут *telephoneNumber* содержит добавочный номер, извлеките его с помощью регулярного выражения. |
     | WorkphoneMobileIsPrimary | true/false | Сопоставление констант или сопоставление выражений, которое возвращает строковое значение true или false. |
     | WorkphoneMobileCountryCodeName | [Трехсимвольный код страны по стандарту ISO 3166-1](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3) | Сопоставление констант или выражений, которое возвращает трехсимвольный код страны. |
     | WorkphoneMobileCountryCodeNumber | [Международный телефонный код страны](https://en.wikipedia.org/wiki/List_of_country_calling_codes) | Сопоставление констант или выражений, которое возвращает допустимы телефонный код страны (без символа +). |
     | WorkphoneMobileNumber | Полный номер телефона, включая код города | Сопоставляется с атрибутом *mobile*. С помощью регулярных выражений следует удалить все пробелы, скобки и код страны. См. пример ниже. |

     > [!NOTE]
     > При вызове веб-службы Change_Work_Contact в Workday служба Azure AD отправляет следующие значения констант: <br>
     > * **Communication_Usage_Type_ID** с постоянным строковым значением WORK. <br>
     > * **Phone_Device_Type_ID** с постоянным строковым значением Mobile для номеров мобильных телефонов и Landline для номеров стационарных телефонов. <br>
     > 
     > Вы столкнетесь с ошибками обратной записи, если арендатор Workday использует другие идентификаторы типа. Чтобы избежать таких ошибок, примените задачу Workday **Maintain Reference IDs** (Обслуживание ссылочных идентификаторов) и измените значения Type_ID (Идентификатор типа) так, чтобы они соответствовали значениям в Azure AD. <br>
     >  

     **Справка по регулярным выражениям — пример 1**

     Используйте приведенное ниже регулярное выражение, если номер телефона в Azure AD задан в формате службы "Самостоятельный сброс пароля (SSPR)". <br>
     Например, для номера телефона +1 1112223333 это регулярное выражение возвращает значение 1112223333.

     ```C#
     Replace([telephoneNumber], , "\\+(?<isdCode>\\d* )(?<phoneNumber>\\d{10})", , "${phoneNumber}", , )
     ```

     **Справка по регулярным выражениям — пример 2**

     Используйте приведенное ниже регулярное выражение, если номер телефона в Azure AD задан в формате (XXX) XXX-XXXX. <br>
     Например, для номера телефона (111) 222-3333 это регулярное выражение возвращает значение 1112223333.

     ```C#
     Replace([mobile], , "[()\\s-]+", , "", , )
     ```

6. Чтобы сохранить сопоставления, щелкните **Сохранить** в верхней части раздела "Сопоставление атрибутов".

## <a name="enable-and-launch-user-provisioning"></a>Включение и запуск подготовки пользователей

После завершения настройки приложения подготовки Workday можно включить службу подготовки на портале Azure.

> [!TIP]
> По умолчанию при включении службы подготовки она инициализирует операции подготовки для всех пользователей в области. При наличии ошибок в сопоставлении или проблем с данными Workday задание подготовки может завершиться ошибкой и перейти в состояние карантина. Чтобы избежать этого, рекомендуется настроить фильтр **Область исходного объекта** и протестировать сопоставления атрибутов с несколькими тестовыми пользователями перед запуском полной синхронизации всех пользователей. После проверки работоспособности сопоставлений и получения желаемых результатов можно либо удалить фильтр, либо постепенно расширять его, добавляя больше пользователей.

1. На вкладке **Подготовка** установите для параметра **Состояние подготовки** значение **Вкл**.

1. В раскрывающемся списке **Область** выберите **Синхронизация всех пользователей и групп**. Если выбран этот вариант, приложение Writeback будет выполнять обратную запись сопоставленных атрибутов для всех пользователей из Azure AD в Workday с учетом правил области, определенных в поле **Сопоставления** -> **Область исходного объекта**. 

   > [!div class="mx-imgBorder"]
   > ![Выбор области для приложения Writeback](./media/sap-successfactors-inbound-provisioning/select-writeback-scope.png)

   > [!NOTE]
   > Приложение подготовки Workday Writeback не поддерживает вариант **Синхронизация только назначенных пользователей и групп**.
 

2. Выберите команду **Сохранить**.

3. Будет запущена начальная синхронизация, которая может занять несколько часов в зависимости от количества пользователей в исходном каталоге. Ход выполнения цикла синхронизации можно проверить на индикаторе выполнения для отслеживания. 

4. В любой момент можно проверить вкладку **Журналы подготовки** на портале Azure, чтобы узнать, какие действия выполнила служба подготовки. Эти журналы аудита содержат список всех событий синхронизации, которые выполнены службой подготовки, в том числе они содержат сведения о том, какие пользователи импортируются из исходного каталога и экспортируются в целевое приложение.  

5. После завершения первичной синхронизации на вкладке **Подготовка** будет предоставлен сводный отчет, как показано ниже.

     > [!div class="mx-imgBorder"]
     > ![Индикатор выполнения подготовки](./media/sap-successfactors-inbound-provisioning/prov-progress-bar-stats.png)

## <a name="known-issues-and-limitations"></a>Известные проблемы и ограничения

* Приложение Writeback использует заранее определенные значения для параметров **Communication_Usage_Type_ID** и **Phone_Device_Type_ID**. Если в вашем арендаторе Workday для этих атрибутов используются другие значения, операцию обратной записи выполнить не удастся. В качестве обходного решения мы предлагаем изменить идентификаторы типа (Type_ID) в Workday. 
* Если в приложении Writeback настроено обновление дополнительных номеров телефона, оно не заменяет уже существующие дополнительные номера телефонов в Workday. Оно всегда добавляет в запись о сотруднике еще один дополнительный номер телефона. Для этого поведения не существует обходного решения. 


## <a name="next-steps"></a>Дальнейшие действия

* [Дополнительные сведения о сценариях интеграции Azure AD и Workday и о вызовах веб-служб](../app-provisioning/workday-integration-reference.md)
* [Сведения о просмотре журналов и получении отчетов о действиях по подготовке](../app-provisioning/check-status-user-account-provisioning.md)
* [Узнайте, как настроить единый вход Azure Active Directory в Workday](workday-tutorial.md).
* [Узнайте, как интегрировать другие приложения SaaS с Azure Active Directory](tutorial-list.md).
* [Узнайте, как экспортировать и импортировать конфигурации подготовки.](../app-provisioning/export-import-provisioning-configuration.md)

