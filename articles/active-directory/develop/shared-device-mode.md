---
title: Режим общего устройства для устройств Android | Службы
description: Сведения о режиме общего устройства, который позволяет фирстлине работникам совместно использовать устройство Android
services: active-directory
documentationcenter: dev-center-name
author: mmacy
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 1/15/2020
ms.author: marsma
ms.reviwer: hahamil
ms.custom: aaddev, identityplatformtop40
ms.openlocfilehash: 9928b64d286cc5072f28f7cc17e4af3e95662cd0
ms.sourcegitcommit: cfbea479cc065c6343e10c8b5f09424e9809092e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "77085616"
---
# <a name="shared-device-mode-for-android-devices"></a>Режим совместной работы с устройством Android

> [!NOTE]
> Эта функция предоставляется в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Фирстлине работники, такие как розничные связи, участники сотрудников и сотрудники службы полей, часто используют общее мобильное устройство для работы. Это создает проблемы, когда они начинают совместно использовать пароли или ПИН-коды для доступа к данным клиентов и бизнес-данных на общем устройстве.

Режим общего устройства позволяет настроить устройство Android, чтобы его можно было легко предоставить нескольким сотрудникам. Сотрудники могут быстро входить в систему и получать доступ к информации о клиентах. Когда они закончат свою смену или задачу, они могут выйти из устройства, и они будут немедленно готовы к использованию следующим сотрудником.

Режим общего устройства также предоставляет Microsoft Identity Management для устройства.

Чтобы создать приложение в режиме общего устройства, разработчики и администраторы облачных устройств работают вместе:

- Разработчики пишут приложение с одной учетной записью (приложения с несколькими учетными записями не поддерживаются в режиме общего устройства), добавляют `"shared_device_mode_supported": true` в конфигурацию приложения и пишут код для выполнения таких операций, как выход из общего устройства.
- Администраторы устройств подготавливают устройство к совместному использованию, устанавливая приложение проверки подлинности и настроив устройство в общем режиме с помощью приложения Authenticator. Только пользователи, которые входят в роль [администратора облачных устройств](https://docs.microsoft.com/azure/active-directory/users-groups-roles/directory-assign-admin-roles#cloud-device-administrator) , могут перевести устройство в общий режим с помощью [приложения для проверки подлинности](https://docs.microsoft.com/azure/active-directory/user-help/user-help-auth-app-overview). Членство в ролях Организации можно настроить в портал Azure с помощью: **Azure Active Directory** > **ролей и администраторов** > **администратора облачных устройств**.

 В этой статье основное внимание уделяется разработчикам.

## <a name="single-vs-multiple-account-applications"></a>Одно приложение с несколькими учетными записями VS

Приложения, написанные с помощью пакета SDK библиотеки проверки подлинности (Майкрософт) (MSAL), могут управлять одной или несколькими учетными записями. Дополнительные сведения см. в разделе [режим с одной учетной записью или режим с несколькими учетными записями](https://docs.microsoft.com/azure/active-directory/develop/single-multi-account). Функции платформы идентификации Майкрософт, доступные для приложения, зависят от того, выполняется ли приложение в режиме одной или нескольких учетных записей.

**Приложения в режиме общего устройства работают только в режиме одной учетной записи**.

> [!IMPORTANT]
> Приложения, поддерживающие режим с несколькими учетными записями, не могут выполняться на общем устройстве. Если сотрудник загружает приложение, которое не поддерживает режим с одной учетной записью, оно не будет выполняться на общем устройстве.
>
> Приложения, написанные до выпуска пакета SDK для MSAL, были выпущены в режиме с несколькими учетными записями и должны быть обновлены для поддержки однопользовательского режима, прежде чем они смогут работать на устройстве с общим режимом.

**Поддержка одной учетной записи и нескольких учетных записей**

Приложение может быть создано для поддержки работы на личных устройствах и на общих устройствах. Если приложение в настоящее время поддерживает несколько учетных записей и вы хотите поддерживать режим общего устройства, добавьте поддержку для одного режима учетной записи.

Вам также может потребоваться изменить поведение приложения в зависимости от типа устройства, на котором оно выполняется. Используйте `ISingleAccountPublicClientApplication.isSharedDevice()`, чтобы определить, когда следует запускать в режиме одной учетной записи.

Существует два разных интерфейса, представляющих тип устройства, на котором установлено приложение. При запросе экземпляра приложения из фабрики приложений MSAL правильный объект приложения предоставляется автоматически.

Следующая объектная модель иллюстрирует тип объекта, который вы можете получить, и то, что он означает в контексте общего устройства:

![модель наследования общедоступных клиентских приложений](media/v2-shared-device-mode/ipublic-client-app-inheritance.png)

При получении объекта `PublicClientApplication` необходимо выполнить проверку типа и привести к соответствующему интерфейсу. Следующий код проверяет режим с несколькими учетными записями или одиночную учетную запись и приводит объект приложения соответствующим образом:

```java
private IPublicClientApplication mApplication;

        // Running in personal-device mode?
        if (mApplication instanceOf IMultipleAccountPublicClientApplication) {
          IMultipleAccountPublicClientApplication multipleAccountApplication = (IMultipleAccountPublicClientApplication) mApplication;
          ...
        // Running in shared-device mode?
        } else if (mApplication instanceOf ISingleAccountPublicClientApplication) {
           ISingleAccountPublicClientApplication singleAccountApplication = (ISingleAccountPublicClientApplication) mApplication;
            ...
        }
```

В зависимости от того, работает ли приложение на общем или личном устройстве, применяются следующие отличия.

|  | Устройство общего режима  | Личное устройство |
|---------|---------|---------|
| **Измерение счетов**     | Одна учетная запись | Несколько учетных записей |
| **Вход** | Global | Global |
| **Выход** | Global | Каждое приложение может контролировать, является ли выход локальным для приложения или для семейства приложений. |
| **Поддерживаемые типы учетных записей** | Только рабочие учетные записи | Персональные и рабочие учетные записи поддерживаются  |

## <a name="why-you-may-want-to-only-support-single-account-mode"></a>Почему может потребоваться поддержка только одной учетной записи

Если вы создаете приложение, которое будет использоваться только для рабочих ролей фирстлине, использующих общее устройство, рекомендуется написать приложение для поддержки только одной учетной записи. Это относится к большинству приложений, ориентированных на задачи, например к приложениям для учета медицинских записей и выставления счетов, а также к большинству бизнес-приложений. Только поддержка режима одной учетной записи упрощает разработку, поскольку не требуется реализовывать дополнительные функции, которые являются частью приложений с несколькими учетными записями.

## <a name="what-happens-when-the-device-mode-changes"></a>Что происходит при изменении режима устройства

Если приложение работает в режиме с несколькими учетными записями и администратор помещает устройство в режиме общего устройства, все учетные записи на устройстве удаляются из приложения, а приложение переходит в режим с одной учетной записью.

## <a name="shared-device-sign-out-and-the-overall-app-lifecycle"></a>Выход из общего устройства и общий жизненный цикл приложения

При выходе пользователя необходимо принять меры для защиты конфиденциальности и данных пользователя. Например, если вы создаете приложение для медицинских записей, необходимо убедиться, что при выходе пользователя из ранее отображаемых записей пациент очищаются. Приложение должно быть подготовлено к работе и проверяться при каждом входе в передний план.

Когда приложение использует MSAL для выхода пользователя из приложения, работающего на устройстве в общем режиме, учетная запись для входа и кэшированные токены удаляются как из приложения, так и с устройства.

На следующей схеме показан общий жизненный цикл приложения и общие события, которые могут возникнуть во время выполнения приложения. Схема охватывает время запуска действия, вход и выход из учетной записи, а также то, как события, такие как приостановка, возобновление и остановка действия, помещаются в.

![Жизненный цикл приложения общего устройства](media/v2-shared-device-mode/lifecycle.png)

## <a name="next-steps"></a>Дальнейшие действия

Попробуйте [использовать режим общего устройства в приложении Android](tutorial-v2-shared-device-mode.md) , в котором показано, как запустить фирстлине рабочее приложение на устройстве Android с общим режимом.
