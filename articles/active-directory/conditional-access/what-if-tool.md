---
title: Средство What If условного доступа — Azure Active Directory
description: Узнайте, как можно понять влияние политик условного доступа в вашей среде.
services: active-directory
ms.service: active-directory
ms.subservice: conditional-access
ms.topic: conceptual
ms.date: 06/22/2020
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: nigu
ms.collection: M365-identity-device-management
ms.openlocfilehash: db76ec2bc2fc8640214f962a809fee559b4c4af3
ms.sourcegitcommit: e69bb334ea7e81d49530ebd6c2d3a3a8fa9775c9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2020
ms.locfileid: "88948204"
---
# <a name="troubleshoot-using-the-what-if-tool-in-conditional-access"></a>Устранение неполадок с условным доступом с помощью средства What If

[Условный доступ](./overview.md) — это возможность Azure Active Directory (Azure AD), которая позволяет управлять доступом полномочных пользователей к облачным приложениям. Как узнать, что следует рассчитывать на основе политик условного доступа в вашей среде? Чтобы ответить на этот вопрос, можно использовать **средство What If условного доступа**.

В этой статье объясняется, как можно использовать это средство для проверки политик условного доступа.

## <a name="what-it-is"></a>Что это

**Средство политики What If условного доступа** позволяет понять влияние политик условного доступа в среде. Вместо того, чтобы тестировать политики, выполняя несколько входов вручную, можно воспользоваться данным инструментом, чтобы имитировать вход пользователя. При имитации оценивается влияние входа на политики и создается отчет об имитации. В отчете не только перечисляются примененные политики условного доступа, но и [классические политики](policy-migration.md#classic-policies) , если они существуют.    

Средство **What If** предоставляет способ быстрого определения политик, применяемых к конкретному пользователю. Эти сведения можно использовать, например, если необходимо устранить проблему.    

## <a name="how-it-works"></a>Принцип работы

В **средстве What If условного доступа**необходимо сначала настроить параметры сценария входа, который требуется имитировать. Эти параметры приведены ниже:

- пользователь, которого необходимо проверить; 
- облачные приложения, к которым пользователь попытается получить доступ;
- условия, при которых осуществляется доступ к настроенным облачным приложениям.
     
В качестве следующего шага можно запустить имитацию, чтобы проверить выбранные параметры. В оценке участвуют только включенные политики.

По завершении оценки инструмент создает отчет о задействованных политиках. Чтобы получить дополнительные сведения о политике условного доступа, [книга "аналитика и отчеты" условного доступа](howto-conditional-access-insights-reporting.md) может предоставить дополнительные сведения о политиках в режиме "только отчет" и о включенных в данный момент политиках.

## <a name="running-the-tool"></a>Запуск инструмента

Средство **What If** можно найти на странице **[Условный доступ — политики](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)** в портал Azure.

Чтобы запустить средство, на панели инструментов в верхней части списка политик щелкните **What If**.

![What If](./media/what-if-tool/01.png)

Прежде чем можно будет выполнить оценку, необходимо настроить параметры.

## <a name="settings"></a>Параметры

В этом разделе приводятся сведения о параметрах имитации.

![What If](./media/what-if-tool/02.png)

### <a name="user"></a>Пользователь

Можно выбрать только одного пользователя. Это единственное обязательное поле.

### <a name="cloud-apps"></a>Облачные приложения

Значение по умолчанию для этого параметра — **Все облачные приложения**. При значении по умолчанию выполняется оценка всех доступных политик в вашей среде. Можно сузить область оценки до политик, влияющих на конкретные облачные приложения.

### <a name="ip-address"></a>IP-адрес

IP-адрес — это отдельный IPv4-адрес, необходимый для имитации [условия расположения](location-condition.md). Адрес представляет веб-адрес устройства, используемого пользователем для входа. Можно проверить IP-адрес устройства, например, перейдя по ссылке [What is my IP address](https://whatismyipaddress.com) (Определить мой IP-адрес).    

### <a name="device-platforms"></a>Платформы устройств

Этот параметр имитирует [условие платформы устройства](concept-conditional-access-conditions.md#device-platforms) и представляет эквивалент параметра **Все платформы (в том числе и неподдерживаемые)**. 

### <a name="client-apps"></a>Клиентские приложения

Этот параметр имитирует [условие клиентских приложений](concept-conditional-access-conditions.md#client-apps).
По умолчанию этот параметр вызывает оценку всех политик, для которых выбран параметр **Браузер** или **Мобильные приложения и настольные клиенты** (или оба эти параметра). Он также позволяет обнаружить политики, которые принудительно используют **Exchange ActiveSync (EAS)**. Область этого параметра можно сузить, выбрав:

- **Браузер** для оценки всех политик, для которых выбран по крайней мере параметр **Браузер**; 
- **Мобильные приложения и настольные клиенты** для оценки всех политик, для которых выбран по крайней мере параметр **Мобильные приложения и настольные клиенты**. 

### <a name="sign-in-risk"></a>Риск при входе

Этот параметр имитирует [условие риска при входе](concept-conditional-access-conditions.md#sign-in-risk).   

## <a name="evaluation"></a>Ознакомительная версия 

Чтобы начать оценку, нажмите кнопку **What If**. После оценки предоставляется отчет, содержащий: 

![What If](./media/what-if-tool/03.png)

- индикатор существования классических политик в вашей среде;
- политики, которые применяются к вашему пользователю;
- политики, которые не применяются к вашему пользователю.

Если для выбранных облачных приложений существуют [классические политики](policy-migration.md#classic-policies), то отчет содержит соответствующий индикатор. Щелкнув этот индикатор, можно перейти на страницу классических политик. На странице классических политик можно перенести классическую политику или просто отключить ее. Закрыв эту страницу, можно вернуться к результату оценки.

В списке политик, применяемых к выбранному пользователю, можно также найти список [элементов управления предоставлением](concept-conditional-access-grant.md) и [управления сеансами](concept-conditional-access-session.md) , которым должен соответствовать пользователь.

В списке политик, которые не применяются к пользователю, можно также найти причины, по которым эти политики не применяются. Для каждой из перечисленных политик причина представляет первое условие, которое не было выполнено. Возможной причиной для политики, которая не применяется, является отключение политики ввиду того, что она в дальнейшем не оценивается.   

## <a name="next-steps"></a>Следующие шаги

- Дополнительные сведения о приложении политики условного доступа можно найти с помощью режима "только отчет", в котором используется [Условный доступ Insights и отчеты](howto-conditional-access-insights-reporting.md).
- Если вы готовы к настройке политик условного доступа для своей среды, см. раздел [Общие политики условного доступа](concept-conditional-access-policy-common.md).