---
title: Учебник по массовому приглашению пользователей B2B для совместной работы в Azure AD
description: Из этого руководства вы узнаете, как с помощью PowerShell и CSV-файла отправлять массовые приглашения для внешних пользователей службы совместной работы Azure AD B2B.
services: active-directory
ms.service: active-directory
ms.subservice: B2B
ms.topic: tutorial
ms.date: 05/07/2020
ms.author: mimart
author: msmimart
manager: celestedg
ms.reviewer: mal
ms.collection: M365-identity-device-management
ms.openlocfilehash: f0f88b310bc00881e66ee8e8b5f2d40616d60315
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "87907038"
---
# <a name="tutorial-bulk-invite-azure-ad-b2b-collaboration-users"></a>Руководство по Массовое приглашение пользователей службы совместной работы Azure Active Directory B2B

Если вы используете службу совместной работы Azure Active Directory (Azure AD) B2B для работы с внешними партнерами, вы можете одновременно пригласить несколько гостевых пользователей к вашей организации. Из этого руководства вы узнаете, как с помощью портала Azure выполнять массовую отправку приглашений внешним пользователям. В частности, вы выполните описанные ниже действия:

> [!div class="checklist"]
> * с помощью функции **Массовая отправка приглашений пользователям** подготовите файл с разделителями-запятыми (.csv), который содержит данные о пользователях и параметрах приглашения;
> * отправите этот CSV-файл в AAD.
> * убедитесь, что пользователи добавлены в каталог.

Если у вас нет учетной записи AAD, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="understand-the-csv-template"></a>Сведения о шаблоне CSV

Скачайте и заполните шаблон CSV для массовой отправки, чтобы успешно приглашать гостевых пользователей AAD в пакетном режиме. Загружаемый шаблон CSV будет похож на этот пример:

![Электронная таблица для отправки со сносками, которые поясняют смысл каждой строки и столбца и значений в них](media/tutorial-bulk-invite/understand-template.png)

### <a name="csv-template-structure"></a>Структура шаблона CSV

В скачанном шаблоне CSV содержатся следующие строки.

- **Номер версии**: Первая строка с номером версии должна сохраняться в отправляемой версии CSV-файла.
- **Заголовки столбцов**. Формат заголовков столбцов: &lt;*имя элемента*&gt; [ИмяСвойства] &lt;*Required или пусто*&gt;. Например, `Email address to invite [inviteeEmail] Required`. Некоторые старые версии шаблона могут иметь небольшие отличия.
- **Строка примеров**. Мы включили в шаблон строку с примерами допустимых значений для каждого столбца. Строку примеров необходимо удалить, заменив реальными значениями.

### <a name="additional-guidance"></a>Дополнительные рекомендации

- Первые две строки шаблона отправки нельзя удалять или изменять, иначе отправка не будет обработана.
- Обязательные столбцы перечислены первыми.
- Мы не рекомендуем добавлять в шаблон новые столбцы. Любые дополнительные столбцы игнорируются и не обрабатываются.
- Мы рекомендуем скачивать свежие версии шаблона CSV как можно чаще.

## <a name="prerequisites"></a>Предварительные требования

Требуется две или больше тестовых учетных записей электронной почты, с которых можно отправлять приглашения. Учетные записи должны находиться за пределами вашей организации. Вы можете использовать любой тип учетной записи, включая учетные записи социальных сетей, такие как адреса gmail.com или outlook.com.

## <a name="invite-guest-users-in-bulk"></a>Массовая отправка приглашений гостевым пользователям

1. Войдите на портал Azure с учетной записью администратора пользователей в организации.
2. В области навигации выберите **Azure Active Directory**.
3. В разделе **Управление** последовательно выберите **Пользователи** > **Массовое приглашение**.
4. На странице **Массовое приглашение пользователей** выберите действие **Скачать**, чтобы получить готовый CSV-файл со свойствами для приглашения.

    ![Кнопка скачивания данных для массовой отправки приглашений](media/tutorial-bulk-invite/bulk-invite-button.png)

5. Откройте CSV-файл шаблона и добавьте в него строку для каждого гостевого пользователя. Ниже перечислены обязательные параметры.

   * **Адрес электронной почты для приглашения** обозначает пользователя, который получит приглашение.

   * **URL-адрес перенаправления** — это URL-адрес, на который перенаправляется приглашенный пользователь после принятия приглашения.

    ![Пример CSV-файла с введенными данными о гостевых пользователях](media/tutorial-bulk-invite/bulk-invite-csv.png)

   > [!NOTE]
   > Не используйте запятые в поле **Настраиваемое сообщение с приглашением**, так как с ними сообщение будет обработано неправильно.

6. Сохраните файл.
7. На странице **Массовая отправка приглашений пользователям** найдите нужный файл в разделе **Отправка CSV-файла**. При выборе файла запускается проверка CSV-файла. 
8. После проверки содержимого файла вы увидите сообщение **Файл успешно передан**. Если будут обнаружены ошибки, их нужно исправить для отправки задания.
9. Когда файл пройдет проверку, щелкните **Отправить**, чтобы запустить групповую операцию Azure, с помощью которой добавляются приглашения. 
10. Чтобы просмотреть состояние задания, выберите **Щелкните здесь, чтобы просмотреть состояние каждой операции**. Также можно выбрать **Результаты групповой операции** в разделе **Действия**. Чтобы получить подробные сведения о каждом элементе групповой операции, выберите значения в столбцах **# Success** (Количество успешных), **# Failure** (Количество неудачных) или **Всего запросов**. При возникновении сбоя здесь будут указаны его причины.

    ![Пример результатов групповой операции](media/tutorial-bulk-invite/bulk-operation-results.png)

11. По завершении задания поступит уведомление о том, что групповая операция выполнена успешно.

## <a name="verify-guest-users-in-the-directory"></a>Проверка гостевых пользователей в каталоге

Убедитесь, что добавленные гостевые пользователи есть в каталоге, с помощью портала Azure или PowerShell.

### <a name="view-guest-users-in-the-azure-portal"></a>Просмотр гостевых пользователей на портале Azure

1. Войдите на портал Azure с учетной записью администратора пользователей в организации.
2. В области навигации выберите **Azure Active Directory**.
3. В разделе **Управление** выберите **Пользователи**.
4. В разделе **Показать** выберите **Только пользователи-гости** и убедитесь, что отображаются только что добавленные пользователи.

### <a name="view-guest-users-with-powershell"></a>Просмотр гостевых пользователей с помощью PowerShell

Выполните следующую команду:

```powershell
 Get-AzureADUser -Filter "UserType eq 'Guest'"
```

Вы должны увидеть приглашенных пользователей в списке с именем участника-пользователя (UPN) в формате *emailaddress*#EXT#\@*domain*. Например *lstokes_fabrikam.com#EXT#\@contoso.onmicrosoft.com*, где contoso.onmicrosoft.com — это организация, из которой отправляется приглашение.

## <a name="clean-up-resources"></a>Очистка ресурсов

Когда тестовая учетная запись пользователя станет не нужна, ее можно будет удалить из каталога на странице "Пользователи" портала Azure. Для этого нужно установить флажок рядом с гостевым пользователем и щелкнуть **Удалить**. 

Кроме того, для удаления учетной записи пользователя можно выполнить следующую команду PowerShell:

```powershell
 Remove-AzureADUser -ObjectId "<UPN>"
```

Например: `Remove-AzureADUser -ObjectId "lstokes_fabrikam.com#EXT#@contoso.onmicrosoft.com"`

## <a name="next-steps"></a>Дальнейшие действия

С помощью этого руководства вы отправили массовые приглашения гостевым пользователям за пределами своей организации. Затем узнайте, как работает процесс активации приглашения.

> [!div class="nextstepaction"]
> [Активация приглашения службы совместной работы Azure Active Directory B2B](redemption-experience.md)
