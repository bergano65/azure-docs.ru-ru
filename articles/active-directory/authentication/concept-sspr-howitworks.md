---
title: Самостоятельный сброс пароля — Azure Active Directory
description: Как работает самостоятельный сброс пароля.
services: active-directory
ms.service: active-directory
ms.subservice: authentication
ms.topic: conceptual
ms.date: 12/07/2020
ms.author: justinha
author: justinha
manager: daveba
ms.reviewer: rhicock
ms.collection: M365-identity-device-management
ms.openlocfilehash: e5bcc6503af5f5f685ee589ed7671b4715834fef
ms.sourcegitcommit: 8b4b4e060c109a97d58e8f8df6f5d759f1ef12cf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/07/2020
ms.locfileid: "96779368"
---
# <a name="how-it-works-azure-ad-self-service-password-reset"></a>Как это работает: самостоятельный сброс пароля в Azure AD

Самостоятельный сброс пароля (SSPR) в Azure Active Directory (AAD) позволяет пользователям изменить или сбросить пароль без участия администратора или службы технической поддержки. Если учетная запись пользователя заблокирована или пользователь забыл пароль, выполнив несложные инструкции, он сможет выполнить разблокировку и вернуться к работе. Эта возможность снижает количество обращений в службу технической поддержки и минимизирует время простоя из-за невозможности войти на устройство или в приложение.

> [!IMPORTANT]
> Эта статья описывает администратора, как работает самостоятельный сброс пароля. Если вы уже зарегистрировались для самостоятельного сброса пароля и хотите вернуться в учетную запись, перейдите по адресу [https://aka.ms/sspr](https://aka.ms/sspr) .
>
> Если ваша группа ИТ пока не включила возможность самостоятельно сбрасывать пароль, обратитесь за помощью в службу поддержки.

## <a name="how-does-the-password-reset-process-work"></a>Как работает процесс сброса пароля?

Пользователь может сбросить или изменить пароль с помощью [портала SSPR](https://aka.ms/sspr). Сначала они должны зарегистрировать нужные методы проверки подлинности. Когда пользователь обращается к порталу SSPR, Платформа Azure считает следующие факторы:

* язык страницы;
* допустимость учетной записи;
* организация, к которой принадлежит пользователь;
* Где осуществляется управление паролем пользователя?
* наличие лицензии на использование функции.

Когда пользователь выбирает ссылку **не удается получить доступ к своей учетной записи** из приложения или страницы или переходит непосредственно к [https://aka.ms/sspr](https://passwordreset.microsoftonline.com) , язык, используемый на портале SSPR, основан на следующих параметрах:

* По умолчанию языковой стандарт браузера используется для вывода SSPR на соответствующем языке. Процедура сброса пароля локализована на те же языки, которые [Microsoft 365 поддерживает](https://support.microsoft.com/office/what-languages-is-office-available-in-26d30382-9fba-45dd-bf55-02ab03e2a7ec).
* Если вы хотите создать ссылку на SSPR на определенном локализованном языке, добавьте `?mkt=` в конец URL-адреса сброса пароля вместе с требуемым языковым стандартом.
    * Например, чтобы указать языковой стандарт испанской *es-US* , используйте `?mkt=es-us`  -  [https://passwordreset.microsoftonline.com/?mkt=es-us](https://passwordreset.microsoftonline.com/?mkt=es-us) .

После отображения портала SSPR на требуемом языке пользователю будет предложено ввести идентификатор пользователя и передать CAPTCHA. Теперь Azure AD проверяет, может ли пользователь использовать SSPR, выполняя следующие проверки:

* Проверяет, что у пользователя включен SSPR и ему назначена лицензия Azure AD.
  * Если пользователь не включен для SSPR или не имеет назначенной лицензии, пользователю предлагается обратиться к администратору для сброса пароля.
* Проверяет наличие у пользователя соответствующих методов проверки подлинности, определенных в его учетной записи в соответствии с политикой администратора.
  * Если для политики требуется только один метод, убедитесь, что у пользователя есть соответствующие данные, определенные по крайней мере для одного из методов проверки подлинности, включенных политикой администратора.
    * Если методы проверки подлинности не настроены, пользователю рекомендуется обратиться к администратору для сброса пароля.
  * Если для политики требуются два метода, убедитесь, что у пользователя есть соответствующие данные, определенные по крайней мере для двух методов проверки подлинности, включенных политикой администратора.
    * Если методы проверки подлинности не настроены, пользователю рекомендуется обратиться к администратору для сброса пароля.
  * Если пользователю назначается роль администратора Azure, применяется строгая двухфакторная политика паролей. Дополнительные сведения см. в разделе [Различия политики сброса администратора](concept-sspr-policy.md#administrator-reset-policy-differences).
* Проверяет, управляет ли пароль пользователя локальным, например, если клиент Azure AD использует федеративный, сквозную проверку подлинности или синхронизацию хэшей паролей:
  * Если настроена обратная запись SSPR и управление паролем пользователя осуществляется локально, пользователю разрешается продолжать проверку подлинности и сбросить пароль.
  * Если функция обратной записи SSPR не развернута и управление паролем пользователя осуществляется локально, пользователю предлагается обратиться к администратору для сброса пароля.

Если все предыдущие проверки успешно выполнены, пользователь проходит через процесс сброса или изменения пароля.

> [!NOTE]
> SSPR может отправлять пользователям уведомления по электронной почте в рамках процесса сброса пароля. Эти сообщения электронной почты отправляются с помощью службы ретранслятора SMTP, работающей в режиме "активный — активный" в нескольких регионах.
>
> Службы ретранслятора SMTP получают и обрабатывают текст электронной почты, но не сохраняют их. Текст сообщения электронной почты SSPR, который потенциально может содержать сведения, предоставленные клиентом, не хранится в журналах службы ретранслятора SMTP. В журналах содержатся только метаданные протокола.

Чтобы приступить к работе с SSPR, выполните инструкции из следующего руководства.

> [!div class="nextstepaction"]
> [Учебник. Включение самостоятельного сброса пароля (SSPR)](tutorial-enable-sspr.md)


## <a name="require-users-to-register-when-they-sign-in"></a>Запрос регистрации пользователей при входе

Вы можете включить параметр, чтобы требовать от пользователя завершить регистрацию SSPR, если они входят в любые приложения, использующие Azure AD. К этому рабочему процессу относятся следующие приложения:

* Microsoft 365
* Портал Azure
* Панель доступа
* федеративные приложения;
* пользовательские приложения, использующие Azure AD.

Если регистрация не требуется, пользователи не получают запрос во время входа в систему, но их можно зарегистрировать вручную. Пользователи могут посетить [https://aka.ms/ssprsetup](https://aka.ms/ssprsetup) или выбрать ссылку **Регистрация для сброса пароля** на вкладке **профиль** на панели доступа.

![Параметры регистрации для SSPR в портал Azure][Registration]

> [!NOTE]
> Пользователи могут закрыть портал регистрации SSPR, нажав **кнопку Отмена** или закрыв окно. Однако они получают запрос на регистрацию при каждом входе, пока они не завершат регистрацию.
>
> Это прерывание для регистрации в SSPR не нарушает подключение пользователя, если оно уже зарегистрировано.

## <a name="reconfirm-authentication-information"></a>Подтверждение сведений о проверке подлинности

Чтобы убедиться в правильности методов проверки подлинности, когда требуется сбросить или изменить пароль, можно потребовать от пользователей подтвердить зарегистрированную информацию по истечении определенного периода времени. Этот параметр доступен только в том случае, если включен параметр **требовать регистрацию пользователей при входе в** систему.

Допустимые значения, по которым пользователю предлагается подтвердить, что зарегистрированные методы находятся в *диапазоне от 0* до *730* дней. Установка этого значения равным *0* означает, что пользователям не будет предложено подтвердить данные проверки подлинности.

## <a name="authentication-methods"></a>методы проверки подлинности;

Если пользователь включен для SSPR, он должен зарегистрировать по крайней мере один метод проверки подлинности. Настоятельно рекомендуется выбрать два или более метода проверки подлинности, чтобы обеспечить большую гибкость пользователей в случае, если они не смогут получить доступ к одному из них, когда они им понадобятся. Дополнительные сведения см. в статье [что такое методы проверки подлинности?](concept-authentication-methods.md).

Для SSPR доступны следующие методы проверки подлинности:

* Уведомление от мобильного приложения
* Код мобильного приложения
* Адрес электронной почты
* Мобильный телефон
* Рабочий телефон
* Контрольные вопросы

Пользователи могут сбрасывать пароль только в том случае, если они зарегистрировали метод проверки подлинности, включенный администратором.

> [!WARNING]
> Назначенные учетным записям роли *администратора* Azure необходимы для использования методов, описанных в разделе [различия политики сброса администратором](concept-sspr-policy.md#administrator-reset-policy-differences).

![Выбор методов проверки подлинности в портал Azure][Authentication]

### <a name="number-of-authentication-methods-required"></a>Необходимое количество методов проверки подлинности

Можно настроить количество доступных методов проверки подлинности, которые пользователь должен предоставить для сброса или снятия блокировки пароля. Это значение можно задать как *один* или *два*.

Пользователи могут, а также регистрировать несколько методов проверки подлинности. И опять же, мы настоятельно рекомендуем, чтобы пользователи регистрировали два или более метода проверки подлинности, чтобы обеспечить большую гибкость в случае, если они не смогут получить доступ к одному методу.

Если у пользователя нет минимального числа обязательных методов, зарегистрированных при попытке использовать SSPR, они увидят страницу ошибки, которая направляет им запрос на сброс пароля администратором. Следите за тем, чтобы увеличить число требуемых методов от одного до двух, если у вас есть зарегистрированные пользователи для SSPR и они не смогут использовать эту функцию. Дополнительные сведения см. в следующем разделе, посвященном [изменению методов проверки подлинности](#change-authentication-methods).

#### <a name="mobile-app-and-sspr"></a>Мобильное приложение и SSPR

При использовании мобильного приложения в качестве метода сброса пароля, например приложения Microsoft Authenticator, следует учитывать следующие моменты.

* Когда администраторы требуют использовать один метод для сброса пароля, применение кода проверки является единственным доступным вариантом.
* Когда администраторам требуется использовать два метода для сброса пароля, пользователи могут использовать код уведомления **или** проверки в дополнение к любым другим включенным методам.

| Число требуемых способов сброса | Один | Два |
| :---: | :---: | :---: |
| Доступные функции мобильного приложения | Код | Код или уведомление |

У пользователей нет возможности зарегистрировать мобильное приложение при регистрации для самостоятельного сброса пароля из [https://aka.ms/ssprsetup](https://aka.ms/ssprsetup) . Пользователи могут зарегистрировать свое мобильное приложение по адресу [https://aka.ms/mfasetup](https://aka.ms/mfasetup) или в общей регистрации сведений о безопасности по адресу [https://aka.ms/setupsecurityinfo](https://aka.ms/setupsecurityinfo) .

> [!IMPORTANT]
> Приложение Authenticator не может быть выбрано в качестве единственного метода проверки подлинности, если требуется только метод. Аналогично, приложение Authenticator и только один дополнительный метод не могут быть выбраны, если требуется два метода.
>
> При настройке политик SSPR, включающих приложение Authenticator в качестве метода, необходимо выбрать по крайней мере один дополнительный метод, если требуется один метод, и при настройке двух методов необходимо выбрать по крайней мере два дополнительных метода.
>
> Это требование связано с тем, что текущая процедура регистрации SSPR не включает возможность регистрации приложения для проверки подлинности. Возможность регистрации приложения для проверки подлинности включается в новую [объединенную процедуру регистрации](./concept-registration-mfa-sspr-combined.md).
>
> Разрешение политик, использующих только приложение для проверки подлинности (если требуется один метод) или приложение для проверки подлинности и только один дополнительный метод (если требуются два метода), может привести к блокированию регистрации пользователей для SSPR до тех пор, пока они не будут настроены для использования новой функции регистрации.

### <a name="change-authentication-methods"></a>Изменение методов проверки подлинности

Что случится, если начать с политики, в которой зарегистрирован только один обязательный метод проверки подлинности для сброса или разблокировки, а затем изменить его на два?

| Число зарегистрированных методов | Число обязательных методов | Результат |
| :---: | :---: | :---: |
| 1 или более | 1 | **Есть возможность** сброса или разблокировки |
| 1 | 2 | **Нет возможности** сброса или разблокировки |
| минимум 2 | 2 | **Есть возможность** сброса или разблокировки |

Изменение доступных методов проверки подлинности также может вызвать проблемы для пользователей. Если изменить типы методов проверки подлинности, которые доступны пользователю, то можно непреднамеренно заблокировать ему возможность использовать SSPR. Это произойдет, если у пользователя не будет минимального объема доступных данных.

Рассмотрим следующий пример сценария:

1. Настроена исходная политика с двумя методами проверки подлинности. Она использует только номер рабочего телефона и контрольные вопросы.
1. Администратор изменяет политику таким образом, чтобы больше не использовались контрольные вопросы, а использовались номер мобильного телефона и запасной адрес электронной почты.
1. Пользователи без заполненного мобильного телефона или дополнительных полей электронной почты не могут сбрасывать свои пароли.

## <a name="notifications"></a>Уведомления

Чтобы улучшить осведомленность о событиях паролей, SSPR позволяет настраивать уведомления как для пользователей, так и для администраторов удостоверений.

### <a name="notify-users-on-password-resets"></a>"Уведомлять пользователей о сбросе пароля"

Если для этого параметра задано значение **Да**, пользователи, устанавливающие пароль, получают по электронной почте уведомление о том, что пароль был изменен. Сообщение электронной почты отправляется через портал SSPR на основной и запасной адрес электронной почты, хранящиеся в Azure AD. Больше это уведомление никому не отправляется.

### <a name="notify-all-admins-when-other-admins-reset-their-passwords"></a>"Уведомлять всех администраторов, если другие администраторы сбрасывают свои пароли"

Если для этого параметра задано значение **Да**, все остальные администраторы Azure получат электронное письмо по его основному адресу электронной почты, хранящемуся в Azure AD. В сообщении будет указано, что другой администратор изменил пароль с помощью SSPR.

Рассмотрим следующий пример сценария:

* В среде есть 4 администратора.
* Администратор *а* сбрасывает пароль с помощью SSPR.
* Администраторы *B*, *C* и *D* получают по электронной почте уведомления о сбросе пароля.

## <a name="on-premises-integration"></a>Интеграция с локальной средой

При наличии гибридной среды можно настроить Azure AD Connect для записи событий изменения пароля обратно из Azure AD в локальный каталог.

![Проверка включения обратной записи паролей включена и работает][Writeback]

Azure AD проверяет текущее гибридное подключение и предоставляет одно из следующих сообщений в портал Azure:

* Локальный клиент обратной записи работает.
* "Служба Azure AD Connect работает и подключена к локальному клиенту обратной записи. Похоже, однако, что установленная версия Azure AD Connect устарела. [Обновите Azure AD Connect](../hybrid/how-to-upgrade-previous-version.md), чтобы использовать новые функции подключения и получить важные исправления ошибок".
* К сожалению, не удается проверить состояние локального клиента обратной записи, так как установленная версия Azure AD Connect устарела. [Обновите Azure AD Connect](../hybrid/how-to-upgrade-previous-version.md), чтобы проверить состояние подключения".
* "Сейчас не удается подключиться к локальному клиенту обратной записи. [Устраните неполадки с Azure AD Connect](./troubleshoot-sspr-writeback.md), чтобы восстановить подключение".
* "Не удается подключиться к локальному клиенту обратной записи, так как обратная запись пароля не настроена. [Настройте обратную запись пароля](./tutorial-enable-sspr-writeback.md), чтобы восстановить подключение".
* "Сейчас не удается подключиться к локальному клиенту обратной записи. Возможно, дело во временных проблемах с нашей стороны. Если ошибка сохраняется, [устраните неполадки с Azure AD Connect](./troubleshoot-sspr-writeback.md), чтобы восстановить подключение".

Чтобы приступить к работе с обратной записью SSPR, ознакомьтесь со следующим руководством.

> [!div class="nextstepaction"]
> [Руководство. Включение обратной записи при самостоятельном сбросе пароля (SSPR)](./tutorial-enable-sspr-writeback.md)

### <a name="write-back-passwords-to-your-on-premises-directory"></a>"Включить обратную запись паролей в локальный каталог"

Включить обратную запись паролей можно с помощью портал Azure. Можно также временно отключить обратную запись паролей без необходимости перенастройки Azure AD Connect.

* Если для параметра задано значение **Да**, обратная запись включена. Федеративные пользователи, сквозная проверка подлинности или синхронизация с помощью хэша паролей, могут сбрасывать свои пароли.
* Если параметр имеет значение **No**, обратная запись отключена. Федеративные, сквозная проверка подлинности или пользователи с синхронизацией хэша паролей не могут сбрасывать свои пароли.

### <a name="allow-users-to-unlock-accounts-without-resetting-their-password"></a>Разрешить пользователям разблокировать учетные записи без сброса пароля

По умолчанию Azure AD разблокирует учетные записи при выполнении сброса пароля. Для обеспечения гибкости можно разрешить пользователям разблокировать локальные учетные записи без необходимости сбрасывать их пароли. Используйте этот параметр, чтобы разделить эти две операции.

* Если задано значение **Да**, пользователям предоставляется возможность сбросить пароль и разблокировать учетную запись или разблокировать учетную запись без сброса пароля.
* Если задано значение **нет**, пользователи смогут выполнять только операцию сброса пароля и разблокировки учетной записи.

### <a name="on-premises-active-directory-password-filters"></a>Фильтры паролей локальной службы Active Directory

SSPR выполняет эквивалент сброса пароля, инициированного администратором, в Active Directory. Если вы используете фильтр паролей стороннего производителя для применения настраиваемых правил паролей и вам требуется, чтобы этот фильтр паролей проверялся во время самостоятельного сброса пароля Azure AD, убедитесь, что решение для фильтрации паролей стороннего производителя настроено для применения в сценарии сброса пароля администратора. [Защита паролей Azure AD для домен Active Directory Services](concept-password-ban-bad-on-premises.md) поддерживается по умолчанию.

## <a name="password-reset-for-b2b-users"></a>Сброс пароля для пользователей B2B

Сброс и изменение пароля полностью поддерживается во всех конфигурациях B2B. Сброс паролей для пользователей B2B поддерживается в трех случаях:

* **Пользователи из партнерской организации с существующим клиентом Azure AD**. Если организация, с которой вы являетесь партнером, имеет существующего клиента Azure AD, мы будем использовать все политики сброса паролей, включенные для этого клиента. Для работы сброса паролей партнерская организация должна убедиться в том, что SSPR включен в Azure AD. Дополнительная плата за Microsoft 365 клиентов не взимается.
* **Пользователи, которые подписываются с помощью** самостоятельной регистрации. Если организация, с которой вы сотрудничаете, использует функцию [самостоятельной регистрации](../enterprise-users/directory-self-service-signup.md) , чтобы войти в клиент, мы добавим пароль в ответ на зарегистрированный адрес электронной почты.
* **Пользователи B2B**. все новые пользователи B2B, созданные с помощью новых [возможностей Azure AD B2B](../external-identities/what-is-b2b.md) , также могут сбрасывать пароли с учетом электронной почты, зарегистрированной в процессе приглашения.

Чтобы протестировать данный сценарий, перейдите на сайт https://passwordreset.microsoftonline.com под одним из этих пользователей-партнеров. Если они определили дополнительный адрес электронной почты или адрес электронной почты для проверки подлинности, сброс паролей будет работать должным образом.

> [!NOTE]
> Учетные записи Майкрософт, которым предоставлен гостевой доступ к вашему клиенту Azure AD, такие как Hotmail.com, Outlook.com или другие личные адреса электронной почты, не могут использовать Azure AD SSPR. Им потребуется сбросить свой пароль, как описано в статье [Не удается войти в учетную запись Майкрософт](https://support.microsoft.com/help/12429/microsoft-account-sign-in-cant).

## <a name="next-steps"></a>Дальнейшие действия

Чтобы приступить к работе с SSPR, выполните инструкции из следующего руководства.

> [!div class="nextstepaction"]
> [Учебник. Включение самостоятельного сброса пароля (SSPR)](tutorial-enable-sspr.md)

Дополнительные сведения о сбросе пароля с помощью Azure AD см. в следующих статьях:

[Authentication]: ./media/concept-sspr-howitworks/manage-authentication-methods-for-password-reset.png "Доступные методы проверки подлинности Azure AD и требуемое число методов"
[Registration]: ./media/concept-sspr-howitworks/configure-registration-options.png "Настройка параметров регистрации SSPR в портал Azure"
[Writeback]: ./media/concept-sspr-howitworks/on-premises-integration.png "Локальная интеграция для SSPR в портал Azure"