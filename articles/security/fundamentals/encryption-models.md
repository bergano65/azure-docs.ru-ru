---
title: Модели шифрования данных в Microsoft Azure
description: В этой статье приводятся общие сведения о моделях шифрования данных в Microsoft Azure.
services: security
documentationcenter: na
author: msmbaldwin
manager: rkarlin
ms.assetid: 9dcb190e-e534-4787-bf82-8ce73bf47dba
ms.service: security
ms.subservice: security-fundamentals
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/09/2020
ms.author: mbaldwin
ms.openlocfilehash: 836e01d3cd8fb25dda1616803d8b6f3e9ff4e06f
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "89645756"
---
# <a name="data-encryption-models"></a>Модели шифрования данных

Знакомство с различными моделями шифрования, их преимуществами и недостатками необходимо для понимания реализации шифрования неактивных данных в Azure различными поставщиками ресурсов. Эти определения являются общими для всех поставщиков ресурсов в Azure для обеспечения общей среды и таксономии.

Существует три сценария для шифрования на стороне сервера:

- Шифрование на стороне сервера с помощью управляемых службой ключей
  - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
  - ключами управляет Майкрософт;
  - все возможности облака.

- Шифрование на стороне сервера с помощью управляемых пользователем ключей в Azure Key Vault:
  - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
  - пользователь управляет ключами через Azure Key Vault;
  - все возможности облака.

- Шифрование на стороне сервера с использованием администрируемых пользователем ключей на управляемом пользователем оборудовании:
  - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
  - пользователь администрирует ключи на управляемом оборудовании;
  - все возможности облака.

Модели шифрования на стороне сервера относятся к шифрованию, выполняемому службой Azure. В этой модели поставщик ресурсов выполняет операции шифрования и расшифровки. Например, служба хранилища Azure может получать данные посредством простых текстовых операций, а затем выполнять внутренние шифрование и расшифровку. Поставщик ресурсов может использовать ключи шифрования, управляемые Майкрософт или пользователем, в зависимости от конфигурации.

![Сервер](./media/encryption-models/azure-security-encryption-atrest-fig3.png)

Каждая из моделей шифрования неактивных данных на стороне сервера подразумевает отличные характеристики управления ключами, в частности то, где и как создаются и хранятся ключи шифрования, а также модели доступа и процедуры смены ключей.  

Для шифрования на стороне клиента учтите следующее:

- расшифрованные данные недоступны службам Azure;
- управление ключами и их хранение доступно в локальной среде или других безопасных хранилищах. Ключи недоступны для служб Azure
- возможности облака ограничены.

Поддерживаемые модели шифрования в Azure делятся на две основные группы: "шифрование клиента" и "шифрование на стороне сервера", как упоминалось ранее. Независимо от используемой модели шифрования неактивных данных службы Azure всегда рекомендуют использовать безопасный канал транспорта, например TLS или HTTPS. Таким образом, шифрование на транспортном уровне должно определяться транспортным протоколом и не должно быть основным фактором при определении используемой модели шифрования неактивных данных.

## <a name="client-encryption-model"></a>Модель шифрования клиентом

Модель шифрования клиентом — это шифрование, выполняемое службой или вызывающим приложением за пределами поставщика ресурсов или Azure. Это шифрование можно выполнить с помощью приложения службы в Azure или приложения, работающего в центре обработки данных пользователя. В любом случае при использовании этой модели шифрования поставщик ресурсов Azure принимает зашифрованный большой двоичный объект данных без возможности расшифровки этих данных каким-либо образом, а также без доступа к ключам шифрования. В этой модели ключами управляют вызывающие приложение или служба. Этот процесс является непрозрачным для службы Azure.

![Клиент](./media/encryption-models/azure-security-encryption-atrest-fig2.png)

## <a name="server-side-encryption-using-service-managed-keys"></a>Шифрование на стороне сервера с помощью управляемых службой ключей

Для многих пользователей существенным требованием является гарантия шифрования неактивных данных. Шифрование на стороне сервера с помощью управляемых службой ключей позволяет реализовать эту модель, давая пользователям возможность помечать конкретный ресурс (учетную запись хранения, базу данных SQL и т. д.) для шифрования и передает все аспекты управления ключами, например выдачу, смену и резервное копирование ключей, корпорации Майкрософт. Большинство служб Azure, поддерживающих шифрование неактивных данных, обычно поддерживают эту модель для разгрузки управления ключами шифрования в Azure. Поставщик ресурсов Azure создает ключи и помещает их в надежное хранилище, извлекая их при необходимости. Это означает, что служба имеет полный доступ к ключам и полностью контролирует жизненный цикл учетных данных.

![Управляемые](./media/encryption-models/azure-security-encryption-atrest-fig4.png)

Таким образом, шифрование на стороне сервера с помощью управляемых службой ключей быстро выполняет шифрование неактивных данных с низкими издержками для пользователя. Откройте целевую подписку и поставщика ресурсов на портале Azure и установите флажок, указывающий, что данные требуется зашифровать. В некоторых диспетчерах ресурсов шифрование на стороне сервера с помощью управляемых службой ключей включено по умолчанию.

Шифрование на стороне сервера с помощью ключей, управляемых Майкрософт, подразумевает, что служба имеет полный доступ к хранению ключей и управлению ими. Хотя некоторые пользователи хотят управлять ключами, так как они считают, что они получат больше безопасности, при оценке такой модели следует учитывать затраты и риски, связанные с использованием пользовательского хранилища ключей. Во многих случаях организация может решить, что нехватка ресурсов или риски, связанные с локальным решением, превышают риски облачного управления ключами шифрования неактивных данных.  Однако эта модель может оказаться недостаточной для организаций, имеющих требования для управления созданием или жизненным циклом ключей шифрования, а также для того, чтобы различные сотрудники управляли ключами шифрования службы, чем Управление службой (то есть разделение управления ключами из общей модели управления для службы).

### <a name="key-access"></a>Доступ к ключам

При использовании шифрования на стороне сервера с ключами, управляемыми службой, созданием и хранением ключей, а также доступом к ним службами управляет служба. Как правило, основные поставщики ресурсов Azure хранят ключи шифрования данных в хранилище рядом с данными для быстрого доступа, в то время как ключи шифрования ключей хранятся в защищенном внутреннем хранилище.

**Преимущества**

- Простая настройка.
- Корпорация Майкрософт управляет сменой, резервным копированием и избыточностью ключей.
- Пользователь не несет затраты, связанные с реализацией, и для него нет риска использования пользовательской схемы управления ключами.

**Недостатки**

- Пользователь не управляет ключами шифрования (спецификацией, жизненным циклом, отзывом ключей и т. д.).
- Отсутствует возможность отделить управление ключами от общей модели управления для службы.

## <a name="server-side-encryption-using-customer-managed-keys-in-azure-key-vault"></a>Шифрование на стороне сервера с помощью управляемых пользователем ключей в Azure Key Vault:

Для сценариев, в которых требуется шифровать неактивные данные и управлять ключами шифрования, можно использовать шифрование на стороне сервера с помощью управляемых пользователем ключей в хранилище ключей. Некоторые службы могут хранить корневой ключ шифрования ключей в Azure Key Vault и хранить зашифрованный ключ шифрования данных во внутреннем расположении рядом с данными. В таком сценарии пользователи могут переносить свои собственные ключи (BYOK) в хранилище ключей или создать ключи и использовать их для шифрования нужных ресурсов. Пока поставщик ресурсов выполняет операции шифрования и расшифровки, он использует настроенный ключ шифрования ключа в качестве корневого ключа для всех операций шифрования.

Потери ключей шифрования ключа означают потери данных. По этой причине ключи не должны удаляться. Необходимо создавать резервные копии ключей при создании или вращении. [Обратимое удаление](https://docs.microsoft.com/azure/key-vault/key-vault-ovw-soft-delete) должно быть включено в любом хранилище, в котором хранятся ключи шифрования ключей. Вместо удаления ключа задайте для параметра Enabled значение false или задайте дату окончания срока действия.

### <a name="key-access"></a>Доступ к ключам

В модели шифрования на стороне сервера с хранением в Azure Key Vault ключей, управляемых пользователем, служба при необходимости получает доступ к ключам для шифрования и расшифровки. Ключи для шифрования неактивных данных становятся доступными для службы благодаря политике управления доступом. Эта политика предоставляет службе доступ на основе удостоверения для получения ключа. Службу Azure, запущенную от имени связанной подписки, можно настроить с помощью удостоверения в рамках этой подписки. Служба может выполнять проверку подлинности Azure Active Directory и получать токен проверки подлинности, идентифицируя себя как службу, которая действует от имени подписки. Затем этот токен может быть предоставлен хранилищу ключей для получения ключа, доступ к которому был получен.

Для операций с использованием ключей шифрования удостоверению службы можно предоставить доступ к любой из следующих операций: расшифровка, шифрование, упаковка, распаковка, проверка, подписывание, получение, перечисление, обновление, создание, импорт, удаление, резервное копирование и восстановление.

Чтобы получить ключ для шифрования или расшифровки неактивных данных, удостоверение службы, запущенное экземпляром службы диспетчера ресурсов, должно иметь ключ распаковки (чтобы получить ключ для расшифровки) и ключ упаковки (чтобы вставить ключ в хранилище ключей при создании нового ключа).

>[!NOTE]
>Дополнительные сведения об авторизации в хранилище ключей см. в статье [Защита хранилища ключей](../../key-vault/general/secure-your-key-vault.md).

**Преимущества**

- Полный контроль над используемыми ключами — управление ключами шифрования осуществляется в Key Vault клиента под управлением клиента.
- Возможность шифрования нескольких служб с помощью главного ключа.
- Возможность отделить управление ключами от общей модели управления для службы.
- Возможность определить службу и расположение ключа в нескольких регионах.

**Недостатки**

- Пользователь полностью отвечает за управление доступом к ключам.
- Пользователь полностью отвечает за управление жизненным циклом ключей.
- Дополнительные издержки в процессе установки и конфигурации.

## <a name="server-side-encryption-using-customer-managed-keys-in-customer-controlled-hardware"></a>Шифрование на стороне сервера с помощью управляемых клиентом ключей в оборудовании, управляемом клиентом

Некоторые службы Azure допускают использование модели управления с размещением собственного ключа (HYOK). Этот режим управления полезен в сценариях, когда необходимо зашифровать неактивных данные и управлять ключами в собственном репозитории за пределами системы управления Майкрософт. В этой модели службе необходимо получить ключ с внешнего сайта. Что в результате оказывает влияние на производительность и гарантии доступности, а конфигурация усложняется. Кроме того, так как служба имеет доступ к ключу шифрования данных во время операции шифрования и расшифровки, общие гарантии безопасности этой модели аналогичны модели, в которой ключами управляют пользователи в Azure Key Vault.  В результате эта модель не подходит для большинства организаций, если они не имеют конкретных требований к управлению ключами. Из-за этих ограничений большинство служб Azure не поддерживают шифрование на стороне сервера с помощью управляемых сервером ключей на оборудовании, управляемом клиентом.

### <a name="key-access"></a>Доступ к ключам

При использовании шифрования на стороне сервера с помощью управляемых службой ключей в аппаратно-управляемом оборудовании ключи сохраняются в системе, настроенной клиентом. Службы Azure, которые поддерживают эту модель, предоставляют средства для создания безопасного подключения к хранилищу ключей, предоставленному пользователем.

**Преимущества**

- Полный контроль над корневым ключом. Ключи шифрования управляются в хранилище пользователя.
- Возможность шифрования нескольких служб с помощью главного ключа.
- Возможность отделить управление ключами от общей модели управления для службы.
- Возможность определить службу и расположение ключа в нескольких регионах.

**Недостатки**

- Полная ответственность за хранение ключей, безопасность, производительность и доступность.
- Полная ответственность за управление доступом к ключам.
- Полная ответственность за управление жизненным циклом ключей.
- Значительные расходы на установку, настройку и текущее обслуживание.
- Повышенная зависимость от доступности сети между центрами обработки данных Azure и центром обработки данных пользователя.

## <a name="supporting-services"></a>Вспомогательные службы
Службы Azure, поддерживающие каждую модель шифрования:

| Продукт, функция или услуга | На стороне сервера с помощью управляемого службой ключа   | Server-Side с помощью Customer-Managed ключа | Client-Side с помощью Client-Managed ключа  |
|----------------------------------|--------------------|-----------------------------------------|--------------------|
| **ИИ и Машинное обучение**      |                    |                    |                    |
| Когнитивный поиск Azure           | Да                | Да                | -                  |
| Azure Cognitive Services         | Да                | Да                | -                  |
| Машинное обучение Azure           | Да                | Да                | -                  |
| Студия машинного обучения Azure    | Да                | 2048-разрядный RSA (предварительная версия) | -               |
| Content Moderator                | Да                | Да                | -                  |
| Распознавание лиц                             | Да                | Да                | -                  |
| Распознавание речи           | Да                | Да                | -                  |
| Персонализатор                     | Да                | Да                | -                  |
| QnA Maker                        | Да                | Да                | -                  |
| Службы "Речь"                  | Да                | Да                | -                  |
| Перевод текстов                  | Да                | Да                | -                  |
| Power BI                         | Да                | Да, RSA 4096-bit  | -                  |
| **Аналитика**                    |                    |                    |                    |
| Azure Stream Analytics           | Да                | Недоступно\*              | -                  |
| Центры событий                       | Да                | Да                | -                  |
| Функции                        | Да                | Да                | -                  |
| Службы Azure Analysis Services          | Да                | -                  | -                  |
| Каталог данных Azure               | Да                | -                  | -                  |
| Azure HDInsight                  | Да                | All                | -                  |
| Azure Monitor Application Insights | Да                | Да                | -                  |
| Azure Monitor Log Analytics      | Да                | Да                | -                  |
| Azure Data Explorer              | Да                | Да                | -                  |
| Фабрика данных Azure               | Да                | Да                | -                  |
| Хранилище озера данных Azure            | Да                | Да, 2048-разрядный RSA  | -                  |
| **Контейнеры**                   |                    |                    |                    |
| Служба Azure Kubernetes         | Да                | Да                | -                  |
| Экземпляры контейнеров              | Да                | Да                | -                  |
| Реестр контейнеров               | Да                | Да                | -                  |
| **Compute**                      |                    |                    |                    |
| Виртуальные машины                 | Да                | Да                | -                  |
| Масштабируемый набор виртуальных машин        | Да                | Да                | -                  |
| SAP HANA                         | Да                | Да                | -                  |
| Служба приложений                      | Да                | Да\*\*            | -                  |
| Служба автоматизации                       | Да                | Да\*\*            | -                  |
| Функции Azure                  | Да                | Да\*\*            | -                  |
| Портал Azure                     | Да                | Да\*\*            | -                  |
| Logic Apps                       | Да                | Да                | -                  |
| Приложения, управляемые Azure       | Да                | Да\*\*            | -                  |
| Служебная шина                      | Да                | Да                | -                  |
| Site Recovery                    | Да                | Да                | -                  |
| **Базы данных**                    |                    |                    |                    |
| SQL Server на виртуальных машинах   | Да                | Да                | Да                |
| База данных SQL Azure               | Да                | Да, RSA 3072-bit  | Да                |
| База данных SQL Azure для MariaDB   | Да                | -                  | -                  |
| База данных SQL Azure для MySQL     | Да                | Да                | -                  |
| База данных SQL Azure для PostgreSQL | Да               | Да                | -                  |
| Azure Synapse Analytics          | Да                | Да, RSA 3072-bit  | -                  |
| SQL Server Stretch Database      | Да                | Да, RSA 3072-bit  | Да                |
| Хранилище таблиц                    | Да                | Да                | Да                |
| Azure Cosmos DB                  | Да                | Да                | -                  |
| Azure Databricks                 | Да                | Да                | -                  |
| Azure Database Migration Service | Да                | Недоступно\*              | -                  |
| **DevOps**                       |                    |                    |                    |
| Azure DevOps Services            | Да                | -                  | Да                |
| Azure Repos                      | Да                | -                  | Да                |
| **Удостоверение**                     |                    |                    |                    |
| Azure Active Directory           | Да                | -                  | -                  |
| Доменные службы Azure Active Directory | Да          | Да                | -                  |
| **Интеграция**                  |                    |                    |                    |
| Служебная шина                      | Да                | Да                | Да                |
| Сетка событий Azure                       | Да                | -                  | -                  |
| Управление API                   | Да                | -                  | -                  |
| **Службы Интернета вещей**                 |                    |                    |                    |
| Центр Интернета вещей                          | Да                | Да                | Да                |
| Подготовка устройств к добавлению в центр Интернета вещей      | Да                | Да                | -                  |
| **Управление**    |                    |                    |                    |
| Azure Site Recovery              | Да                | -                  | -                  |
| Служба "Миграция Azure"                    | Да                | Да                | -                  |
| **Носитель**                        |                    |                    |                    |
| Службы мультимедиа                   | Да                | -                  | Да                |
| **Безопасность**                     |                    |                    |                    |
| Центр безопасности Azure для Интернета вещей    | Да                | Да                | -                  |
| Azure Sentinel                   | Да                | Да                | -                  |
| **Память**                      |                    |                    |                    |
| Хранилище BLOB-объектов                     | Да                | Да                | Да                |
| Хранилище BLOB-объектов класса Premium             | Да                | Да                | Да                |
| Хранилище дисков                     | Да                | Да                | -                  |
| Ultra Хранилище дисков               | Да                | Да                | -                  |
| Управляемый Хранилище дисков             | Да                | Да                | -                  |
| Хранилище файлов                     | Да                | Да                | -                  |
| Хранилище файлов класса Premium             | Да                | Да                | -                  |
| Синхронизация файлов Azure                        | Да                | Да                | -                  |
| Хранилище очередей                    | Да                | Да                | Да                |
| Avere vFXT                       | Да                | -                  | -                  |
| Кэш Redis для Azure            | Да                | Недоступно\*              | -                  |
| Azure NetApp Files               | Да                | Да                | -                  |
| Архивное хранилище                  | Да                | Да                | -                  |
| StorSimple                       | Да                | Да                | Да                |
| Azure Backup                     | Да                | Да                | Да                |
| Data Box                         | Да                | -                  | Да                |
| Data Box Edge                    | Да                | Да                | -                  |

\* Эта служба не сохраняет данные. Временные кэши, если они есть, шифруются с помощью ключа Microsoft.

\*\* Эта служба поддерживает хранение данных в собственной Key Vault, учетной записи хранения или другой сохраняемой службе данных, которая уже поддерживает Server-Sideное шифрование с помощью ключа Customer-Managed.

## <a name="next-steps"></a>Дальнейшие шаги

- Узнайте [, как используется шифрование в Azure](encryption-overview.md).
- Узнайте, как Azure использует [двойное шифрование](double-encryption.md) для устранения угроз, поступающих от шифрования данных.
