---
title: Аварийное восстановление для Фармбеатс
description: В этой статье описывается, как восстановление данных защищает от потери данных.
author: uhabiba04
ms.topic: article
ms.date: 04/13/2020
ms.author: v-umha
ms.openlocfilehash: bdd59d078da1df021b7e23ec858ba7305f72cfa1
ms.sourcegitcommit: 419c8c8061c0ff6dc12c66ad6eda1b266d2f40bd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/18/2020
ms.locfileid: "92164216"
---
# <a name="disaster-recovery-for-farmbeats"></a>Аварийное восстановление для Фармбеатс

Восстановление данных позволяет избежать потери данных в таких событиях, как сворачивание региона Azure. В таком случае можно запустить отработку отказа и восстановить данные, хранящиеся в развертывании Фармбеатс.

Восстановление данных не является функцией по умолчанию в Azure Фармбеатс. Эту функцию можно настроить вручную, настроив необходимые ресурсы Azure, используемые Фармбеатс для хранения данных в парном регионе Azure. Используйте активный – пассивный подход, чтобы включить восстановление.

В следующих разделах приведены сведения о настройке восстановления данных в Azure Фармбеатс.

- [Включить избыточность данных](#enable-data-redundancy)
- [Восстановление службы из оперативной резервной копии](#restore-service-from-online-backup)


## <a name="enable-data-redundancy"></a>Включить избыточность данных

Фармбеатс хранит данные в трех службах первого производителя Azure, которые представляют собой **хранилище Azure**, **Cosmos DB** и **аналитику временных рядов**. Чтобы включить избыточность данных для этих служб в парном регионе Azure, выполните следующие действия.

1.  Служба **хранилища Azure** . Следуйте этим рекомендациям, чтобы включить избыточность данных для каждой учетной записи хранения в развертывании фармбеатс.
2.  **Azure Cosmos DB** . Следуйте этой рекомендации, чтобы включить избыточность данных для Cosmos DB учетной записи развертывания фармбеатс.
3.  Служба **"аналитика временных рядов Azure" (TSI)** — сейчас TSI не поддерживает избыточность данных. Чтобы восстановить данные аналитики временных рядов, перейдите к своему партнеру или в систему погоды и снова отправьте данные в Фармбеатс Deployment.

## <a name="restore-service-from-online-backup"></a>Восстановление службы из оперативной резервной копии

Вы можете инициировать отработку отказа и восстанавливать данные, в которых хранятся все перечисленные выше хранилища данных для развертывания Фармбеатс. После восстановления данных для службы хранилища Azure и Cosmos DB создайте другое развертывание Фармбеатс в парном регионе Azure, а затем настройте новое развертывание для использования данных из восстановленных хранилищ данных (т. е. службы хранилища Azure и Cosmos DB), выполнив следующие действия.

1. [Настройка Cosmos DB](#configure-cosmos-db)
2. [Настройка учетной записи хранения](#configure-storage-account)


### <a name="configure-cosmos-db"></a>Настройка Cosmos DB

Скопируйте ключ доступа восстановленной Cosmos DB и обновите новый Key Vault Фармбеатс Датахуб.


  ![Снимок экрана, посвященный месту получения копии ключа доступа.](./media/disaster-recovery-for-farmbeats/key-vault-secrets.png)

> [!NOTE]
> Скопируйте URL-адрес восстановленной Cosmos DB и обновите его в новой конфигурации службы приложений Фармбеатс Датахуб. Теперь можно удалить учетную запись Cosmos DB в новом развертывании Фармбеатс.

  ![Снимок экрана, на котором показано, куда копировать URL-адрес восстановленного Cosmos DB.](./media/disaster-recovery-for-farmbeats/configuration.png)

### <a name="configure-storage-account"></a>Настройка учетной записи хранения

Скопируйте ключ доступа восстановленной учетной записи хранения и обновите его в новом Key Vault Датахуб Фармбеатс.

![Снимок экрана, на котором показано, куда копировать ключ доступа для восстановленной учетной записи хранения.](./media/disaster-recovery-for-farmbeats/key-vault-7-secrets.png)

>[!NOTE]
> Обязательно обновите имя учетной записи хранения в новом файле конфигурации виртуальной машины Фармбеатс Batch.

![Аварийное восстановление](./media/disaster-recovery-for-farmbeats/batch-prep-files.png)

Аналогично, если вы включили восстановление данных для учетной записи хранения ускорителя, выполните шаг 2, чтобы обновить ключ доступа и имя учетной записи хранения ускорителя в новом экземпляре Фармбеатс.
