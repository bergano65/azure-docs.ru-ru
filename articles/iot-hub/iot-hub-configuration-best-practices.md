---
title: Рекомендации по настройке устройств для Центра Интернета вещей | Документация Майкрософт
description: Рекомендации по настройке устройств Интернета вещей в масштабе
author: chrisgre
ms.author: chrisgre
ms.date: 06/24/2018
ms.topic: conceptual
ms.service: iot-hub
services: iot-hub
ms.openlocfilehash: c97395981ea3af90c7b0c590cb049fccc7392304
ms.sourcegitcommit: d83fa82d6fec451c0cb957a76cfba8d072b72f4f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2019
ms.locfileid: "58863072"
---
# <a name="best-practices-for-device-configuration-within-an-iot-solution"></a>Рекомендации по настройке устройств в рамках решения Интернета вещей

Автоматическое управление устройствами в Центре Интернета вещей Azure позволяет автоматизировать многие повторяющиеся и сложные задачи управления для большого количества устройств на протяжении их жизненного цикла. В этой статье описаны многие из лучших методик для различных ролей, связанных с разработкой и использованием решений Интернета вещей.

* **Производитель или интегратор оборудования Интернета вещей:** Изготовители оборудования Интернета вещей, интеграторы, которые собирают оборудование различных изготовителей, или поставщики, которые предоставляют оборудование для развертывания Интернета вещей, изготовленное или интегрированное другими поставщиками. Участие в разработке и интеграции встроенных программ, встроенных операционных систем и программного обеспечения.

* **Разработчик решений IoT:** Разработка решения Интернета вещей обычно делается разработчиком решений. Этот разработчик может входить в команду внутри компании или быть системным интегратором, специализирующимся на данной деятельности. Разработчик решений Интернета вещей может с нуля разработать различные компоненты решения Интернета вещей, интегрировать разные стандарты или компоненты с открытым кодом и настраивать [ускоритель решений Центра Интернета вещей](/azure/iot-accelerators/).

* **Оператор решений Интернета вещей:** После развертывания решения Интернета вещей требует долгосрочного мониторинга, обновления и обслуживания. Эти задачи может выполнять команда внутри компании, в которую входят специалисты по информационным технологиям, группы по эксплуатации и обслуживанию оборудования, а также специалисты в определенной области, которые следят за работой всей инфраструктуры Интернета вещей.

## <a name="understand-automatic-device-management-for-configuring-iot-devices-at-scale"></a>Понимание автоматического управления устройством для настройки устройств Интернета вещей в масштабе

Автоматическое управление устройством включает в себя множество преимуществ, связанных с [двойниками устройств](iot-hub-devguide-device-twins.md) и [двойниками модулей](iot-hub-devguide-module-twins.md), для синхронизации требуемых и сообщаемых состояний между облаком и устройствами. [Конфигурации автоматического устройств](iot-hub-auto-device-config.md) автоматическое обновление большими наборами двойников и получения итоговых значений ход выполнения и соответствия требованиям. Ниже приведены основные действия по разработке и использованию автоматического управления устройствами.

* **Производитель или интегратор аппаратного обеспечения Интернета вещей** реализует функции управления устройствами во встроенном приложении с использованием [двойников устройств](iot-hub-devguide-device-twins.md). Эти функции могут включать в себя обновления встроенного ПО, установку и обновление программного обеспечения и управление настройками.

* **Разработчик решения Интернета вещей** реализует уровень управления операций администрирования устройства с помощью [двойников устройств](iot-hub-devguide-device-twins.md) и [автоматических конфигураций устройств](iot-hub-auto-device-config.md). Решение должно включать определение интерфейса оператора для выполнения задач управления устройством.

* **Оператор решения Интернета вещей** использует решение Интернета вещей для выполнения задач управления устройством, в частности для группирования устройств, инициирования изменений конфигурации, таких как обновления встроенного ПО, отслеживание хода выполнения и устранение возникающих проблем.

## <a name="iot-hardware-manufacturerintegrator"></a>Производитель или интегратор оборудования IoT

Ниже приведены лучшие методики для производителей и интеграторов оборудования, занимающихся разработкой встроенных программ.

* **Реализуйте [двойников](iot-hub-devguide-device-twins.md):** Двойники устройств позволяют синхронизации требуемой конфигурацией из облака и формирования отчетов текущей конфигурации и свойства устройства. Лучший способ реализовать двойники устройств во встроенных приложениях — использовать [пакеты SDK для Azure IoT](https://github.com/Azure/azure-iot-sdks). Двойники устройств лучше всего подходят для конфигурации, потому что они:

    * поддерживают двунаправленную связь;
    * разрешают как подключенные, так и отключенные состояния устройств;
    * следуют принципу итоговой согласованности;
    * полностью запрашиваемые в облаке.

* **Структура двойника устройства для управления устройствами:** Двойник устройства должны быть структурированы таким образом, что свойства управления устройства логически группируются в разделы. В этом случае изменения конфигурации могут быть изолированы, не влияя на другие части двойника. Например, создайте раздел в пределах требуемых свойств для встроенного ПО, второй раздел для программного обеспечения и третий раздел для сетевых параметров. 

* **Атрибуты отчета устройства, которые полезны для управления устройствами:** Такие атрибуты, как физическое устройство, изготовитель и модель, встроенного по, операционной системы, серийный номер, и другие идентификаторы полезны для создания отчетов и в качестве параметров для нацеливания на изменения конфигурации.

* **Определяют основные состояния reporting состояния и хода выполнения:** Таким образом, чтобы их можно сообщить оператору, должны быть перечислены состояния верхнего уровня. Например, при обновлении встроенного ПО может сообщаться состояние "Текущее", "Загрузка", "Применение", "Выполняется" или "Ошибка". Определите дополнительные поля для получения сведений о каждом состоянии.

## <a name="iot-solution-developer"></a>Разработчик решений IoT

Ниже перечислены рекомендации для разработчиков решений Интернета вещей, которые создают системы на основе Azure.

* **Реализуйте [двойников](iot-hub-devguide-device-twins.md):** Двойники устройств позволяют синхронизации требуемой конфигурацией из облака и формирования отчетов текущей конфигурации и свойства устройства. Лучший способ реализовать двойники устройств в облачных решениях — использовать [пакеты SDK для Azure IoT](https://github.com/Azure/azure-iot-sdks). Двойники устройств лучше всего подходят для конфигурации, потому что они:

    * поддерживают двунаправленную связь;
    * разрешают как подключенные, так и отключенные состояния устройств;
    * следуют принципу итоговой согласованности;
    * полностью запрашиваемые в облаке.

* **Организации с помощью тегов устройств-двойников устройств:** Решение должно позволять оператор для определения колец качества или другие наборы устройств в зависимости от различных стратегий развертывания, например Канарские. Организация устройств может быть реализована в решении с использованием тегов двойников устройств и [запросов](iot-hub-devguide-query-language.md). Организация устройств необходима для обеспечения надежной и точной настройки развертывания конфигурации.

* **Реализуйте [конфигураций автоматического устройств](iot-hub-auto-device-config.md):** Развертывание автоматической настройки и изменения конфигурации монитора большие наборы устройств Интернета вещей с помощью двойников устройств. Автоматические конфигурации устройств определяют наборы двойников устройств с помощью **целевого состояния**, которое является запросом к тегам двойников устройств или сообщаемым свойствам. **Целевое содержимое** — это набор требуемых свойств, который будет установлен в указанных двойниках устройств. Целевое содержимое должно соответствовать структуре двойников устройств, определяемой изготовителем оборудования Центра Интернета вещей или интегратором.

   **Метрики** — это запросы к сообщаемым свойствам двойников устройств, которые должны совпадать со структурой двойника устройства, определенной производителем или интегратором оборудования Центра Интернета вещей. Автоматические конфигурации устройств также имеют преимущество Центра Интернета вещей, который выполняет операции с двойниками устройств со скоростью, которая никогда не будет превышать [пределы регулирования](iot-hub-devguide-quotas-throttling.md) для считываний и обновлений двойников устройств.

* **Используйте [службы подготовки устройств](../iot-dps/how-to-manage-enrollments.md):** Разработчики решений следует использовать в службе подготовки устройств для назначения тегов устройств-двойников устройств, таким образом, что они будут автоматически настраивается с помощью **конфигураций автоматического устройств** , нацеленных на двойниках с этим тегом. 

## <a name="iot-solution-operator"></a>Оператор решений IoT

Ниже приведены лучшие методики для операторов решений Интернета вещей, которые используют решение Интернета вещей на основе Azure.

* **Упорядочить устройств для управления.** Решения Интернета вещей следует определять или разрешить для создания колец качества или других наборов устройств в зависимости от различных стратегий развертывания, например Канарские. Наборы устройств будут использоваться для развертывания изменений конфигурации и выполнения других операций управления масштабируемыми устройствами.

* **Изменения конфигурации, с помощью поэтапного развертывания:**  Поэтапного развертывания — это общий процесс, посредством которого оператор развертывает изменения в расширенном наборе устройств Интернета вещей. Цель этого развертывания — постепенно вносить изменения, чтобы уменьшить риск глобальных критических изменений.  Оператору необходимо использовать интерфейс решения для создания [автоматической конфигурации устройств](iot-hub-auto-device-config.md), а условие назначения должно быть нацелено на исходный набор устройств (например, группа раннего выпуска). Затем оператор должен проверить изменение конфигурации в исходном наборе устройств.

   После завершения проверки оператор обновит автоматическую конфигурацию устройства, чтобы включить в нее более широкий набор устройств. Оператор также должен установить более высокий приоритет для этой конфигурации, чем у других конфигураций, предназначенных для этих устройств. Развертыванием можно управлять, используя метрики, сообщаемые автоматической конфигурацией устройства.

* **Выполните откаты в случае ошибки или неверные настройки.**  На конфигурацию автоматической, которая будет вызывать ошибки или неправильные настройки можно выполнить откат, изменив **условиям назначения** таким образом, чтобы устройства больше не соответствовало условиям назначения. Убедитесь, что другая конфигурация устройства с более низким приоритетом по-прежнему предназначена для этих устройств. Убедитесь, что откат выполнен успешно, просмотрев метрики: Откат конфигурации больше не должен показывать состояние для untargeted устройств, а вторую конфигурацию метрик должен включать счетчики для устройств, которые по-прежнему предназначены.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о реализации двойников устройств см. в статье [Общие сведения о двойниках устройств и их использование в Центре Интернета вещей](iot-hub-devguide-device-twins.md).

* Дополнительные сведения о создании, обновлении и удалении автоматической конфигурации устройства см. в статье [Настройка и мониторинг устройств Центра Интернета вещей в масштабе (предварительная версия)](iot-hub-auto-device-config.md).

* Реализация шаблона обновления встроенного по, использование двойников устройств и их автоматической настройки в [руководства: Реализуйте процесс обновления встроенного по устройства](tutorial-firmware-update.md).
