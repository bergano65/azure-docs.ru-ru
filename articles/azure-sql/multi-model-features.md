---
title: Возможности при использовании нескольких моделей
description: Microsoft Azure SQL позволяет работать с несколькими моделями данных в одной базе данных.
services: sql-database
ms.service: sql-db-mi
ms.subservice: features
ms.custom: sqldbrb=2
ms.devlang: ''
ms.topic: conceptual
author: jovanpop-msft
ms.author: jovanpop
ms.reviewer: ''
ms.date: 12/17/2018
ms.openlocfilehash: 59a709a206eb29b875272674ee19e414023cc37f
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "87073316"
---
# <a name="multi-model-capabilities-of-azure-sql-database--sql-managed-instance"></a>Многомодельные возможности базы данных SQL Azure & SQL Управляемый экземпляр
[!INCLUDE[appliesto-sqldb-sqlmi](includes/appliesto-sqldb-sqlmi.md)]

Многомодельные базы данных позволяют хранить и работать с данными, представленными в нескольких форматах данных, таких как реляционные данные, графы, документы JSON/XML, пары "ключ-значение" и т. д.

## <a name="when-to-use-multi-model-capabilities"></a>Когда следует использовать возможности нескольких моделей

[Семейство продуктов Azure SQL](azure-sql-iaas-vs-paas-what-is-overview.md) предназначено для работы с реляционной моделью, обеспечивающей наилучшую производительность в большинстве случаев для различных приложений общего назначения. Однако семейство продуктов Azure SQL не ограничивается только реляционными данными. Семейство продуктов Azure SQL позволяет использовать разнообразные нереляционные форматы, тесно интегрированные в реляционную модель.
Вы должны использовать Многомодельные возможности семейства продуктов Azure SQL в следующих случаях:

- У вас есть некоторые сведения или структуры, которые лучше подходят для моделей NoSQL и вы не хотите использовать отдельную базу данных NoSQL.
- Большая часть данных подходит для реляционной модели, и необходимо моделировать некоторые части данных в стиле NoSQL.
- Вы хотите использовать многофункциональный язык Transact-SQL для запроса и анализа реляционных и NoSQL данных, а также интегрировать его с различными инструментами и приложениями, которые могут использовать язык SQL.
- Вы хотите применить такие функции базы данных, как [технологии в памяти](in-memory-oltp-overview.md) , чтобы повысить производительность аналитической или обрабатывающей структуры данных NoSQL, использовать [репликацию транзакций](managed-instance/replication-transactional-overview.md) или доступные для [чтения реплики](database/read-scale-out.md) для создания копии данных в другом месте и разгрузки некоторых аналитических рабочих нагрузок из базы данных-источника.

## <a name="overview"></a>Обзор

Семейство продуктов Azure SQL предоставляет следующие Многомодельные функции:

- [Функции графа](#graph-features). Позволяют представлять данные в виде набора узлов и ребер, а также запрашивать данные графа, используя стандартные запросы Transact-SQL, улучшенные за счет оператора графа `MATCH`.
- [Возможности JSON](#json-features). Позволяют помещать JSON-документы в таблицы, преобразовывать реляционные данные в JSON-документы и наоборот. Вы можете использовать стандартный язык Transact-SQL, расширенный с помощью функций JSON, чтобы выполнять синтаксический анализ документов, и некластеризованные индексы, индексы columnstore или таблицы, оптимизированные для памяти, чтобы оптимизировать запросы.
- [Пространственные функции](#spatial-features). Позволяют хранить географические и геометрические данные, индексировать их с использованием пространственных индексов и извлекать данные с помощью пространственных запросов.
- [Возможности XML](#xml-features). Позволяют хранить, индексировать XML-данные в базе данных и использовать собственные операции XQuery и XPath для работы с XML-данными. Семейство продуктов Azure SQL имеет специализированный встроенный обработчик запросов XML, обрабатывающий XML-данные.
- [Пары "ключ-значение"](#key-value-pairs) не поддерживаются явно в качестве специальных функций, так как пары "ключ-значение" могут быть изначально смоделированы как таблицы с двумя столбцами.

  > [!Note]
  > Вы можете использовать выражение пути JSON, выражения XQuery/XPath, пространственные функции и выражения запроса по графам в одном запросе Transact-SQL для доступа к любым данным, хранящимся в базе данных. Кроме того, любое средство или язык, поддерживающие выполнение запросов Transact-SQL, также могут использовать этот интерфейс запросов для доступа к данным нескольких моделей. Это ключевое различие в сравнении с многомодельными базами данных, такими как [Azure Cosmos DB](/azure/cosmos-db/), которое предоставляет специальный API для различных моделей данных.

В следующих разделах вы узнаете о наиболее важных многомодельных возможностях семейства продуктов SQL Azure.

## <a name="graph-features"></a>Функции графа

Семейство продуктов Azure SQL предоставляет возможности баз данных Graph для моделирования связей "многие ко многим" в базе данных. Граф состоит из узлов (или вершин) и ребер (или связей). Узел представляет сущность (например, пользователя или организацию), а ребро — связь между двумя узлами, которые оно соединяет (например, отметки "Нравится" или друзья). Ниже приведены некоторые функции, благодаря которым графовая база данных является уникальной.

- Ребра или связи в графовой базе данных являются сущностями первого класса, с которым могут быть связаны атрибуты или свойства.
- Одно ребро может гибко соединить несколько узлов в графовой базе данных.
- Вы можете легко выразить запросы на сопоставление шаблонов и навигацию со множеством переходов.
- Вы можно легко выразить транзитивное замыкание и полиморфные запросы.

[Связи графа и возможности запросов Graph](/sql/relational-databases/graphs/sql-graph-overview) интегрированы в TRANSACT-SQL и получают преимущества использования ядра СУБД SQL Server в качестве базовой системы управления базами данных.

### <a name="when-to-use-a-graph-capability"></a>Когда следует использовать возможности графа

Все, чего можно достигнуть с графовой базой данных, возможно и с реляционной базой данных. Тем не менее графовая база данных может упростить выражение определенных запросов. Графовую базу данных следует использовать при наличии следующих условий:

- При моделировании иерархических данных, в которых один узел может иметь несколько родительских элементов ( в таком случае HierarchyId нельзя использовать).
- Модель вашего приложения содержит сложные связи "многие ко многим": по мере развития приложения добавляются новые связи.
- Вам необходимо анализировать взаимосвязанные данные и связи.

## <a name="json-features"></a>Возможности JSON

Семейство продуктов Azure SQL позволяет анализировать и запрашивать данные, представленные в формате нотация объектов JavaScript [(JSON)](https://www.json.org/) , а также экспортировать реляционные данные в виде текста JSON.

JSON – это распространенный формат данных, который используются для обмена данными в современных мобильных и веб-приложениях. Кроме того, формат JSON используется для хранения частично структурированных данных в файлах журнала или базах данных NoSQL, например [базе данных Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/). Многие веб-службы REST возвращают результаты в формате текста JSON или принимают данные в формате JSON. Большинство служб Azure, таких как [azure когнитивный Поиск](https://azure.microsoft.com/services/search/), служба [хранилища Azure](https://azure.microsoft.com/services/storage/)и [Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) , имеют конечные точки RESTful, возвращающие или использующие JSON.


Семейство продуктов Azure SQL позволяет легко работать с данными JSON и интегрировать базу данных с современными службами, а также предоставляет следующие функции для работы с данными JSON.

![Функции JSON](./media/multi-model-features/image_1.png)

Если имеется текст JSON, то можно извлечь данные из JSON или проверить правильность его форматирования с помощью встроенных функций [JSON_VALUE](/sql/t-sql/functions/json-value-transact-sql), [JSON_QUERY](/sql/t-sql/functions/json-query-transact-sql) и [ISJSON](/sql/t-sql/functions/isjson-transact-sql). Функция [JSON_MODIFY](/sql/t-sql/functions/json-modify-transact-sql) позволяет обновить значение внутри текста JSON. Если требуются более сложные запросы и анализ, то с помощью функции [OPENJSON](/sql/t-sql/functions/openjson-transact-sql) можно преобразовать массив объектов JSON в набор строк. С возвращенным результирующим набором можно выполнить любой SQL-запрос. Наконец, можно использовать предложение [FOR JSON](/sql/relational-databases/json/format-query-results-as-json-with-for-json-sql-server) , которое позволяет форматировать данные, хранящиеся в реляционных таблицах в виде текста JSON.

Дополнительные сведения см. [в разделе как работать с данными JSON](database/json-features.md).
[JSON](/sql/relational-databases/json/json-data-sql-server) — это основная SQL Server компонента ядра СУБД.

### <a name="when-to-use-a-json-capability"></a>Когда следует использовать возможность JSON

Модели документов могут использоваться вместо реляционных моделей в некоторых конкретных сценариях:

- Высокая нормализация схемы не приносит значительных преимуществ, так как вы одновременно получаете доступ ко всем полям объектов или никогда не обновляете нормализованные части объектов. Тем не менее нормализованная модель увеличивает сложность запросов из-за большего количества таблиц, которые необходимо соединить для получения данных.
- Вы работаете с приложениями, которые изначально используют JSON-документы и в которых применяются модели обмена данными или модели данных, и вы не хотите вводить дополнительные уровни, преобразовывающие реляционные данные в формат JSON и наоборот.
- Необходимо упростить модель данных путем отмены нормализации дочерних таблиц или шаблонов "сущность — объект — значение".
- Вам нужно загрузить или экспортировать данные, хранящиеся в формате JSON, без использования какого-либо дополнительного средства, анализирующего данные.

## <a name="spatial-features"></a>Пространственные функции

Пространственные данные представляют сведения о физическом расположении и форме геометрических объектов. Эти объекты могут быть расположениями точек или более сложными объектами, такими как страны, регионы, дороги или озера.

 Два поддерживаемых пространственных типа данных: 

- Геометрический тип данных представляет данные в евклидовой (плоской) системе координат,
- а географический — в сферической.

Существует ряд пространственных объектов, которые можно использовать в семействе продуктов SQL Azure для анализа и запроса данных, представленных в формате нотация объектов JavaScript [(JSON)](https://www.json.org/) , и экспорта реляционных данных в виде текста JSON.
Например, " [точка](/sql/relational-databases/spatial/point)", " [LineString](/sql/relational-databases/spatial/linestring)", " [многоугольник](/sql/relational-databases/spatial/polygon)" и т. д.

Семейство продуктов Azure SQL также предоставляет специализированные [пространственные индексы](/sql/relational-databases/spatial/spatial-indexes-overview) , которые можно использовать для повышения производительности пространственных запросов.

[Поддержка пространственного](/sql/relational-databases/spatial/spatial-data-sql-server) механизма — это основная SQL Server компонента ядра СУБД.

## <a name="xml-features"></a>Функции XML

Ядро СУБД SQL Server предоставляет мощную платформу для разработки многофункциональных приложений для управления частично структурированными данными. Поддержка XML встроена во все компоненты ядра СУБД и включает в себя следующее:

- Тип XML-данных. Значения XML можно изначально хранить в столбце типа XML-данных, который можно типизировать в соответствии с коллекцией схем XML или оставить нетипизированным. XML-столбец можно индексировать.
- Возможность указывать запросы XQuery к XML-данным, хранящимся в столбцах и переменных типа XML. Функции XQuery можно использовать в любом запросе Transact-SQL, который получает доступ к любой модели данных, используемой в базе данных.
- Можно автоматически индексировать все элементы в XML-документах с использованием [первичного XML-индекса](/sql/relational-databases/xml/xml-indexes-sql-server#primary-xml-index) или указать точные пути, которые должны индексироваться с использованием [вторичного XML-индекса](/sql/relational-databases/xml/xml-indexes-sql-server#secondary-xml-indexes).
- OPENROWSET, позволяющий применять массовую загрузку XML-данных.
- Преобразование реляционных данных в XML-формат.

[XML](/sql/relational-databases/xml/xml-data-sql-server) — это основная SQL Server компонента ядра СУБД.

### <a name="when-to-use-an-xml-capability"></a>Когда следует использовать возможность XML

Модели документов могут использоваться вместо реляционных моделей в некоторых конкретных сценариях:

- Высокая нормализация схемы не приносит значительных преимуществ, так как вы одновременно получаете доступ ко всем полям объектов или никогда не обновляете нормализованные части объектов. Тем не менее нормализованная модель увеличивает сложность запросов из-за большего количества таблиц, которые необходимо соединить для получения данных.
- Вы работаете с приложениями, которые изначально используют XML-документы и в которых применяются модели обмена данными или модели данных, и вы не хотите вводить дополнительные уровни, преобразовывающие реляционные данные в формат XML и наоборот.
- Необходимо упростить модель данных путем отмены нормализации дочерних таблиц или шаблонов "сущность — объект — значение".
- Вам нужно загрузить или экспортировать данные, хранящиеся в формате XML, без использования какого-либо дополнительного средства, анализирующего данные.

## <a name="key-value-pairs"></a>Пары "ключ-значение"

Семейство продуктов SQL Azure не имеет специализированных типов или структур, которые поддерживают пары "ключ-значение", так как структуры пар "ключ — значение" могут быть представлены в виде стандартных реляционных таблиц.

```sql
CREATE TABLE Collection (
  Id int identity primary key,
  Data nvarchar(max)
)
```

Вы можете настраивать эту структуру пар "ключ — значение" в соответствии со своими потребностями без каких-либо ограничений. Например, значение может быть XML-документом, а не типом `nvarchar(max)`. Если значение является JSON-документом, вы можете поместить ограничение `CHECK`, которое проверяет правильность содержимого JSON. Вы можете помещать любое количество значений, связанных с одним ключом, в дополнительные столбцы, добавлять вычисляемые столбцы и индексы, чтобы упростить и оптимизировать доступ к данным, определить таблицу в качестве таблицы, оптимизированной для памяти, или таблицы, предназначенной только с оптимизированной схемой, чтобы достичь более высокой производительности и т. д.

Ознакомьтесь с тем, [как BWin использует выполняющуюся в памяти OLTP для достижения беспрецедентной производительности и масштаба](https://blogs.msdn.microsoft.com/sqlcat/20../../how-bwin-is-using-sql-server-2016-in-memory-oltp-to-achieve-unprecedented-performance-and-scale/) для своих решений кэширования ASP.NET, кэширующих 1 200 000 пакетов в секунду, для примера того, как реляционные модели могут эффективно использоваться в качестве решения пар "ключ — значение" на практике.

## <a name="next-steps"></a>Дальнейшие действия

Многомодельные возможности в семействе продуктов Azure SQL также являются основными SQL Server функциями ядра СУБД, которые являются общими для семейства продуктов Azure SQL. Чтобы получить дополнительные сведения об этих возможностях, посетите страницы документации по реляционной базе данных SQL:

- [Обработка Graph](/sql/relational-databases/graphs/sql-graph-overview)
- [Данные JSON](/sql/relational-databases/json/json-data-sql-server)
- [Пространственные данные (SQL Server)](/sql/relational-databases/spatial/spatial-data-sql-server)
- [XML-данные](/sql/relational-databases/xml/xml-data-sql-server)
