---
title: Подключение с помощью Excel
description: Узнайте, как подключить Microsoft Excel к базе данных в базе данных SQL Azure или Управляемый экземпляр Azure SQL. Импортируйте данные в Excel для создания отчетов и просмотра данных.
titleSuffix: Azure SQL Database & SQL Managed Instance
services: sql-database
ms.service: sql-database
ms.subservice: development
ms.custom: sqldbrb=1
ms.devlang: ''
ms.topic: how-to
author: stevestein
ms.author: sstein
ms.reviewer: ''
ms.date: 05/29/2020
ms.openlocfilehash: 304ad51bc40c8165c2dc11bb70287491e3d6dfb9
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91444030"
---
# <a name="connect-excel-to-a-database-in-azure-sql-database-or-azure-sql-managed-instance-and-create-a-report"></a>Подключение Excel к базе данных в базе данных SQL Azure или Управляемый экземпляр SQL Azure и создание отчета
[!INCLUDE[appliesto-sqldb-sqlmi](../includes/appliesto-sqldb-sqlmi.md)]

Можно подключить Excel к базе данных, а затем импортировать данные и создать таблицы и диаграммы на основе значений в базе данных. Работая с этим руководством, вы установите подключение между Excel и таблицей базы данных, сохраните файл, в котором хранятся данные и сведения о соединении для Excel, а затем создадите сводную диаграмму на основе значений базы данных.

Прежде чем приступить к работе, необходимо создать базу данных. Если у вас ее нет, см. статью [Создание базы данных в базе данных SQL Azure](single-database-create-quickstart.md) и [Создание брандмауэра IP на уровне сервера](firewall-create-server-level-portal-quickstart.md) для получения базы данных с демонстрационными данными в течение нескольких минут.

Следуя инструкциям в этой статье, вы импортируете демонстрационные данные в Excel, но те же действия можно выполнять и с собственными данными.

Вам также понадобится копия Excel. В этой статье используется [Microsoft Excel 2016](https://products.office.com/).

## <a name="connect-excel-and-load-data"></a>Подключение к Excel и загрузка данных

1. Чтобы подключить Excel к базе данных в базе данных SQL, откройте Excel и создайте новую книгу или откройте существующую книгу Excel.
2. В строке меню в верхней части страницы выберите вкладку **Данные**, нажмите кнопку **Получить данные**, выберите пункт "Из Azure", а затем — пункт **Из базы данных SQL Azure**.

   ![Выбор источника данных: Подключение Excel к базе данных SQL.](./media/connect-excel/excel_data_source.png)

3. В диалоговом окне **SQL Server базу данных** введите **имя сервера** , к которому нужно подключиться, в формате <*ServerName* > **. Database.Windows.NET**. Пример: **msftestserver.database.windows.net**. При необходимости введите имя базы данных. Нажмите кнопку **ОК**, чтобы открыть окно учетных данных.

   ![Диалоговое окно «Подключение к серверу базы данных»](./media/connect-excel/server-name.png)

4. В диалоговом окне **SQL Server базу данных** выберите в левой части элемент **база данных** , а затем введите **имя пользователя** и **пароль** для сервера, к которому вы хотите подключиться. Нажмите кнопку **Подключиться**, чтобы открыть **навигатор**.

   ![Ввод имени сервера и учетных данных для входа](./media/connect-excel/connect-to-server.png)

   > [!TIP]
   > В зависимости от сетевой среды подключение может оказаться невозможным, или если сервер не разрешает трафик с IP-адреса клиента. Перейдите на [портал Azure](https://portal.azure.com/), щелкните "Серверы SQL Server", выберите свой сервер, в разделе "Параметры" щелкните "Брандмауэр" и добавьте IP-адрес клиента. Дополнительные сведения см. в статье [Настройка правила брандмауэра уровня сервера базы данных SQL Azure с помощью портала Azure](firewall-configure.md).

5. В **навигаторе** выберите в списке нужную базу данных, выберите нужные таблицы или представления (мы выбрали **vGetAllCategories**), а затем нажмите кнопку **Загрузить**, чтобы перенести данные из базы данных в электронную таблицу Excel.

    ![Выберите базу данных и таблицу.](./media/connect-excel/select-database-and-table.png)

## <a name="import-the-data-into-excel-and-create-a-pivot-chart"></a>Импорт данных в Excel и создание сводной диаграммы

Теперь, когда вы установили подключение, вы можете загрузить данные несколькими способами. Например, следующие шаги создают сводную диаграмму на основе данных, найденных в базе данных в базе данных SQL.

1. Выполните действия из предыдущего раздела, но на этот раз не нажимайте кнопку **Загрузить**, а выберите пункт **Загрузить в** из раскрывающегося списка **Загрузить**.
2. Затем выберите способ представления данных в книге. Мы выбрали режим **Сводная диаграмма**. Кроме того, можно создать **новый лист** или **добавить эти сведения в модель данных**. Дополнительные сведения о моделях данных см. в статье [Создание модели данных в Excel](https://support.office.com/article/Create-a-Data-Model-in-Excel-87E7A54C-87DC-488E-9410-5C75DBCB0F7B).

    ![Выбор формата данных в Excel](./media/connect-excel/import-data.png)

    Лист теперь содержит пустую сводную таблицу и диаграмму.
3. В разделе **Поля сводной таблицы**установите все флажки для полей, которые требуется просмотреть.

    ![Настройте отчет базы данных.](./media/connect-excel/power-pivot-results.png)

> [!TIP]
> Если нужно подключить другие книги и листы Excel к базе данных, на вкладке **Данные** нажмите кнопку **Последние источники**, чтобы открыть диалоговое окно **Последние источники**. Выберите в списке ранее созданное подключение и нажмите кнопку **Открыть**.
> ![Диалоговое окно «последние источники»](./media/connect-excel/recent-connections.png)

## <a name="create-a-permanent-connection-using-odc-file"></a>Создание постоянного подключения с помощью файла ODC

Чтобы сохранить сведения о подключении, можно создать файл ODC. После этого подключение можно будет выбирать в диалоговом окне **Существующие подключения**.

1. В строке меню в верхней части страницы выберите вкладку **Данные** и нажмите кнопку **Существующие подключения**, чтобы открыть диалоговое окно **Существующие подключения**.
   1. Нажмите кнопку **Найти другие**, чтобы открыть диалоговое окно **Выбор источника данных**.
   2. Выберите файл **+Новое подключение к SQL-серверу.odc** и нажмите кнопку **Открыть**, чтобы запустить **мастер подключения к данным**.

      ![Диалоговое окно «Создание соединения»](./media/connect-excel/new-connection.png)

2. В **мастере подключения к данным** введите имя сервера и учетные данные для базы данных SQL. Выберите **Далее**.
   1. В раскрывающемся списке выберите нужную базу данных.
   2. Выберите нужную таблицу или представление. Мы выбрали vGetAllCategories.
   3. Выберите **Далее**.

      ![Мастер подключения к данным](./media/connect-excel/data-connection-wizard.png)

3. На следующем экране мастера подключения к данным выберите расположение файла, **имя файла** и **понятное имя**. Вы также можете сохранить пароль в файле, но это может сделать данные уязвимыми для несанкционированного доступа. По завершении нажмите кнопку **Готово**.

    ![Сохранение подключения к данным](./media/connect-excel/save-data-connection.png)

4. Выберите способ импорта данных. Мы выбрали создание сводной таблицы. Кроме того, можно изменить свойства подключения, нажав кнопку **Свойства**. По окончании нажмите кнопку **ОК**. Если вы не сохранили пароль в файле, вам будет предложено ввести учетные данные.

    ![Импорт данных](./media/connect-excel/import-data2.png)

5. Проверьте, сохранилось ли новое подключение. Для этого на вкладке **Данные** нажмите кнопку **Существующие подключения**.

    ![Существующее подключение](./media/connect-excel/existing-connection.png)

## <a name="next-steps"></a>Дальнейшие шаги

* Узнайте, как [подключиться к SQL Server Management Studio и выполнить запросы](connect-query-ssms.md) к расширенным запросам и анализу.
* Узнайте о преимуществах использования [пулов эластичных БД](elastic-pool-overview.md).
* Узнайте, как [создать веб-приложение, которое подключается к базе данных SQL Azure на серверной части](../../app-service/app-service-web-tutorial-dotnet-sqldatabase.md).
