---
title: Руководство по переносу базы данных SQLite в бессерверную Базу данных SQL Azure
description: Сведения о том, как выполнить автономную миграцию из SQLite в бессерверную Базу данных SQL Azure, используя Фабрику данных Azure.
services: sql-database
author: joplum
ms.author: joplum
ms.service: sql-database
ms.workload: data-services
ms.topic: tutorial
ms.date: 01/08/2020
ms.custom: sqldbrb=1
ms.openlocfilehash: 6e60403344a0341b4aee74a001287c09ba67e114
ms.sourcegitcommit: 3792cf7efc12e357f0e3b65638ea7673651db6e1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2020
ms.locfileid: "91448899"
---
# <a name="how-to-migrate-your-sqlite-database-to-azure-sql-database-serverless"></a>Перенос базы данных SQLite в бессерверную Базу данных SQL Azure
[!INCLUDE[appliesto-sqldb](../includes/appliesto-sqldb.md)]

Для многих пользователей SQLite дает первый опыт работы с базами данных и программированием на SQL. Ядро СУБД SQLite включено во многие операционные системы и популярные приложения, что делает его одним из самых широко распространенных и используемых в мире. Поскольку именно эта ядро СУБД для многих становится первой попыткой работы с базами данных, оно является центральным элементом многих проектов и приложений. В тех случаях, когда проект или приложение выходят за рамки возможностей SQLite, на которой создавалась первичная реализация, разработчикам нужно перенести данные в надежное и централизованное хранилище данных.

Бессерверная База данных SQL Azure — это уровень вычислений для отдельных баз данных, которые автоматически масштабируются в соответствии с потребностями в рабочей нагрузке, а счета выставляются за количество использованных вычислительных ресурсов в секунду. Уровень бессерверных вычислений также автоматически приостанавливает базы данных в периоды отсутствия активности, когда оплачивается только хранилище, и автоматически возобновляет работу баз данных, когда активность восстанавливается.

После выполнения описанных ниже действий вы перенесете базу данных в Бессерверную Базу данных SQL Azure, что позволит с минимальными изменениями кода приложения предоставить доступ к базе данных другим пользователям и приложениям в облаке, оплачивая только реально используемые ресурсы.

## <a name="prerequisites"></a>Предварительные требования

- Подписка Azure.
- База данных SQLite2 или SQLite3, которую вы хотите перенести.
- Среда Windows.
  - Если у вас нет локальной среды Windows, для миграции можно использовать виртуальную машину Windows в Azure. Переместите файл базы данных SQLite на виртуальную машину и предоставьте к нему доступ, используя службы "Файлы Azure" и "Обозреватель службы хранилища".

## <a name="steps"></a>Шаги

1. Подготовьте к работе новую Базу данных SQL Azure на уровне бессерверных вычислений.

    ![Снимок экрана с примером подготовки Базы данных SQL Azure (бессерверные вычисления) на портале Azure](./media/migrate-sqlite-db-to-azure-sql-serverless-offline-tutorial/provision-serverless.png)

2. Убедитесь, что файл базы данных SQLite доступен в среде Windows. Установите драйвер SQLite ODBC, если у вас его еще нет (есть много доступных вариантов с открытым кодом, например http://www.ch-werner.de/sqliteodbc/) ).

3. Создайте для базы данных системное имя DSN. Убедитесь, что используемая версия приложения администратора источника данных соответствует архитектуре системы (32- или 64-разрядная). Выполняемую версию можно узнать в настройках системы.

    - Откройте средство "Администратор источника данных ODBC" в своей среде.
    - Щелкните вкладку системного DSN и нажмите кнопку "Добавить".
    - Выберите установленный ранее соединитель ODBC SQLite и присвойте ему понятное имя, например sqlitemigrationsource.
    - Присвойте DB-файлу имя базы данных.
    - Сохраните и закройте.

4. Скачайте и установите локальную среду выполнения интеграции. Проще всего это сделать с помощью экспресс-установки, как описано в документации. Если вы выберете установку вручную, придется предоставить приложению ключ проверки подлинности, который можно найти в экземпляре Фабрики данных, выполнив следующие действия:

    - Запустите ADF (создание и мониторинг из службы на портале Azure).
    - Щелкните вкладку "Создание" (синий карандаш) слева.
    - Щелкните "Подключения" (внизу слева), а затем выберите среды выполнения интеграции.
    - Добавьте новую локальную среду выполнения интеграции и присвойте ей имя, а затем щелкните *Вариант 2*.

5. Создайте в Фабрике данных новую связанную службу для исходной базы данных SQLite.

    ![Снимок экрана с пустой колонкой связанных служб в Фабрике данных Azure](./media/migrate-sqlite-db-to-azure-sql-serverless-offline-tutorial/linked-services-create.png)

6. На странице **Подключения** в разделе **Связанная служба** щелкните **Создать**.

7. Найдите и выберите соединитель ODBC.

   ![Снимок экрана с логотипом соединителя ODBC в колонке связанных служб в Фабрике данных Azure](./media/migrate-sqlite-db-to-azure-sql-serverless-offline-tutorial/linked-services-odbc.png)

8. Присвойте этой связанной службе понятное имя, например sqlite_odbc. Выберите среду выполнения интеграции из раскрывающегося списка "Подключение через среду выполнения интеграции". Введите приведенный ниже код в качестве строки подключения, заменив переменную Initial Catalog (Начальный каталог) реальным путем к DB-файлу, а переменную DSN — именем системного подключения DSN.

   ```
   Connection string: Provider=MSDASQL.1;Persist Security Info=False;Mode=ReadWrite;Initial Catalog=C:\sqlitemigrationsource.db;DSN=sqlitemigrationsource
    ```

9. В качестве типа проверки подлинности укажите "Анонимный".

10. Проверка подключения

    ![Снимок экрана с успешным подключением в Фабрике данных Azure](./media/migrate-sqlite-db-to-azure-sql-serverless-offline-tutorial/linked-services-test-successful.png)

11. Создайте еще одну связанную службу для целевой бессерверной среды SQL. Выберите базу данных в мастере связанных служб и укажите учетные данные для проверки подлинности SQL.

    ![Снимок экрана с интерфейсом Фабрики данных Azure, где выбрана База данных SQL Azure](./media/migrate-sqlite-db-to-azure-sql-serverless-offline-tutorial/linked-services-create-target.png)

12. Извлеките инструкции CREATE TABLE из базы данных SQLite. Для этого можно выполнить приведенный ниже скрипт Python в файле базы данных.

    ```
    #!/usr/bin/python
    import sqlite3
    conn = sqlite3.connect("sqlitemigrationsource.db")
    c = conn.cursor()

    print("Starting extract job..")
    with open('CreateTables.sql', 'w') as f:
        for tabledetails in c.execute("SELECT * FROM sqlite_master WHERE type='table'"):
            print("Extracting CREATE statement for " + (str(tabledetails[1])))
            print(tabledetails)
            f.write(str(tabledetails[4].replace('\n','') + ';\n'))
    c.close()
    ```

13. Создайте целевые таблицы в целевой бессерверной среде SQL, скопировав инструкции CREATE TABLE из файла CreateTables.sql и выполнив эти инструкции SQL в редакторе запросов на портале Azure.

14. Вернитесь на домашнюю страницу Фабрики данных и щелкните "Копирование данных", чтобы запустить мастер создания задания.

    ![Снимок экрана с логотипом мастера копирования данных в Фабрике данных Azure](./media/migrate-sqlite-db-to-azure-sql-serverless-offline-tutorial/copy-data.png)

15. Выберите все таблицы из исходной базы данных SQLite, установив соответствующие флажки, и сопоставьте их с целевыми таблицами в SQL Azure. Когда выполнение задания завершится, данные будут перенесены из SQLite в SQL Azure.

## <a name="next-steps"></a>Дальнейшие действия

- Чтобы начать работу, см. [краткое руководство по Создание отдельной базы данных в Базе данных SQL с помощью портала Azure](single-database-create-quickstart.md).
- См. подробнее об [ограничениях ресурсов уровня бессерверных вычислений](../../sql-database/sql-database-vcore-resource-limits-single-databases.md#general-purpose---serverless-compute---gen5).
