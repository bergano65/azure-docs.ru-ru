---
title: Защита общедоступных конечных точек Azure SQL Управляемый экземпляр
description: Безопасно использовать общедоступные конечные точки в Azure SQL Управляемый экземпляр
services: sql-database
ms.service: sql-managed-instance
ms.subservice: security
ms.custom: sqldbrb=1
ms.topic: conceptual
author: srdan-bozovic-msft
ms.author: srbozovi
ms.reviewer: vanto, sstein
ms.date: 05/08/2019
ms.openlocfilehash: d9c1828732b9a4e0e85c3af2263f097edd54437d
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91332854"
---
# <a name="use-azure-sql-managed-instance-securely-with-public-endpoints"></a>Безопасное использование Azure SQL Управляемый экземпляр с общедоступными конечными точками
[!INCLUDE[appliesto-sqlmi](../includes/appliesto-sqlmi.md)]

Управляемый экземпляр Azure SQL предоставляет возможность подключения пользователей через [общедоступные конечные точки](../../virtual-network/virtual-network-service-endpoints-overview.md). В этой статье объясняется, как сделать эту конфигурацию более безопасной.

## <a name="scenarios"></a>Сценарии

Управляемый экземпляр Azure SQL предоставляет закрытую конечную точку, чтобы разрешить подключение из виртуальной сети. Параметр по умолчанию обеспечивает максимальную изоляцию. Однако существуют сценарии, в которых необходимо предоставить подключение к общедоступной конечной точке.

- Управляемый экземпляр должен интегрироваться с предложениями "платформа как услуга" с несколькими клиентами (PaaS).
- Вам потребуется более высокая пропускная способность обмена данными, чем это возможно при использовании VPN.
- Политики компании запрещают PaaS в корпоративных сетях.

## <a name="deploy-a-managed-instance-for-public-endpoint-access"></a>Развертывание управляемого экземпляра для доступа к общедоступной конечной точке

Хотя это и не обязательно, общая модель развертывания для управляемого экземпляра с доступом к общедоступной конечной точке — это создание экземпляра в выделенной изолированной виртуальной сети. В этой конфигурации виртуальная сеть используется только для изоляции виртуальных кластеров. Не имеет значения, пересекается ли пространство IP-адресов управляемого экземпляра с пространством IP-адресов корпоративной сети.

## <a name="secure-data-in-motion"></a>Защита данных в движении

Трафик данных SQL Управляемый экземпляр всегда шифруется, если драйвер клиента поддерживает шифрование. Данные, передаваемые между управляемым экземпляром и другими виртуальными машинами Azure или службами Azure, никогда не покидает магистраль Azure. При наличии подключения между управляемым экземпляром и локальной сетью рекомендуется использовать Azure ExpressRoute. ExpressRoute позволяет избежать перемещения данных через общедоступный Интернет. Для частного подключения с управляемым экземпляром можно использовать только частный пиринг.

## <a name="lock-down-inbound-and-outbound-connectivity"></a>Блокировка входящего и исходящего подключения

На следующей схеме показаны рекомендуемые конфигурации безопасности.

![Конфигурации безопасности для блокировки входящего и исходящего подключения](./media/public-endpoint-overview/managed-instance-vnet.png)

Управляемый экземпляр имеет [выделенный адрес общедоступной конечной точки](management-endpoint-find-ip-address.md). В правилах брандмауэра исходящего трафика на стороне клиента и в группе безопасности сети задайте для этого IP-адреса общедоступной конечной точки ограничение исходящего подключения.

Чтобы убедиться, что трафик к управляемому экземпляру поступает из надежных источников, рекомендуется подключиться из источников с известными IP-адресами. Используйте группу безопасности сети, чтобы ограничить доступ к общедоступной конечной точке управляемого экземпляра через порт 3342.

Когда клиентам необходимо инициировать подключение из локальной сети, убедитесь, что исходный адрес преобразован в известный набор IP-адресов. Если это невозможно (например, в качестве типичного сценария для мобильных устройств), мы рекомендуем использовать [VPN-подключения типа "точка — сеть" и частную конечную точку](point-to-site-p2s-configure.md).

Если подключения запускаются из Azure, мы рекомендуем использовать трафик, полученный с помощью известного назначенного [виртуального IP-адреса](/previous-versions/azure/virtual-network/virtual-networks-reserved-public-ip) (например, виртуальной машины). Чтобы упростить управление виртуальными IP-адресами, может потребоваться использовать [префиксы общедоступного IP-адреса](../../virtual-network/public-ip-address-prefix.md).

## <a name="next-steps"></a>Дальнейшие шаги

- Узнайте, как настроить общедоступную конечную точку для управления экземплярами: [Настройка общедоступной конечной точки](public-endpoint-configure.md)
