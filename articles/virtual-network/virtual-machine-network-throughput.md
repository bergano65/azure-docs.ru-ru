---
title: Пропускная способность сети для виртуальной машины Azure | Документация Майкрософт
description: Сведения о пропускной способности сети для виртуальной машины Azure.
services: virtual-network
documentationcenter: na
author: steveesp
editor: ''
tags: azure-resource-manager
ms.assetid: ''
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 4/26/2019
ms.author: steveesp
ms.reviewer: kumud, mareat
ms.openlocfilehash: f5694e18d5743118e2b6e73708dd3acb17151198
ms.sourcegitcommit: de47a27defce58b10ef998e8991a2294175d2098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67874941"
---
# <a name="virtual-machine-network-bandwidth"></a>Пропускная способность сетевых ресурсов виртуальной машины

Azure предоставляет несколько разных типов и размеров виртуальных машин, каждый из которых имеет определенное сочетание характеристик производительности. Одной из таких характеристик производительности является пропускная способность сети, которая измеряется в мегабитах в секунду (Мбит/с). Поскольку виртуальные машины размещены на общем оборудовании, пропускная способность сети должна справедливо распределяться между виртуальными машинами на одном элементе оборудования. Крупным виртуальным машинам предоставляется больше пропускной способности, чем более мелким.
 
Пропускная способность сети, выделяемая каждой виртуальной машине, определяет скорость передачи данных от виртуальной машины (исходящий трафик). Ограничение распространяется на весь сетевой трафик, покидающий виртуальную машину, независимо от его назначения. Например, если для виртуальной машины установлено ограничение 1000 Мбит/с, эта квота расходуется на любой исходящий трафик — как к другой виртуальной машине в той же виртуальной сети, так и за пределы Azure.
 
Входящий трафик не измеряется и не ограничивается напрямую. Однако способность виртуальной машины обрабатывать входящие данные может быть ограничена другими факторами, такими как ограничения на использование ЦП и (или) хранилища.

Функция ускорения работы в сети позволяет повысить производительность сети по таким показателям, как задержки в сети, пропускная способность и использование ЦП. Любые улучшения производительности, которые предоставляет ускорение работы в сети, возможны только в пределах полосы пропускания, выделенной для виртуальной машины. Дополнительные сведения см. в разделах об ускорении работы в сети для виртуальных машин [Windows](create-vm-accelerated-networking-powershell.md) или [Linux](create-vm-accelerated-networking-cli.md).
 
К виртуальной машине Azure можно присоединить несколько сетевых интерфейсов, и по меньшей мере один должен присутствовать обязательно. Пропускная способность, выделенная для виртуальной машины, оценивается по сумме исходящего трафика на всех присоединенных к ней сетевых интерфейсах. Другими словами, пропускная способность выделяется на виртуальную машину в целом, независимо от количества присоединенных к ней сетевых интерфейсов. Чтобы узнать, сколько сетевых интерфейсов поддерживают виртуальные машины Azure разных размеров, изучите описание размеров виртуальных машин для [Windows](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [Linux](../virtual-machines/linux/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json). 

## <a name="expected-network-throughput"></a>Ожидаемая пропускная способность сети

Ожидаемая пропускная способность сети и количество поддерживаемых сетевых интерфейсов для разных размеров виртуальных машин указаны в описаниях размеров для виртуальных машин [Windows](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) и [Linux](../virtual-machines/linux/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json). Выберите интересующий вас тип, например "Общего назначения", а затем на соответствующей странице выберите серию размеров, например Dv2. Для каждой серии предоставлена таблица с характеристиками, в которой спецификации сети указаны в последнем столбце под названием **Максимальное число сетевых адаптеров и ожидаемая производительность сети (Мбит/с)** . 

Ограничение пропускной способности применяется ко всей виртуальной машине. Пропускная способность не зависит от следующих факторов.
- **Число сетевых интерфейсов**: Ограничение пропускной способности является накопительным для всего исходящего трафика виртуальной машины.
- **Ускоренная сеть**: Хотя эта функция может быть полезной при достижении опубликованного ограничения, она не меняет это ограничение.
- **Назначение трафика**: Все назначения подсчитывается в сторону исходящего ограничения.
- **Протокол**: Весь исходящий трафик по всем протоколам подсчитывается в сторону ограничения.

## <a name="network-flow-limits"></a>Ограничения сетевого потока

Помимо пропускной способности, количество сетевых подключений, имеющихся на виртуальной машине в любой конкретный момент времени, может повлиять на производительность сети. Стек сетей Azure сохраняет состояние для каждого направления соединения TCP/UDP в структурах данных, называемых "потоками". Типичное подключение TCP/UDP будет иметь 2 потока, один для входящего, а другой для исходящего направления. 

Передача данных между конечными точками требует создания нескольких потоков в дополнение к тем, которые выполняют перенос данных. Некоторые примеры — это потоки, созданные для разрешения DNS и потоки, созданные для проверок работоспособности подсистемы балансировки нагрузки. Кроме того, обратите внимание, что сетевые виртуальные устройства (NVA), такие как шлюзы, прокси-серверы, брандмауэры, будут видеть потоки, создаваемые для соединений, прерванных на устройстве и созданные устройством. 

![Число потоков для диалога TCP через устройство пересылки](media/virtual-machine-network-throughput/flow-count-through-network-virtual-appliance.png)

## <a name="flow-limits-and-recommendations"></a>Ограничения потока и рекомендации

Сегодня сетевой стек Azure поддерживает 250 000 общее количество потоков сети с высокой производительностью для виртуальных машин с более чем 8 ядрами ЦП и общее количество последовательностей с высокой производительностью для виртуальных машин с менее чем 8 ядрами ЦП. За пределами этого ограничения производительность сети постепенно снижается для дополнительных потоков до предела в 1 МБ, а затем 500 тыс Inbound и 500 тыс Outbound, после чего дополнительные потоки удаляются.

||Виртуальные машины с < 8 ядер ЦП|Виртуальные машины с 8 и ядром ЦП|
|---|---|---|
|<b>Хорошая производительность</b>|последовательности 100 КБ |Потоки 250 000|
|<b>Снижение производительности</b>|Свыше 100 000 последовательностей|Выше потоков 250 000|
|<b>Ограничение потока</b>|1 млн потоков|1 млн потоков|

Метрики доступны в [Azure Monitor](../azure-monitor/platform/metrics-supported.md#microsoftcomputevirtualmachines) для контроля количества сетевых потоков и частоты создания потоков на ЭКЗЕМПЛЯРАХ виртуальной машины или VMSS.

![Азуре-монитор-Флов-Метрикс. png](media/virtual-machine-network-throughput/azure-monitor-flow-metrics.png)

Использование подключения и тарифов на увольнение также могут повлиять на производительность сети в качестве установления соединения и завершения использования ресурсов ЦП с помощью подпрограмм обработки пакетов. Рекомендуется протестировать рабочие нагрузки в соответствии с ожидаемыми шаблонами трафика и масштабировать рабочие нагрузки соответствующим образом в соответствии с потребностями производительности. 

## <a name="next-steps"></a>Следующие шаги

- [Оптимизации пропускной способности сети для виртуальной машины Azure](virtual-network-optimize-network-bandwidth.md)
- [Проверка пропускной способности (NTTTCP)](virtual-network-bandwidth-testing.md) для виртуальной машины
