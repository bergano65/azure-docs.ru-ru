---
title: Обзор Azure Blueprints
description: Описание службы Azure Blueprints, с помощью которой можно создавать, определять и развертывать артефакты в среде Azure.
ms.date: 05/06/2020
ms.topic: overview
ms.openlocfilehash: 3a7cece81027bd8ac79250f2f2cd08da637b5f0b
ms.sourcegitcommit: f684589322633f1a0fafb627a03498b148b0d521
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2020
ms.locfileid: "85970932"
---
# <a name="what-is-azure-blueprints"></a>Что такое Azure Blueprint?

Так же, как чертеж позволяет инженеру или архитектору набросать конструктивные параметры для проекта, схемы Azure Blueprint позволяют облачным архитекторам и центральным ИТ-группам определять воспроизводимый набор ресурсов Azure, который реализует стандарты, шаблоны и требования организации и соблюдает их. С помощью Azure Blueprints группы разработчиков могут быстро создавать и настраивать новые среды, зная, что они создаются в соответствии с требованиями организации с рядом встроенных возможностей, таких как сетевое взаимодействие, для ускорения разработки и поставки.

Схемы — это декларативный способ оркестрации развертывания различных шаблонов ресурсов и других артефактов, таких как:

- Назначения ролей
- Назначения политик
- Шаблоны Azure Resource Manager (шаблоны ARM)
- Группы ресурсов

Служба Azure Blueprint поддерживает глобально распределенную базу данных [Azure Cosmos DB](../../cosmos-db/introduction.md). Объекты схемы реплицируются в нескольких регионах Azure. Такая репликация обеспечивает низкую задержку, высокий уровень доступности и постоянный доступ к объектам схемы, независимо от того, в каком регионе служба Azure Blueprints развернула ресурсы.

## <a name="how-its-different-from-arm-templates"></a>Отличия от шаблонов ARM

Служба предназначена для помощи с _настройкой среды_. Эта настройка часто включает набор групп ресурсов, политик, назначений ролей и развертываний шаблонов ARM. Схема — это пакет, который объединяет все эти _артефакты_. Вы можете компоновать такие пакеты и создавать их версии, в том числе через конвейер CI/CD. В конечном счете каждый из них назначается подписке за одну операцию, которую можно контролировать и отслеживать.

Почти все, что вы решите включить в схемы для развертывания в Azure Blueprints, можно реализовать с помощью шаблонов ARM. При этом шаблоны ARM — это документы, которые не существуют в Azure в исходном виде. Каждый из них хранится локально или в системе управления версиями. Шаблон используется для развертывания одного или нескольких ресурсов Azure, но после развертывания этих ресурсов нет ни активного подключения с используемым шаблоном, ни отношения к нему.

В Azure Blueprints связь между определением схемы (тем, _что должно быть_ развернуто) и назначением схемы (тем, _что было_ развернуто) сохраняется. Это подключение поддерживает улучшенные отслеживание и аудит развертываний. Azure Blueprints также поддерживает одновременное обновление нескольких подписок, управляемых одной схемой.

Нет необходимости выбирать между схемой и шаблоном ARM. В каждой схеме может быть несколько _артефактов_ шаблона ARM. Это означает, что предыдущие действия по разработке и поддержке библиотеки шаблонов ARM не будут напрасными, так как все это можно использовать в Azure Blueprints.

## <a name="how-its-different-from-azure-policy"></a>В чем отличие от Политики Azure

Схема — это пакет или контейнер для составления специальных наборов стандартов, шаблонов и требований к реализации облачных служб Azure, безопасности и разработке, которые можно использовать многократно для поддержания согласованности и соответствия требованиям.

[Политика](../policy/overview.md) — это система разрешений по умолчанию и явных запретов, ориентированная на свойства ресурсов во время развертывания и предназначенная для уже существующих ресурсов. Она поддерживает облачное управление, проверяя соответствие ресурсов в подписке требованиям и стандартам.

Включение политики в схему позволяет создавать правильный шаблон или проект во время назначения схемы. Применение политики также гарантирует, что в среду могут вноситься только утвержденные или планируемые изменения. Это обеспечивает постоянное соответствие целям схемы.

Политику можно включать в определение схем в качестве одного из многих _артефактов_. Схемы также поддерживают использование параметров с политиками и инициативами.

## <a name="blueprint-definition"></a>Определение схемы

Схема состоит из _артефактов_. Сейчас Azure Blueprints поддерживает следующие ресурсы в качестве артефактов:

|Ресурс  | Параметры иерархии| Описание  |
|---------|---------|---------|
|Группы ресурсов | Подписка | Создайте новую группу ресурсов для использования другими артефактами в схеме.  Эти группы ресурсов-заполнителей позволяют упорядочивать ресурсы в точном соответствии с требуемой структурой и предоставляют механизм ограничения области для включенных артефактов назначения политик и ролей и шаблонов ARM. |
|Шаблон ARM | Подписка, группа ресурсов | Шаблоны, включая вложенные и связанные, используются для создания сложных сред. Примеры сред: ферма SharePoint, платформа настройки состояния службы автоматизации Azure или рабочая область Log Analytics. |
|Назначение политики | Подписка, группа ресурсов | Позволяет назначать политику или инициативу подписке, которой назначена схема. Эта политика или инициатива должна быть в области расположения определения схемы. Если политика или инициатива имеет параметры, эти параметры назначаются при создании схемы или во время назначения схемы. |
|Назначение ролей | Подписка, группа ресурсов | Добавьте существующего пользователя или группу во встроенную роль, чтобы соответствующие пользователи всегда имели соответствующий доступ к ресурсам. Назначения ролей можно определить для всей подписки или в определенной группе ресурсов, включенной в схему. |

### <a name="blueprint-definition-locations"></a>Расположения определений схемы

При создании определения схемы вы указываете место сохранения схемы. Схемы можно сохранять только в [группах управления](../management-groups/overview.md) или подписках, к которым у вас есть доступ **участника**. Если расположение представляет собой группу управления, схему можно назначать любой дочерней подписке этой группы управления.

### <a name="blueprint-parameters"></a>Параметры схемы

Схемы могут передавать параметры в политику или инициативу либо в шаблон ARM. При добавлении в схему какого-либо _артефакта_ автор выбирает, предоставить ли определенное значение каждому назначению схемы или разрешить предоставлять значение каждому назначению схемы во время назначения. Такая гибкость позволяет задать предопределенное значение для всех видов использования схемы или разрешить принимать это решение во время назначения.

> [!NOTE]
> Схема может иметь собственные параметры, но в настоящее время их можно создать только в том случае, если схема была создана из REST API, а не на портале.

Дополнительные сведения см. в описании [параметров схемы](./concepts/parameters.md).

### <a name="blueprint-publishing"></a>Публикация схемы

Изначально, когда схема создается, она находится в режиме **черновика**. Когда она будет готова к назначению, ее следует **опубликовать**. Для публикации необходимо задать строку **версия** (буквы, цифры и дефисы, не более 20 символов) и при желании указать необязательные **сведения об изменениях**. Каждый вариант этой схемы, полученный в результате будущих изменений, имеет свою **версию**, и можно назначать любую версию этой схемы. Кроме того, можно также назначать разные **версии** одной и той же схемы одной подписке. Когда в схему вносятся дополнительные изменения, **опубликованная**
**версия** продолжает существовать как версия с **неопубликованными изменениями**. После завершения изменений обновленная схема **публикуется** с новой и уникальной **версией**, и с этого момента ее также можно назначать.

## <a name="blueprint-assignment"></a>Назначение схемы

Каждую **опубликованную** **версию** схемы (с именем максимальной длины в 90 символов) можно назначить существующей подписке. На портале схеме по умолчанию назначается **версия**, соответствующая версии последней **опубликованной** схемы. Если имеются параметры артефакта (или параметры схемы), они будут задаваться в процессе назначения.

## <a name="permissions-in-azure-blueprints"></a>Разрешения в Azure Blueprint

Чтобы использовать схемы, вам должны быть предоставлены разрешения с помощью [управления доступом на основе ролей](../../role-based-access-control/overview.md) (RBAC). Для создания схем ваша учетная запись должна иметь следующие разрешения:

- `Microsoft.Blueprint/blueprints/write` — создание определения схемы
- `Microsoft.Blueprint/blueprints/artifacts/write` — создание артефактов в определении схемы
- `Microsoft.Blueprint/blueprints/versions/write` — публикация схемы

Для удаления схем ваша учетная запись должна иметь следующие разрешения:

- `Microsoft.Blueprint/blueprints/delete`
- `Microsoft.Blueprint/blueprints/artifacts/delete`
- `Microsoft.Blueprint/blueprints/versions/delete`

> [!NOTE]
> Разрешения на определение схем должны быть предоставлены или унаследованы в области группе управления или подписке, где они хранятся.

Для назначения или отмены назначения схем ваша учетная запись должна иметь следующие разрешения:

- `Microsoft.Blueprint/blueprintAssignments/write` — назначение схемы
- `Microsoft.Blueprint/blueprintAssignments/delete` — отмена назначения схемы

> [!NOTE]
> Так как назначения схем создаются в подписке, разрешения на назначение и отмену назначения схем должны быть предоставлены в области подписки или унаследованы в области подписки.

Доступны следующие встроенные роли:

|Роль RBAC | Описание |
|-|-|
|[Владелец](../../role-based-access-control/built-in-roles.md#owner) | Наряду с другими разрешениями включает все разрешения, связанные с Azure Blueprint. |
|[Участник](../../role-based-access-control/built-in-roles.md#contributor) | Наряду с другими разрешениями позволяет создавать и удалять определения схем, но не назначать схемы. |
|[Участник схемы](../../role-based-access-control/built-in-roles.md#blueprint-contributor) | Позволяет управлять определениями схем, но не назначать их. |
|[Оператор схемы](../../role-based-access-control/built-in-roles.md#blueprint-operator) | Позволяет назначать существующие опубликованные схемы, но не создавать новые определения схем. Назначение схемы нужно выполнять только с использованием управляемого удостоверения, назначаемого пользователем. |

Если эти встроенные роли не соответствуют вашим требованиям безопасности, можно создать [настраиваемую роль](../../role-based-access-control/custom-roles.md).

> [!NOTE]
> При использовании управляемого удостоверения, назначенного системой, субъекту-службе для Azure Blueprints требуется роль **владельца** в назначенной подписке, чтобы включить развертывание. При использовании портала эта роль автоматически предоставляется для развертывания и отменяется после завершения развертывания. При использовании REST API эту роль необходимо предоставлять вручную, но она тоже автоматически отменяется после завершения развертывания. При использовании управляемого удостоверения, назначенного пользователем, разрешение `Microsoft.Blueprint/blueprintAssignments/write` нужно только пользователю, создающему назначение схемы. Это разрешение предоставляется с ролью **Владелец** и **Оператор схемы**.

## <a name="naming-limits"></a>Ограничения имен

Для некоторых полей применяются следующие ограничения:

|Объект|Поле|Допустимые символы|Макс. Длина|
|-|-|-|-|
|Схема|Имя|буквы, цифры, дефисы и точки|48|
|Схема|Версия|буквы, цифры, дефисы и точки|20|
|Назначение схемы|Имя|буквы, цифры, дефисы и точки|90|
|Артефакт схемы|Имя|буквы, цифры, дефисы и точки|48|

## <a name="video-overview"></a>Видеообзор

Обзор Azure Blueprint из цикла видеоматериалов "Пятницы с Azure". См. видеообзор [Azure Blueprint из цикла видеоматериалов "Пятницы с Azure"](https://channel9.msdn.com/Shows/Azure-Friday/An-overview-of-Azure-Blueprints) на канале Channel 9.

> [!VIDEO https://www.youtube.com/embed/cQ9D-d6KkMY]

## <a name="next-steps"></a>Дальнейшие действия

- [Создание схемы с помощью портала](./create-blueprint-portal.md).
- [Создание схемы с помощью PowerShell](./create-blueprint-powershell.md).
- [Создание схемы с помощью REST API](./create-blueprint-rest-api.md).