---
title: Определение причин несоответствия требованиям
description: Если ресурс является несоответствующим, существует множество возможных причин. Узнайте, как выяснения причины несоответствия.
author: DCtheGeek
ms.author: dacoulte
ms.date: 03/30/2019
ms.topic: conceptual
ms.service: azure-policy
manager: carmonm
ms.openlocfilehash: 0af3fd8596bf558f9d5cc97c95be773aa40954cc
ms.sourcegitcommit: bf509e05e4b1dc5553b4483dfcc2221055fa80f2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "59995016"
---
# <a name="determine-causes-of-non-compliance"></a>Определение причин несоответствия требованиям

Когда ресурс Azure определяется как несоответствующее в правило политики, необходимо понять, какая часть ресурса не соответствует требованиям, с помощью правила. Это также позволяет понять, какие изменения изменен ранее соответствующее ресурс, чтобы сделать его как несоответствующие. Существует два способа получить эти сведения:

> [!div class="checklist"]
> - [Сведения о соответствии](#compliance-details)
> - [Журнал изменений (Предварительная версия)](#change-history-preview)

## <a name="compliance-details"></a>Сведения о соответствии

Если ресурс является несоответствующим, сведения о соответствии для этого ресурса доступны из **соответствие политике** страницы. В области сведений соответствия включает в себя следующие сведения:

- Сведения о ресурсах, например имя, тип, расположение и ресурсов по Идентификатору
- Состояние соответствия и отметка времени последнего вычисления текущей назначения политики
- Список _причин_ несоответствии ресурсов

> [!IMPORTANT]
> Как сведения о соответствии для _несоответствующие_ ресурсе показано текущее значение свойства в этом ресурсе, пользователь должен иметь **чтение** операции **тип** из ресурс. Например если _несоответствующие_ ресурс является **Microsoft.Compute/virtualMachines** затем пользователь должен иметь **Microsoft.Compute/virtualMachines/read** операция. Если у пользователя нет необходимых операцию, отображается ошибка доступа.

Чтобы просмотреть сведения о соответствии, выполните следующие действия.

1. Запустите службу "Политика Azure" на портале Azure, щелкнув **Все службы**, а затем выполнив поиск и выбрав **Политика**.

1. На **Обзор** или **соответствия** выберите политику в **состояние соответствия** то есть _несоответствующие_.

1. В разделе **соответствие ресурсов** вкладке **соответствие политике** странице, щелкните правой кнопкой мыши или нажмите кнопку с многоточием ресурса в **состояние соответствия** то есть  _Несовместимые_. Затем выберите **просмотреть сведения о соответствии**.

   ![Параметр сведений соответствия представления](../media/determine-non-compliance/view-compliance-details.png)

1. **Сведения о соответствии** панели отображаются сведения из последней оценки ресурса для текущего назначения политики. В этом примере поле **Microsoft.Sql/servers/version** является _12.0_ хотя ожидалось Определение политики _14.0_. Если ресурс является несоответствующим по нескольким причинам, каждый присутствует в этой области.

   ![Сведения о соответствия и причины несоответствия](../media/determine-non-compliance/compliance-details-pane.png)

   Для **auditIfNotExists** или **deployIfNotExists** Определение политики, эти сведения включают **details.type** свойство и любые дополнительные свойства. Список, см. в разделе [свойства auditIfNotExists](../concepts/effects.md#auditifnotexists-properties) и [deployIfNotExists свойства](../concepts/effects.md#deployifnotexists-properties). **Последняя проверка ресурсов** является ресурсом, связанных с **сведения** часть определения.

   Пример частичной **deployIfNotExists** определение:

   ```json
   {
       "if": {
           "field": "type",
           "equals": "[parameters('resourceType')]"
       },
       "then": {
           "effect": "DeployIfNotExists",
           "details": {
               "type": "Microsoft.Insights/metricAlerts",
               "existenceCondition": {
                   "field": "name",
                   "equals": "[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-', field('name'))]"
               },
               "existenceScope": "subscription",
               "deployment": {
                   ...
               }
           }
       }
   }
   ```

   ![Область сведений соответствия - * ifNotExists](../media/determine-non-compliance/compliance-details-pane-existence.png)

> [!NOTE]
> Для защиты данных, в том случае, когда значение свойства является _секрет_ текущее значение отображается звездочка.

Эти сведения объяснить, почему ресурс является в настоящее время несоответствующим, но не отображаются, когда изменения к ресурсу, из-за нарушения соответствия. Дополнительные сведения см. в разделе [журнал (Предварительная версия) изменений](#change-history-preview) ниже.

### <a name="compliance-reasons"></a>Соответствия требованиям

Приведенной ниже таблице сопоставляет каждое возможное _Причина_ чтобы ответственный [условие](../concepts/definition-structure.md#conditions) в определении политики:

|Причина | Условие |
|-|-|
|Текущее значение может содержать целевое значение как ключ. |containsKey или **не** notContainsKey |
|Текущее значение может содержать целевое значение. |содержит или **не** notContains |
|Текущее значение должно быть равно целевому. |равно или **не** notEquals |
|Текущее значение должен существовать. |exists (существует) |
|Текущее значение должно быть включено в целевое значение. |в или **не** notIn |
|Текущее значение должно находиться как целевое значение. |как и или **не** notLike |
|Текущее значение должно с учетом регистра соответствовать целевому значению. |соответствует или **не** notMatch |
|Текущее значение должно без учета регистра соответствовать целевому значению. |matchInsensitively или **не** notMatchInsensitively |
|Текущее значение не может содержать целевое значение как ключ. |notContainsKey или **не** containsKey|
|Текущее значение не должно содержать целевое значение. |notContains или **не** содержит |
|Текущее значение не должно быть равно целевому. |notEquals или **не** равно |
|Текущее значение не должно существовать. |**не** существует  |
|Текущее значение не должно быть в целевое значение. |notIn или **не** в |
|Текущее значение не должно быть как целевое значение. |notLike или **не** как |
|Текущее значение не должно с учетом регистра соответствовать целевому значению. |notMatch или **не** соответствует |
|Текущее значение не должно без учета регистра соответствовать целевому значению. |notMatchInsensitively или **не** matchInsensitively |
|Нет связанных ресурсов, соответствующих сведениям о воздействии в определении политики. |Ресурс типа, определенного в **then.details.type** и связанный ресурс, определенный в **Если** часть правила политики не существует. |

## <a name="change-history-preview"></a>Журнал изменений (предварительная версия)

Как часть нового **общедоступной предварительной версии**, последние 14 дней изменений журнал доступен для всех ресурсов Azure, которые поддерживают [завершить режим удаления](../../../azure-resource-manager/complete-mode-deletion.md). Журнал изменений содержит подробные сведения о том, когда было обнаружено изменение и _отличия между визуальными элементами_ для каждого изменения. Обнаружение изменений активируется в том случае, когда добавлены, удалены или изменены свойства Resource Manager.

1. Запустите службу "Политика Azure" на портале Azure, щелкнув **Все службы**, а затем выполнив поиск и выбрав **Политика**.

1. На **Обзор** или **соответствия** выберите политику в любом **состояние соответствия**.

1. В разделе **соответствие ресурсов** вкладке **соответствие политике** странице, выберите ресурс.

1. На странице **Соответствие ресурсов** выберите вкладку **Журнал изменений (предварительная версия)**. После этого отобразится список обнаруженных изменений (при наличии).

   ![Вкладка "Политика журнал изменений на странице соответствие ресурсов"](../media/determine-non-compliance/change-history-tab.png)

1. Выберите одно из обнаруженных изменений. _Visual diff_ для ресурса, отображаемым на **журнал изменений** страницы.

   ![Политика изменения журнала Visual Diff на странице журнала изменений](../media/determine-non-compliance/change-history-visual-diff.png)

_Отличия между визуальными элементами_ позволяют обнаружить изменения ресурса. Обнаружены изменения не могут быть связаны с текущее состояние соответствия ресурса.

Предоставляемые данных журнала изменений [график ресурсов Azure](../../resource-graph/overview.md). Чтобы запросить эти сведения за пределами портала Azure, см. в разделе [получить изменения ресурсов](../../resource-graph/how-to/get-resource-changes.md).

## <a name="next-steps"></a>Дальнейшие действия

- См. другие [примеры шаблонов для службы "Политика Azure"](../samples/index.md).
- См. дополнительные сведения о [структуре определения политики](../concepts/definition-structure.md).
- См. дополнительные сведения о [действиях политик](../concepts/effects.md).
- См. сведения о [программном создании политик](programmatically-create.md).
- Узнайте о том, как получить [подробные сведения о соответствии](getting-compliance-data.md).
- См. сведения о том, как [исправлять несоответствующие ресурсы](remediate-resources.md).
- См. дополнительные сведения о группе управления в разделе [Упорядочение ресурсов с помощью групп управления Azure](../../management-groups/overview.md)