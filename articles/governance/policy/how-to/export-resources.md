---
title: Экспорт ресурсов Политики Azure
description: Узнайте, как экспортировать ресурсы политики Azure в GitHub, такие как определения политик и назначения политик.
ms.date: 10/29/2020
ms.topic: how-to
ms.custom: devx-track-azurecli, devx-track-azurepowershell
ms.openlocfilehash: c16ceed755cab3228b8f9e401f486a0629f3a60d
ms.sourcegitcommit: daab0491bbc05c43035a3693a96a451845ff193b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2020
ms.locfileid: "93025720"
---
# <a name="export-azure-policy-resources"></a>Экспорт ресурсов Политики Azure

В этой статье содержатся сведения о том, как экспортировать существующие ресурсы политики Azure. Экспорт ресурсов полезен и рекомендуется для резервного копирования, но он также является важным шагом в вашем пути к управлению облаком и рассматривая вашу [политику как код](../concepts/policy-as-code.md). Ресурсы политики Azure можно экспортировать с помощью [портал Azure](#export-with-azure-portal), [Azure CLI](#export-with-azure-cli), [Azure PowerShell](#export-with-azure-powershell)и каждого из поддерживаемых пакетов SDK.

## <a name="export-with-azure-portal"></a>Экспорт с помощью портал Azure

Чтобы экспортировать определение политики с помощью портала Azure, сделайте следующее:

1. Запустите службу Политика Azure на портале Azure, щелкнув **Все службы** , а затем выполнив поиск и выбрав **Политика** .

1. Выберите **Определения** на странице службы Политики Azure слева.

1. Нажмите кнопку **Экспортировать определения** или щелкните значок с многоточием в строке определения политики и выберите **Экспортировать определение** .

1. Нажмите кнопку **Войти по учетным данным GitHub** . Если вы еще не выполнили аутентификацию в GitHub для предоставления Политике Azure прав на экспорт ресурса, изучите разрешения, запрашиваемые [GitHub Actions](https://github.com/features/actions), в новом окне и выберите **Предоставить разрешения для AzureGitHubActions** , чтобы продолжить процесс экспорта. По завершении новое окно автоматически закроется.

1. На вкладке **Основные сведения** задайте следующие параметры, а затем щелкните вкладку **Политики** или нажмите кнопку **Далее: Политики** в нижней части страницы.

   - **Фильтр репозиториев.** Установите значение _Мои репозитории_ , чтобы просмотреть только свои репозитории, или _Все репозитории_ , чтобы просмотреть все репозитории, к которым вы предоставили для GitHub Actions разрешение на доступ.
   - **Репозиторий.** Укажите репозиторий, в который вы хотите экспортировать ресурсы Политики Azure.
   - **Ветвь.** Укажите ветвь репозитория. Использование ветви, отличающейся от используемой по умолчанию, считается хорошим способом проверки обновлений перед дальнейшим слиянием с исходным кодом.
   - **Каталог** . Выберите _корневую папку_ для экспорта ресурсов Политики Azure. В этой папке будут созданы вложенные папки, в зависимости от типов экспортируемых ресурсов.

1. На вкладке **Политики** настройте область поиска, щелкнув значок с многоточием и выбрав нужное сочетание групп управления, подписок и групп ресурсов.
   
1. С помощью кнопки **Добавить определения политик** найдите нужную область для экспорта объектов. В открывшемся дополнительном окне выберите все нужные объекты для экспорта. Отфильтруйте выбранные элементы по типу или полю поиска. Завершив выбор объектов для экспорта, нажмите кнопку **Добавить** в нижней части страницы.

1. Для каждого выбранного объекта укажите нужный режим экспорта, например _Только определение_ или _Определение и назначения_ . Теперь перейдите на вкладку **Просмотр и экспорт** или нажмите кнопку **Далее: Просмотр и экспорт** в нижней части страницы.

   > [!NOTE]
   > Если вы выбрали вариант _Определение и назначения_ , будут экспортированы только те назначения политики, которые входят в область действия, установленную фильтрами при добавлении этого определения политики.

1. На вкладке **Просмотр и экспорт** проверьте сведения и нажмите кнопку **Экспорт** в нижней части страницы.

1. Зайдите в репозиторий GitHub и проверьте выбранную ветвь и _корневую папку_ , чтобы убедиться, что выбранные ресурсы успешно экспортированы в систему управления версиями.

Ресурсы Политики Azure экспортируются в указанную _корневую папку_ выбранного репозитория GitHub в виде такой структуры:

```text
|
|- <root level folder>/  ________________ # Root level folder set by Directory property
|  |- policies/  ________________________ # Subfolder for policy objects
|     |- <displayName>_<name>____________ # Subfolder based on policy displayName and name properties
|        |- policy.json _________________ # Policy definition
|        |- assign.<displayName>_<name>__ # Each assignment (if selected) based on displayName and name properties
|
```

## <a name="export-with-azure-cli"></a>Экспорт с помощью Azure CLI

Определения политик Azure, инициативы и назначения можно экспортировать в формате JSON с помощью [Azure CLI](/cli/azure/install-azure-cli). Каждая из этих команд использует параметр **Name** для указания объекта, для которого нужно получить JSON. Свойство **Name** часто представляет собой _идентификатор GUID_ , а не **DisplayName** объекта.

- Определение — [AZ определение политики-демонстрация](/cli/azure/policy/definition#az-policy-definition-show)
- Инициатива- [AZ установка политики-определение](/cli/azure/policy/set-definition#az-policy-set-definition-show)
- Назначение — [AZ Policy назначение политики](/cli/azure/policy/assignment#az-policy-assignment-show)

Ниже приведен пример получения JSON для определения политики с **именем** _виртуалмачинестораже_ :

```azurecli-interactive
az policy definition show --name 'VirtualMachineStorage'
```

## <a name="export-with-azure-powershell"></a>Экспорт с помощью Azure PowerShell

Определения политик Azure, инициативы и назначения можно экспортировать в формате JSON с помощью [Azure PowerShell](/powershell/azure/). Каждый из этих командлетов использует параметр **Name** для указания объекта, для которого нужно получить JSON. Свойство **Name** часто представляет собой _идентификатор GUID_ , а не **DisplayName** объекта.

- Определение — [Get-азполицидефинитион](/powershell/module/az.resources/get-azpolicydefinition)
- Инициатива- [Get-азполицисетдефинитион](/powershell/module/az.resources/get-azpolicysetdefinition)
- Назначение — [Get-азполициассигнмент](/powershell/module/az.resources/get-azpolicyassignment)

Ниже приведен пример получения JSON для определения политики с **именем** _виртуалмачинестораже_ :

```azurepowershell-interactive
Get-AzPolicyDefinition -Name 'VirtualMachineStorage' | ConvertTo-Json -Depth 10
```

## <a name="next-steps"></a>Дальнейшие действия

- Рассмотрите [примеры для службы "Политика Azure"](../samples/index.md).
- Изучите статью о [структуре определения Политики Azure](../concepts/definition-structure.md).
- Изучите [сведения о действии политик](../concepts/effects.md).
- Узнайте о [программном создании политик](programmatically-create.md).
- Узнайте, как [исправлять несоответствующие ресурсы](remediate-resources.md).
- Дополнительные сведения о группе управления см. в статье [Упорядочивание ресурсов с помощью групп управления Azure](../../management-groups/overview.md).
