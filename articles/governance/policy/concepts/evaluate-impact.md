---
title: Оценка влияния нового определения политики Azure
description: Изучите процесс, который необходимо выполнить при внедрении нового определения политики в среду Azure.
ms.date: 05/20/2020
ms.topic: conceptual
ms.openlocfilehash: d9844e8435452b388c934c5969898fe01d23fb47
ms.sourcegitcommit: 50673ecc5bf8b443491b763b5f287dde046fdd31
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/20/2020
ms.locfileid: "83684300"
---
# <a name="evaluate-the-impact-of-a-new-azure-policy-definition"></a>Оценка влияния нового определения политики Azure

Политика Azure — это мощный инструмент управления ресурсами Azure в соответствии с бизнес-стандартами и нормативными требованиями. Когда люди, процессы или конвейеры создают или обновляют ресурсы, политика Azure проверяет запрос. Когда цель определения политики — [Append](./effects.md#deny) или [DeployIfNotExists](./effects.md#deployifnotexists), политика изменяет запрос или дополняет его. Когда цель определения политики — [Audit](./effects.md#audit) или [AuditIfNotExists](./effects.md#auditifnotexists), политика приводит к созданию записи в журнале действий. А когда цель определения политики — [Deny](./effects.md#deny), политика останавливает создание или изменение запроса.

Это ожидаемые результаты, если известно, что политика определена правильно. Однако важно проверить, что новая политика работает так, как задумано, прежде чем разрешить ей изменять или блокировать работу. Проверка должна гарантировать, что только требуемые ресурсы будут определены как не соответствующие требованиям, а соответствующие ресурсы не будут ошибочно включены в список (так называемый _ложноположительный результат_).

Для проверки нового определения политики рекомендуется выполнить следующие действия.

- Строгое определение политики
- Аудит существующих ресурсов
- Аудит новых или обновленных запросов ресурсов
- Развертывание политики в ресурсах
- Непрерывный мониторинг

## <a name="tightly-define-your-policy"></a>Строгое определение политики

Важно понимать, как бизнес-политика реализуется в виде определения политики и как ресурсы Azure связаны с другими службами Azure. Этот шаг выполняется путем [определения требований](../tutorials/create-custom-policy-definition.md#identify-requirements) и [определения свойств ресурсов](../tutorials/create-custom-policy-definition.md#determine-resource-properties).
Также важно не ограничиваться узким определением бизнес-политики. Ваша политика гласит: "Все виртуальные машины должны..."? Как насчет других служб Azure, использующих виртуальные машины, например HDInsight или AKS? При определении политики необходимо учитывать, как эта политика влияет на ресурсы, используемые другими службами.

По этой причине определения политик должны быть строгими и направленными на ресурсы и свойства, которые необходимо проверить на соответствие.

## <a name="audit-existing-resources"></a>Аудит существующих ресурсов

Прежде чем начать управление новыми или обновленными ресурсами с помощью нового определения политики, нужно понять, как она оценивает ограниченное подмножество существующих ресурсов, например тестовую группу ресурсов. Используйте для [режима принудительного применения](./assignment-structure.md#enforcement-mode) значение _Disabled_ (DoNotEnforce) для назначения политики, чтобы предотвратить [влияние](./effects.md) или создание записей в журнале действий.

Этот шаг дает возможность оценить результаты проверки соответствия новой политики для существующих ресурсов без влияния на рабочий процесс. Убедитесь, что соответствующие ресурсы не помечены как несоответствующие (_ложноположительный результат_) и что все ресурсы, которые являются несоответствующими, отмечены правильно.
Когда начальное подмножество ресурсов проверено ожидаемым образом, постепенно разверните оценку для всех существующих ресурсов.

Оценка существующих ресурсов таким образом также позволяет исправлять несоответствующие ресурсы до полной реализации новой политики. Эту очистку можно выполнить вручную или с помощью [задачи исправления](../how-to/remediate-resources.md), если воздействие определения политики — _DeployIfNotExists_.

## <a name="audit-new-or-updated-resources"></a>Аудит новых или обновленных ресурсов

После проверки того, правильно ли новое определение политики сообщает о существующих ресурсах, следует рассмотреть влияние политики на создание или обновление ресурсов. Если определение политики поддерживает параметризацию, используйте [аудит](./effects.md#audit). Эта конфигурация позволяет отслеживать создание и обновление ресурсов, чтобы определить, активирует ли новое определение политики запись в журнале действий Azure для ресурса, который не соответствует требованиям, не влияя на существующие рабочие процессы или запросы.

Рекомендуется обновить и создать новые ресурсы, соответствующие определению политики, чтобы убедиться в том, что _аудит_ правильно срабатывает при ожидаемых событиях. Следите за запросами ресурсов, на которые не должно распространяться новое определение политики, запускающими _аудит_.
Эти затронутые ресурсы являются еще одним примером _ложноположительного результата_ и должны быть исправлены в определении политики до полной реализации.

В случае изменения определения политики на этом этапе тестирования рекомендуется начать процесс проверки с аудитом существующих ресурсов. Изменение определения политики для _ложноположительного результата_ в новых или обновленных ресурсах, вероятно, также повлияет на существующие ресурсы.

## <a name="deploy-your-policy-to-resources"></a>Развертывание политики в ресурсах

После завершения проверки нового определения политики с помощью существующих ресурсов и новых или обновленных запросов ресурсов начинается процесс реализации политики. Рекомендуется сначала создать назначение политики для нового определения в подмножестве всех ресурсов, например в группе ресурсов. После проверки первоначального развертывания расширяйте область применения политики все дальше и дальше, например на подписки и группы управления. Это расширение достигается путем удаления назначения и создания нового в целевых областях до тех пор, пока новое определение политики не будет назначено всей области ресурсов, на которую оно должно распространяться.

Если при выпуске обнаружены ресурсы, которые должны быть исключены из нового определения политики, проблему можно устранить одним из следующих способов.

- Изменение определения политики на более явное, чтобы снизить непреднамеренное воздействие.
- Изменение области назначения политики (путем удаления и создания нового назначения).
- Добавление группы ресурсов в список исключений для назначения политики.

Все изменения в области (уровень или исключения) должны быть полностью проверены и согласованы с отделами безопасности и соответствия требованиям, чтобы гарантировать, что все будет учтено.

## <a name="monitor-your-policy-and-compliance"></a>Мониторинг политики и соответствия требованиям

Реализация и назначение определения политики — это не последний шаг. Непрерывно отслеживайте уровень [соответствия](../how-to/get-compliance-data.md) ресурсов для нового определения политики и настраивайте соответствующие [предупреждения и уведомления Azure Monitor](../../../azure-monitor/platform/alerts-overview.md) при обнаружении несоответствующих устройств. Также рекомендуется оценивать определение политики и связанные назначения по расписанию, чтобы убедиться, что определение политики соответствует требованиям бизнес-политики и соответствия. Ненужные политики необходимо удалять. Кроме того, время от времени политики нужно обновлять по мере развития базовых ресурсов Azure и добавления новых свойств и возможностей.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте больше о [структуре определения политик](./definition-structure.md).
- Узнайте больше о [структуре назначения политик](./assignment-structure.md).
- Узнайте больше о [программном создании политик](../how-to/programmatically-create.md).
- Узнайте, как получить [сведения о соответствии](../how-to/get-compliance-data.md).
- Узнайте, как [исправлять несоответствующие ресурсы](../how-to/remediate-resources.md).
- Дополнительные сведения о группе управления см. в статье [Упорядочивание ресурсов с помощью групп управления Azure](../../management-groups/overview.md).