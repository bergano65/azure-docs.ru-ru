---
title: Общие сведения о сетевых подключениях в Azure Service Fabric | Документация Майкрософт
description: Сведения о сетях, шлюзах и интеллектуальной маршрутизации трафика в службе "Сетка Service Fabric".
services: service-fabric-mesh
documentationcenter: .net
author: dkkapur
manager: timlt
editor: ''
ms.assetid: ''
ms.service: service-fabric-mesh
ms.devlang: dotNet
ms.topic: conceptual
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 11/26/2018
ms.author: dekapur
ms.custom: mvc, devcenter
ms.openlocfilehash: b0e1047c5bbd7d8caaf2afd8b002be1c46837852
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "60811019"
---
# <a name="introduction-to-networking-in-service-fabric-mesh-applications"></a>Общие сведения о сетевых подключениях в приложениях службы "Сетка Service Fabric"
В этой статье описываются разные подсистемы балансировки нагрузки, подключение сетей с приложениями к другим сетям через шлюзы, а также маршрутизация трафика между службами в приложениях.

## <a name="layer-4-vs-layer-7-load-balancers"></a>Подсистемы балансировки нагрузки уровня 4 и уровня 7
Балансировка нагрузки для сетевых подключений может выполняться на разных уровнях [модели OSI](https://en.wikipedia.org/wiki/OSI_model) — чаще всего на уровне 4 (L4) или уровне 7 (L7).  Традиционно используются два типа подсистем балансировки нагрузки.

- Подсистема балансировки нагрузки L4 работает на транспортном уровне, который отвечает за доставку пакетов без учета их содержимого. Такая подсистема проверяет только заголовки пакетов, а значит в качестве критериев для балансировки доступны только значения IP-адресов и портов. Предположим, что клиент создает TCP-подключение к подсистеме балансировки нагрузки. Подсистема балансировки нагрузки завершает это подключение (напрямую отвечая на пакет SYN), выбирает серверную часть и создает новое подключение TCP к этой серверной части (отправляет новый пакет SYN). Подсистема балансировки нагрузки L4 обычно работает только на уровне 4, то есть на уровне подключения (сеанса) TCP/UDP. Это означает, что подсистема балансировки нагрузки перенаправляет байты так, чтобы гарантировать отправку всех данных одного сеанса на одну серверную часть. Подсистема балансировки нагрузки L4 не имеет никакой информации о приложениях, которые будут обрабатывать эти переданные байты. Содержимое может относиться к любому протоколу уровня приложений.

- Подсистема балансировки нагрузки L7 работает на уровне приложений, который обрабатывает содержимое каждого пакета. Она проверяет содержимое пакетов и понимает многие протоколы, например HTTP, HTTPS или WebSockets. Это позволяет реализовать более сложные алгоритмы маршрутизации. Давайте рассмотрим пример, в котором клиент создает одно TCP-подключение к подсистеме балансировки нагрузки, используя протокол HTTP/2. Подсистема балансировки нагрузки создает два подключения к серверной части. Когда клиент отправляет два потока HTTP/2 в подсистему балансировки нагрузки, один из этих потоков передается в одну серверную часть, а другой — в другую. Такой подход позволяет эффективно балансировать нагрузку даже для клиентов, использующих мультиплексирование, с очень разными требованиями к запросам. 

## <a name="networks-and-gateways"></a>Сети и шлюзы
В [модели ресурсов Service Fabric](service-fabric-mesh-service-fabric-resources.md) сетевой ресурс развертывается отдельно, независимо от ресурсов приложения или службы, которые могут ссылаться на него как на зависимость. Он позволяет создать сеть для приложений, открытую для доступа из Интернета. В одну сеть могут входить несколько служб из разных приложений. Такая частная сеть создается и управляется Service Fabric и не является виртуальной сетью Azure. Приложения можно динамически добавлять в сетевой ресурс и удалять из него, чтобы включать и отключать подключение к виртуальной сети. 

Шлюз используется для связи двух сетей. Ресурс шлюза развертывает [прокси Envoy](https://www.envoyproxy.io/), который реализует маршрутизацию уровня 4 для любого протокола и расширенную маршрутизацию уровня 7 для приложения HTTP(S). Шлюз направляет трафик в вашу сеть из внешней сети и определяет, в какую службу нужно передать этот трафик.  Внешней сетью может являться открытая сеть (по сути, это общедоступный Интернет) или виртуальная сеть Azure, что позволяет подключаться к другим приложениям и ресурсам Azure. 

![Сеть и шлюз][Image1]

Когда с помощью `ingressConfig` создается сетевой ресурс, ему назначается общедоступный IP-адрес. Этот общедоступный IP-адрес будет привязан к времени существования сетевого ресурса.

Создаваемое в среде "Сетка Service Fabric" приложение должно ссылаться на существующий сетевой ресурс. Вы можете добавить общие порты или удалить имеющиеся порты из конфигурации входящего трафика. Удаление сетевого ресурса завершится ошибкой, если на него есть ссылка в ресурсе приложения. При удалении приложения сетевой ресурс удаляется автоматически.

## <a name="next-steps"></a>Дальнейшие действия 
Чтобы узнать больше о службе "Сетка Service Fabric", прочитайте этот обзор:
- [Обзор службы "Сетка Service Fabric"](service-fabric-mesh-overview.md)

[Image1]: media/service-fabric-mesh-networks-and-gateways/NetworkAndGateway.png