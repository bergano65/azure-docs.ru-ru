---
title: Общие сведения о группах контейнеров
description: Сведения о группах контейнеров в службе "экземпляры контейнеров Azure", коллекции экземпляров, которые совместно используют жизненный цикл и ресурсы, такие как ЦП, хранилище и сеть.
ms.topic: article
ms.date: 11/01/2019
ms.custom: mvc
ms.openlocfilehash: b5f4f834d44294d846495a59af2fb65b231e4820
ms.sourcegitcommit: b9d4b8ace55818fcb8e3aa58d193c03c7f6aa4f1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/29/2020
ms.locfileid: "82583831"
---
# <a name="container-groups-in-azure-container-instances"></a>Группы контейнеров в службе "Экземпляры контейнеров Azure"

Ресурс верхнего уровня в службе "Экземпляры контейнеров Azure" — это *группа контейнеров*. В этой статье представлены сведения о группах контейнеров и описаны сценарии, которые можно реализовать с их помощью.

## <a name="what-is-a-container-group"></a>Что такое группа контейнеров?

Группа контейнеров — это набор контейнеров, которые можно планировать на одном хост-компьютере. Контейнеры в группе контейнеров совместно используют жизненный цикл, ресурсы, локальную сеть и тома хранилища. Он похож на понятие для *Pod* в [Kubernetes][kubernetes-pod].

На схеме ниже показан пример группы контейнеров, включающей несколько контейнеров:

![Диаграмма групп контейнеров][container-groups-example]

Группа контейнеров в этом примере:

* Планируется на одном хост-компьютере.
* Принимает назначенную метку DNS-имени.
* Предоставляет один общедоступный IP-адрес с одним предоставленным портом.
* Состоит из двух частей. Один контейнер ожидает передачи данных на порте 80, а другой — на порте 5000.
* Включает два общих файловых ресурса Azure в качестве подключенных томов. При этом к каждому контейнеру локально подключен один из общих ресурсов.

> [!NOTE]
> В настоящее время группы с несколькими контейнерами поддерживают только контейнеры Linux. Для контейнеров Windows служба "экземпляры контейнеров Azure" поддерживает только развертывание одного экземпляра контейнера. Пока мы работаем над переносом всех компонентов в контейнеры Windows, в [обзоре](container-instances-overview.md#linux-and-windows-containers)службы можно найти различия в текущих платформах.

## <a name="deployment"></a>Развертывание

Ниже приведены два распространенных способа развертывания группы с несколькими контейнерами. Используйте [шаблон диспетчер ресурсов][resource-manager template] или [YAML-файл][yaml-file]. Шаблон диспетчер ресурсов рекомендуется использовать, если требуется развернуть дополнительные ресурсы службы Azure (например, файловый [ресурс Azure][azure-files]) при развертывании экземпляров контейнера. Из-за более краткой природы формата YAML рекомендуется использовать файл YAML, если развертывание включает только экземпляры контейнеров. Дополнительные сведения о свойствах, которые можно задать, см. в [справочнике по шаблону диспетчер ресурсов](/azure/templates/microsoft.containerinstance/containergroups) или в [справочной](container-instances-reference-yaml.md) документации по YAML.

Чтобы сохранить конфигурацию группы контейнеров, можно экспортировать конфигурацию в файл YAML с помощью команды Azure CLI [AZ Container Export][az-container-export]. Экспорт позволяет хранить конфигурации групп контейнеров в системе управления версиями для "конфигурации как кода". Или вы можете использовать экспортированный файл в качестве отправной точки при разработке новой конфигурации в YAML-файле.



## <a name="resource-allocation"></a>Выделение ресурсов

Служба "экземпляры контейнеров Azure" выделяет ресурсы, такие как ЦП, память и (необязательно) [GPU][gpus] (Предварительная версия), в группу с несколькими контейнерами, добавляя [запросы ресурсов][resource-requests] к экземплярам в группе. Если вы создаете группу контейнеров с двумя экземплярами контейнеров, которые запрашивают 1 ЦП, то для каждой группы контейнеров выделяется 2 процессора.

### <a name="resource-usage-by-container-instances"></a>Использование ресурсов по экземплярам контейнеров

Каждому экземпляру контейнера в группе назначаются ресурсы, указанные в запросе ресурса. Однако максимальное количество ресурсов, используемых экземпляром контейнера в группе, может отличаться при настройке свойства необязательного [ограничения ресурсов][resource-limits] . Ограничение ресурса для экземпляра контейнера должно быть больше или равно значению обязательного свойства [запроса ресурса][resource-requests] .

* Если не указать ограничение ресурса, максимальное использование ресурсов экземпляром контейнера будет таким же, как и его запрос ресурса.

* Если указать ограничение для экземпляра контейнера, максимальное использование экземпляра может быть больше запроса, вплоть до установленного предела. Соответственно, использование ресурсов другими экземплярами контейнеров в группе может уменьшиться. Максимальный предел ресурсов, который можно задать для экземпляра контейнера, — общее количество ресурсов, выделенных группе.
    
Например, в группе с двумя экземплярами контейнеров, каждый из которых запрашивает 1 ЦП, в одном из контейнеров может выполняться рабочая нагрузка, требующая больше процессоров, чем другая.

В этом сценарии можно задать ограничение ресурсов не более чем на 2 процессора для экземпляра контейнера. Такая конфигурация позволяет экземпляру контейнера использовать до 2 ЦП, если он доступен.

> [!NOTE]
> Основная инфраструктура службы использует небольшой объем ресурсов группы контейнеров. Ваши контейнеры смогут получать доступ к большинству, но не ко всем ресурсам, выделенным группе. По этой причине запланируйте небольшой буфер ресурсов при запросе ресурсов для контейнеров в группе.

### <a name="minimum-and-maximum-allocation"></a>Минимальное и максимальное выделение

* Выделите не **менее** 1 ЦП и 1 ГБ памяти для группы контейнеров. Отдельные экземпляры контейнера в группе могут быть подготовлены с использованием менее 1 ЦП и 1 ГБ памяти. 

* Сведения о **максимальном объеме** ресурсов в группе контейнеров см. в разделе [доступность ресурсов][region-availability] для экземпляров контейнеров Azure в регионе развертывания.

## <a name="networking"></a>Сеть

Группы контейнеров могут совместно использовать внешний IP-адрес, один или несколько портов на этом IP-адресе, а также метку DNS с полным доменным именем (FQDN). Чтобы внешние клиенты могли получить доступ к контейнеру в группе, необходимо предоставить порт по IP-адресу и из контейнера. IP-адрес и полное доменное имя группы контейнеров освобождаются при удалении группы контейнеров. 

В пределах группы контейнеров экземпляры контейнеров могут взаимодействовать друг с другом через localhost на любом порте, даже если эти порты не предоставляются извне на IP-адрес или из контейнера группы.

При необходимости разверните группы контейнеров в [виртуальной сети Azure][virtual-network] , чтобы обеспечить безопасное взаимодействие контейнеров с другими ресурсами в виртуальной сети.

## <a name="storage"></a>Память

Вы можете указать внешние тома для подключения в пределах группы контейнеров. К поддерживаемым томам относятся:
* [Файловый ресурс Azure][azure-files]
* [Секрет][secret]
* [Пустой каталог][empty-directory]
* [Клонированный репозиторий Git][volume-gitrepo]

Эти тома можно сопоставить с конкретными путями в пределах отдельных контейнеров в группе. 

## <a name="common-scenarios"></a>Распространенные сценарии

Многоконтейнерные группы удобны в случаях, когда нужно разделить одну функциональную задачу на небольшое число образов контейнеров. Эти образы затем могут доставляться различными командами сотрудников и иметь отдельные требования к ресурсам.

Пример использования может включать следующее:

* Контейнер, обслуживающий веб-приложение, и контейнер, извлекающий последнее содержимое из системы управления версиями.
* Контейнер приложения и журнала. Контейнер журнала собирает журналы и выходные данные метрик для основного приложения и записывает их в хранилище для долговременного хранения.
* Контейнер приложения и мониторинга. Контейнер мониторинга периодически выполняет запрос к приложению, чтобы убедиться, что оно правильно работает и отвечает, и выдает предупреждение, если это не так.
* Интерфейсный контейнер и серверный контейнер. Внешний интерфейс может обслуживать веб-приложение с серверной частью службы для получения данных. 

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как развертывать группу контейнеров с несколькими контейнерами с использованием шаблона Azure Resource Manager:

> [!div class="nextstepaction"]
> [Развертывание группы контейнеров][resource-manager template]

<!-- IMAGES -->
[container-groups-example]: ./media/container-instances-container-groups/container-groups-example.png

<!-- LINKS - External -->
[dcos-pod]: https://dcos.io/docs/1.10/deploying-services/pods/
[kubernetes-pod]: https://kubernetes.io/docs/concepts/workloads/pods/pod/

<!-- LINKS - Internal -->
[resource-manager template]: container-instances-multi-container-group.md
[yaml-file]: container-instances-multi-container-yaml.md
[region-availability]: container-instances-region-availability.md
[resource-requests]: /rest/api/container-instances/containergroups/createorupdate#resourcerequests
[resource-limits]: /rest/api/container-instances/containergroups/createorupdate#resourcelimits
[resource-requirements]: /rest/api/container-instances/containergroups/createorupdate#resourcerequirements
[azure-files]: container-instances-volume-azure-files.md
[virtual-network]: container-instances-virtual-network-concepts.md
[secret]: container-instances-volume-secret.md
[volume-gitrepo]: container-instances-volume-gitrepo.md
[gpus]: container-instances-gpu.md
[empty-directory]: container-instances-volume-emptydir.md
[az-container-export]: /cli/azure/container#az-container-export
