---
title: Общие сведения о портале разработчика в службе управления API Azure
titleSuffix: Azure API Management
description: Узнайте о портале разработчика в оснастке управления API — настраиваемом веб-сайте, где потребители API могут исследовать ваши API.
services: api-management
documentationcenter: API Management
author: mikebudzynski
manager: cfowler
editor: ''
ms.service: api-management
ms.workload: mobile
ms.tgt_pltfrm: na
ms.topic: article
ms.date: 10/15/2020
ms.author: apimpm
ms.openlocfilehash: 30a6a73768db7b073258487435ddbe6c0daccf16
ms.sourcegitcommit: ce8eecb3e966c08ae368fafb69eaeb00e76da57e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2020
ms.locfileid: "92317823"
---
# <a name="overview-of-the-developer-portal"></a>Общие сведения о портале разработчика

Портал разработчика — это автоматически создаваемый, полностью настраиваемый веб-сайт с документацией по API. Именно здесь пользователи API могут обнаружить ваши API, узнать, как их использовать, запросить доступ и испытать их.

В этой статье описываются различия между самостоятельным размещением и управляемыми версиями портала разработчика в управлении API. Здесь также содержатся ответы на часто задаваемые вопросы.

![Портал разработчика API Management](media/api-management-howto-developer-portal/cover.png)

[!INCLUDE [premium-dev-standard-basic.md](../../includes/api-management-availability-premium-dev-standard-basic.md)]

## <a name="migration-from-the-legacy-portal"></a>Миграция с устаревшего портала

> [!IMPORTANT]
> Устаревший портал разработчика теперь является устаревшим и будет принимать только обновления для системы безопасности. Вы можете по-прежнему использовать его в обычном режиме до его выхода в октябре 2023, когда он будет удален из всех служб управления API.

Переход на новый портал разработчика описан в [статье о выделенной документации](developer-portal-deprecated-migration.md).

## <a name="customization-and-styling"></a>Настройка и стилизация

Портал разработчика можно настроить и использовать в качестве стиля с помощью встроенного визуального редактора, поддерживающего перетаскивание. Дополнительные сведения см. в [этом руководстве](api-management-howto-developer-portal-customize.md) .

## <a name="extensibility"></a><a name="managed-vs-self-hosted"></a> Расширяемость

Служба управления API включает встроенный, всегда обновленный **управляемый** портал разработчика. Доступ к нему можно получить из интерфейса портал Azure.

Если необходимо расширить его с помощью пользовательской логики, которая не поддерживается готовым к работе, можно изменить ее базу кода. База кода портала [доступна в репозитории GitHub][1]. Например, можно реализовать новое мини-приложение, которое интегрируется со сторонней системой поддержки. При реализации новых функциональных возможностей можно выбрать один из следующих вариантов.

- **Самостоятельное размещение** конечного портала за пределами службы управления API. При самостоятельном размещении портала становится его сопровождением, и вы несете ответственность за его обновление. Помощь в поддержке Azure ограничена только базовой настройкой собственных порталов, как описано в [разделе вики репозитория][2].
- Откройте запрос на вытягивание для группы управления API, чтобы объединить новые функции с базой кода **управляемого** портала.

Дополнительные сведения о расширяемости и инструкции см. в [репозитории GitHub][1] и [руководствах по реализации мини-][3]приложения. [Руководство по настройке управляемого портала](api-management-howto-developer-portal-customize.md) поможет вам через панель администрирования портала, которая является общей для **управляемых** и **самостоятельных** версий.

## <a name="frequently-asked-questions"></a><a name="faq"></a> Часто задаваемые вопросы

В этом разделе мы будем отвечать на часто задаваемые вопросы о портале разработчика, который является общим характером. Вопросы, относящиеся к локальной версии, см. в [разделе Wiki репозитория GitHub](https://github.com/Azure/api-management-developer-portal/wiki).

### <a name="how-can-i-migrate-from-the-preview-version-of-the-portal"></a><a id="preview-to-ga"></a> Как перейти с предварительной версии портала?

При первом запуске предварительной версии портала разработчика вы подготовили предварительную версию содержимого по умолчанию в службе управления API. Содержимое по умолчанию существенно изменилось в общедоступной версии. Например, предварительная версия содержимого по умолчанию не включает кнопки OAuth на страницах входа, она использует различные мини-приложения для отображения интерфейсов API и зависит от ограниченных возможностей для структурирования страниц портала разработчика. Несмотря на различия в содержимом, подсистема портала (включая базовые мини-приложения) автоматически обновляется каждый раз при публикации портала разработчика.

Если вы сильно настроили портал на основе предварительной версии содержимого, вы можете продолжать использовать его как есть и размещать новые мини-приложения вручную на страницах портала. В противном случае мы рекомендуем заменить содержимое портала новым содержимым по умолчанию.

Чтобы сбросить содержимое на управляемом портале, в разделе меню " **операции** " выберите команду " **сбросить содержимое** ". Эта операция приведет к удалению всего содержимого портала и подготовке нового содержимого по умолчанию. Все настройки и изменения портала разработчика будут потеряны. **Это действие нельзя отменить**.

![Сброс содержимого портала](media/api-management-howto-developer-portal/reset-content.png)

Если вы используете локальную версию, выполните `scripts.v2/cleanup.bat` `scripts.v2/generate.bat` сценарии и из репозитория GitHub, чтобы удалить существующее содержимое и подготавливать новое содержимое. Не забудьте заранее обновить код портала до последней версии из репозитория GitHub.

Если вы впервые получали доступ к порталу после объявления о доступности в ноябре 2019 ноября, он уже должен иметь новое содержимое по умолчанию, а дальнейшие действия не требуются.

### <a name="functionality-i-need-isnt-supported-in-the-portal"></a>Требуемые функции не поддерживаются на портале

Вы можете открыть запрос функции в [репозитории GitHub][1] или [самостоятельно реализовать недостающие функции][3]. Дополнительные сведения см. в разделе " **расширяемость** " выше.

### <a name="how-can-i-automate-portal-deployments"></a><a id="automate"></a> Как автоматизировать развертывание портала?

Вы можете программно получить доступ к содержимому портала разработчика и управлять им с помощью REST API, независимо от того, используете ли вы управляемую или локальную версию.

API описан в [разделе вики репозитория GitHub][2]. Его можно использовать для автоматизации миграции содержимого портала между средами, например из тестовой среды в рабочую среду. Дополнительные сведения об этом процессе см. [в этой статье документации](https://aka.ms/apimdocs/migrateportal) на сайте GitHub.

### <a name="how-do-i-move-from-the-managed-to-the-self-hosted-version"></a>Разделы справки переходить с управляемой на локальную версию?

См. подробную статью в [разделе вики репозитория портала разработчика на сайте GitHub][2].

### <a name="can-i-have-multiple-developer-portals-in-one-api-management-service"></a>Можно ли использовать несколько порталов разработчиков в одной службе управления API?

У вас может быть один управляемый портал и несколько самостоятельных порталов. Содержимое всех порталов хранится в одной службе управления API, поэтому они будут идентичны. Если вы хотите отличить внешний вид и функциональность порталов, вы можете самостоятельно размещать их с помощью собственных пользовательских мини-приложений, которые динамически настраивают страницы в среде выполнения, например на основе URL-адреса.

### <a name="does-the-portal-support-azure-resource-manager-templates-andor-is-it-compatible-with-api-management-devops-resource-kit"></a>Поддерживает ли портал Azure Resource Manager шаблоны и/или является ли он совместимым с набором средств API Management DevOps Resource Kit?

Нет.

### <a name="is-the-portals-content-saved-with-the-backuprestore-functionality-in-api-management"></a>Сохраняется ли содержимое портала с функцией резервного копирования и восстановления в службе управления API?

Нет.

### <a name="do-i-need-to-enable-additional-vnet-connectivity-for-the-managed-portal-dependencies"></a>Нужно ли включать дополнительное подключение к виртуальной сети для зависимостей управляемого портала?

В большинстве случаев — нет.

Если служба управления API находится во внутренней виртуальной сети, портал разработчика доступен только в пределах сети. Имя узла конечной точки управления должно разрешаться во внутренний виртуальный IP-адрес службы с компьютера, используемого для доступа к административному интерфейсу портала. Убедитесь, что конечная точка управления зарегистрирована в DNS. В случае неявной настройки вы увидите ошибку: `Unable to start the portal. See if settings are specified correctly in the configuration (...)` .

Если служба управления API находится во внутренней виртуальной сети и к ней осуществляется доступ через шлюз приложений из Интернета, обязательно включите подключение к порталу разработчика и конечным точкам управления API. Может потребоваться отключить правила брандмауэра веб-приложения. Дополнительные сведения см. в [этой статье документации](api-management-howto-integrate-internal-vnet-appgateway.md) .

### <a name="i-have-assigned-a-custom-api-management-domain-and-the-published-portal-doesnt-work"></a>Я назначил пользовательский домен управления API, и опубликованный портал не работает

После обновления домена необходимо [повторно опубликовать портал](api-management-howto-developer-portal-customize.md#publish) , чтобы изменения вступили в силу.

### <a name="i-have-added-an-identity-provider-and-i-cant-see-it-in-the-portal"></a>Я добавил поставщик удостоверений и не вижу его на портале.

После настройки поставщика удостоверений (например, Azure AD, Azure AD B2C) необходимо [повторно опубликовать портал](api-management-howto-developer-portal-customize.md#publish) , чтобы изменения вступили в силу. Убедитесь, что страницы портала разработчика содержат мини-приложение кнопок OAuth.

### <a name="i-have-set-up-delegation-and-the-portal-doesnt-use-it"></a>Я настроил делегирование, и портал не использует его

После настройки делегирования необходимо [повторно опубликовать портал](api-management-howto-developer-portal-customize.md#publish) , чтобы изменения вступили в силу.

### <a name="my-other-api-management-configuration-changes-havent-been-propagated-in-the-developer-portal"></a>Изменения конфигурации управления API не были распространены на портале разработчика

Для большинства изменений конфигурации (например, для виртуальной сети, входа, условий продуктов) требуется [Повторная публикация портала](api-management-howto-developer-portal-customize.md#publish).

### <a name="im-getting-a-cors-error-when-using-the-interactive-console"></a><a name="cors"></a> При использовании интерактивной консоли возникает ошибка CORS

Интерактивная консоль выполняет клиентский запрос API из браузера. Устраните проблему CORS, добавив [политику CORS](api-management-cross-domain-policies.md#CORS) в API-интерфейсы.

Состояние политики CORS можно проверить в разделе **Обзор портала** службы управления API в портал Azure. Поле предупреждения указывает на отсутствующую или неправильно настроенную политику.

![Портал разработчика API Management](media/api-management-howto-developer-portal/cors-azure-portal.png)

Автоматически примените политику CORS, нажав кнопку **включить CORS** .

CORS можно также включить вручную.

1. Выберите **вручную применить его на ссылке глобального уровня** , чтобы просмотреть созданный код политики.
2. Перейдите ко **всем API** в разделе **API** службы управления API в портал Azure.
3. Выберите **</>** значок в разделе **обработка входящих** сообщений.
4. Вставьте политику в **<inbound>** раздел XML-файла. Убедитесь, что **<origin>** значение соответствует домену портала разработчика.

> [!NOTE]
> 
> Если применить политику CORS в области продукта вместо области API, а API использует проверку подлинности ключа подписки через заголовок, консоль не будет работать.
>
> Браузер автоматически выдает HTTP-запрос OPTIONS, который не содержит заголовок с ключом подписки. Из-за отсутствующего ключа подписки службе управления API не удается связать параметры вызова с продуктом, поэтому невозможно применить политику CORS.
>
> В качестве обходного решения можно передать ключ подписки в параметре запроса.

> [!NOTE]
> 
> Выполняется только одна политика CORS. Если вы указали несколько политик CORS (например, на уровне API и на уровне всех интерфейсов API), Интерактивная консоль может работать не так, как ожидалось.

### <a name="what-permissions-do-i-need-to-edit-the-developer-portal"></a>Какие разрешения требуются для изменения портала разработчика?

Если вы видите `Oops. Something went wrong. Please try again later.` ошибку при открытии портала в административном режиме, возможно, отсутствуют необходимые разрешения (Azure RBAC).

Устаревшие порталы требовали разрешения `Microsoft.ApiManagement/service/getssotoken/action` в области службы ( `/subscriptions/<subscription-id>/resourceGroups/<resource-group>/providers/Microsoft.ApiManagement/service/<apim-service-name>` ), чтобы предоставить администратору пользователей доступ к порталам. Новому порталу требуется разрешение `Microsoft.ApiManagement/service/users/token/action` в области `/subscriptions/<subscription-id>/resourceGroups/<resource-group>/providers/Microsoft.ApiManagement/service/<apim-service-name>/users/1` .

Чтобы создать роль с требуемым разрешением, можно использовать следующий сценарий PowerShell. Не забудьте изменить `<subscription-id>` параметр. 

```powershell
#New Portals Admin Role 
Import-Module Az 
Connect-AzAccount 
$contributorRole = Get-AzRoleDefinition "API Management Service Contributor" 
$customRole = $contributorRole 
$customRole.Id = $null
$customRole.Name = "APIM New Portal Admin" 
$customRole.Description = "This role gives the user ability to log in to the new Developer portal as administrator" 
$customRole.Actions = "Microsoft.ApiManagement/service/users/token/action" 
$customRole.IsCustom = $true 
$customRole.AssignableScopes.Clear() 
$customRole.AssignableScopes.Add('/subscriptions/<subscription-id>') 
New-AzRoleDefinition -Role $customRole 
```
 
После создания роли она может быть предоставлена любому пользователю из раздела **управления доступом (IAM)** в портал Azure. Назначение этой роли пользователю приведет к назначению разрешения в области службы. Пользователь сможет создавать маркеры SAS от имени *любого* пользователя в службе. Как минимум, эта роль должна быть назначена администратору службы. Следующая команда PowerShell показывает, как назначить роль пользователю в самой нижней `user1` области, чтобы избежать предоставления пользователю ненужных разрешений: 

```powershell
New-AzRoleAssignment -SignInName "user1@contoso.com" -RoleDefinitionName "APIM New Portal Admin" -Scope "/subscriptions/<subscription-id>/resourceGroups/<resource-group>/providers/Microsoft.ApiManagement/service/<apim-service-name>/users/1" 
```

После предоставления разрешений пользователю пользователь должен выйти из портал Azure и снова войти в него, чтобы новые разрешения вступили в силу.

### <a name="im-seeing-the-unable-to-start-the-portal-see-if-settings-are-specified-correctly--error"></a>Я вижу `Unable to start the portal. See if settings are specified correctly (...)` ошибку

Эта ошибка отображается `GET` в случае `https://<management-endpoint-hostname>/subscriptions/xxx/resourceGroups/xxx/providers/Microsoft.ApiManagement/service/xxx/contentTypes/document/contentItems/configuration?api-version=2018-06-01-preview` сбоя вызова. Вызов выполняется из браузера через административный интерфейс портала.

Если служба управления API находится в виртуальной сети, см. описанный выше вопрос о подключении к виртуальной сети.

Сбой вызова также может быть вызван сертификатом TLS/SSL, который назначается пользовательскому домену и не является доверенным для браузера. Для устранения этой проблемы можно удалить пользовательскую конечную точку управления. Управление доменными API будет возвращаться к конечной точке по умолчанию с доверенным сертификатом.

### <a name="whats-the-browser-support-for-the-portal"></a>Что такое поддержка браузера для портала?

| Браузер                     | Поддерживается       |
|-----------------------------|-----------------|
| Apple Safari.                | Да<sup>1</sup> |
| Google Chrome               | Да<sup>1</sup> |
| Microsoft Edge              | Да<sup>1</sup> |
| Microsoft Internet Explorer | Нет              |
| Mozilla Firefox;             | Да<sup>1</sup> |

 <small><sup>1</sup> поддерживается в двух последних рабочих версиях.</small>

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о новом портале разработчика:

- [Доступ и Настройка портала управляемого разработчика](api-management-howto-developer-portal-customize.md)
- [Настройка самостоятельно размещенной версии портала][2]
- [Реализация собственного мини-приложения][3]

Обзор других ресурсов:

- [Репозиторий GitHub с исходным кодом][1]

[1]: https://aka.ms/apimdevportal
[2]: https://github.com/Azure/api-management-developer-portal/wiki
[3]: https://aka.ms/apimdevportal/extend
