---
title: Ограничения и сведения о поддержке форматов API
titleSuffix: Azure API Management
description: Сведения об известных проблемах и ограничениях для форматов Open API, WSDL и WADL поддерживаются в службе управления API Azure.
services: api-management
documentationcenter: ''
author: vladvino
manager: vlvinogr
editor: ''
ms.assetid: 7a5a63f0-3e72-49d3-a28c-1bb23ab495e2
ms.service: api-management
ms.workload: mobile
ms.tgt_pltfrm: na
ms.topic: article
ms.date: 01/02/2020
ms.author: apimpm
ms.openlocfilehash: 86ed7f3941965bcac525a2ba71786d20a4753489
ms.sourcegitcommit: 32c521a2ef396d121e71ba682e098092ac673b30
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2020
ms.locfileid: "91335506"
---
# <a name="api-import-restrictions-and-known-issues"></a>Ограничения и известные проблемы при импорте API

## <a name="about-this-list"></a>Об этом списке

При импорте API может возникнуть ряд ограничений или выявлены проблемы, которые необходимо исправить, прежде чем можно будет успешно выполнить импорт. В этой статье описываются эти ограничения, упорядоченные по формату импорта API. В нем также описано, как работает экспорт OpenAPI.

## <a name="openapiswagger-import-limitations"></a><a name="open-api"> </a>Ограничения импорта OpenAPI/Swagger

Если при импорте документа OpenAPI возникают ошибки, убедитесь, что вы проверили его заранее. Вы можете сделать это с помощью конструктора на портале Azure ("Конструктор" — "Интерфейс" — "Редактор спецификаций OpenAPI") или с помощью стороннего инструмента, например <a href="https://editor.swagger.io">редактора Swagger</a>.

### <a name="general"></a><a name="open-api-general"> </a>Общие сведения

-   Обязательные параметры пути и запроса должны иметь уникальные имена. (В OpenAPI имя параметра должно быть уникальным только в пределах расположения (например, пути, запроса, заголовка)). Тем не менее Управление API дает возможность различать операции по параметрам пути и запроса (которые не поддерживаются в OpenAPI). Поэтому необходимо указать уникальные имена параметров в пределах всего шаблона URL-адреса.)
-   `\$ref` указатели не могут ссылаться на внешние файлы.
-   `x-ms-paths` и `x-servers` являются единственными поддерживаемыми расширениями.
-   Настраиваемые расширения игнорируются при импорте и не сохраняются для экспорта.
-   `Recursion` — Управление API не поддерживает определения, определенные рекурсивно (например, схемы, ссылающиеся на себя).
-   URL-адрес исходного файла (если доступен) применяется для относительных URL-адресов сервера.
-   Определения безопасности игнорируются.
-   Встроенные определения схемы для операций API не поддерживаются. Определения схемы определяются в области API, и на них можно ссылаться в областях запросов или ответов операций API.
-   Определенный параметр URL-адреса должен быть частью шаблона URL-адреса.
-   `Produces` ключевое слово, описывающее типы MIME, возвращаемые API, не поддерживается. 

### <a name="openapi-version-2"></a><a name="open-api-v2"> </a>OpenAPI версия 2

-   Поддерживается только формат JSON.

### <a name="openapi-version-3"></a><a name="open-api-v3"> </a>OpenAPI версия 3

-   Если указано значение many `servers` , то при управлении API будет предпринята попытка выбрать первый URL-адрес HTTPS. Если нет ни одного URL-адреса с протоколом HTTPS, тогда подходит первый URL-адрес с протоколом HTTP. Если нет ни одного URL-адреса с протоколом HTTP, тогда URL-адрес сервера будет пустым.
-   `Examples` не поддерживается, но `example` имеет.

## <a name="openapi-import-update-and-export-mechanisms"></a>Механизмы импорта, обновления и экспорта OpenAPI

### <a name="general"></a><a name="open-import-export-general"> </a>Общие сведения

-   Определения API, экспортированные из службы управления API, в основном предназначены для приложений, внешних для службы управления API, которым необходимо вызывать API, размещенный в службе управления API. Экспортированные определения API не предназначены для повторного импорта в одну и ту же или другую службу управления API. Сведения об управлении конфигурацией API дефиитионс в разных serivces)/енвионментс см. в документации по использованию службы управления API с Git. 

### <a name="add-new-api-via-openapi-import"></a>Добавление нового API с помощью импорта OpenAPI

Для каждой операции, найденной в документе OpenAPI, будет создана новая операция с именем ресурса Azure и отображаемым именем, равным `operationId` и `summary` соответственно. `operationId` значение нормализовано согласно правилам, описанным ниже. `summary` значение импортируется как есть и его длина ограничена 300 символами.

Если не `operationId` указано (то есть отсутствует, `null` или пусто), значение имени ресурса Azure будет создано путем объединения метода HTTP и шаблона пути, например `get-foo` .

Если параметр `summary` не указан (т. е. отсутствует, `null` или пусто), `display name` значение будет равно `operationId` . Если параметр `operationId` не указан, значение отображаемого имени будет создано путем объединения метода HTTP и шаблона пути, например `Get - /foo` .

### <a name="update-an-existing-api-via-openapi-import"></a>Обновление существующего API с помощью импорта OpenAPI

Во время импорта существующий API изменяется в соответствии с API, описанным в документе OpenAPI. Каждая операция в документе OpenAPI сопоставляется с существующей операцией путем сравнения ее `operationId` значения с именем ресурса Azure существующей операции.

Если совпадение найдено, свойства существующей операции будут обновлены на месте.

Если совпадение не найдено, новая операция будет создана с использованием правил, описанных в разделе выше. Для каждой новой операции Импорт будет пытаться скопировать политики из существующей операции с тем же методом HTTP и шаблоном пути.

Все существующие несопоставленные операции будут удалены.

Чтобы сделать импорт более предсказуемым, следуйте приведенным ниже рекомендациям.

- Обязательно укажите `operationId` свойство для каждой операции.
- Не отменяйте изменения `operationId` после первоначального импорта.
- Никогда не изменяйте `operationId` и метод HTTP или шаблон пути одновременно.

### <a name="export-api-as-openapi"></a>Экспорт API как OpenAPI

Для каждой операции имя ресурса Azure будет экспортировано как `operationId` , а отображаемое имя будет экспортировано как `summary` .
Правила нормализации для идентификаторов с идентификаторами

- Преобразовать в нижний регистр.
- Замените каждую последовательность символов, отличных от буквенно-цифровых, одним тире, например, `GET-/foo/{bar}?buzz={quix}` преобразованным в `get-foo-bar-buzz-quix-` .
- Обрезать тире на обеих сторонах, например, `get-foo-bar-buzz-quix-` станет `get-foo-bar-buzz-quix`
- Усечение в соответствии с 76 символами, четыре символа меньше максимального ограничения для имени ресурса.
- При необходимости используйте оставшиеся четыре символа для суффикса дедупликации в виде `-1, -2, ..., -999` .


## <a name="wsdl"></a><a name="wsdl"> </a>Язык WSDL

WSDL-файлы используются для создания передаваемых через SOAP API и интерфейсов SOAP to-RESTFUL.

-   **Привязки SOAP.** Поддерживаются только привязки SOAP шифрования типа document или literal. Шифрование SOAP типа rpc не поддерживается.
-   **WSDL:Import**. Этот атрибут не поддерживается. Клиентам следует объединить импортированные элементы в один документ.
-   **Сообщения, состоящие из нескольких частей**. Такие типы сообщений не поддерживаются.
-   **WCF wsHttpBinding**. Службы SOAP, созданные с помощью технологии Windows Communication Foundation, должны использовать basicHttpBinding. Значение wsHttpBinding не поддерживается.
-   **MTOM.** Службы, использующие MTOM, <em>могут</em> работать. Официальная поддержка сейчас не предоставляется.
-   **Рекурсия.** APIM не поддерживает типы, которые определены рекурсивно (например, которые ссылаются на включающий их массив).
-   **Несколько пространств имен.** В схеме можно использовать несколько пространство имен, но для определения частей сообщений можно использовать только целевое пространство имен. Пространства имен, отличные от целевых, которые используются для определения других входных или выходных элементов, не сохраняются. Хотя и можно импортировать такой WSDL-документ, для экспорта всех частей сообщений будет использоваться целевое пространство имен WSDL.
-   **Массивы** — преобразование "SOAP-to-RESTful" поддерживает только Упакованные массивы, показанные в следующем примере:

```xml
    <complexType name="arrayTypeName">
        <sequence>
            <element name="arrayElementValue" type="arrayElementType" minOccurs="0" maxOccurs="unbounded"/>
        </sequence>
    </complexType>
    <complexType name="typeName">
        <sequence>
            <element name="element1" type="someTypeName" minOccurs="1" maxOccurs="1"/>
            <element name="element2" type="someOtherTypeName" minOccurs="0" maxOccurs="1" nillable="true"/>
            <element name="arrayElement" type="arrayTypeName" minOccurs="1" maxOccurs="1"/>
        </sequence>
    </complexType>
```

## <a name="wadl"></a><a name="wadl"> </a>WADL

У нас нет сведений о проблемах импорта с помощью формата WADL.
