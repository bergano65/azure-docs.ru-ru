---
title: О сетчатых службах
description: Получите общие сведения о сетевых картах, их архитектуре и возможностях, а также критерии, которые следует учитывать при выборе одного из них для развертывания.
author: paulbouwer
ms.service: container-service
ms.topic: article
ms.date: 10/09/2019
ms.author: pabouwer
ms.openlocfilehash: 226a4e5cf97be2e23ef13a95b80be07b7fbf5d7a
ms.sourcegitcommit: f29fec8ec945921cc3a89a6e7086127cc1bc1759
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2019
ms.locfileid: "72530710"
---
# <a name="about-service-meshes"></a>О сетчатых службах

Сетка служб предоставляет такие возможности, как управление трафиком, устойчивость, политика, безопасность, надежный идентификатор и наблюдаемость рабочих нагрузок. Приложение отделено от этих операционных возможностей, а сетка служб перемещает их из уровня приложения и до уровня инфраструктуры.

## <a name="scenarios"></a>Сценарии

Ниже приведены некоторые сценарии, которые можно включить для рабочих нагрузок при использовании сети службы.

- **Зашифровать весь трафик в кластере** . Включите взаимное TLS-подключение между указанными службами в кластере. Его можно расширить на входящий и исходящий трафик по периметру сети. Предоставляет параметр безопасности по умолчанию без изменений, необходимых для кода приложения и инфраструктуры.

- **Ранний и поэтапное развертывания** — укажите условия для подмножества трафика, передаваемого в набор новых служб в кластере. При успешном тестировании выпуска ранний удалите условную маршрутизацию и фазу постепенного увеличения% всего трафика к новой службе. В конечном итоге весь трафик будет направляться в новую службу.

- **Управление трафиком и их обработка** . Создание политики для службы, которая будет оценивать весь трафик до версии службы из определенного источника. Или политика, которая применяет стратегию повтора к классам сбоев между указанными службами. Зеркальное отображение динамического трафика к новым версиям служб во время миграции или отладке проблем. Вставка ошибок между службами в тестовой среде для тестирования устойчивости.

- **Наблюдаемость** — понимание того, как ваши службы соединяются с трафиком, который проходит между ними. Получение метрик, журналов и трассировок для всего трафика в кластере, входящих и исходящих данных. Добавьте в приложения возможности распределенной трассировки.

## <a name="architecture"></a>Архитектура

Сетка служб обычно состоит из плоскости управления и плоскости данных.

**Плоскость управления** имеет ряд компонентов, которые поддерживают управление сеткой служб. Обычно это включает интерфейс управления, который может быть интерфейсом пользователя или API. Также обычно существуют компоненты, которые управляют правилами и определениями политик, определяющими, как эта сеть должна реализовывать определенные возможности. Существуют также компоненты, которые управляют аспектами безопасности, такими как надежные удостоверения и сертификаты для mTLS. Сети служб также обычно имеют метрики или компонент наблюдения, собирающий и собирающий метрики и данные телеметрии из рабочих нагрузок.

**Плоскость данных** обычно состоит из учетной записи-посредника, которая прозрачно внедряется как расширения в рабочие нагрузки. Этот прокси-сервер настроен для управления всем сетевым трафиком в модуле Pod, который содержит рабочую нагрузку. Это позволяет настроить прокси-сервер для защиты трафика с помощью mTLS, динамического направления трафика, применения политик к трафику и сбора метрик и сведений трассировки. 

![Стандартная архитектура сетки служб](media/servicemesh/typical-architecture.png)

## <a name="capabilities"></a>Возможности

Каждая из сеток служб имеет естественное соответствие и сосредоточена на поддержке конкретных сценариев, но обычно большинство из них будет реализовывать ряд, если не все, из следующих возможностей.

### <a name="traffic-management"></a>Управление трафиком 

- **Протокол** — уровень 7 (HTTP, GRPC)
- **Динамическая маршрутизация** — условное, взвешенное, зеркальное отображение
- **Устойчивость** — время ожидания, повторные попытки, автоматическое выключение
- **Политика** — контроль доступа, пределы скорости, квоты
- **Тестирование** — внедрение ошибок

### <a name="security"></a>Безопасность

- **Шифрование** — mTLS, Управление сертификатами, внешний ЦС
- **Strong удостоверение** — спиффе или аналогичное
- **Проверка подлинности —** Аутентификация, авторизации

### <a name="observability"></a>Наблюдаемость

- **Метрики** — Золотой метрики, Prometheus, grafana
- **Трассировка** — трассировка между рабочими нагрузками
- Трафик — кластер, **входящий/исходящий**

### <a name="mesh"></a>Сетчат

- **Поддерживаемые COMPUTE** -Kubernetes, виртуальные машины
- Шлюзы с **несколькими кластерами** , Федерация

## <a name="selection-criteria"></a>Критерии выбора

Прежде чем выбрать сеть службы, убедитесь, что вы понимаете требования и причины установки сети службы. Попробуйте задать следующие вопросы.

- **Достаточен ли входной контроллер для моих потребностей?** — В некоторых случаях для поддержки требуемого сценария требуется наличие таких возможностей, как тестирование в/b или разделение трафика на входе. Не добавляйте к своей среде сложность без переворачивания.

- **Могут ли мои рабочие нагрузки и среда допускать дополнительные расходы?** — Для всех дополнительных компонентов, необходимых для поддержки сетки служб, требуются дополнительные ресурсы, такие как ЦП и память. Кроме того, все прокси-серверы и связанные с ними политики проверяют задержку трафика. Если у вас есть рабочие нагрузки, которые очень чувствительны к задержкам или не могут предоставить дополнительные ресурсы для покрытия компонентов сетки служб, следует рассмотреть их повторно.

- **Необязательно ли это делать без лишних сложностей?** — Если причина установки сети службы заключается в том, чтобы получить возможность, которая не обязательно важна для бизнеса или рабочих групп, следует подумать о том, стоит ли использовать дополнительную сложность установки, обслуживания и настройки.

- **Может ли это быть принято в инкрементном подходе?** — Некоторые из сеток служб, которые предоставляют множество возможностей, могут быть приняты в более инкрементном подходе. Установите только необходимые компоненты, чтобы убедиться в успешном выполнении. Получив больше уверенности и потребуются дополнительные возможности, изучите их. Установите *все* с самого начала.

Если после тщательного рассмотрения вы решите, что вам нужна сеть службы, чтобы предоставить необходимые возможности, тогда ваше следующее решение — это *сеть службы?*

Рассмотрим следующие области и их соответствие требованиям. Это поможет вам лучше подобрать вашу среду и рабочие нагрузки. В разделе [дальнейшие действия](#next-steps) приводятся дополнительные подробные сведения о конкретных сетках служб и их сопоставлении с этими областями.

- **Техническая информация** : управление трафиком, политика, безопасность, Наблюдаемость

- **Business** -коммерческая поддержка, Foundation (кнкф), лицензия OSS, управление

- **Операционная** система — Установка и обновление, требования к ресурсам, требования к производительности, интеграция (метрики, телеметрии, панели мониторинга, средства, SMI), смешанные рабочие нагрузки (пулы узлов Linux и Windows), вычисление (Kubernetes, виртуальные машины), несколько кластеров

- **Безопасность** — проверка подлинности, идентификация, Управление сертификатами и вращение, подключаемый внешний ЦС


## <a name="next-steps"></a>Дальнейшие действия

В следующей документации содержатся дополнительные сведения о сетевых сетках, которые можно испытать в службе Azure Kubernetes (AKS).

> [!div class="nextstepaction"]
> [Дополнительные сведения о Istio...][istio-about]

> [!div class="nextstepaction"]
> [Дополнительные сведения о Linkerd...][linkerd-about]

> [!div class="nextstepaction"]
> [Дополнительные сведения о Consul...][consul-about]

Кроме того, вам может потребоваться изучить интерфейс SMI, стандартный интерфейс для сеток служб в Kubernetes:

- [Интерфейс сети службы (SMI)][smi]


<!-- LINKS - external -->
[smi]: https://smi-spec.io/

<!-- LINKS - internal -->
[istio-about]: ./servicemesh-istio-about.md
[linkerd-about]: ./servicemesh-linkerd-about.md
[consul-about]: ./servicemesh-consul-about.md