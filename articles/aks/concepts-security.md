---
title: Основные понятия безопасности в Службе Azure Kubernetes (AKS)
description: Узнайте о безопасности в Службе Azure Kubernetes (AKS), включая взаимодействие главных компонентов и узлов, политики сети и секреты Kubernetes.
services: container-service
author: iainfoulds
ms.service: container-service
ms.topic: conceptual
ms.date: 10/16/2018
ms.author: iainfou
ms.openlocfilehash: e29b94f270b295725400103f288f3d3bd0c2a2eb
ms.sourcegitcommit: 3a7c1688d1f64ff7f1e68ec4bb799ba8a29a04a8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2018
ms.locfileid: "49380699"
---
# <a name="security-concepts-for-applications-and-clusters-in-azure-kubernetes-service-aks"></a>Основные понятия безопасности приложений и кластеров в Службе Azure Kubernetes (AKS)

Чтобы защитить данные клиентов при выполнении рабочих нагрузок приложений в Службе Azure Kubernetes (AKS), в первую очередь следует обеспечить безопасность кластера. Kubernetes включает в себя компоненты системы безопасности, такие как *политики сети* и *секреты*. Azure добавляет такие компоненты, как группы безопасности сети и управляемые обновления кластера. Эти компоненты системы безопасности используются совместно, чтобы обеспечить работу кластера AKS с использованием последних обновлений безопасности операционной системы и выпусков Kubernetes, а также защитить трафик pod и доступ к конфиденциальным учетным данным.

В этой статье приводится обзор ключевых понятий безопасности приложений в AKS:

- [безопасность главных компонентов](#master-security);
- [безопасность узлов](#node-security);
- [Обновления кластера](#cluster-upgrades)
- [Безопасность сети](#network-security)
- [секреты Kubernetes](#secrets).

## <a name="master-security"></a>Безопасность главных компонентов

В AKS главные компоненты Kubernetes являются частью управляемой службы, предоставляемой корпорацией Майкрософт. У каждого кластера AKS имеется выделенный главный экземпляр Kubernetes с одним клиентом, обеспечивающий работу сервера API, планировщика и т. д. Управление этим главным экземпляром и его обслуживание осуществляет корпорация Майкрософт.

По умолчанию сервер API Kubernetes использует общедоступный IP-адрес и полное доменное имя (FQDN). Вы можете управлять доступом к серверу API с помощью управления доступом на основе ролей Kubernetes и Azure Active Directory. Дополнительные сведения см. в разделе [Интеграция Azure AD с AKS][aks-aad].

## <a name="node-security"></a>Безопасность узлов

Узлы AKS — это виртуальные машины Azure, которыми вы управляете и которые вы обслуживаете. На узлах используется оптимизированный дистрибутив Ubuntu Linux со средой выполнения контейнеров Docker. При создании или масштабировании кластера AKS узлы автоматически развертываются с последними обновлениями и конфигурациями безопасности операционной системы.

Каждую ночь платформа Azure автоматически применяет исправления системы безопасности операционной системы к узлам. Если для установки обновления системы безопасности операционной системы требуется перезагрузка узла, она не выполняется автоматически. Вы можете вручную перезагрузить узлы, но, как правило, для этого используется [Kured][kured] — управляющая программа перезагрузки с открытым кодом для Kubernetes. Kured выполняется как [DaemonSet][aks-daemonset] и отслеживает каждый узел на наличие файла, указывающего необходимость перезагрузки. Для управления перезагрузками в кластере используется тот же [процесс блокировки и остановки](#cordon-and-drain), что и при обновлении кластера.

Узлы развертываются в подсети частной виртуальной сети без назначения общедоступных IP-адресов. В целях устранения неполадок и управления по умолчанию включен протокол SSH. Этот протокол обеспечивает доступ только при использовании внутреннего IP-адреса. Правила группы безопасности сети Azure можно использовать для усиления ограничения диапазона IP-адресов для доступа к узлам AKS. Удаление правила SSH по умолчанию группы безопасности сети и отключение службы SSH на узлах предотвращает выполнение задач обслуживания платформой Azure.

Для хранения данных узлы используют Управляемые диски Azure. Для большинства размеров узлов виртуальных машин используются высокоскоростные диски SSD ценовой категории "Премиум". Неактивные данные, хранящиеся на управляемых дисках, автоматически шифруются платформой Azure. Для повышения избыточности эти диски также безопасно реплицируются в центре обработки данных Azure.

## <a name="cluster-upgrades"></a>Обновления кластера

Чтобы обеспечить безопасность и соответствие или использование последних компонентов, платформа Azure предоставляет инструменты для оркестрации обновления кластера AKS и его компонентов. Эта оркестрация охватывает главные компоненты и компоненты агента Kubernetes. Вы можете просмотреть список доступных версий Kubernetes для кластера AKS. Чтобы начать обновление, следует указать одну из этих доступных версий. Затем Azure безопасно заблокирует и остановит каждый узел AKS и выполнит обновление.

### <a name="cordon-and-drain"></a>Блокировка и остановка

В процессе обновления узлы AKS в кластере по отдельности блокируются, чтобы на них не планировался запуск новых элементов pod. Затем узлы останавливаются и обновляются, как показано ниже.

- Существующие элементы pod корректно завершаются, и планируется их запуск на оставшихся узлах.
- Узел перезагружается, чтобы процесс обновления завершился, после его узел снова присоединяется к кластеру AKS.
- И на нем уже можно планировать запуск элементов pod.
- Затем блокируется и останавливается следующий узел в кластере, и процесс повторяется, пока все узлы не будут успешно обновлены.

Дополнительные сведения см. в разделе [Обновление кластера AKS][aks-upgrade-cluster].

## <a name="network-security"></a>Безопасность сети

Для подключения к локальным сетям и обеспечения безопасности можно развернуть кластер AKS в имеющейся подсети виртуальной сети Azure. Эти виртуальные сети могут использовать VPN-подключение Azure типа "сеть – сеть" или подключение ExpressRoute к локальной сети. Для контроллеров входящего трафика Kubernetes можно определить частные внутренние IP-адреса, чтобы службы были доступны только через это подключение к внутренней сети.

### <a name="azure-network-security-groups"></a>Группы безопасности сети Azure

Чтобы фильтровать поток трафика в виртуальных сетях, платформа Azure использует правила групп безопасности сети. Эти правила определяют диапазоны IP-адресов источника и назначения, порты и протоколы, использование которых разрешено или запрещено для доступа к ресурсам. Чтобы разрешить трафик TLS для сервера API Kubernetes и обеспечить доступ к узлам по протоколу SSH, создаются правила по умолчанию. При создании служб с подсистемами балансировки нагрузки, сопоставлением портов или входящими маршрутами AKS автоматически изменяет группу безопасности сети, чтобы трафик передавался соответствующим образом.

## <a name="kubernetes-secrets"></a>Секреты Kubernetes

*Секрет* Kubernetes используется для внедрения в элементы pod конфиденциальных данных, например учетных данных или ключей доступа. Сначала создается секрет с помощью API Kubernetes. При определении pod или развертывания можно запросить определенный секрет. Секрет предоставляются только узлам, на которых запланирован запуск элемента pod, требующего этот секрет. Секрет сохраняется в *tmpfs*, а не записывается на диск. При удалении с узла последнего pod, которому нужен секрет, данный секрет удаляется из tmpfs. Секреты хранятся в указанном пространстве имен и доступны только элементам pod в этом пространстве имен.

Использование секретов уменьшает объем конфиденциальных сведений, определяемых в pod или YAML-файле манифеста службы. Вместо этого запрашивается секрет, хранимый на сервере API Kubernetes в YAML-файле манифеста. Это позволяет предоставлять секрет только определенным элементам pod.

## <a name="next-steps"></a>Дополнительная информация

Чтобы приступить к защите кластеров AKS, ознакомьтесь с разделом [Обновление кластера AKS][aks-upgrade-cluster].

Дополнительные сведения о ключевых понятиях Kubernetes и AKS см. в следующих статьях:

- [Кластеры и рабочие нагрузки Kubernetes и AKS][aks-concepts-clusters-workloads]
- [Идентификация в Kubernetes и AKS][aks-concepts-identity]
- [Виртуальные сети Kubernetes и AKS][aks-concepts-network]
- [Хранилище Kubernetes и AKS][aks-concepts-storage]
- [Масштабирование Kubernetes и AKS][aks-concepts-scale]

<!-- LINKS - External -->
[kured]: https://github.com/weaveworks/kured
[kubernetes-network-policies]: https://kubernetes.io/docs/concepts/services-networking/network-policies/

<!-- LINKS - Internal -->
[aks-daemonsets]: concepts-clusters-workloads.md#daemonsets
[aks-upgrade-cluster]: upgrade-cluster.md
[aks-aad]: aad-integration.md
[aks-concepts-clusters-workloads]: concepts-clusters-workloads.md
[aks-concepts-identity]: concepts-identity.md
[aks-concepts-scale]: concepts-scale.md
[aks-concepts-storage]: concepts-storage.md
[aks-concepts-network]: concepts-network.md
