---
title: Политики поддержки для службы Azure Kubernetes (AKS)
description: Узнайте о политиках поддержки Azure Kubernetes Service (AKS), общей ответственности и функциях, доступных в предварительной версии (альфа- или бета-версии).
services: container-service
ms.topic: article
ms.date: 09/18/2020
ms.openlocfilehash: 188416d9ef6f8e7568b10e8ccbb405be0bff315d
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90888985"
---
# <a name="support-policies-for-azure-kubernetes-service"></a>Политики поддержки для службы Azure Kubernetes

В этой статье описаны политики технической поддержки и ограничения для Службы Azure Kubernetes (AKS). В этой статье также подробно описываются Управление узлами агентов, управляемые компоненты плоскости управления, сторонние компоненты с открытым исходным кодом, а также управление безопасностью или исправлениями.

## <a name="service-updates-and-releases"></a>Обновления и выпуски службы

* Сведения о выпусках см. в [заметках о выпуске AKS](https://github.com/Azure/AKS/releases).
* Сведения о функциях в предварительной версии см. в разделе [Функции предварительной версии AKS и связанные проекты](https://awesomeopensource.com/projects/aks?categoryPage=11).

## <a name="managed-features-in-aks"></a>Управляемые функции в AKS

Основные компоненты облачной инфраструктуры как услуги (IaaS), такие как компоненты вычислений или сети, позволяют получить доступ к элементам управления низкого уровня и параметрам настройки. Напротив, AKS предоставляет готовое развертывание Kubernetes, которое предоставляет общий набор конфигураций и возможностей, необходимых для кластера. Как пользователь AKS, у вас есть ограниченные возможности настройки и развертывания. В Exchange вам не нужно беспокоиться о кластерах Kubernetes и управлять ими напрямую.

С AKS вы получаете полностью управляемую *плоскость управления*. Плоскость управления содержит все компоненты и службы, необходимые для работы и предоставления конечным пользователям кластеров Kubernetes. Корпорация Майкрософт обслуживает все компоненты Kubernetes и управляет ими.

Корпорация Майкрософт осуществляет управление и мониторинг приведенных ниже компонентов с помощью панели управления.

* Серверы kubelet или API Kubernetes.
* Etcd или совместимое хранилище пар "ключ-значение", обеспечивающее качество обслуживания, масштабируемость и время работы.
* Службы DNS (например, kube-dns или CoreDNS).
* Прокси-сервер или сеть Kubernetes.
* Любая дополнительная надстройка или системный компонент, выполняющийся в пространстве имен KUBE-System.

AKS не является решением "платформа как услуга" (PaaS). Некоторые компоненты, такие как узлы агентов, имеют *общую ответственность*, где пользователи должны помогать поддерживать кластер AKS. Ввод данных пользователем требуется, например, для применения исправления безопасности операционной системы узла агента (ОС).

Службы являются *управляемыми* в том смысле, что корпорация Майкрософт и группа AKS развертывают и обслуживают их, а также отвечают за доступность и функциональность этих служб. Клиенты не могут изменять эти управляемые компоненты. Корпорация Майкрософт ограничивает возможности настройки, обеспечивая согласованное и масштабируемое взаимодействие с пользователями. Сведения о полностью настраиваемом решении см. в разделе [Обработчик AKS](https://github.com/Azure/aks-engine).

## <a name="shared-responsibility"></a>Общая ответственность

При создании кластера необходимо определить узлы агента Kubernetes, создаваемые AKS. Рабочие нагрузки выполняются на этих узлах.

Так как узлы агента выполняют частный код и хранят конфиденциальные данные, служба поддержки Майкрософт могут обращаться к ним только очень ограниченным образом. Служба поддержки Майкрософт не может войти в, выполнить команды в или просмотреть журналы для этих узлов без разрешения Express или помощи.

Любые изменения, выполненные непосредственно на узлах агента с помощью любого из API IaaS, отводят к неподдерживаемому кластеру. Любые изменения, выполненные на узлах агента, должны выполняться с помощью собственных механизмов kubernetes, таких как `Daemon Sets` .

Аналогичным образом, хотя вы можете добавлять любые метаданные в кластер и узлы, такие как теги и метки, изменение любых метаданных, созданных системой, приведет к тому, что кластер не будет поддерживаться.

## <a name="aks-support-coverage"></a>Право на поддержку AKS

Корпорация Майкрософт предоставляет техническую поддержку для следующих примеров:

* Подключение ко всем компонентам Kubernetes, предоставляемым и поддерживаемым службой Kubernetes, таким как сервер API.
* Управление, время бесперебойной работы, качество обслуживания и операции служб Kubernetes Control плоскость (например, плоскость управления Kubernetes, сервер API, etcd и Кореднс).
* Хранилище данных Etcd. Поддержка включает в себя автоматизированное прозрачное резервное копирование всех данных etcd каждые 30 минут для планирования аварийного восстановления и восстановления состояния кластера. Эти резервные копии напрямую недоступны вам или пользователям. Они гарантируют надежность и согласованность данных. Etcd. откат или восстановление по запросу не поддерживается в качестве функции.
* Любые точки интеграции в драйвере поставщика облачных служб Azure для Kubernetes. К ним относятся интеграции с другими службами Azure, такими как подсистемы балансировки нагрузки, постоянные тома или сети (Kubernetes и Azure CNI).
* Вопросы или проблемы, касающиеся настройки компонентов плоскости управления, таких как сервер API Kubernetes, etcd и Кореднс.
* Проблемы с сетью, например Azure CNI, kubenet или другие проблемы доступа и функциональности сети. Эти проблемы могут быть связаны с разрешением DNS, потерей пакетов, маршрутизацией и т. д. Корпорация Майкрософт поддерживает различные конфигурации сети.
  * Кубенет и Azure CNI с использованием управляемого виртуальных сетей или настраиваемых (собственных) подсетей.
  * Подключение к другим службам и приложениям Azure.
  * Конфигурации контроллеров входящего трафика и подсистем балансировки нагрузки или входящего трафика.
  * Производительность и задержка сетей.


> [!NOTE]
> Любые действия кластера, выполняемые Microsoft/AKS, выполняются с согласия пользователя во встроенной роли Kubernetes `aks-service` и встроенной привязке ролей `aks-service-rolebinding` . Эта роль позволяет AKS устранять неполадки в работе кластера и диагностировать их, но не может изменять разрешения и создавать роли или привязки ролей, а также другие действия с высоким уровнем привилегий. Доступ к роли доступен только в рамках активных запросов в службу поддержки с JIT-доступом.

Корпорация Майкрософт не предоставляет техническую поддержку для следующих примеров:

* Вопросы об использовании Kubernetes. Например, служба поддержки Майкрософт не предоставляет рекомендаций о том, как создавать пользовательские контроллеры входящего трафика, использовать рабочие нагрузки приложений или применять программные пакеты или средства сторонних разработчиков или с открытым кодом.
  > [!NOTE]
  > Служба поддержки Майкрософт может рекомендовать функции, конфигурацию и настройки кластера AKS (например, в случае проблем в работе Kubernetes).
* Проекты сторонних разработчиков с открытым кодом, которые не входят в уровень управления Kubernetes или не развернуты вместе с кластерами AKS. Это могут быть проекты Istio, Helm, Envoy и пр.
  > [!NOTE]
  > Корпорация Майкрософт может предоставить лучшие решения для сторонних проектов с открытым кодом, таких как Helm. В случае проблем со сторонним инструментом с открытым кодом, интегрированным с поставщиком облачных служб Azure Kubernetes, или других проблем, связанных с AKS, корпорация Майкрософт предоставляет примеры и приложения из своей документации.
* Стороннее программное обеспечение с закрытым кодом. Это могут быть средства проверки безопасности, устройства или программное обеспечение для сетевого взаимодействия.
* Настройки сети, отличные от перечисленных в [документации по AKS](./index.yml).


## <a name="aks-support-coverage-for-agent-nodes"></a>Покрытие AKS поддержки для узлов агентов

### <a name="microsoft-responsibilities-for-aks-agent-nodes"></a>Обязанности Майкрософт для узлов агента AKS

Корпорация Майкрософт и пользователи используют ответственность за узлы агента Kubernetes, где:

* Базовый образ ОС содержит необходимые дополнения (например, агенты мониторинга и сетевые агенты).
* Узлы агента получают исправления для ОС автоматически.
* Проблемы с компонентами плоскости управления Kubernetes, которые выполняются на узлах агента, автоматически исправляются. Ниже перечислены эти компоненты.
  * `Kube-proxy`
  * сетевые туннели, предоставляющие пути взаимодействия с главными компонентами Kubernetes;
  * `Kubelet`
  * `Moby` или `ContainerD`

> [!NOTE]
> Если узел агента не работает, AKS может перезапустить отдельные компоненты или весь узел агента. Эти операции перезапуска автоматизированы и обеспечивают автоматическое исправление для распространенных проблем. Дополнительные сведения о механизмах автоматического исправления см. в разделе [Автоматическое восстановление узла](node-auto-repair.md) .

### <a name="customer-responsibilities-for-aks-agent-nodes"></a>Обязанности клиента для узлов агента AKS

Корпорация Майкрософт предоставляет исправления и новые образы для узлов образа еженедельно, но не по умолчанию автоматически исправляет их. Чтобы обеспечить обновление операционной системы узла агента и компонентов среды выполнения, следует регулярно выполнять расписание [обновления образа узла](node-image-upgrade.md) или автоматизировать его.

Аналогичным образом, AKS регулярно выпускает новые исправления kubernetes и дополнительные версии. Эти обновления могут содержать улучшения безопасности или функциональности для Kubernetes. Вы несете ответственность за обновление версии kubernetes кластера и в соответствии с [политикой версии AKS kubernetes](supported-kubernetes-versions.md).

#### <a name="user-customization-of-agent-nodes"></a>Пользовательская настройка узлов агентов
> [!NOTE]
> Узлы агента AKS отображаются в портал Azure как обычные ресурсы Azure IaaS. Но эти виртуальные машины развертываются в настраиваемой группе ресурсов Azure (обычно с префиксом MC_ \* ). Нельзя изменить базовый образ ОС или выполнить любые прямые настройки для этих узлов с помощью API-интерфейсов IaaS или ресурсов. Любые пользовательские изменения, которые не выполняются через API AKS, не будут сохраняться при обновлении, масштабировании, обновлении или перезагрузке. Избегайте внесения изменений в узлы агента, если только служба поддержки Майкрософт не направит вам никаких изменений.

AKS управляет жизненным циклом и операциями узлов агентов от вашего имени. изменение ресурсов IaaS, связанных с узлами агентов, **не поддерживается**. Примером неподдерживаемой операции является Настройка масштабируемого набора виртуальных машин пула узлов путем ручного изменения конфигураций с помощью портала или API масштабируемого набора виртуальных машин.
 
Для конфигураций или пакетов, зависящих от рабочей нагрузки, AKS рекомендует использовать [Kubernetes `daemon sets` ](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/).

Использование привилегированных `daemon sets` и Kubernetes контейнеров позволяет настраивать, изменять или устанавливать сторонние программы на узлах агентов кластера. Например, это позволяет добавить пользовательское программное обеспечение для проверки безопасности или обновить параметры sysctl.

Хотя этот путь рекомендуется, если применяются указанные выше требования, AKS проектирование и поддержка не могут помочь в устранении неполадок или диагностике изменений, которые приводили к недоступности узла из-за нестандартного развертывания `daemon set` .

### <a name="security-issues-and-patching"></a>Проблемы с безопасностью и установка исправлений

Если в одном или нескольких управляемых компонентах AKS обнаружен изъян в системе безопасности, Группа AKS отправит все затронутые кластеры, чтобы устранить эту неполадку. Возможно, группа поддержки предоставит пользователям инструкции по обновлению.

Для узлов агентов, затронутых нарушением безопасности, корпорация Майкрософт сообщит вам подробные сведения о влиянии и действиях по исправлению или устранению проблемы безопасности (обычно это обновление образа узла или обновление кластера).

### <a name="node-maintenance-and-access"></a>Обслуживание узлов и доступ к ним

Хотя вы можете войти в и изменить узлы агента, выполнение этой операции не рекомендуется, так как изменения могут привести к невозможности поддержки кластера.

## <a name="network-ports-access-and-nsgs"></a>Сетевые порты, доступ и группы безопасности сети

Вы можете настроить группы безопасности сети только для пользовательских подсетей. Вы не можете настраивать группы безопасности сети в управляемых подсетях или на уровне NIC узлов агентов. AKS имеет требования к выходу для конкретных конечных точек, чтобы контролировать исходящий трафик и обеспечить необходимое подключение, см. раздел [ограничение исходящего трафика](limit-egress-traffic.md).

## <a name="stopped-or-de-allocated-clusters"></a>Остановленные или освобожденные кластеры

Как описано выше, отмена выделения всех узлов кластера с помощью API IaaS, интерфейс командной строки или портала выводит кластер из поддержки.
Единственный поддерживаемый способ отключения или отмены выделения всего узла — [останавливает кластер AKS, который сохранит состояние кластера в течение 12 месяцев.

Кластеры, остановленные более 12 месяцев, больше не будут сохранять состояние. 

Кластеры, освобожденные за пределами API AKS, не имеют гарантий сохранения состояния. Плоскости управления для кластеров в этом состоянии будут архивироваться по истечении 30 дней и удалены через 12 месяцев.

AKS сохраняет право на архивацию уровней управления, которые были настроены в соответствии с указаниями службы поддержки, на период до 30 дней. AKS обслуживает резервные копии метаданных etcd кластера и может быстро повторно выделить кластер. Это повторное выделение может быть инициировано любой операцией PUT, которая возвращает возможность поддержки кластера, например обновлением или масштабированием до активных узлов агентов.

Если ваша подписка приостановлена или удалена, плоскость управления и состояние кластера будут удалены через 90 дней.

## <a name="unsupported-alpha-and-beta-kubernetes-features"></a>Неподдерживаемые альфа- и бета-версии функций Kubernetes

AKS поддерживает только стабильные и бета-версии компонентов в вышестоящем проекте Kubernetes. Если не указано иное, AKS не поддерживает альфа-компонент, доступный в вышестоящем проекте Kubernetes.

## <a name="preview-features-or-feature-flags"></a>Предварительные версии компонентов или флаги компонентов

Функции и компоненты, для которых требуется длительное тестирование и сбор отзывов пользователей, корпорация Майкрософт выпускает сначала в режиме предварительной версии, и их нужно отдельно включать соответствующим флагом компонента. Такие функции можно рассматривать как предварительные или бета-версии.

Функции предварительной версии (с флагом компонента) не предназначены для рабочей среды. Регулярные изменения интерфейсов API и поведения компонентов, исправления ошибок и другие изменения могут привести к нестабильной работе и простоям кластеров.

Для функций в общедоступной предварительной версии действует принцип "оптимальной поддержки", так как эти функции не предназначены для рабочей среды. Их поддержку осуществляют группы технической поддержки AKS только в рабочее время. Дополнительные сведения можно найти в разделе

* [Часто задаваемые вопросы о поддержке Azure](https://azure.microsoft.com/support/faq/)

## <a name="upstream-bugs-and-issues"></a>Вышестоящие ошибки и проблемы

Учитывая скорость разработки в вышестоящем проекте Kubernetes, ошибки неизбежны. Некоторые из этих ошибок невозможно исправить или обойти в системе AKS. Вместо этого исправления ошибок занимают более крупные исправления для вышестоящего проекта (например, операционные системы Kubernetes, Node или Agent, а также ядро). Для компонентов, принадлежащих корпорации Майкрософт (например, поставщика облачных служб Azure), сотрудники AKS и Azure обязуются устранять проблемы, о которых сообщается в сообществе.

Если возникла ошибка, о которой извещена служба технической поддержки, причиной которой является одна или нескольких вышестоящих ошибок, группы поддержки и разработки AKS сделают следующее.

* Выявят и сопоставят вышестоящие ошибки с любыми дополнительными сведениями, которые помогут объяснить, почему эта проблема влияет на кластер или рабочую нагрузку. Клиенты получат ссылки на необходимые репозитории, чтобы они могли просмотреть проблемы и узнать, когда в новом выпуске будут предоставлены исправления.
* Предоставление возможных путей решения проблем или их устранение. Если проблему можно устранить, то эта [известная проблема](https://github.com/Azure/AKS/issues?q=is%3Aissue+is%3Aopen+label%3Aknown-issue) будет сохранена в репозитории AKS. Описание известной проблемы содержит:
  * суть проблемы, включая ссылки на вышестоящее ошибки;
  * обходное решение и сведения об обновлении или другом действенном решении;
  * приблизительные сроки устранения проблемы в соответствии с графиком выпуска вышестоящего проекта.
