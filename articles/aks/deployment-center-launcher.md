---
title: Центр развертывания для Azure Kubernetes
description: Центр развертывания в Azure DevOps упрощает настройку надежного конвейера Azure DevOps для вашего приложения
ms.author: puagarw
ms.manager: douge
ms.prod: devops
ms.technology: devops-cicd
ms.topic: tutorial
ms.date: 07/12/2019
author: pulkitaggarwl
monikerRange: vsts
ms.openlocfilehash: 35484566890f3bfd964e3fda337bfb3666d1da6c
ms.sourcegitcommit: 08d3a5827065d04a2dc62371e605d4d89cf6564f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/29/2019
ms.locfileid: "68618720"
---
# <a name="deployment-center-for-azure-kubernetes"></a>Центр развертывания для Azure Kubernetes

Центр развертывания в Azure DevOps упрощает настройку надежного конвейера Azure DevOps для вашего приложения. По умолчанию центр развертывания настраивает конвейер Azure DevOps для развертывания обновлений приложения в кластере Kubernetes. Вы можете расширить настроенный по умолчанию конвейер Azure DevOps, а также добавить более широкие возможности: получение подтверждения перед развертыванием, настройку дополнительных ресурсов Azure, запуск сценариев, обновление приложения или даже запуск дополнительных проверочных тестов.

Изучив данный учебник, вы научитесь:

> [!div class="checklist"]
> * Настраивать конвейер Azure DevOps для развертывания обновлений приложения в кластере Kubernetes.
> * Проверять конвейер непрерывной интеграции (CI).
> * Проверять конвейер непрерывной поставки (CD).
> * Очищать ресурсы.

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Вы можете получить бесплатную подписку с помощью [Visual Studio Dev Essentials](https://visualstudio.microsoft.com/dev-essentials/).

* Кластер Службы Azure Kubernetes (AKS).

## <a name="create-an-aks-cluster"></a>Создание кластера AKS

1. Войдите на [портал Azure](https://portal.azure.com/).

1. На портале Azure справа в строке меню выберите параметр [Cloud Shell](https://docs.microsoft.com/azure/cloud-shell/overview).

1. Чтобы создать кластер AKS, выполните следующие команды:

    ```cmd
    # Create a resource group in the South India location:

    az group create --name azooaks --location southindia

    # Create a cluster named azookubectl with one node.

    az aks create --resource-group azooaks --name azookubectl --node-count 1 --enable-addons monitoring --generate-ssh-keys
    ```

## <a name="deploy-application-updates-to-a-kubernetes-cluster"></a>Развертывание обновлений приложения в кластере Kubernetes

1. Перейдите к группе ресурсов, созданной при работе с предыдущим разделом.

1. Выберите кластер AKS, а затем выберите **Центр развертывания (предварительная версия)** в колонке слева. Выберите **Начать**.

   ![Параметры](media/deployment-center-launcher/settings.png)

1. Выберите расположение кода и нажмите кнопку **Далее**. Затем выберите один из репозиториев, поддерживаемых на данный момент: **[Azure Repos](https://docs.microsoft.com/azure/devops/repos/index?view=azure-devops)** или **GitHub**.

    Azure Repos — это набор средств управления версиями, которые помогают вам управлять кодом. Независимо от того, малый или большой проект программного обеспечения вы имеете, рекомендуется как можно раньше использовать контроль версий.

    - **Azure Repos**. Выберите репозиторий из существующего проекта и организации.

        ![Azure Repos](media/deployment-center-launcher/azure-repos.gif)

    - **GitHub**. Авторизуйтесь и выберите репозиторий для учетной записи GitHub.

        ![GitHub](media/deployment-center-launcher/github.gif)


1. Центр развертывания анализирует репозиторий и обнаруживает файл Dockerfile. Если вы хотите обновить Dockerfile, можно изменить определенный номер порта.

    ![Параметры приложения](media/deployment-center-launcher/application-settings.png)

    Если репозиторий не содержит Dockerfile, система отображает сообщение для фиксации.

    ![Dockerfile](media/deployment-center-launcher/dockerfile.png)

1. Выберите существующий реестр контейнеров или создайте его, а затем нажмите кнопку **Готово**. Конвейер создается автоматически и встает в очередь сборки в [Azure Pipelines](https://docs.microsoft.com/azure/devops/pipelines/index?view=azure-devops).

    Azure Pipelines — это облачная служба, которую можно использовать для автоматической сборки и тестирования проекта кода, а также предоставления доступа другим пользователям. Azure Pipelines сочетает непрерывную интеграцию и непрерывную доставку для постоянного и согласованного тестирования, а также создания кода и помещения его в любой целевой объект.

    ![Реестр контейнеров](media/deployment-center-launcher/container-registry.png)

1. Щелкните ссылку, чтобы просмотреть текущий конвейер.

1. После завершения установки вы увидите журналы успешной установки.

    ![Журналы](media/deployment-center-launcher/logs.png)

## <a name="examine-the-ci-pipeline"></a>Просмотр конвейера CI

Центр развертывания автоматически настраивает конвейер CI/CD организации Azure DevOps. Конвейер можно исследовать и настраивать.

1. Перейдите на панель мониторинга центра развертывания.  

1. Щелкните номер сборки в списке журналов успешной установки, чтобы просмотреть конвейер сборки для проекта.

1. Щелкните многоточие (...) в правом верхнем углу. В меню отображается несколько вариантов, таких как постановка в очередь новой сборки, сохранение сборки и редактирование конвейера сборки. Выберите **Изменить конвейер**. 

1. На этой панели можно изучить различные задачи для конвейера сборки. Сборка выполняет различные задачи, такие как сбор источников из репозитория Git, создание образа, отправка образа в реестр контейнеров и публикация выходных данных, используемых для развертываний.

1. Выберите имя конвейера сборки в верхней части соответствующей области.

1. Замените имя конвейера сборки более понятным для себя, выберите **Save & queue** (Сохранить и поместить в очередь) и нажмите кнопку **Сохранить**.

1. Под конвейером сборки щелкните **Журнал**. В этой области отображается журнал аудита недавних изменений сборки. Azure DevOps отслеживает все изменения, внесенные в конвейер сборки, и позволяет сравнивать версии.

1. Выберите **Триггеры**. Вы можете включать в процесс CI ветви или исключать их из него.

1. Щелкните **Период удержания**. Вы можете указать политику сохранения или удаления нескольких сборок в зависимости от вашего сценария.

## <a name="examine-the-cd-pipeline"></a>Просмотр конвейера CD

Центр развертывания автоматически создает и настраивает связь между организацией Azure DevOps и вашей подпиской Azure. Эти действия охватывают настройку подключения к службе Azure для проверки подлинности подписки Azure с помощью Azure DevOps. Автоматический процесс также создает конвейер выпуска, обеспечивающий непрерывную поставку в Azure.

1. Выберите **Конвейеры**, а затем **Выпуски**.

1. Чтобы изменить конвейер выпуска, нажмите кнопку **Правка**.

1. Выберите **Удалить** из списка **Артефакты**. Конвейер сборки, который вы изучали на предыдущих этапах, создает выходные данные для артефакта. 

1. Выберите переключатель **Непрерывное развертывание** справа от параметра **Удалить**. В этом конвейере выпуска есть включенный триггер CD, который запускает развертывание каждый раз, когда доступен новый артефакт сборки. Вы также можете отключить триггер, чтобы потребовать ручного выполнения установки.

1. Чтобы просмотреть все задачи для конвейера, выберите **Задачи**. В выпуске задается среда, настраивается параметр `imagePullSecrets`, устанавливаются средства Helm и развертываются диаграммы Helm в кластере Kubernetes.

1. Чтобы просмотреть журнал выпусков, выберите **Просмотреть выпуски**.

1. Чтобы просмотреть сводку, выберите **Выпуск**. Выберите любой из этапов, чтобы просмотреть несколько меню, таких как сводка по выпуску, связанные рабочие элементы и тесты. 

1. Щелкните **Фиксации**. В этом представлении отображаются фиксации кода, связанные с этим развертыванием. Сравните выпуски, чтобы просмотреть различия между развертываниями.

1. Выберите **Журналы**. Журналы содержат полезные сведения о развертывании, которые можно просмотреть во время и после развертываний.

## <a name="clean-up-resources"></a>Очистка ресурсов

Вы можете удалить связанные ресурсы, которые вы создали, когда они больше не нужны. Для этого воспользуйтесь функционалом удаления на панели мониторинга DevOps Projects.

## <a name="next-steps"></a>Дополнительная информация

Вы можете изменить эти конвейеры сборки и выпуска в соответствии с потребностями вашей команды. Вы также можете использовать эту модель CI/CD в качестве шаблона для других конвейеров.
