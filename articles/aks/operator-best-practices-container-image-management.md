---
title: Рекомендации для операторов по управлению образами контейнеров в Службах Azure Kubernetes (AKS)
description: Ознакомьтесь с рекомендациями по управлению и защите образов контейнеров в Службе Azure Kubernetes (AKS) для операторов кластеров.
services: container-service
author: iainfoulds
ms.service: container-service
ms.topic: conceptual
ms.date: 12/06/2018
ms.author: iainfou
ms.openlocfilehash: 20d3d3d755a35927550064ddfdf3b983348f93d3
ms.sourcegitcommit: 9fb6f44dbdaf9002ac4f411781bf1bd25c191e26
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2018
ms.locfileid: "53111142"
---
# <a name="best-practices-for-container-image-management-and-security-in-azure-kubernetes-service-aks"></a>Рекомендации по управлению и защите образов контейнеров в Службе Azure Kubernetes (AKS)

В процессе разработки и запуска приложений в Службе Azure Kubernetes (AKS) важно не забывать о безопасности контейнеров. Контейнеры, которые включают устаревшие базовые образы или среды выполнения приложений, представляют угрозу безопасности и возможность атаки. Чтобы свести к минимуму эти риски, нужно интегрировать инструменты, которые сканируют и устраняют проблемы в контейнерах.

В процессе разработки и запуска приложений в Службе Azure Kubernetes (AKS) важно не забывать о безопасности контейнеров и их образов. Контейнеры, содержащие устаревшие базовые образы или неисправленные среды выполнения приложений, представляют угрозу безопасности и возможность атаки. Чтобы свести к минимуму эти риски, нужно интегрировать инструменты, которые сканируют и устраняют проблемы в контейнерах как во время сборки, так и во время выполнения. Чем раньше обнаруживается уязвимость или устаревший базовый образ, тем более безопасным является кластер. В этой статье *контейнеры* обозначают как образы контейнеров, хранящиеся в реестре контейнеров, так и выполняющиеся контейнеры.

Эта статья посвящается вопросам, связанным с безопасностью контейнеров в AKS. Вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * сканировать и устранять уязвимости образов;
> * использовать доверенный реестр с образами контейнеров, содержащими цифровую подпись;
> * автоматически активировать и повторно развертывать образы контейнеров при обновлении базового образа.

Вы также можете изучить рекомендации по [безопасности кластера][best-practices-cluster-security] и [безопасности pod][best-practices-pod-security].

## <a name="secure-the-images-and-run-time"></a>Защита образов и время выполнения

**Советы и рекомендации**. Сканируйте образы контейнеров на наличие уязвимостей и развертывайте только те образы, которые прошли проверку. Регулярно обновляйте базовые образы и среды выполнения приложения, затем повторно развертывайте рабочие нагрузки в кластере AKS.

Одна из проблем с внедрением рабочих нагрузок на основе контейнера – это проверка безопасности образов и среды выполнения, используемых для создания собственных приложений. Как убедиться, что не возникнут новые уязвимости системы безопасности в ваших развертываниях? Рабочий процесс развертывания должен включать сканирование образов контейнеров с помощью средств [Twistlock][twistlock] или [Aqua][aqua] и разрешать развертывания только для проверенных образов.

![Сканирование и исправление, проверка и развертывания образов контейнеров](media/operator-best-practices-container-security/scan-container-images-simplified.png)

В реальном примере вы можете использовать конвейер непрерывной интеграции и непрерывного развертывания (CI/CD) для автоматизации сканирования, проверки и развертывания образов. Реестр контейнеров Azure включает в себя эти возможные сканирования уязвимости.

## <a name="use-a-trusted-registry"></a>Использования доверенного реестра

**Советы и рекомендации**. Ограничьте реестры образов, которые могут использовать модули pod и развертывания. Разрешите только доверенные реестры, в которых вы проверяете и контролируете доступные образы.

Для обеспечения дополнительной безопасности можно также поставить цифровую подпись на образах контейнеров или на коде приложения. Только тогда вы разрешаете AKS развертывать подписанные образы. Этот процесс обеспечивает дополнительный уровень безопасности, поскольку вы ограничиваете AKS извлечением только доверенных образов с цифровой подписью, а не тех образов, которые проходят проверку на уязвимость. Кроме того, вы убедитесь, что образ контейнера не изменен и заменен образом с точно таким же именем.

Доверенные реестры, которые предоставляют образы контейнеров с цифровой подписью, усложняют задачи вашей среде, но может потребоваться, чтобы они соответствовали определенной политике или требованиям. Реестр контейнеров Azure поддерживает использование доверенных реестров и подписанных образов.

Дополнительные сведения о подписанных образах см. в разделе [Доверие к содержимому в Реестре контейнеров Azure][acr-content-trust].

## <a name="automatically-build-new-images-on-base-image-update"></a>Автоматическое создание новых образов на основе обновления базового образа

**Советы и рекомендации**. Поскольку вы используете базовые образы для образов приложений, используйте автоматизацию для создания новых образов при обновлении базового образа. Так как эти базовые образы обычно включают исправления безопасности, обновите все образы контейнеров подчиненных приложений.

При каждом обновлении базового образа все нижестоящие образы контейнеров также должны обновляться. Этот процесс сборки следует интегрировать в конвейеры проверки и развертывания, например в [][azure-pipelines] или Jenkins. Эти конвейеры гарантируют, что ваши приложения продолжат работать с обновленными базовыми образами. После того, как образы контейнеров вашего приложения проверены, развертывания AKS могут быть обновлены для запуска новейших защищенных образов.

Задачи Реестра контейнеров Azure также могут автоматически обновлять образы контейнеров после обновления базового образа. Эта возможность позволяет создавать небольшое количество базовых образов и регулярно обновлять их, учитывая ошибки и исправления безопасности.

Дополнительные сведения см. в статьи [Руководство. автоматизации сборок образов контейнера при обновлении базового образа в службе "Реестр контейнеров Azure"][acr-base-image-update].

## <a name="next-steps"></a>Дополнительная информация

Эта статья посвящена вопросам безопасности контейнеров. Для реализации части этих рекомендаций требуются сведения, опубликованные в следующих статьях:

* [Руководство. автоматизации сборок образов контейнера при обновлении базового образа в службе "Реестр контейнеров Azure"][acr-base-image-update]
* [Доверия содержимому в реестре контейнеров Azure][acr-content-trust]

<!-- EXTERNAL LINKS -->
[azure-pipelines]: /azure/devops/pipelines/?view=vsts
[twistlock]: https://www.twistlock.com/
[aqua]: https://www.aquasec.com/

<!-- INTERNAL LINKS -->
[best-practices-cluster-security]: operator-best-practices-cluster-security.md
[best-practices-pod-security]: developer-best-practices-pod-security.md
[acr-content-trust]: ../container-registry/container-registry-content-trust.md
[acr-base-image-update]: ../container-registry/container-registry-tutorial-base-image-update.md
