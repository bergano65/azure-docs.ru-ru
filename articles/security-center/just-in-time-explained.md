---
title: Основные сведения о JIT-доступе к виртуальным машинам в центре безопасности Azure
description: В этом документе объясняется, как JIT-доступ к виртуальной машине в центре безопасности Azure помогает контролировать доступ к виртуальным машинам Azure.
services: security-center
author: memildin
manager: rkarlin
ms.service: security-center
ms.topic: how-to
ms.date: 07/12/2020
ms.author: memildin
ms.openlocfilehash: 73b1ba5e93ad82498938055db50abb665849f442
ms.sourcegitcommit: 3792cf7efc12e357f0e3b65638ea7673651db6e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2020
ms.locfileid: "91449006"
---
# <a name="understanding-just-in-time-jit-vm-access"></a>Основные сведения о JIT-доступе к виртуальной машине

На этой странице объясняются принципы функции доступа к виртуальной машине в центре безопасности Azure, а также логика, основанная на рекомендациях.

Сведения о применении JIT-компилятора к виртуальным машинам с помощью портал Azure (центра безопасности или виртуальных машин Azure) или программного обеспечения см. в статье [Защита портов управления с помощью JIT](security-center-just-in-time.md).


## <a name="the-risk-of-open-management-ports-on-a-virtual-machine"></a>Риск открытия портов управления на виртуальной машине

Субъекты угроз активно прорегистрируют доступные компьютеры с открытыми портами управления, такими как RDP или SSH. Все ваши виртуальные машины являются потенциальными целями для атаки. Если виртуальная машина успешно скомпрометирована, она используется в качестве точки входа для атаки на дополнительные ресурсы в вашей среде.



## <a name="why-jit-vm-access-is-the-solution"></a>Почему JIT-доступ к виртуальным машинам является решением 

Как и в случае со всеми методами предотвращения кибербезопасности, ваша цель — уменьшить область атаки. В этом случае это означает, что у вас меньше открытых портов, особенно портов управления.

Ваши законные пользователи также используют эти порты, поэтому их не всегда нужно закрывать.

Чтобы решить эту дилеммой, центр безопасности Azure предлагает JIT-компилятор. JIT позволяет блокировать входящий трафик к виртуальным машинам, уменьшая вероятность атак, обеспечивая при необходимости удобный доступ к виртуальным машинам.



## <a name="how-jit-operates-with-network-security-groups-and-azure-firewall"></a>Как JIT работает с группами безопасности сети и брандмауэром Azure

При включении JIT-доступа к виртуальной машине можно выбрать порты на виртуальной машине, для которых будет заблокирован входящий трафик. Центр безопасности обеспечивает существование правил "запретить весь входящий трафик" для выбранных портов в [группе безопасности сети](https://docs.microsoft.com/azure/virtual-network/security-overview#security-rules) (NSG) и [правил брандмауэра Azure](https://docs.microsoft.com/azure/firewall/rule-processing). Эти правила ограничивают доступ к портам управления ВМ Azure и защищают их от атак. 

Если для выбранных портов уже существуют другие правила, эти правила имеют приоритет над новым правилом "запретить весь входящий трафик". Если на выбранных портах нет существующих правил, новые правила будут иметь наивысший приоритет в NSG и брандмауэре Azure.

Когда пользователь запрашивает доступ к виртуальной машине, центр безопасности проверяет, имеет ли пользователь разрешения [на управление доступом на основе ролей Azure (Azure RBAC)](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-portal) для этой виртуальной машины. Если запрос утвержден, центр безопасности настраивает группы безопасности сети и брандмауэр Azure, чтобы разрешить входящий трафик на выбранные порты с соответствующего IP-адреса (или диапазона) в течение указанного периода времени. После истечения этого времени центр безопасности восстанавливает прежнее состояние групп безопасности сети. Уже установленные соединения не прерываются.

> [!NOTE]
> JIT не поддерживает виртуальные машины, защищенные брандмауэрами Azure, которыми управляет [Диспетчер брандмауэра Azure](https://docs.microsoft.com/azure/firewall-manager/overview).




## <a name="how-security-center-identifies-which-vms-should-have-jit-applied"></a>Как центр безопасности определяет, какие виртуальные машины должны быть применены к JIT-компилятору

На схеме ниже показана логика, применяемая центром безопасности при принятии решения о категории поддерживаемых виртуальных машин. 

[![Логический поток виртуальной машины (JIT)](media/just-in-time-explained/jit-logic-flow.png)](media/just-in-time-explained/jit-logic-flow.png#lightbox)

Когда центр безопасности находит компьютер, который может использовать преимущества JIT-компилятора, он добавляет этот компьютер на вкладку **неработоспособные ресурсы** рекомендации. 

![Рекомендации по доступу к виртуальной машине по требованию (JIT)](./media/just-in-time-explained/unhealthy-resources.png)


## <a name="faq---questions-about-just-in-time-virtual-machine-access"></a>Часто задаваемые вопросы о JIT-доступе к виртуальной машине

### <a name="what-permissions-are-needed-to-configure-and-use-jit"></a>Какие разрешения необходимы для настройки и использования JIT?

Если вы хотите создать настраиваемые роли, которые могут работать с JIT, вам понадобятся сведения из следующей таблицы.

> [!TIP]
> Чтобы создать роль с минимальными привилегиями для пользователей, которым требуется запросить JIT-доступ к виртуальной машине, и не выполнять другие операции JIT, используйте [Скрипт Set-житлеастпривилежедроле](https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts/JIT%20Custom%20Role) на страницах сообщества центра безопасности GitHub.

| Чтобы предоставить пользователю следующие возможности: | Разрешения для установки|
| --- | --- |
| Настройка или изменение политики JIT для виртуальной машины | *Назначьте этой роли следующие действия.*  <ul><li>В области подписки или группы ресурсов, связанной с виртуальной машиной:<br/> `Microsoft.Security/locations/jitNetworkAccessPolicies/write` </li><li> В области подписки или группы ресурсов виртуальной машины: <br/>`Microsoft.Compute/virtualMachines/write`</li></ul> | 
|Запрос JIT-доступа к виртуальной машине | *Назначьте пользователю следующие действия:*  <ul><li>В области подписки или группы ресурсов, связанной с виртуальной машиной:<br/>  `Microsoft.Security/locations/jitNetworkAccessPolicies/initiate/action` </li><li>В области подписки или группы ресурсов, связанной с виртуальной машиной:<br/>  `Microsoft.Security/locations/jitNetworkAccessPolicies/*/read` </li><li>  В области подписки, группы ресурсов или виртуальной машины:<br/> `Microsoft.Compute/virtualMachines/read` </li><li>  В области подписки, группы ресурсов или виртуальной машины:<br/> `Microsoft.Network/networkInterfaces/*/read` </li></ul>|
|Чтение политик JIT| *Назначьте пользователю следующие действия:*  <ul><li>`Microsoft.Security/locations/jitNetworkAccessPolicies/read`</li><li>`Microsoft.Security/locations/jitNetworkAccessPolicies/initiate/action`</li><li>`Microsoft.Security/policies/read`</li><li>`Microsoft.Compute/virtualMachines/read`</li><li>`Microsoft.Network/*/read`</li>|
|||





## <a name="next-steps"></a>Дальнейшие действия

На этой странице объясняется, _почему_ следует использовать JIT-доступ к виртуальной машине. 

Перейдите к статье с инструкциями, чтобы узнать о включении JIT-компилятора и запросе доступа к виртуальным машинам с поддержкой JIT.

> [!div class="nextstepaction"]
> [Как защитить порты управления с помощью JIT-компилятора](security-center-just-in-time.md)
