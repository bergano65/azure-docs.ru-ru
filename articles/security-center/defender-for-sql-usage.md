---
title: Использование защитника Azure для SQL
description: Узнайте, как использовать необязательный план Azure Defender для SQL в центре безопасности Azure
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.assetid: ba46c460-6ba7-48b2-a6a7-ec802dd4eec2
ms.service: security-center
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/22/2020
ms.author: memildin
ms.openlocfilehash: 6d19027cfd406f81d31696c5cd2c1a235574e400
ms.sourcegitcommit: a422b86148cba668c7332e15480c5995ad72fa76
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/30/2020
ms.locfileid: "91577855"
---
# <a name="azure-defender-for-sql-servers-on-machines"></a>Защитник Azure для серверов SQL Server на компьютерах 

Эта схема защитника Azure обнаруживает аномальные действия, указывающие на необычные и потенциально опасные попытки доступа к базам данных или их использования.

Вы получаете оповещения о подозрительных действиях с базами данных, потенциальных уязвимостях, атаках путем внедрения кода SQL и аномальных закономерностях в доступе к базам данных и шаблонах запросов.

## <a name="availability"></a>Доступность

|Аспект|Подробнее|
|----|:----|
|Состояние выпуска:|Предварительный просмотр|
|Цены|Счета **за использование защитника Azure для серверов SQL Server на компьютерах** выставляются, как показано на [странице с ценами](security-center-pricing.md) .|
|Защищенные версии SQL:|SQL Server Azure (все версии, охваченные службой поддержки Майкрософт)|
|Облако.|![Да](./media/icons/yes-icon.png) Коммерческие облака<br>![Да](./media/icons/yes-icon.png) US Gov<br>![Нет](./media/icons/no-icon.png) Gov Китая, другое gov|
|||

## <a name="set-up-azure-defender-for-sql-servers-on-machines"></a>Настройка защитника Azure для серверов SQL Server на компьютерах

Чтобы включить этот план, сделайте следующее:

* Подготавливает агент Log Analytics на узле SQL Server. Это обеспечивает подключение к Azure.

* Включите необязательный план на странице цен и параметров центра безопасности.

Ниже описаны оба этих варианта.

### <a name="step-1-provision-the-log-analytics-agent-on-your-sql-servers-host"></a>Шаг 1. Подготавливаете агент Log Analytics на узле SQL Server:

- **SQL Server на виртуальной машине Azure** . Если компьютер SQL размещается на виртуальной машине Azure, можно выполнить [автоматическую инициализацию агента log Analytics](security-center-enable-data-collection.md#workspace-configuration). Кроме того, вы можете выполнить процедуру вручную, чтобы подключить [Azure Stack виртуальные машины](quickstart-onboard-machines.md#onboard-your-azure-stack-vms).
- **SQL Server в службе "Дуга Azure** ". если ваша SQL Server размещена на компьютере [Arc Azure](https://docs.microsoft.com/azure/azure-arc/) , можно развернуть агент log Analytics с помощью рекомендации центра безопасности "log Analytics должен быть установлен на компьютерах Arc Azure на базе Windows (Предварительная версия)". Кроме того, можно выполнить процедуру вручную в [документации по службе Arc Azure](https://docs.microsoft.com/azure/azure-arc/servers/manage-vm-extensions#enable-extensions-from-the-portal).

- **SQL Server локального** компьютера. если ваша SQL Server размещена на локальном компьютере Windows без дуги Azure, у вас есть два варианта подключения его к Azure:
    
    - **Развертывание Arc Azure** . Вы можете подключить любой компьютер Windows к центру безопасности. Тем не менее Azure Arc обеспечивает более глубокую интеграцию во *всей* среде Azure. Если вы настроили дугу Azure, вы увидите страницу **SQL Server — Azure Arc** на портале, и ваши оповещения системы безопасности будут отображаться на выделенной вкладке **безопасности** на этой странице. Поэтому первым и рекомендуемым вариантом является [Настройка дуги Azure на узле](https://docs.microsoft.com/azure/azure-arc/servers/onboard-portal#install-and-validate-the-agent-on-windows) и следуйте инструкциям по **SQL Server в Azure**, приведенном выше.
        
    - **Подключение компьютера Windows без дуги Azure** . Если вы решили подключить SQL Server, работающую на компьютере Windows, без использования дуги Azure, следуйте инструкциям в статье [Подключение компьютеров Windows к Azure Monitor](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows).


### <a name="step-2-enable-the-optional-plan-in-security-centers-pricing-and-settings-page"></a>Шаг 2. Включите необязательный план на странице цен и настроек центра безопасности:

1. В меню центра безопасности откройте страницу **параметры ценообразования &** .

    - Если вы используете **рабочую область по умолчанию центра безопасности Azure** (с именем "defaultWorkspace-[ваш идентификатор подписки]-[регион]"), выберите соответствующую **подписку**.

    - Если вы используете **рабочую область не по умолчанию**, выберите соответствующую **рабочую область** (введите имя рабочей области в фильтре, если это необходимо):

        ![Поиск рабочей области, отличной от используемой по умолчанию, по названию](./media/security-center-advanced-iaas-data/pricing-and-settings-workspaces.png)

1. Установите параметр для **защитника Azure для серверов SQL Server на компьютерах (Предварительная версия)** в значение **вкл**. 

    ![Страница цен на центр безопасности с необязательными планами](media/security-center-advanced-iaas-data/sql-servers-on-vms-in-pricing-small.png)

    Этот план будет включен на всех серверах SQL Server, подключенных к выбранной рабочей области. Защита будет полностью активна после первого перезапуска экземпляра SQL Server.

    >[!TIP] 
    > Чтобы создать новую рабочую область, следуйте инструкциям в разделе [создание log Analytics рабочей области](https://docs.microsoft.com/azure/azure-monitor/learn/quick-create-workspace).


1. При необходимости настройте уведомления по электронной почте для оповещений системы безопасности. 
    Вы можете задать список получателей уведомлений по электронной почте при создании оповещений центра безопасности. Сообщение электронной почты содержит прямую ссылку на оповещение в центре безопасности Azure со всеми релевантными сведениями. Дополнительные сведения см. в разделе [Настройка уведомлений по электронной почте для оповещений системы безопасности](security-center-provide-security-contact-details.md).



## <a name="explore-vulnerability-assessment-reports"></a>Просмотр отчетов об оценке уязвимостей

Служба оценки уязвимостей сканирует базы данных раз в неделю. Проверка выполняется в тот же день недели, в который была включена служба.

На панели мониторинга "Оценка уязвимостей" представлены общие сведения о результатах оценки для всех баз данных, а также сводка по работоспособным и неработоспособным базам данных и Общая сводка сбоев проверок в соответствии с распределением рисков.

Результаты оценки уязвимостей можно просмотреть непосредственно в центре безопасности.

1. На боковой панели центра безопасности откройте страницу **рекомендации** и выберите рекомендации по рекомендациям **на серверах SQL Server на компьютерах, которые следует исправить (Предварительная версия)**. Дополнительные сведения см. в разделе [рекомендации центра безопасности](security-center-recommendations.md). 

    :::image type="content" source="./media/security-center-advanced-iaas-data/data-and-storage-sqldb-vulns-on-vm.png" alt-text="Необходимо исправить результаты оценки уязвимостей на серверах SQL Server на компьютерах (Предварительная версия)":::

    Отобразится подробное представление для этой рекомендации.

    :::image type="content" source="./media/security-center-advanced-iaas-data/all-servers-view.png" alt-text="Необходимо исправить результаты оценки уязвимостей на серверах SQL Server на компьютерах (Предварительная версия)":::

1. Дополнительные сведения см. в детализации:

    * Чтобы просмотреть обзор проверенных ресурсов (баз данных) и список проверенных проверок безопасности, выберите интересующий вас сервер.

    * Чтобы получить общие сведения об уязвимостях, сгруппированных по определенной базе данных SQL, выберите интересующую базу данных.

    В каждом представлении проверки безопасности сортируются по **степени серьезности**. Щелкните определенную проверку безопасности, чтобы просмотреть область сведений с **описанием**, способ устранения **этой проблемы** и другие связанные сведения, такие как **влияние** или **тест производительности**.

## <a name="azure-defender-for-sql-alerts"></a>Оповещения Azure Defender для SQL
Предупреждения создаются необычными и потенциально опасными попытками получить доступ к компьютерам SQL или использовать их. Эти события могут активировать предупреждения, показанные в [разделе оповещения для базы данных SQL и Azure синапсе Analytics (ранее — хранилище данных SQL) на странице справки по оповещениям](alerts-reference.md#alerts-sql-db-and-warehouse).

## <a name="explore-and-investigate-security-alerts"></a>Просмотр и исследование оповещений системы безопасности

Оповещения защитника Azure доступны на странице Оповещения центра безопасности, на вкладке Безопасность ресурса, на [панели мониторинга защитника Azure](azure-defender-dashboard.md)или через прямую ссылку в сообщении электронной почты с оповещениями.

1. Чтобы просмотреть оповещения, в меню центра безопасности выберите **оповещения системы безопасности** и выберите оповещение.

1. Оповещения предназначены для автономного выполнения с подробными инструкциями по исправлению и анализом информации в каждом из них. Дополнительные сведения см. в более широком обзоре с помощью другого центра безопасности Azure и возможностей Azure Sentinel:

    * Включите функцию аудита SQL Server для дальнейшего исследования. Если вы являетесь пользователем-Sentinel Azure, вы можете отправить журналы аудита SQL из событий журнала безопасности Windows в метку и наслаждаться богатыми возможностями расследования. Дополнительные [сведения об аудите SQL Server](https://docs.microsoft.com/sql/relational-databases/security/auditing/create-a-server-audit-and-server-audit-specification?view=sql-server-ver15).
    * Чтобы повысить уровень безопасности, используйте рекомендации центра безопасности для главного компьютера, указанного в каждом оповещении. Это снизит риски, возникающие в будущих атаках. 

    [Дополнительные сведения об управлении оповещениями и реагировании на них](security-center-managing-and-responding-alerts.md).


## <a name="next-steps"></a>Дальнейшие действия

Связанные материалы см. в следующей статье:

- [Оповещения системы безопасности для базы данных SQL и Azure синапсе Analytics (ранее — хранилище данных SQL)](alerts-reference.md#alerts-sql-db-and-warehouse)
- [Настройка уведомлений по электронной почте для оповещений системы безопасности](security-center-provide-security-contact-details.md)
- [Дополнительные сведения об Azure Sentinel](https://docs.microsoft.com/azure/sentinel/)
- [Пакет безопасности данных центра безопасности Azure](https://docs.microsoft.com/azure/sql-database/sql-database-advanced-data-security)