---
title: Типы запросов
titleSuffix: Azure Cognitive Search
description: Сведения о типах запросов, поддерживаемых в Когнитивный поиск, включая произвольный текст, фильтр, автозаполнение и предложения, географический поиск, системные запросы и поиск документов.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 12/11/2020
ms.openlocfilehash: 9cac0a0026a7007e227607e04e03a77e4df99ecd
ms.sourcegitcommit: 1bdcaca5978c3a4929cccbc8dc42fc0c93ca7b30
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/13/2020
ms.locfileid: "97368127"
---
# <a name="querying-in-azure-cognitive-search"></a>Запросы в Azure Когнитивный поиск

Azure Когнитивный поиск предлагает обширный язык запросов для поддержки широкого спектра сценариев, от поиска бесплатных форм до строго заданных шаблонов запросов. В этой статье перечислены типы запросов, которые можно создать.

В Когнитивный поиск запрос представляет собой полную спецификацию операции приема-передачи **`search`** с параметрами, которые сообщают о выполнении запроса и формируют ответ, который возвращается. Параметры и синтаксические анализаторы определяют тип запроса запроса. В следующем примере запроса используются [документы поиска (REST API)](/rest/api/searchservice/search-documents), предназначенные для [демонстрационного индекса гостиниц](search-get-started-portal.md).

```http
POST https://[service name].search.windows.net/indexes/hotels-sample-index/docs/search?api-version=2020-06-30
{
    "queryType": "simple"
    "search": "`New York` +restaurant",
    "searchFields": "Description, Address/City, Tags",
    "select": "HotelId, HotelName, Description, Rating, Address/City, Tags",
    "top": "10",
    "count": "true",
    "orderby": "Rating desc"
}
```

Параметры, используемые при выполнении запроса:

+ **`queryType`** Задает средство синтаксического анализа, которое является либо [анализатором простого запроса по умолчанию](search-query-simple-examples.md) (оптимальным для полнотекстового поиска), либо [полным средством синтаксического анализа запросов Lucene](search-query-lucene-examples.md) , используемым для расширенных конструкций запросов, таких как регулярные выражения, поиск по сходству, нечеткий и поиск с подстановочными знаками.

+ **`search`** предоставляет критерии соответствия, обычно целые термины или фразы с операторами или без них. Для этого параметра доступно любое поле, которое является атрибутом, поддерживающим *Поиск* в схеме индекса. 

+ **`searchFields`** ограничивает выполнение запросов конкретными полями, поддерживающими Поиск.

Параметры, используемые для формирования ответа:

+ **`select`** Указывает, какие поля должны возвращаться в ответе. В инструкции SELECT можно использовать только те поля, которые помечены как доступные для *получения* индекса.

+ **`top`** Возвращает указанное число наиболее подходящих документов. В этом примере возвращаются только 10 обращений. Для страницы результатов можно использовать предложения TOP и Skip (не показано).

+ **`count`** Указывает, сколько документов во всем индексе соответствует общему числу, что может быть больше, чем возвращено. 

+ **`orderby`** используется, если требуется сортировать результаты по значению, например по рейтингу или расположению. В противном случае по умолчанию используется показатель релевантности для ранжирования результатов. Поле должно быть с атрибутом, *допускающим сортировку* , в качестве кандидата для этого параметра.

Приведенный выше список является репрезентативным, но не исчерпывающим. Полный список параметров запроса запроса см. в разделе [Поиск документов (REST API)](/rest/api/searchservice/search-documents).

<a name="types-of-queries"></a>

## <a name="types-of-queries"></a>Типы запросов

С помощью нескольких заметных исключений Запрос перебирает Инвертированные индексы, структурированные для быстрой проверки, где соответствие может быть найдено в любом поле, в любом количестве поисковых документов. В Когнитивный поиск основной методологией поиска совпадений является полнотекстовый поиск или фильтры, но можно также реализовать другие хорошо известные возможности поиска, такие как автозаполнение или поиск по географическому расположению. В оставшейся части этой статьи перечислены запросы в Когнитивный поиск и приведены ссылки на дополнительные сведения и примеры.

## <a name="full-text-search"></a>Полнотекстовый поиск

Если приложение поиска содержит поле поиска, которое собирает входные данные термина, то полнотекстовый поиск, возможно, будет выполнять операции запроса. Полнотекстовый поиск принимает термины или фразы, переданные в **`search`** параметре во всех полях с *возможностью поиска* в индексе. Необязательные логические операторы в строке запроса могут указывать условия включения или исключения. И простой, и полный синтаксический анализатор поддерживают полнотекстовый поиск.

В Когнитивный поиск полнотекстовый поиск основан на механизме запросов Apache Lucene. Строки запросов в полнотекстовом поиске просматривают лексическую анализ, чтобы сделать сканирование более эффективным. Анализ включает в себя нижний регистр всех терминов, удаление таких слов, как «The», и сокращение терминов на простые корневые формы. Анализатором по умолчанию является стандартный Lucene.

При обнаружении совпадающих терминов механизм запросов восстанавливает документ поиска, содержащий совпадение, ранжирует документы в порядке релевантности и возвращает первые 50 (по умолчанию) в ответе.

Если вы реализуете полнотекстовый поиск, то понимание того, как размечено содержимое, поможет вам отлаживать все аномалии запросов. Запросы к строкам с дефисами или специальными символами могут использовать анализатор, отличный от стандартного уровня Lucene по умолчанию, чтобы гарантировать, что индекс содержит нужные маркеры. Можно переопределить параметры по умолчанию с помощью [анализаторов языка](index-add-language-analyzers.md#language-analyzer-list) или [специализированных анализаторов](index-add-custom-analyzers.md#AnalyzerTable) , изменяющих лексическую аналитику. Одним из примеров является [ключевое слово](https://lucene.apache.org/core/6_6_1/analyzers-common/org/apache/lucene/analysis/core/KeywordAnalyzer.html) , которое обрабатывает все содержимое поля как один маркер. Это полезно для данных некоторых типов, таких как почтовые индексы, идентификаторы и названия продуктов. Дополнительные сведения см. в разделе [частичный Поиск терминов и шаблоны со специальными символами](search-query-partial-matching.md).

Если предполагается интенсивное использование логических операторов, которые, скорее всего, будут в индексах, содержащих большие текстовые блоки (поле содержимого или длинные описания), обязательно протестируйте запросы с **`searchMode=Any|All`** параметром, чтобы оценить влияние этого параметра на логический поиск.

## <a name="autocomplete-and-suggested-queries"></a>Автозаполнение и предлагаемые запросы

[Автозаполнение или предлагаемые результаты](search-autocomplete-tutorial.md) являются альтернативами **`search`** , которые запускают последовательные запросы на основе неполных строковых значений (после каждого символа) в интерфейсе поиска по мере использования. **`autocomplete`** Параметр и можно использовать **`suggestions`** совместно или отдельно, как описано в [этом руководстве](tutorial-csharp-type-ahead-and-suggestions.md), но нельзя использовать с **`search`** . Как завершенные термины, так и предлагаемые запросы являются производными от содержимого индекса. Обработчик никогда не будет возвращать строку или предложение, которое не существует в индексе. Дополнительные сведения см. в разделе [Автозаполнение (REST API)](/rest/api/searchservice/autocomplete) и [предложения (REST API)](/rest/api/searchservice/suggestions).

## <a name="filter-search"></a>Фильтрация поиска

Фильтры широко используются в приложениях, которые включают Когнитивный поиск. На страницах приложений фильтры часто выводятся в виде аспектов в структурах навигации ссылок для ориентированной на пользователя фильтрации. Фильтры также используются внутри для предоставления срезов индексированного содержимого. Например, можно выполнить фильтрацию по языку, если индекс содержит поля как на английском, так и на французском языках. 

Также могут потребоваться фильтры для вызова специализированной формы запроса, как описано в следующей таблице. Фильтр можно использовать с неопределенным поиском ( **`search=*`** ) или со строкой запроса, включающей термины, фразы, операторы и закономерности.

| Сценарий фильтра | Описание |
|-----------------|-------------|
| Фильтры диапазонов | В Когнитивный поиск Azure запросы к диапазону создаются с помощью параметра Filter. Дополнительные сведения и примеры см. в разделе [Пример фильтра диапазона](search-query-simple-examples.md#example-4-range-filters). |
| Поиск по географическому расположению | Если поле с возможностью поиска имеет [тип EDM. GeographyPoint](/rest/api/searchservice/supported-data-types), можно создать критерий фильтра для элемента управления поиска "соседние элементы" или "Поиск на основе карт". Поля, на которых размещен географический поиск, содержат координаты. Дополнительные сведения и пример см. в разделе [Пример географического поиска](search-query-simple-examples.md#example-5-geo-search). |
| Фасетная навигация | Структура навигации аспекта превращается в Instrumental при переходе пользователя при вызове фильтра в ответ на `onclick` событие аспекта. Таким образом, аспекты и фильтры переходят в руки. Если вы добавите навигацию по аспектам, вам понадобятся фильтры для завершения работы. Дополнительные сведения см. [в разделе Создание фильтра аспектов](search-filters-facets.md). |

> [!NOTE]
> Текст, используемый в критерии фильтра, не анализируется во время обработки запроса. Предполагается, что введенный текст является буквальным шаблоном символов с учетом регистра, который либо завершается успешно, либо неудачно завершается с совпадением. Выражения фильтра создаются с помощью [синтаксиса OData](query-odata-filter-orderby-syntax.md) и передаются в **`filter`** параметр во всех *фильтруемых* полях индекса. Дополнительные сведения см. [в статье фильтры в когнитивный Поиск Azure](search-filters.md).

## <a name="document-look-up"></a>Поиск в документе

В отличие от ранее описанных форм запросов, эта единица возвращает один [документ поиска по идентификатору](/rest/api/searchservice/lookup-document)без соответствующего поиска по индексу или просмотра. Запрашиваются и возвращаются только один документ. Когда пользователь выбирает элемент в результатах поиска, получение документа и заполнение страницы сведений с полями являются обычным ответом, а поиск документа — это операция, которая его поддерживает.

## <a name="advanced-search-fuzzy-wildcard-proximity-regex"></a>Расширенный поиск: нечеткий, подстановочный знак, близость, регулярное выражение

Расширенная форма запроса зависит от полного средства синтаксического анализа и операторов, которые запускают определенное поведение запроса.

| Тип запроса | Использование | Дополнительные сведения и примеры |
|------------|--------|------------------------------|
| [Поиск по полям](query-lucene-syntax.md#bkmk_fields) | **`search`**  параметр **`queryType=full`**  | Создайте сложное выражение запроса, предназначенное для одного поля. <br/>[Пример поиска по полям](search-query-lucene-examples.md#example-2-fielded-search) |
| [нечеткий поиск](query-lucene-syntax.md#bkmk_fuzzy) | **`search`** параметр **`queryType=full`** | Находит совпадения с терминами, которые имеют сходную конструкцию или орфографию. <br/>[Пример поиска нечетких соответствий](search-query-lucene-examples.md#example-3-fuzzy-search) |
| [поиск по сходству](query-lucene-syntax.md#bkmk_proximity) | **`search`** параметр **`queryType=full`** | Находит термины, которые расположены в документе рядом друг с другом. <br/>[Пример поиска с учетом расположения](search-query-lucene-examples.md#example-4-proximity-search) |
| [повышение термина](query-lucene-syntax.md#bkmk_termboost) | **`search`** параметр **`queryType=full`** | Присваивает более высокий приоритет документам, которые содержат определенный термин. <br/>[Пример повышения приоритета термина](search-query-lucene-examples.md#example-5-term-boosting) |
| [Поиск регулярных выражений](query-lucene-syntax.md#bkmk_regex) | **`search`** параметр **`queryType=full`** | Находит совпадения на основе содержимого регулярного выражения. <br/>[Пример поиска с использованием регулярного выражения](search-query-lucene-examples.md#example-6-regex) |
|  [Поиск с подстановочным знаком или префиксом](query-lucene-syntax.md#bkmk_wildcard) | **`search`** параметр с * *_`~`_* или **`?`** , **`queryType=full`**| Находит совпадения с учетом префикса и символа тильды (`~`) или одного символа (`?`). <br/>[Пример поиска с использованием подстановочных знаков](search-query-lucene-examples.md#example-7-wildcard-search) |

## <a name="next-steps"></a>Дальнейшие действия

Используйте портал или другое средство, например POST или Visual Studio Code, или один из пакетов SDK для более подробного изучения запросов. Чтобы приступить к работе, необходимо ознакомиться со следующими ссылками.

+ [Обозреватель поиска](search-explorer.md)
+ [Выполнение запроса в REST](search-get-started-rest.md)
+ [Выполнение запроса в .NET](search-get-started-dotnet.md)
+ [Как выполнить запрос в Python](search-get-started-python.md)
+ [Как выполнить запрос в JavaScript](search-get-started-javascript.md)