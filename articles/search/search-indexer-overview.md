---
title: Обзор индексатора
titleSuffix: Azure Cognitive Search
description: Просканировать базу данных SQL Azure, SQL Управляемый экземпляр, Azure Cosmos DB или службу хранилища Azure, чтобы извлечь данные для поиска и заполнить индекс Azure Когнитивный поиск.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 01/29/2021
ms.openlocfilehash: df393f54e7dfa83c8fc0feab3dbf42a156b296b7
ms.sourcegitcommit: eb546f78c31dfa65937b3a1be134fb5f153447d6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/02/2021
ms.locfileid: "99430468"
---
# <a name="indexers-in-azure-cognitive-search"></a>Indexers in Azure Cognitive Search (Индексаторы в службе "Когнитивный поиск Azure")

*Индексатор* в когнитивный Поиск Azure — это средство, которое извлекает искомый текст и метаданные из внешнего источника данных Azure и заполняет индекс поиска, используя сопоставления полей и полей между исходными данными и индексом. Этот подход иногда называют "моделью извлечения", так как служба извлекает данные в, не требуя написания кода, добавляющего данные в индекс. Индексаторы также дают возможность [расширить возможности искусственного интеллекта](cognitive-search-concept-intro.md) когнитивный Поиск, объединяя внешнюю обработку маршрута содержимого EN к индексу.

Индексаторы доступны только для Azure, с индивидуальными индексаторами для [Azure SQL](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md), [Azure Cosmos DB](search-howto-index-cosmosdb.md), [хранилищем таблиц Azure](search-howto-indexing-azure-tables.md) и [хранилищем BLOB-объектов](search-howto-indexing-azure-blob-storage.md). При настройке индексатора вы указываете источник данных (происхождение), а также индекс (назначение). Несколько источников, таких как хранилище BLOB-объектов, имеют дополнительные свойства конфигурации, относящиеся к этому типу содержимого.

Индексаторы можно запускать по требованию или по регулярному расписанию обновления данных, которое выполняется каждые пять минут. Для более частых обновлений требуется ["Push Model"](search-what-is-data-import.md) , который одновременно обновляет данные в когнитивный Поиск Azure и внешнем источнике данных.

## <a name="usage-scenarios"></a>Сценарии использования

Индексатор можно использовать в качестве единственного способа приема данных или в составе сочетания методов, которые загружают и при необходимости преобразуют или расширяют содержимое. В следующей таблице перечислены основные сценарии.

| Сценарий |Стратегия |
|----------|---------|
| Один источник данных | Этот шаблон является самым простым: один источник данных является единственным поставщиком содержимого для индекса поиска. Из источника вы обнаружите одно поле, содержащее уникальные значения, которые будут использоваться в качестве ключа документа в индексе поиска. Уникальное значение будет использоваться в качестве идентификатора. Все остальные поля источника сопоставляются неявно или явно с соответствующими полями в индексе. </br></br>Важным мысль является то, что значение ключа документа поступает из исходных данных. Служба поиска не создает значения ключа. При последующих запусках добавляются входящие документы с новыми ключами, а входящие документы с существующими ключами объединяются или перезаписываются в зависимости от того, имеют ли поля индекса значения NULL или заполнены. |
| Несколько источников данных | Индекс может принимать содержимое из нескольких источников, где каждый запуск помещает новое содержимое из другого источника. </br></br>Одним из результатов может быть индекс, который получает документы после выполнения каждого индексатора, при этом все документы создаются полностью из каждого источника. Например, документы 1-100 находятся в хранилище BLOB-объектов, документы 101-200 — из Azure SQL и т. д. Задача в этом сценарии заключается в проектировании схемы индекса, которая работает для всех входящих данных, и ключевой структуры документа, единообразной в индексе поиска. В собственном виде значения, однозначно идентифицирующие документ, metadata_storage_path в контейнере больших двоичных объектов и первичном ключе в таблице SQL. Можно предположить, что один или оба источника должны быть дополнены для предоставления ключевых значений в общем формате, независимо от происхождения содержимого. Для этого сценария следует выполнить определенный уровень предварительной обработки, чтобы хоможенизе данные, чтобы их можно было извлечь в один индекс. </br></br>В качестве альтернативного результата можно привести Поиск документов, которые частично заполнены при первом запуске, а затем заполняются последующими запусками для получения значений из других источников. Например, поля 1-10 находятся в хранилище BLOB-объектов, 11-20 из Azure SQL и т. д. Задача этого шаблона заключается в том, что каждый запуск индексирования предназначен для одного и того же документа. Для объединения полей в существующий документ требуется совпадение с ключом документа. Демонстрацию этого сценария см. в разделе [учебник. индекс из нескольких источников данных](tutorial-multiple-data-sources.md). |
| Несколько индексаторов | Если вы используете несколько источников данных, вам может потребоваться несколько индексаторов, если необходимо изменить параметры времени выполнения, расписание или сопоставления полей. Хотя несколько наборов источников данных индексатора могут ориентироваться на один и тот же индекс, следует соблюдать осторожность при выполнении индексаторов, которые могут перезаписывать существующие значения в индексе. Если второй источник данных-индексатора предназначен для одних и тех же документов и полей, все значения из первого запуска будут перезаписаны. Значения полей заменяются полностью; индексатор не может объединять значения из нескольких запусков в одно поле.</br></br>Еще один вариант использования с несколькими индексами — [горизонтальное масштабирование из когнитивный Поиск](search-performance-optimization.md#use-indexers-for-updating-content-on-multiple-services). У вас могут быть копии одного индекса поиска в разных регионах. Чтобы синхронизировать содержимое индекса поиска, может потребоваться несколько индексаторов, изменяющих один и тот же источник данных, где каждый индексатор обращается к другому индексу поиска.</br></br>Для [параллельной индексации](search-howto-large-index.md#parallel-indexing) очень больших наборов данных также требуется стратегия с несколькими индексами. Каждый индексатор предназначен для подмножества данных. |
| Преобразование содержимого | Когнитивный поиск поддерживает дополнительное поведение [искусственного интеллекта](cognitive-search-concept-intro.md) , которое добавляет анализ изображений и обработку естественного языка для создания нового содержимого и структуры с возможностью поиска. Обогащение искусственного интеллекта осуществляется на основе индексатора с помощью присоединенного набора [навыков](cognitive-search-working-with-skillsets.md). Чтобы выполнить обогащение искусственного интеллекта, индексатору по-прежнему нужен индекс и источник данных Azure, но в этом сценарии добавляет обработку набора навыков в выполнение индексатора. |

<a name="supported-data-sources"></a>

## <a name="supported-data-sources"></a>Поддерживаемые источники данных

Данные о сканировании, выполненном индексаторами, хранятся в Azure.

+ [Хранилище BLOB-объектов Azure](search-howto-indexing-azure-blob-storage.md)
+ [Azure Data Lake Storage 2-го поколения](search-howto-index-azure-data-lake-storage.md) (Предварительная версия)
+ [хранилище таблиц Azure](search-howto-indexing-azure-tables.md)
+ [Azure Cosmos DB](search-howto-index-cosmosdb.md)
+ [База данных SQL Azure](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md)
+ [Управляемый экземпляр SQL](search-howto-connecting-azure-sql-mi-to-azure-search-using-indexers.md)
+ [SQL Server на Виртуальных машинах Microsoft Azure](search-howto-connecting-azure-sql-iaas-to-azure-search-using-indexers.md)

При использовании виртуальных сетей Azure для клиентских приложений можно устанавливать подключения индексатора к удаленным источникам данных с помощью стандартных подключений к Интернету (общедоступных) или зашифрованных частных подключений. Можно также настроить подключения для проверки подлинности с помощью доверенного удостоверения службы. Дополнительные сведения о безопасных подключениях см. в статьях [предоставление доступа через частные конечные точки](search-indexer-securing-resources.md#granting-access-via-private-endpoints) и [Подключение к источнику данных с помощью управляемого удостоверения](search-howto-managed-identities-data-sources.md).

## <a name="stages-of-indexing"></a>Этапы индексирования

При начальном запуске, когда индекс пуст, индексатор будет считывать все данные, предоставленные в таблице или контейнере. При последующих запусках индексатор обычно может обнаруживать и извлекать только измененные данные. Для данных больших двоичных объектов обнаружение изменений будет автоматическим. Для других источников данных, таких как Azure SQL или Cosmos DB, необходимо включить обнаружение изменений.

Для каждого получаемого документа индексатор реализует или координирует несколько шагов, от извлечения документа до финальной поисковой системы для индексирования. При необходимости индексатор также Instrumental в ходе выполнения и выхода навыков, предполагая, что набор навыков определен.

:::image type="content" source="media/search-indexer-overview/indexer-stages.png" alt-text="Этапы индексатора" border="false":::

### <a name="stage-1-document-cracking"></a>Этап 1. взлом документов

Взлом документов — это процесс открытия файлов и извлечения содержимого. В зависимости от типа источника данных индексатор попытается выполнить различные операции для извлечения потенциально индексируемого содержимого.  

Примеры:  

+ Если документ является записью в [источнике данных SQL Azure](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md), индексатор извлекает каждое из полей для записи.
+ Если документ является PDF-файлом в [источнике данных хранилища больших двоичных объектов Azure](search-howto-indexing-azure-blob-storage.md), индексатор извлечет текст, изображения и метаданные.
+ Если документ является записью в [Cosmos DB источнике данных](search-howto-index-cosmosdb.md), индексатор извлечет поля и подполя из Cosmos DB документа.

### <a name="stage-2-field-mappings"></a>Этап 2. сопоставления полей 

Индексатор извлекает текст из исходного поля и отправляет его в поле назначения в индексе или в хранилище знаний. Если имена и типы полей совпадают, путь является четким. Однако в выходных данных могут потребоваться различные имена или типы, в этом случае необходимо сообщить индексатору, как сопоставлять поле. 

Этот шаг происходит после взлома документа, но до преобразований, когда индексатор считывает из исходных документов. При определении [сопоставления полей](search-indexer-field-mappings.md)значение исходного поля отправляется как есть в целевое поле без изменений. 

### <a name="stage-3-skillset-execution"></a>Этап 3. выполнение набора навыков

Набор квалификационных навыков — это необязательный шаг, который вызывает встроенную или настраиваемую обработку искусственного интеллекта. Он может потребоваться для оптического распознавания символов (OCR) в форме анализа изображений, если исходные данные являются двоичными изображениями, или требуется перевод языка, если содержимое находится на разных языках. 

Независимо от преобразования, при выполнении набора навыков выполняется обогащение. Если индексатор является конвейером, можно представить [навык](cognitive-search-defining-skillset.md) в виде конвейера в конвейере.

### <a name="stage-4-output-field-mappings"></a>Этап 4. сопоставления полей вывода

Если включить набор навыков, то, скорее всего, потребуется включить сопоставления полей вывода. Выходные данные набора навыков на самом деле представляют собой дерево информации, называемой *обогащенным документом*. Сопоставления полей вывода позволяют выбрать, какие части этого дерева должны сопоставляться с полями в индексе. Узнайте, как [определять сопоставления полей вывода](cognitive-search-output-field-mapping.md).

В то время как сопоставления полей связывают точные значения из источника данных с полями назначения, сопоставления полей вывода сообщают индексатору, как связать преобразованные значения в расширенном документе с полями назначения в индексе. В отличие от сопоставлений полей, которые считаются необязательными, всегда необходимо определять сопоставление полей вывода для любого преобразованного содержимого, которое должно находиться в индексе.

На следующем рисунке показан пример представления [сеанса отладки](cognitive-search-debug-session.md) индексатора этапов индексатора: взлом документов, сопоставления полей, выполнение набора навыков и сопоставления полей вывода.

:::image type="content" source="media/search-indexer-overview/sample-debug-session.png" alt-text="Пример сеанса отладки" lightbox="media/search-indexer-overview/sample-debug-session.png":::

## <a name="basic-workflow"></a>Базовый рабочий процесс

В индексаторах реализованы уникальные функции для работы с источниками данных. Поэтому тип индексатора будет определять особенности настройки источника данных или индексатора. Тем не менее всем индексаторам присущи сходные структура и требования. Ниже описаны действия, общие для всех индексаторов.

### <a name="step-1-create-a-data-source"></a>Шаг 1. Создание источника данных

Для индексаторов необходим объект *источника данных* , предоставляющий строку подключения и, возможно, учетные данные. Для создания ресурса вызовите класс [Create Data Source (RESTful)](/rest/api/searchservice/create-data-source) или [сеарчиндексердатасаурцеконнектион](/dotnet/api/azure.search.documents.indexes.models.searchindexerdatasourceconnection) .

Источники данных настраиваются и управляются независимо от индексаторов, которые их используют. Это означает, что источник данных может использоваться несколькими индексаторами для одновременной загрузки нескольких индексов.

### <a name="step-2-create-an-index"></a>Шаг 2. Создание индекса

Хотя индексатор автоматизирует некоторые задачи, связанные с приемом данных, это обычно не распространяется на создание индекса. Перед началом работы у вас должен быть стандартный индекс с полями, которые соответствуют полям во внешнем источнике данных. Поля должны совпадать по имени и типу данных. В противном случае можно [определить сопоставления полей](search-indexer-field-mappings.md) , чтобы установить ассоциацию. Дополнительные сведения о структурировании индекса см. в разделе [Create a index (RESTful)](/rest/api/searchservice/Create-Index) или [сеарчиндекс Class](/dotnet/api/azure.search.documents.indexes.models.searchindex).

> [!Tip]
> Хотя индексаторы не могут создавать индексы, вы можете это сделать с помощью мастера **импорта данных**. В большинстве случаев мастер может определить схему индекса на основе существующих метаданных в источнике, предоставляя предварительную схему, которую можно изменить в мастере во время его работы. После создания индекса в службе последующие изменения на портале ограничиваются добавлением новых полей. Используйте мастер для создания индекса, но не для изменения. Чтобы пройти практическое обучение, перейдите к [пошаговому руководству по порталу](search-get-started-portal.md).

### <a name="step-3-create-and-run-or-schedule-the-indexer"></a>Шаг 3. Создание и запуск (или планирование) индексатора

Индексатор выполняется при первом [создании индексатора](/rest/api/searchservice/Create-Indexer) в службе поиска. Это возможно только в том случае, если вы создаете или запускаете индексатор, который обнаруживает, доступен ли источник данных, или набор квалификационных навыков является допустимым. После первого запуска его можно повторно запустить по запросу с помощью команды [запуска индексатора](/rest/api/searchservice/run-indexer)или [определить повторяющееся расписание](search-howto-schedule-indexers.md). 

Вы можете отслеживать состояние индексатора на портале или с помощью [API получения состояния индексатора](/rest/api/searchservice/get-indexer-status). Необходимо также [выполнить запросы к индексу](search-query-create.md) , чтобы убедиться, что результат является ожидаемым.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы появились, следующий шаг — Просмотр свойств индексатора и параметров, планирования и мониторинга индексатора. Кроме того, можно вернуться к списку [поддерживаемых источников данных](#supported-data-sources) , чтобы получить дополнительные сведения о конкретном источнике.

+ [Создание индексаторов](search-howto-create-indexers.md)
+ [Расписание индексаторов](search-howto-schedule-indexers.md)
+ [Определение сопоставлений полей](search-indexer-field-mappings.md)
+ [Мониторинг состояния индексатора](search-howto-monitor-indexers.md)