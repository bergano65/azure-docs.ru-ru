---
title: Общие сведения о безопасности
titleSuffix: Azure Cognitive Search
description: Сведения о функциях безопасности в Когнитивный поиск Azure для защиты конечных точек, содержимого и операций.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 02/04/2021
ms.custom: references_regions
ms.openlocfilehash: 46f2035e5f8409cd38faeb9c327b88b06fc7d7a0
ms.sourcegitcommit: 24f30b1e8bb797e1609b1c8300871d2391a59ac2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "100097642"
---
# <a name="security-overview-for-azure-cognitive-search"></a>Общие сведения о безопасности для Azure Когнитивный поиск

В этой статье описываются функции безопасности в Azure Когнитивный поиск, которые защищают содержимое и операции.

Для входящих запросов к службе поиска существует прогресс мер безопасности, защищающих конечную точку службы поиска: от ключей API запроса до правил входящего трафика в брандмауэре до частных конечных точек, которые полностью защищают службу от общедоступного Интернета.

Для исходящих запросов к другим службам предстоящие запросы выполняются индексаторами, считывающими содержимое из внешних источников. Вы можете указать учетные данные в строке подключения. Вы также можете настроить управляемое удостоверение, чтобы сделать поиск доверенной службой при доступе к данным из службы хранилища Azure, SQL Azure, Cosmos DB или других источников данных Azure. Управляемое удостоверение — это замена учетных данных или ключей доступа в соединении. Дополнительные сведения об этой возможности см. в разделе [Подключение к источнику данных с помощью управляемого удостоверения](search-howto-managed-identities-data-sources.md).

Операции записи в внешние службы являются небольшими: служба поиска выполняет запись в файлы журнала, и она будет записывать данные в службу хранилища Azure при создании хранилищ знаний, сохранении кэшированных дополнений и сохранении сеансов отладки. Другие вызовы между службами, например Cognitive Services, выполняются во внутренней сети.

Просмотрите это видео с краткими сведениями о архитектуре безопасности и каждой категории компонентов.

> [!VIDEO https://channel9.msdn.com/Shows/AI-Show/Azure-Cognitive-Search-Whats-new-in-security/player]

## <a name="network-security"></a>Безопасность сети

<a name="service-access-and-authentication"></a>

Функции безопасности для входящих подключений защищают конечную точку службы поиска, повышая уровень безопасности и сложности. Во-первых, для всех запросов требуется ключ API для доступа с проверкой подлинности. Во-вторых, при необходимости можно задать правила брандмауэра, ограничивающие доступ к конкретным IP адресам. Для расширенной защиты третий вариант — включить частную ссылку Azure, чтобы защитить конечную точку службы от всего трафика Интернета.

### <a name="public-access-using-api-keys"></a>Открытый доступ с использованием ключей API

По умолчанию доступ к службе поиска осуществляется через общедоступное облако с использованием проверки подлинности на основе ключей для администрирования или доступа к запросам к конечной точке службы поиска. Отправка допустимого ключа представляет собой доказательство того, что запрос исходит от доверенной сущности. Проверка подлинности на основе ключей рассматривается в следующем разделе.

### <a name="configure-ip-firewalls"></a>Настройка брандмауэров IP-адресов

Для дальнейшего управления доступом к службе поиска можно создать правила брандмауэра для входящих подключений, которые разрешают доступ к определенному IP-адресу или диапазону IP-адресов. Все клиентские соединения должны быть выполнены через разрешенный IP-адрес, иначе соединение будет отклонено.

:::image type="content" source="media/search-security-overview/inbound-firewall-ip-restrictions.png" alt-text="Пример схемы архитектуры для доступа с ограниченным IP-адресом":::

Для [настройки входящего доступа](service-configure-firewall.md)можно использовать портал.

Кроме того, можно использовать API-интерфейсы RESTFUL для управления. Начиная с API версии 2020-03-13 с параметром [ипруле](/rest/api/searchmanagement/services/createorupdate#iprule) можно ограничить доступ к службе, определив IP-адреса, по отдельности или в пределах диапазона, который будет предоставлять доступ к службе поиска.

### <a name="network-isolation-through-a-private-endpoint-no-internet-traffic"></a>Сетевая изоляция через частную конечную точку (без трафика Интернета)

Вы можете установить [частную конечную точку](../private-link/private-endpoint-overview.md) для Azure когнитивный поиск позволяя клиенту в [виртуальной сети](../virtual-network/virtual-networks-overview.md) безопасно обращаться к данным в индексе поиска по [частному каналу](../private-link/private-link-overview.md).

Частная конечная точка использует IP-адрес из адресного пространства виртуальной сети для подключений к службе поиска. Сетевой трафик между клиентом и службой поиска проходит по виртуальной сети и частной связи в магистральной сети Майкрософт, что устраняет уязвимость в общедоступном Интернете. ВИРТУАЛЬная сеть обеспечивает безопасное взаимодействие между ресурсами с локальной сетью и Интернетом.

:::image type="content" source="media/search-security-overview/inbound-private-link-azure-cog-search.png" alt-text="Пример схемы архитектуры для доступа к закрытой конечной точке":::

Хотя это решение является наиболее безопасным, использование дополнительных служб является дополнительными затратами, поэтому убедитесь, что у вас есть четкое понимание преимуществ, прежде чем углубляться в. Дополнительные сведения о затратах см. на [странице с ценами](https://azure.microsoft.com/pricing/details/private-link/). Дополнительные сведения о совместной работе этих компонентов см. в видеоролике в верхней части этой статьи. Покрытие параметра закрытой конечной точки начинается с 5:48 в видео. Инструкции по настройке конечной точки см. в статье [Создание частной конечной точки для Azure когнитивный Поиск](service-create-private-endpoint.md).

## <a name="authentication"></a>Аутентификация

Для входящих запросов к службе поиска проверка подлинности осуществляется через [обязательный ключ API](search-security-api-keys.md) (строку, состоящую из случайных чисел и букв), которая подтверждает, что запрос получен из надежного источника. Когнитивный поиск в настоящее время не поддерживает проверку подлинности Azure Active Directory для входящих запросов.

Исходящие запросы, выполняемые индексатором, подлежат проверке подлинности внешней службой. Подслужба индексатора в Когнитивный поиск можно сделать доверенной службой в Azure, подключив ее к другим службам с помощью управляемого удостоверения. Дополнительные сведения см. в разделе [Настройка подключения индексатора к источнику данных с помощью управляемого удостоверения](search-howto-managed-identities-data-sources.md).

## <a name="authorization"></a>Авторизация

Когнитивный поиск предоставляет различные модели авторизации для управления содержимым и управления службами. 

### <a name="authorization-for-content-management"></a>Авторизация для управления содержимым

Авторизация в отношении содержимого и операций, связанных с содержимым, является либо доступом на запись, так и с помощью [ключа API](search-security-api-keys.md) , предоставленного в запросе. Ключ API является механизмом проверки подлинности, но также разрешает доступ в зависимости от типа ключа API.

+ Ключ администратора (разрешает доступ на чтение и запись для операций создания, чтения и удаления в службе поиска), создаваемых при подготовке службы.

+ Ключ запроса (разрешает доступ только для чтения к коллекции документов индекса), создан как необходимый и предназначен для клиентских приложений, которые выдают запросы

В коде приложения укажите конечную точку и ключ API, чтобы разрешить доступ к содержимому и параметрам. Конечной точкой может быть сама служба, коллекция индексов, конкретный индекс, коллекция документов или конкретный документ. При объединении в цепочку конечная точка, операция (например, запрос на создание или обновление) и уровень разрешений (полный или права только для чтения на основе ключа) составляют формулу безопасности, защищающую содержимое и операции.

### <a name="controlling-access-to-indexes"></a>Управление доступом к индексам

В Когнитивный поиск Azure отдельный индекс не является защищаемым объектом. Вместо этого доступ к индексу определяется на уровне службы (доступ на чтение или запись в зависимости от предоставленного ключа API) и контекста операции.

Для доступа только для чтения можно структурировать запросы на подключение с помощью [ключа запроса](search-security-rbac.md)и включить конкретный индекс, используемый приложением. В запросе невозможно объединить индексы или получить доступ к нескольким индексам одновременно, поэтому все запросы по определению направляются к одному индексу. Таким образом, структура самого запроса (ключ и один целевой индекс) определяет границы безопасности.

Доступ администратора и разработчика к индексам недифференцированный: для обоих типов доступа необходимо разрешение на запись для создания, удаления и обновления объектов, управляемых службой. Любой пользователь с [ключом администратора](search-security-rbac.md) службы может читать, изменять или удалять любой индекс в той же службе. Решением для защиты от случайного или злонамеренного удаления индексов являются внутренние средства управления исходным кодом для ресурсов кода, которые позволяют отменить нежелательное удаление или изменение индекса. Когнитивный поиск Azure отработка отказа в кластере для обеспечения доступности, но не сохраняет и не выполняет собственный код, используемый для создания или загрузки индексов.

Для мультитенантных решений, границы безопасности которых должны находиться на уровне индексов, такие решения, как правило, содержат средний уровень, на котором клиенты обрабатывают изоляцию индекса. Дополнительные сведения о варианте использования для нескольких клиентов см. в статье [шаблоны разработки для многоклиентских приложений SaaS и Azure когнитивный Поиск](search-modeling-multitenant-saas-applications.md).

### <a name="controlling-access-to-documents"></a>Управление доступом к документам

Если требуется детальный контроль над результатами поиска, можно создать фильтры безопасности для запросов, возвращая документы, связанные с данным удостоверением безопасности. 

Концептуально эквивалентно "безопасности на уровне строк", авторизация содержимого в индексе изначально не поддерживается с помощью стандартных ролей или назначений ролей, которые сопоставляются с сущностями в Azure Active Directory. Любые разрешения пользователя на доступ к данным во внешних системах, например Cosmos DB, не передаются вместе с данными в том виде, в котором они индексируются Когнитивный поиск.

Обходные пути для решений, требующих "безопасности на уровне строк", включают создание поля в источнике данных, представляющего группу безопасности или удостоверение пользователя, а затем использование фильтров в Когнитивный поиск для выборочной обрезки результатов поиска документов и содержимого на основе удостоверений. В следующей таблице описаны два подхода к обрезке результатов поиска несанкционированного содержимого.

| Метод | Описание |
|----------|-------------|
|[Security filters for trimming results in Azure Search](search-security-trimming-for-azure-search.md) (Фильтры безопасности для обрезки результатов Поиска Azure)  | Документирует базовый рабочий процесс для реализации управления доступом на основе удостоверений пользователей. Описывает добавление удостоверений безопасности в индекс, а также объясняет фильтрацию этого поля для усечения результатов запрещенного содержимого. |
|[Security filters for trimming Azure Search results using Active Directory identities](search-security-trimming-for-azure-search-with-aad.md) (Фильтры безопасности для обрезки результатов Поиска Azure с использованием удостоверений Active Directory)  | Эта статья дополняет предыдущую статью, предоставляя действия по извлечению удостоверений из Azure Active Directory (Azure AD), одной из [бесплатных служб](https://azure.microsoft.com/free/) на облачной платформе Azure. |

### <a name="authorization-for-service-management"></a>Авторизация для управления службами

Операции управления службами проходят авторизацию через [Управление доступом на основе ролей Azure (Azure RBAC)](../role-based-access-control/overview.md). Azure RBAC — это система авторизации, созданная на основе [Azure Resource Manager](../azure-resource-manager/management/overview.md) для подготовки ресурсов Azure. 

В Когнитивный поиск Azure диспетчер ресурсов используется для создания или удаления службы, управления ключами API и масштабирования службы. Таким образом, назначения ролей Azure определяют, кто может выполнять эти задачи, независимо от того, используете ли они [портал](search-manage.md), [PowerShell](search-manage-powershell.md)или [API-интерфейсы других функций управления](/rest/api/searchmanagement/search-howto-management-rest-api).

Для администрирования службы поиска определены [три основные роли](search-security-rbac.md#management-tasks-by-role) . Назначения ролей можно выполнять с помощью любой поддерживаемой методологии (портала, PowerShell и т. д.) и поддерживаются на уровне службы. Роли «владелец» и «участник» могут выполнять различные функции администрирования. Вы можете назначить роль читателя пользователям, которые только могут просматривать необходимую информацию.

> [!Note]
> Используя механизмы Azure, можно заблокировать подписку или ресурс, чтобы предотвратить случайное или несанкционированное удаление службы поиска пользователями с правами администратора. Дополнительные сведения см. [в разделе Блокировка ресурсов для предотвращения непредвиденного удаления](../azure-resource-manager/management/lock-resources.md).

<a name="encryption"></a>

## <a name="data-protection"></a>Защита данных

На уровне хранилища шифрование данных встроено для всех управляемых службой данных, сохраненных на диск, включая индексы, карты синонимов и определения индексаторов, источников данных и навыков. При необходимости можно добавить ключи, управляемые клиентом (CMK), для дополнительного шифрования индексированного содержимого. Для служб, созданных после августа 1 2020, шифрование CMK распространяется на данные на временных дисках для полного "двойного шифрования" индексированного содержимого.

### <a name="data-in-transit"></a>Передаваемые данные

В Когнитивный поиск Azure шифрование начинается с соединений и передач, а также дополняется содержимым, хранящимся на диске. Для служб поиска в общедоступном Интернете Когнитивный поиск Azure прослушивает HTTPS порт 443. Все подключения клиента к службе используют шифрование TLS 1,2. Более ранние версии (1,0 или 1,1) не поддерживаются.

### <a name="encrypted-data-at-rest"></a>Зашифрованные неактивных данные

Для внутренних данных, обрабатываемых службой поиска, в следующей таблице описаны [модели шифрования данных](../security/fundamentals/encryption-models.md). Некоторые функции, такие как хранилище знаний, добавочное дополнение и индексирование на основе индексаторов, читают или пишут структуры данных в других службах Azure. Эти службы имеют собственные уровни поддержки шифрования, отделенные от Когнитивный поиск Azure.

| Моделирование | Ключ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Необходимость&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | Ограничения | Применяется к |
|------------------|-------|-------------|--------------|------------|
| шифрование на стороне сервера | Ключи, управляемые Майкрософт | Нет (встроенная) | Нет, доступно на всех уровнях во всех регионах для содержимого, созданного после января 24 2018. | Содержимое (индексы и карты синонимов) и определения (индексаторы, источники данных, навыков) |
| шифрование на стороне сервера | ключи, управляемые клиентом | Azure Key Vault | Доступно на оплачиваемых уровнях во всех регионах для содержимого, созданного после января 2019. | Содержимое (индексы и карты синонимов) на дисках данных |
| двойное шифрование на стороне сервера | ключи, управляемые клиентом | Azure Key Vault | Доступно на оплачиваемых уровнях в выбранных регионах в службах поиска после августа 1 2020. | Содержимое (индексы и карты синонимов) на дисках данных и временных дисках |

### <a name="service-managed-keys"></a>Ключи, управляемые службой

Шифрование, управляемое службой, является внутренней операцией Майкрософт, основанной на [Шифрование службы хранилища Azure](../storage/common/storage-service-encryption.md), с использованием [шифрования AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)с 256-битным шифрованием. Она выполняется автоматически во всех индексированиях, в том числе при добавочных обновлениях индексов, которые не полностью зашифрованы (создаются до января 2018).

### <a name="customer-managed-keys-cmk"></a>Ключи, управляемые клиентом (CMK)

Для управляемых клиентом ключей требуется дополнительная оплачиваемая служба, Azure Key Vault, которая может находиться в другом регионе, но в рамках той же подписки, что и Azure Когнитивный поиск. Включение шифрования CMK увеличит размер индекса и снизит производительность запросов. Исходя из наблюдений на дату, можно увидеть увеличение 30%-60% времени выполнения запроса, хотя фактическая производительность зависит от определения индекса и типов запросов. В связи с этим влиянием на производительность рекомендуется включить эту функцию только для индексов, которые действительно необходимы. Дополнительные сведения см. [в статье Настройка ключей шифрования, управляемых клиентом, в когнитивный Поиск Azure](search-security-manage-encryption-keys.md).

<a name="double-encryption"></a>

### <a name="double-encryption"></a>Двойное шифрование

В Когнитивный поиск Azure двойное шифрование является расширением CMK. Он рассматривается как двухстороннее шифрование (один раз в CMK, а также через ключи, управляемые службой) и полный в области, охватывающий долгосрочное хранение, которое записывается на диск данных, и краткосрочное хранение, записанное на временные диски. Разница между CMK до 1 2020 августа и после нее, а также то, что делает CMK функцией двойного шифрования в Azure Когнитивный поиск, является дополнительным шифрованием неактивных данных на временных дисках.

В настоящее время в новых службах, созданных в этих регионах после 1 августа, доступно двойное шифрование.

+ Западная часть США 2
+ Восточная часть США
+ Центрально-южная часть США
+ US Gov (Вирджиния)
+ US Gov (Аризона)

## <a name="security-management"></a>Управление безопасностью

### <a name="api-keys"></a>Ключи API

Зависимость от проверки подлинности на основе ключей API означает, что у вас должен быть план повторного создания ключа администратора с регулярными интервалами в соответствии с рекомендациями по обеспечению безопасности в Azure. Для одной службы поиска существует не более двух ключей администрирования. Дополнительные сведения о защите и управлении ключами API см. в статье [Создание ключей API и управление ими](search-security-api-keys.md).

#### <a name="activity-and-diagnostic-logs"></a>Журналы действий и диагностики

Когнитивный поиск не регистрирует удостоверения пользователей, поэтому вы не можете ссылаться на журналы для получения сведений о конкретном пользователе. Тем не менее служба регистрирует операции создания, чтения и обновления и удаления, которые могут быть связаны с другими журналами для понимания компетентности конкретных действий.

Используя оповещения и инфраструктуру ведения журнала в Azure, вы можете выбрать пиковые всплески объема запросов или другие действия, отклоненные от ожидаемых рабочих нагрузок. Дополнительные сведения о настройке журналов см. в разделе [сбора и анализ данных журнала](search-monitor-logs.md) и [наблюдение за запросами запросов](search-monitor-queries.md).

### <a name="certifications-and-compliance"></a>Соответствие требованиям и сертификаты

Когнитивный поиск Azure участвует в регулярных аудитах и сертифицировано по ряду глобальных, региональных и отраслевых стандартов для общедоступного облака и Azure для государственных организаций. Чтобы получить полный список, скачайте [технический документ о **предложениях соответствия Microsoft Azure**](https://azure.microsoft.com/resources/microsoft-azure-compliance-offerings/) на официальной странице отчетов об аудите.

Для обеспечения соответствия требованиям вы можете использовать [политику Azure](../governance/policy/overview.md) для реализации рекомендаций по обеспечению [безопасности Azure](../security/benchmarks/introduction.md)с высоким уровнем безопасности. Производительность системы безопасности Azure — это набор рекомендаций по обеспечению безопасности, кодифицированные в средства управления безопасностью, которые соответствуют ключевым действиям, которые необходимо предпринять для уменьшения угроз для служб и данных. В настоящее время существует 11 элементов управления безопасностью, включая [безопасность сети](../security/benchmarks/security-control-network-security.md), [ведение журнала и мониторинг](../security/benchmarks/security-control-logging-monitoring.md), а также [защиту данных](../security/benchmarks/security-control-data-protection.md) .

Политика Azure — это возможность, встроенная в Azure, которая помогает управлять соответствием нескольким стандартам, включая показатели производительности системы безопасности Azure. Для хорошо известных тестов производительности политика Azure предоставляет встроенные определения, которые предоставляют как критерии, так и реагирование на действия, которые не соответствуют требованиям.

Для Когнитивный поиск Azure в настоящее время имеется встроенное определение. Он предназначен для ведения журнала диагностики. С помощью этого встроенного средства можно назначить политику, определяющую любую службу поиска, в которой отсутствует Диагностическое протоколирование, а затем включить ее. Дополнительные сведения см. в статье [Управление соответствием нормативным требованиям политики Azure для когнитивный Поиск Azure](security-controls-policy.md).

## <a name="see-also"></a>См. также

+ [Основы обеспечения безопасности в Azure](../security/fundamentals/index.yml)
+ [Безопасность Azure](https://azure.microsoft.com/overview/security)
+ [Центр безопасности Azure](../security-center/index.yml)