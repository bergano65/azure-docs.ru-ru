---
title: Раскадровка извлечения документов (Предварительная версия)
titleSuffix: Azure Cognitive Search
description: Извлекает содержимое из файла в конвейере обогащения. Этот навык в настоящее время доступен в общедоступной предварительной версии.
manager: nitinme
author: careyjmac
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 11/04/2019
ms.author: chalton
ms.openlocfilehash: a79b0476fccbd2e2b9d3cf47ecfdc99c17c2862d
ms.sourcegitcommit: 598c5a280a002036b1a76aa6712f79d30110b98d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2019
ms.locfileid: "74113337"
---
# <a name="document-extraction-cognitive-skill"></a>Раскадровка извлечения документов

> [!IMPORTANT] 
> Этот навык в настоящее время доступен в общедоступной предварительной версии. Для предварительной версии функции соглашение об уровне обслуживания не предусмотрено. Мы не рекомендуем использовать ее в рабочей среде. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/). [Версия REST API 2019-05-06-Preview](search-api-preview.md) предоставляет предварительные версии функций. В настоящее время нет поддержки портала или пакета SDK для .NET.

Навык **извлечения документа** извлекает содержимое из файла в конвейере обогащения. Это позволяет использовать преимущества шага извлечения документов, которые обычно выполняются перед выполнением набора навыков с файлами, которые могут быть созданы другими навыками.

> [!NOTE]
> По мере расширения области путем увеличения частоты обработки и добавления большего количества документов или дополнительных алгоритмов ИИ, вам нужно будет [присоединить оплачиваемый ресурс Cognitive Services](cognitive-search-attach-cognitive-services.md). Расходы начисляются при вызове API в Cognitive Services, а также для извлечения изображений в ходе процесса взлома документов в процессе индексирования. За извлечение текста из документов плата не взимается.
>
> Плата за выполнение встроенных навыков взимается в рамках существующей [модели оплаты Cognitive Services по мере использования](https://azure.microsoft.com/pricing/details/cognitive-services/). Цены на извлечение изображений описаны на [странице цен](https://go.microsoft.com/fwlink/?linkid=2042400).
## <a name="odatatype"></a>@odata.type  
Microsoft. Skills. util. Документекстрактионскилл

## <a name="skill-parameters"></a>Параметры навыков

Параметры зависят от регистра.

| Входные данные            | Допустимые значения | ОПИСАНИЕ |
|-----------------|----------------|-------------|
| `parsingMode`   | `default` <br/> `text` <br/> `json`  | Задайте значение `default` для извлечения документа из файлов, которые не являются чистым текстом или JSON. Задайте значение `text`, чтобы повысить производительность в обычных текстовых файлах. Задайте значение `json`, чтобы извлечь структурированное содержимое из файлов JSON. Если `parsingMode` не определен явно, он будет установлен в значение `default`. |
| `dataToExtract` | `contentAndMetadata` <br/> `allMetadata` | Задайте значение `contentAndMetadata`, чтобы извлечь все метаданные и текстовое содержимое из каждого файла. Задайте значение `allMetadata`, чтобы извлечь только [метаданные, относящиеся к типу содержимого](search-howto-indexing-azure-blob-storage.md#ContentSpecificMetadata) (например, метаданные, уникальные только для PNG-файлов). Если `dataToExtract` не определен явно, он будет установлен в значение `contentAndMetadata`. |
| `configuration` | См. ниже. | Словарь необязательных параметров, определяющих, как выполняется извлечение документа. Описание поддерживаемых свойств конфигурации см. в таблице ниже. |

| Параметр конфигурации   | Допустимые значения | ОПИСАНИЕ |
|-------------------------|----------------|-------------|
| `imageAction`           | `none`<br/> `generateNormalizedImages`<br/> `generateNormalizedImagePerPage` | Задайте значение `none`, чтобы пропускать внедренные изображения или файлы изображений в наборе данных. Это уровень по умолчанию. <br/>Для [анализа изображений с помощью «автообучение](cognitive-search-concept-image-scenarios.md)» задайте значение `generateNormalizedImages`, чтобы иметь навык создания массива нормализованных изображений в процессе взлома документа. Для этого действия требуется, чтобы для параметра `parsingMode` было задано значение `default` и для параметра `dataToExtract` задано значение `contentAndMetadata`. Нормализованное изображение получается путем дополнительной обработки, результатом которой является унифицированное изображение, размер и ориентация которого обеспечивают согласованную визуализацию при добавлении в результаты визуального поиска (например, фотографии одинакового размера в элементе управления графа, как показано в [демонстрации JFK](https://github.com/Microsoft/AzureSearch_JFK_Files)). Эта информация создается для каждого изображения при использовании этого параметра.  <br/>Если задано значение `generateNormalizedImagePerPage`, файлы PDF будут обрабатываться по-разному, вместо того чтобы извлекать внедренные изображения, каждая страница будет подготовлена к просмотру в виде изображения и нормализована соответствующим образом.  Типы файлов, отличных от PDF, будут обрабатываться так же, как если бы `generateNormalizedImages` были заданы.
| `normalizedImageMaxWidth` | Любое целое число от 50-10000 | Максимальная ширина (в пикселях) для созданного нормализованного изображения. Значение по умолчанию — 2000. | 
| `normalizedImageMaxHeight` | Любое целое число от 50-10000 | Максимальная высота (в пикселях) для созданных нормализованных изображений. Значение по умолчанию — 2000. |

> [!NOTE]
> По умолчанию навыками [OCR](cognitive-search-skill-ocr.md) и [анализа изображений](cognitive-search-skill-image-analysis.md) поддерживаются нормализованные изображения с максимальными шириной и высотой в 2000 пикселей. [Навык OCR](cognitive-search-skill-ocr.md) поддерживает максимальную ширину и высоту 4200 для языков, отличных от английского, и 10000 для английского языка.  При увеличении максимального предела обработка может завершиться сбоем на больших изображениях в зависимости от определения набора навыков и языка документов. 
## <a name="skill-inputs"></a>Входные данные навыков

| Ввод имени     | ОПИСАНИЕ |
|--------------------|-------------|
| file_data | Файл, из которого должно быть извлечено содержимое. |

Вход "file_data" должен быть объектом, определенным следующим образом:

```json
{
  "$type": "file",
  "data": "BASE64 encoded string of the file"
}
```

Этот объект ссылки на файл может быть создан одним из трех способов:

 - Установка для параметра `allowSkillsetToReadFileData` в определении индексатора значения "true".  Это приведет к созданию пути `/document/file_data`, который является объектом, представляющим исходные данные файла, скачанные из источника данных большого двоичного объекта. Этот параметр применяется только к данным в хранилище BLOB-объектов.

 - Присвоение параметру `imageAction` определения индексатора значения, отличного от `none`.  При этом создается массив изображений, который следует за требуемым соглашением для входных данных этого навыка, если они передаются по отдельности (т. е. `/document/normalized_images/*`).

 - Наличие пользовательского навыка возвращает объект JSON, определенный в точности так, как показано выше.  Параметру `$type` должно быть присвоено значение, равное `file`, а параметр `data` должен быть данными массива байтов в кодировке 64 в байтах содержимого файла.

## <a name="skill-outputs"></a>Выходные данные навыка

| Имя вывода    | ОПИСАНИЕ |
|--------------|-------------|
| Содержимое | Текстовое содержимое документа. |
| normalized_images | Если для `imageAction` задано значение, отличное от `none`, новое поле *normalized_images* будет содержать массив изображений. Дополнительные сведения о формате вывода каждого изображения см. [в документации по извлечению изображений](cognitive-search-concept-image-scenarios.md) . |

##  <a name="sample-definition"></a>Пример определения

```json
 {
    "@odata.type": "#Microsoft.Skills.Util.DocumentExtractionSkill",
    "parsingMode": "default",
    "dataToExtract": "contentAndMetadata",
    "configuration": {
        "imageAction": "generateNormalizedImages",
        "normalizedImageMaxWidth": 2000,
        "normalizedImageMaxHeight": 2000
    },
    "context": "/document",
    "inputs": [
      {
        "name": "file_data",
        "source": "/document/file_data"
      }
    ],
    "outputs": [
      {
        "name": "content",
        "targetName": "content"
      },
      {
        "name": "normalized_images",
        "targetName": "normalized_images"
      }
    ]
  }
```

##  <a name="sample-input"></a>Пример ввода

```json
{
  "values": [
    {
      "recordId": "1",
      "data":
      {
        "file_data": {
          "$type": "file",
          "data": "aGVsbG8="
        }
      }
    }
  ]
}
```


##  <a name="sample-output"></a>Пример выходных данных

```json
{
  "values": [
    {
      "recordId": "1",
      "data": {
        "content": "hello",
        "normalized_images": []
      }
    }
  ]
}
```

## <a name="see-also"></a>См. также

+ [Встроенные навыки](cognitive-search-predefined-skills.md)
+ [Определение набора навыков](cognitive-search-defining-skillset.md)
+ [Как обрабатывать и извлекать информацию из изображений в сценариях со сценарным поиском](cognitive-search-concept-image-scenarios.md)