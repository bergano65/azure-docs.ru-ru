---
title: Справочник по операторам сравнения OData
titleSuffix: Azure Cognitive Search
description: Справочная документация по синтаксису и Справочнику по использованию операторов сравнения OData (EQ, NE, gt, lt, GE и Le) в запросах Когнитивный поиск Azure.
manager: nitinme
author: brjohnstmsft
ms.author: brjohnst
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 11/04/2019
translation.priority.mt:
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pt-br
- ru-ru
- zh-cn
- zh-tw
ms.openlocfilehash: 572b653a49833ae06ee57b1718000e8555239de7
ms.sourcegitcommit: 5cace04239f5efef4c1eed78144191a8b7d7fee8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/08/2020
ms.locfileid: "86146029"
---
# <a name="odata-comparison-operators-in-azure-cognitive-search---eq-ne-gt-lt-ge-and-le"></a>Операторы сравнения OData в Azure когнитивный поиск- `eq` , `ne` ,,, `gt` `lt` `ge` и`le`

Наиболее простой операцией в [выражении фильтра OData](query-odata-filter-orderby-syntax.md) в когнитивный поиске Azure является сравнение поля с заданным значением. Возможны два типа сравнения — сравнение на равенство и сравнение диапазонов. Для сравнения поля с постоянным значением можно использовать следующие операторы:

Операторы равенства:

- `eq`: Проверка того, **равно** ли поле значению константы
- `ne`: Проверьте, **не равно** ли поле значению константы

Операторы диапазона:

- `gt`: **Проверка, превышает** ли поле постоянное значение
- `lt`: Проверка, **меньше** ли поле значения константы
- `ge`: Проверка того, что поле **больше или равно** значению константы
- `le`: Проверка того, что поле **меньше или равно** значению константы

Для проверки того, находится ли поле в определенном диапазоне значений, можно использовать операторы диапазона в сочетании с [логическими операторами](search-query-odata-logical-operators.md) . См. [примеры](#examples) далее в этой статье.

> [!NOTE]
> При желании можно разместить константу в левой части оператора, а имя поля — в правой части. Для операторов диапазона значение сравнения изменяется на противоположное. Например, если значение константы находится слева, `gt` будет проверять, больше ли значение константы, чем поле. Операторы сравнения также можно использовать для сравнения результатов функции, например `geo.distance` , со значением. Для логических функций, таких как `search.ismatch` , сравнение результата с `true` или `false` является необязательным.

## <a name="syntax"></a>Синтаксис

Следующая EBNF ([Расширенная форма Backus-Наура](https://en.wikipedia.org/wiki/Extended_Backus–Naur_form)) определяет грамматику выражения OData, в которой используются операторы сравнения.

<!-- Upload this EBNF using https://bottlecaps.de/rr/ui to create a downloadable railroad diagram. -->

```
comparison_expression ::=
    variable_or_function comparison_operator constant |
    constant comparison_operator variable_or_function

variable_or_function ::= variable | function_call

comparison_operator ::= 'gt' | 'lt' | 'ge' | 'le' | 'eq' | 'ne'
```

Доступна также интерактивная схема синтаксиса:

> [!div class="nextstepaction"]
> [Схема синтаксиса OData для Когнитивный поиск Azure](https://azuresearch.github.io/odata-syntax-diagram/#comparison_expression)

> [!NOTE]
> Полный EBNF см. в [справочнике по синтаксису выражений OData для Azure когнитивный Поиск](search-query-odata-syntax-reference.md) .

Существует две формы выражений сравнения. Единственное различие между ними заключается в том, отображается ли константа в левой или правой части оператора. Выражение на другой стороне оператора должно быть **переменной** или вызовом функции. Переменная может быть именем поля или переменной диапазона в случае [лямбда-выражения](search-query-odata-collection-operators.md).

## <a name="data-types-for-comparisons"></a>Типы данных для сравнений

Типы данных на обеих сторонах оператора сравнения должны быть совместимыми. Например, если левая часть является полем типа `Edm.DateTimeOffset` , то правая часть должна быть константой даты и времени. Числовые типы данных являются более гибкими. Можно сравнивать переменные и функции любого числового типа с константами любого другого числового типа с некоторыми ограничениями, как описано в следующей таблице.

| Тип переменной или функции | Тип значения константы | Ограничения |
| --- | --- | --- |
| `Edm.Double` | `Edm.Double` | Для сравнения применяются [специальные правила для `NaN` ](#special-case-nan) |
| `Edm.Double` | `Edm.Int64` | Константа преобразуется в `Edm.Double` , что приводит к утере точности для значений большой величины |
| `Edm.Double` | `Edm.Int32` | н/д |
| `Edm.Int64` | `Edm.Double` | Сравнения с `NaN` , `-INF` или `INF` не разрешены |
| `Edm.Int64` | `Edm.Int64` | н/д |
| `Edm.Int64` | `Edm.Int32` | Константа преобразуется в `Edm.Int64` перед сравнением |
| `Edm.Int32` | `Edm.Double` | Сравнения с `NaN` , `-INF` или `INF` не разрешены |
| `Edm.Int32` | `Edm.Int64` | Недоступно |
| `Edm.Int32` | `Edm.Int32` | Недоступно |

Для недопустимых сравнений, например для сравнения поля типа `Edm.Int64` с `NaN` , REST API когнитивный Поиск Azure будет возвращать ошибку "HTTP 400: недопустимый запрос".

> [!IMPORTANT]
> Хотя сравнения числовых типов являются гибкими, мы настоятельно рекомендуем писать сравнения в фильтрах, чтобы постоянное значение совпадало с типом данных переменной или функции, с которой выполняется сравнение. Это особенно важно при совместном использовании значений с плавающей запятой и целых чисел, где возможны неявные преобразования с потерей точности.

<a name="special-case-nan"></a>

### <a name="special-cases-for-null-and-nan"></a>Особые случаи для `null` и`NaN`

При использовании операторов сравнения важно помнить, что все поля, не связанные с коллекцией, в Azure Когнитивный поиск потенциально могут быть `null` . В следующей таблице показаны все возможные результаты для выражения сравнения, где может быть одна из сторон `null` :

| Оператор | Результат, если только поле или переменная`null` | Результат, если только константа имеет значение`null` | Результат, если как поле, так и переменная, и константа`null` |
| --- | --- | --- | --- |
| `gt` | `false` | HTTP 400: ошибка неправильного запроса | HTTP 400: ошибка неправильного запроса |
| `lt` | `false` | HTTP 400: ошибка неправильного запроса | HTTP 400: ошибка неправильного запроса |
| `ge` | `false` | HTTP 400: ошибка неправильного запроса | HTTP 400: ошибка неправильного запроса |
| `le` | `false` | HTTP 400: ошибка неправильного запроса | HTTP 400: ошибка неправильного запроса |
| `eq` | `false` | `false` | `true` |
| `ne` | `true` | `true` | `false` |

В сводке `null` он равен только самому себе и не меньше или больше любого другого значения.

Если в индексе есть поля типа, `Edm.Double` а `NaN` значения отправляются в эти поля, необходимо учитывать это при записи фильтров. Когнитивный поиск Azure реализует стандарт IEEE 754 для обработки `NaN` значений, а сравнения с такими значениями дают неочевидные результаты, как показано в следующей таблице.

| Оператор | Результат, если хотя бы один операнд имеет значение`NaN` |
| --- | --- |
| `gt` | `false` |
| `lt` | `false` |
| `ge` | `false` |
| `le` | `false` |
| `eq` | `false` |
| `ne` | `true` |

В сводке `NaN` не равно какому-либо значению, включая само себя.

### <a name="comparing-geo-spatial-data"></a>Сравнение геопространственных данных

Нельзя напрямую сравнивать поле типа `Edm.GeographyPoint` с постоянным значением, но можно использовать `geo.distance` функцию. Эта функция возвращает значение типа `Edm.Double` , поэтому вы можете сравнить его с числовой константой для фильтрации на основе расстояния от постоянных геопространственных координат. См. [примеры](#examples) ниже.

### <a name="comparing-string-data"></a>Сравнение строковых данных

Строки можно сравнивать в фильтрах для точных совпадений с `eq` помощью `ne` операторов и. В этих сравнениях учитывается регистр.

## <a name="examples"></a>Примеры

Сопоставление документов, в которых `Rating` поле находится в диапазоне от 3 до 5 включительно:

```text
Rating ge 3 and Rating le 5
```

Сопоставление документов, в которых `Location` поле меньше 2 километров от заданной широты и долготы:

```text
geo.distance(Location, geography'POINT(-122.031577 47.578581)') lt 2.0
```

Сопоставлять документы, в которых `LastRenovationDate` поле больше или равно 1 января 2015, полночь UTC:

```text
LastRenovationDate ge 2015-01-01T00:00:00.000Z
```

Сопоставлять документы, для которых `Details/Sku` поле не имеет значение `null` :

```text
Details/Sku ne null
```

Сопоставление документов для гостиниц, где по меньшей мере одна комната имеет тип "зал комната", где строка `Rooms/Type` поля соответствует фильтру.

```text
Rooms/any(room: room/Type eq 'Deluxe Room')
```

## <a name="next-steps"></a>Следующие шаги  

- [Фильтры в Когнитивный поиск Azure](search-filters.md)
- [Общие сведения о языке выражений OData для Azure Когнитивный поиск](query-odata-filter-orderby-syntax.md)
- [Справочник по синтаксису выражений OData для Azure Когнитивный поиск](search-query-odata-syntax-reference.md)
- [Поиск документов &#40;Azure Когнитивный поиск REST API&#41;](https://docs.microsoft.com/rest/api/searchservice/Search-Documents)
