---
title: Краткое руководство. Создание индекса на базе ИИ в службе "Поиск Azure" на портале Azure
description: Извлечение данных, обработка естественного языка и изображений на портале индексирования в службе "Поиск Azure" с использованием портала Azure и примера данных.
manager: cgronlun
author: HeidiSteen
services: search
ms.service: search
ms.topic: quickstart
ms.date: 04/08/2019
ms.author: heidist
ms.custom: seodec2018
ms.openlocfilehash: 161d3ff3e00f7e9e979527533f6b8ac365c41490
ms.sourcegitcommit: c174d408a5522b58160e17a87d2b6ef4482a6694
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59265021"
---
# <a name="quickstart-create-an-ai-indexing-pipeline-using-cognitive-skills-and-sample-data"></a>Краткое руководство. Создание конвейера индексирования ИИ с использованием когнитивных навыков и примера данных

Служба "Поиск Azure" интегрируется с [Cognitive Services](https://azure.microsoft.com/services/cognitive-services/), добавляя навыки извлечения данных, обработки естественного языка и изображений в конвейер индексирования службы "Поиск Azure" и упрощая поиск содержимого, по которому не выполняется обычный поиск или которое не структурировано. 

Некоторые ресурсы Cognitive Services, такие как [OCR](cognitive-search-skill-ocr.md), [распознавание языка](cognitive-search-skill-language-detection.md), [распознавание сущностей](cognitive-search-skill-entity-recognition.md) и др., можно подключить к процессу индексирования. Алгоритмы искусственного интеллекта Cognitive Services используются для поиска шаблонов, компонентов и характеристики в исходных данных и возвращают структуры и текстовое содержимое, которые пригодны для применения в решениях полнотекстового поиска на базе Поиска Azure.

В этом кратком руководстве вы создадите простейший конвейер обогащения на [портале Azure](https://portal.azure.com), не написав ни одной строки кода.

> [!div class="checklist"]
> * Начните работу с выборкой данных в хранилище BLOB-объектов Azure.
> * Настройте мастер [**импорта данных**](search-import-data-portal.md) для когнитивного индексирования и обогащения данных. 
> * Запустите мастер (навык сущности обнаруживает людей, расположение и организации).
> * Примените [**проводник поиска**](search-explorer.md) для запроса по обогащенным данным.

В рамках этого краткого руководства используется бесплатная служба, но количество бесплатных транзакций ограничено 20 документами в день. Если вы хотите выполнять описанные здесь операции несколько раз в день, используйте меньший набор файлов.

> [!NOTE]
> По мере расширения области действия путем увеличения частоты обработки, добавления большего количества документов или добавления новых алгоритмов ИИ вам необходимо будет подключить оплачиваемый ресурс Cognitive Services. Плата взимается при вызове API в Cognitive Services и извлечении изображений при открытии документов в службе "Поиск Azure". За извлечение текста из документов плата не взимается.
>
> За операции с применением встроенных навыков взимается [плата по мере использования по тарифам для имеющихся служб Cognitive Services](https://azure.microsoft.com/pricing/details/cognitive-services/). За извлечение изображений взимается плата по тарифам для предварительной версии, как описано на странице [цен на службу "Поиск Azure"](https://go.microsoft.com/fwlink/?linkid=2042400). Дополнительные сведения см. [здесь](cognitive-search-attach-cognitive-services.md).

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="prerequisites"></a>Предварительные требования

[Создайте службу "Поиск Azure"](search-create-service-portal.md) или [найдите существующую службу](https://ms.portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Search%2FsearchServices) в рамках текущей подписки. Вы можете использовать бесплатную службу для выполнения инструкций, описанных в этом кратком руководстве.

[Cognitive Services](https://azure.microsoft.com/services/cognitive-services/) предоставляет функции искусственного интеллекта. В данном кратком руководстве описаны шаги по добавлению этих ресурсов как встроенных при указании конвейера. Заранее настраивать учетные записи необязательно.

Службы Azure должны предоставлять входные данные в конвейер индексирования. Вы можете использовать любой источник данных, поддерживаемый [индексаторами службы "Поиск Azure"](search-indexer-overview.md), за исключением Хранилища таблиц Azure, которое не поддерживается для индексации ИИ. В этом кратком руководстве в качестве контейнера для исходных файлов данных используется [хранилище BLOB-объектов Azure](https://azure.microsoft.com/services/storage/blobs/). 

### <a name="set-up-azure-blob-service-and-load-sample-data"></a>Настройка службы BLOB-объектов Azure и загрузка примера данных

1. [Скачайте пример данных](https://1drv.ms/f/s!As7Oy81M_gVPa-LCb5lC_3hbS-4), который состоит из небольшого набора файлов различных типов. 

1. [Зарегистрируйтесь в хранилище BLOB-объектов Azure](https://docs.microsoft.com/azure/storage/common/storage-quickstart-create-account?tabs=azure-portal), создайте учетную запись хранения, откройте страницы служб BLOB-объектов и создайте контейнер.  Создайте учетную запись хранения в том регионе, где находится служба "Поиск Azure".

1. В созданном контейнере щелкните **Отправить**, чтобы отправить примеры файлов, которые вы скачали на предыдущем шаге.

   ![Исходные файлы в хранилище BLOB-объектов Azure](./media/cognitive-search-quickstart-blob/sample-data.png)

## <a name="create-the-enrichment-pipeline"></a>Создание конвейера обогащения

Вернитесь на страницу информационной панели Поиска Azure и щелкните **Импорт данных** на панели команд, чтобы настроить когнитивное обогащение за четыре шага.

  ![Команда импорта данных](media/cognitive-search-quickstart-blob/import-data-cmd2.png)

### <a name="step-1-create-a-data-source"></a>Шаг 1. Создание источника данных

В разделе **Подключение к данным** выберите **Хранилище BLOB-объектов**, затем выберите учетную запись и созданный контейнер. Присвойте источнику данных имя, а для остальных параметров используйте значения по умолчанию. 

  ![Конфигурация больших двоичных объектов Azure](./media/cognitive-search-quickstart-blob/blob-datasource.png)

Перейдите к следующей странице.

  ![Кнопка следующей страницы для когнитивного поиска](media/cognitive-search-quickstart-blob/next-button-add-cog-search.png)

### <a name="step-2-add-cognitive-skills"></a>Шаг 2. Добавление когнитивных навыков

Затем добавьте шаги обогащения в конвейер индексирования. Если у вас нет ресурса Cognitive Services, вы можете зарегистрироваться на получение бесплатной версии, которая предоставляет до 20 транзакций ежедневно. Пример данных состоит из 14 файлов, а значит после выполнения этого мастера дневная квота будет почти полностью использована.

1. Разверните узел **Подключение Cognitive Services**, чтобы просмотреть варианты ресурсов для API-интерфейсов Cognitive Services. Для целей этого руководства можно использовать **Бесплатный** ресурс.

   ![Подключение Cognitive Services](media/cognitive-search-quickstart-blob/cog-search-attach.png)

2. Разверните узел **Добавление обогащений** и выберите навыки, которые выполняют обработку естественного языка. Для этого краткого руководства выберите распознавание людей, организаций и расположений.

   ![Подключение Cognitive Services](media/cognitive-search-quickstart-blob/skillset.png)

   Портал предоставляет встроенные навыки для распознавания и анализа текста. На портале набор навыков работает над одним полем источника. Это может показаться маленькой целью, но для больших двоичных объектов Azure поле `content` содержит большую часть документа такого объекта (например, документа Word или набора слайдов PowerPoint). Таким образом это поле является идеальными входными данными, так как здесь присутствует все содержимое большого двоичного объекта.

3. Перейдите к следующей странице.

   ![Следующая страница, настройка индекса](media/cognitive-search-quickstart-blob/next-button-customize-index.png)

> [!NOTE]
> Навыки обработки естественного языка работают с текстовым содержимым в примере набора данных. Так как мы не выбрали распознавание текста, JPEG и PNG-файлы из тестового набора данных не будут обрабатываться при выполнении этого краткого руководства. 

### <a name="step-3-configure-the-index"></a>Шаг 3. Настройка индекса

Как правило, мастер правильно определяет индекс по умолчанию. На этом шаге вы можете просмотреть созданную схему и изменить любые параметры, если потребуется. Ниже представлен индекс по умолчанию, созданный для демонстрационного набора BLOB-объектов.

В этом кратком руководстве мастер устанавливает разумные значения по умолчанию: 

+ Для этого типа источника данных имя по умолчанию — *azureblob-index*. 

+ Поля по умолчанию основаны на поле исходных данных (`content`), а также полях выходных данных (`people`, `organizations` и `locations`), созданных когнитивным конвейером. Типы данных по умолчанию выводятся из метаданных и выборки данных.

+ Ключ по умолчанию *metadata_storage_path* (это поле содержит уникальные значения).

+ Атрибутами по умолчанию для этих полей являются **Доступный для получения** и **Доступный для поиска**. **Доступность для поиска** означает, что по этому полю можно выполнять поиск. **Доступность для получения** означает, что его можно возвращать в результатах. Мастер предполагает, что вы хотите, чтобы эти поля были доступны для получения и поиска, потому что вы создали их с помощью набора навыков.

  ![Поля индекса](media/cognitive-search-quickstart-blob/index-fields.png)

Обратите внимание на зачеркивание и вопросительный знак в атрибуте **Доступный для получения** в поле `content`. Для документов с большим количеством текста в поле `content` содержится основная часть файла, которая может достигать тысячи строк. Если необходимо передать содержимое файла в код клиента, убедитесь, что атрибут **Доступный для получения** остается выбранным. В противном случае рассмотрите возможность очистки этого атрибута в `content`, если извлеченные элементы (`people`, `organizations` и `locations`) достаточны для ваших целей.

Маркировка поля как **Доступный для получения** не означает, что поле *должно* присутствовать в результатах поиска. Вы можете точно контролировать состав результатов поиска с помощью параметра запроса **$select**, чтобы указать, какие поля включать. Для полей с большим количеством текста, например `content`, параметр **$select** — это решение для предоставления управляемых результатов поиска пользователям вашего приложения, обеспечивая при этом доступ клиентского кода ко всем необходимым данным с помощью атрибута **Доступный для получения**.
  
Перейдите к следующей странице.

  ![Следующая страница, создание индексатора](media/cognitive-search-quickstart-blob/next-button-create-indexer.png)

### <a name="step-4-configure-the-indexer"></a>Шаг 4. Настройка индексатора

Индексатор — это ресурс высокого уровня, управляющий процессом индексации. Он задает имя источника данных, целевой индекс и частоту выполнения. Конечным результатом мастера **импорта данных** всегда является индексатор, выполняемый несколько раз.

На странице **Индексатор** вы можете подтвердить имя по умолчанию и применить функцию планирования **Запустить один раз**, чтобы выполнить его немедленно. 

  ![Определение индексатора](media/cognitive-search-quickstart-blob/indexer-def.png)

Щелкните **Отправить**, чтобы создать и немедленно запустить индексатор.

## <a name="monitor-indexing"></a>Мониторинга индексирования

Действия по обогащению выполняются дольше, чем обычное текстовое индексирование. Мастер откроет на странице обзорной информации список индексатора, что позволяет отслеживать ход выполнения. Вы также можете самостоятельно открыть страницу обзорной информации и щелкнуть **Индексаторы**.

Вы увидите предупреждение, поскольку в списке есть файлы изображений JPG и PNG, но мы не добавили в конвейер навык распознавания текста. Также вы увидите уведомления об усечении. Поиск Azure на уровень "бесплатный" извлекает не более 32 000 символов.

  ![Уведомление службы поиска Azure](./media/cognitive-search-quickstart-blob/indexer-notification.png)

Индексирование и обогащение может занять время, поэтому для ранних исследований рекомендуется использовать маленькие наборы данных. 

## <a name="query-in-search-explorer"></a>Запросы в обозревателе поиска

После создания индекса можно отправлять запросы, возвращающие документы в индекс. Используйте **обозреватель поиска** на портале, чтобы выполнять запросы и просматривать результаты. 

1. На странице панели мониторинга службы поиска щелкните **Обозреватель поиска** в командной строке.

1. В верхней части окна щелкните **Изменить индекс**, чтобы выбрать созданный индекс.

1. Введите строку поиска для запроса по индексу, например `search=Microsoft&searchFields=organizations`.

Результаты возвращаются в формате JSON, который может быть подробным и трудным для чтения, особенно в больших документах, исходящих из больших двоичных объектов Azure. Если вы не можете легко проверить результаты, используйте сочетание клавиш CTRL+F для поиска в документах. Для этого запроса вы можете найти в документе JSON определенные термины. 

Сочетание клавиш CTRL+F также позволяет определить, сколько документов предоставлено в результирующем наборе. Для больших двоичных объектов Azure портал выбирает metadata_storage_path в качестве ключа, так как каждое значение в этом документе уникально. С помощью сочетания клавиш CTRL+F найдите metadata_storage_path, чтобы узнать количество документов. 

  ![Пример с обозревателем решений](./media/cognitive-search-quickstart-blob/search-explorer.png)

## <a name="takeaways"></a>Общие выводы

Итак, вы завершили первое упражнение по обогащенному индексированию. В этом кратком руководстве представлены важные понятия и шаги мастера, чтобы пользователь мог быстро создавать прототипы решений когнитивного поиска с помощью собственных данных.

Некоторые ключевые понятия, с которыми, как мы надеемся, вы разобрались, включают зависимость от источников данных Azure. Обогащение на основе когнитивного поиска привязано к индексаторам, а индексаторы — к Azure и соответствующим источникам. Несмотря на то что краткое руководство использует хранилище BLOB-объектов Azure, можно использовать и другие источники данных Azure. Дополнительные сведения см. в статье [Индексаторы в службе поиска Azure](search-indexer-overview.md).

Другим важным понятием является выполнение навыков в отношении полей входных данных. На портале необходимо выбрать одно поле входных данных для всех навыков. В коде входными данными могут быть другие поля или выходные данные вышестоящих навыков.

 Входные данные для навыка сопоставляются с полем выходных данных индекса. На внутреннем уровне портал настраивает [заметки](cognitive-search-concept-annotations-syntax.md) и определяет [набор навыков](cognitive-search-defining-skillset.md), устанавливая порядок операций и общую последовательность действий. Эти шаги скрыты на портале, но эти понятия становятся важными при написании кода.

Наконец, вы узнали, что для просмотра результатов необходимо запросить индекс. В результате служба "Поиск Azure" предоставляет доступный для поиска индекс, который можно запрашивать с помощью [простого](https://docs.microsoft.com/rest/api/searchservice/simple-query-syntax-in-azure-search) или [полностью расширенного синтаксиса запроса](https://docs.microsoft.com/rest/api/searchservice/lucene-query-syntax-in-azure-search). Индекс, который содержит обогащенные поля, не отличается от других. Если вы хотите включить стандартные или [настраиваемые анализаторы](search-analyzers.md), [профили оценки](https://docs.microsoft.com/rest/api/searchservice/add-scoring-profiles-to-a-search-index), [синонимы](search-synonyms.md), [фильтры аспектов](search-filters-facets.md), географический поиск или любую другую функцию службы "Поиск Azure", вы можете это сделать.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если изучение завершено, самый быстрый способ очистки — удалить группу ресурсов, содержащую службу "Поиск Azure" и службу BLOB-объектов Azure.  

Предположим, обе службы находятся в одной группе, удалите группу ресурсов, чтобы окончательно удалить все ее содержимое, включая службы и любое хранимое содержимое, созданное для этого упражнения. На портале имя группы ресурсов находится на странице "Обзор" каждой службы.

## <a name="next-steps"></a>Дополнительная информация

В зависимости от того, как вы подготовили ресурс Cognitive Services, вы можете поэкспериментировать с индексированием и обогащением, повторно запустив мастер с разными навыками и полями источника данных. Чтобы повторить шаги, удалите индекс и индексатор, а затем повторно создайте индексатор с новым сочетанием выбранных элементов.

+ В разделе **Обзор** > **Индексы** выберите созданный индекс, а затем щелкните **Удалить**.

+ В разделе **Обзор** дважды щелкните элемент **Индексаторы**. Найдите созданный индексатор и удалите его.

Кроме того, этот пример данных и созданные службы можно использовать повторно, чтобы узнать, как выполнять эти же задания программно в следующем руководстве. 

> [!div class="nextstepaction"]
> [Руководство. REST API когнитивного поиска](cognitive-search-tutorial-blob.md)
