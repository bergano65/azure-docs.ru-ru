---
title: Обновление до пакета SDK управления .NET для службы поиска Azure
titleSuffix: Azure Cognitive Search
description: Обновите пакет SDK для службы поиска Azure для .NET из предыдущих версий. Узнайте о новых возможностях и изменениях кода, необходимых для миграции.
manager: nitinme
author: brjohnstmsft
ms.author: brjohnst
ms.service: cognitive-search
ms.devlang: dotnet
ms.topic: conceptual
ms.date: 07/08/2020
ms.openlocfilehash: 5f6a198445f9c9bd8e02cd8b6df3405431263e0b
ms.sourcegitcommit: 3d79f737ff34708b48dd2ae45100e2516af9ed78
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "87076412"
---
# <a name="upgrading-versions-of-the-azure-search-net-management-sdk"></a>Обновление версий пакета SDK для службы поиска Azure для .NET

В этой статье объясняется, как перейти к последовательным версиям пакета SDK для управления .NET для службы поиска Azure, который используется для предоставления или отмены наполнения служб поиска, настройки емкости и управления ключами API.

Пакеты SDK для управления предназначены для определенной версии REST API управления. Дополнительные сведения об основных понятиях и операциях см. в разделе [Управление поиском (остальные)](https://docs.microsoft.com/rest/api/searchmanagement/).

## <a name="versions"></a>Версии

| Версия пакета SDK | Соответствующая версия REST API | Добавление компонентов или изменение поведения |
|-------------|--------------------------------|-------------------------------------|
| [3.0](https://www.nuget.org/packages/Microsoft.Azure.Management.Search/3.0.0) | API-Version = 2020-30-20 | Добавляет безопасность конечных точек (брандмауэры IP и интеграция с помощью [частной ссылки Azure](../private-link/private-endpoint-overview.md)) |
| [2.0](https://www.nuget.org/packages/Microsoft.Azure.Management.Search/2.0.0) | API-Version = 2019-10-01 | Повышение удобства использования. Критическое изменение [ключей запроса списка](https://docs.microsoft.com/rest/api/searchmanagement/querykeys/listbysearchservice) (Get больше не поддерживается). |
| [1.0](https://www.nuget.org/packages/Microsoft.Azure.Management.Search/1.0.1) | API-Version = 2015-08-19  | Первая версия |

## <a name="how-to-upgrade"></a>Обновление

1. Обновите ссылку NuGet для `Microsoft.Azure.Management.Search` использования консоли диспетчера пакетов NuGet или щелкнув правой кнопкой мыши ссылку на проект и выбрав пункт "Управление пакетами NuGet...". в Visual Studio.

1. После того как NuGet загрузит новые пакеты и их зависимости, перестройте проект. В зависимости от структуры кода он может успешно перестроиться, в этом случае все готово.

1. Если выполнить сборку не удается, причина может быть в том, что вы реализовали некоторые интерфейсы SDK (например, для модульного тестирования), которые были изменены. Чтобы устранить эту проблему, необходимо реализовать более новые методы, такие как `BeginCreateOrUpdateWithHttpMessagesAsync` .

1. После исправления ошибок сборки можно внести изменения в приложение, чтобы воспользоваться преимуществами новых функциональных возможностей. 

## <a name="upgrade-to-30"></a>Обновление до 3,0

Версия 3,0 добавляет закрытую защиту конечных точек, ограничиваюя доступ к диапазонам IP-адресов, а также при необходимости интегрируя с помощью частной ссылки Azure для служб поиска, которые не должны быть видны в общедоступном Интернете.

### <a name="new-apis"></a>Новые интерфейсы API

| API | Категория| Подробности |
|-----|--------|------------------|
| [нетворкрулесет](https://docs.microsoft.com/rest/api/searchmanagement/services/createorupdate#networkruleset) | Брандмауэр IP-адресов | Ограничьте доступ к конечной точке службы списком разрешенных IP-адресов. Основные понятия и инструкции на портале см. в разделе [Настройка брандмауэра IP](service-configure-firewall.md) . |
| [Общий ресурс частной ссылки](https://docs.microsoft.com/rest/api/searchmanagement/sharedprivatelinkresources) | Приватный канал | Создайте общий ресурс частной ссылки, который будет использоваться службой поиска.  |
| [Подключения к частным конечным точкам](https://docs.microsoft.com/rest/api/searchmanagement/privateendpointconnections) | Приватный канал | Установка и управление подключениями к службе поиска через закрытую конечную точку. Основные понятия и инструкции на портале см. [в разделе Создание частной конечной точки](service-create-private-endpoint.md) .|
| [Ресурсы частной ссылки](https://docs.microsoft.com/rest/api/searchmanagement/privatelinkresources/) | Приватный канал | Для службы поиска, имеющей подключение к частной конечной точке, получите список всех служб, используемых в той же виртуальной сети. Если решение поиска содержит индексаторы, которые извлекаются из источников данных Azure (служба хранилища Azure, Cosmos DB, Azure SQL) или используют Cognitive Services или Key Vault, то все эти ресурсы должны иметь конечные точки в виртуальной сети, и этот API должен возвращать список. |
| [публикнетворкакцесс](https://docs.microsoft.com/rest/api/searchmanagement/services/createorupdate#publicnetworkaccess)| Приватный канал | Это свойство при создании или обновлении запросов на обслуживание. Если этот параметр отключен, то частная связь является единственной модальностью доступа. |

### <a name="breaking-changes"></a>Критические изменения

Вы больше не можете использовать запрос [ключей запроса](https://docs.microsoft.com/rest/api/searchmanagement/querykeys/listbysearchservice) на получение списка. В предыдущих выпусках можно было использовать GET или POST, в этом выпуске и во всех выпусках поддерживается только POST. 

## <a name="upgrade-to-20"></a>Обновление до 2,0

Версия 2 пакета SDK для службы поиска Azure для .NET является незначительным обновлением, поэтому изменение кода должно потребовать минимальных усилий. Изменения в пакете SDK являются исключительно клиентскими изменениями, чтобы повысить удобство использования пакета SDK. К этим изменениям относятся следующие:

* `Services.CreateOrUpdate` и его асинхронные версии теперь автоматически опрашивают подготавливаемую службу `SearchService` и не возвращают ответ, пока не завершена подготовка службы. Это избавляет от необходимости создавать такой код опроса самостоятельно.

* Если вы все равно хотите опросить процесс подготовки службы вручную, то можете использовать новый метод `Services.BeginCreateOrUpdate` или одну из его асинхронных версий.

* Новые методы `Services.Update` и их асинхронные версии были добавлены в пакет SDK. Эти методы используют HTTP PATCH для поддержки добавочного обновления службы. Например, теперь можно масштабировать службу путем передачи в эти методы экземпляра `SearchService`, который содержит только нужные свойства `partitionCount` и `replicaCount`. Старый способ вызова `Services.Get` путем изменения возвращенного `SearchService` и его передачи в `Services.CreateOrUpdate` по-прежнему поддерживается, но больше не является необходимым. 

## <a name="next-steps"></a>Дальнейшие действия

При возникновении проблем лучшим решением для отправки вопросов является [Stack overflow](https://stackoverflow.com/questions/tagged/azure-cognitive-search?tab=Newest). При обнаружении ошибки можно зарегистрировать проблему в [репозитории GitHub пакета SDK .NET для Azure](https://github.com/Azure/azure-sdk-for-net/issues). Обязательно пометка названия проблемы на "[Поиск]".
