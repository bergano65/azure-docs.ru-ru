---
title: Отправка и получение сообщений AS2 для B2B Azure Logic Apps
description: Обмен сообщениями AS2 для сценариев интеграции B2B Enterprise с помощью Azure Logic Apps
services: logic-apps
ms.service: logic-apps
ms.suite: integration
author: divyaswarnkar
ms.author: divswa
ms.reviewer: jonfan, estfan, LADocs
ms.topic: article
ms.date: 08/22/2019
ms.openlocfilehash: 1f063c0e8dada8eb6c4eee031764f6ca7dd3a91d
ms.sourcegitcommit: d37991ce965b3ee3c4c7f685871f8bae5b56adfa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2019
ms.locfileid: "72680389"
---
# <a name="exchange-as2-messages-for-b2b-enterprise-integration-in-azure-logic-apps-with-enterprise-integration-pack"></a>Обмен сообщениями AS2 для интеграции с предприятием B2B в Azure Logic Apps с помощью Пакета интеграции Enterprise

Для работы с сообщениями AS2 в Azure Logic Apps можно использовать соединитель AS2, который предоставляет триггеры и действия для управления связью AS2. Например, чтобы установить безопасность и надежность при передаче сообщений, можно использовать следующие действия:

* [Действие **кодирования AS2** ](#encode) для предоставления шифрования, цифровой подписи и подтверждений с помощью уведомлений о расположении сообщений (MDN), которые помогают поддерживать неподдельность. Например, это действие применяет заголовки AS2/HTTP и выполняет эти задачи при настройке.

  * Подписывает исходящие сообщения.
  * Шифрует исходящие сообщения.
  * Сжимает сообщение.
  * Передает имя файла в заголовке MIME.

* [Действие **декодирования AS2** ](#decode) для предоставления расшифровки, цифровой подписи и подтверждений с помощью уведомлений о расположении сообщений (MDN). Например, это действие выполняет следующие задачи:

  * Обрабатывает заголовки AS2/HTTP.
  * Согласовывает полученные MDN с исходными исходящими сообщениями.
  * Обновляет и сопоставляет записи в базе данных, не поддерживающей отрицание.
  * Записывает записи для отчетов о состоянии AS2.
  * Выводит содержимое полезных данных в кодировке Base64.
  * Определяет, требуются ли MDN. На основе соглашения AS2 определяет, должна ли MDN быть синхронной или асинхронной.
  * Создает синхронные или асинхронные MDN на основе соглашения AS2.
  * Задает токены корреляции и свойства для MDN.

  Это действие также выполняет следующие задачи при настройке.

  * Проверяет подпись.
  * Расшифровывает сообщения.
  * Распаковывает сообщение.
  * Проверьте и запретите дублирование ИДЕНТИФИКАТОРов сообщений.

В этой статье показано, как добавить действия кодирования AS2 и декодирования в существующее приложение логики.

> [!IMPORTANT]
> Исходный соединитель AS2 будет признан устаревшим, поэтому убедитесь, что вместо него используется соединитель **AS2 (версии 2)** . Эта версия предоставляет те же возможности, что и исходная версия, является встроенной в среду выполнения Logic Apps и обеспечивает значительное повышение производительности с точки зрения пропускной способности и размера сообщения. Кроме того, соединитель Native v2 не требует создания подключения к учетной записи интеграции. Вместо этого, как описано в разделе Предварительные требования, обязательно свяжите учетную запись интеграции с приложением логики, в котором вы планируете использовать соединитель.

## <a name="prerequisites"></a>Технические условия

* Подписка Azure. Если у вас еще нет подписки Azure, [зарегистрируйтесь для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/).

* Приложение логики, из которого вы хотите использовать соединитель AS2, и триггер, который запускает рабочий процесс приложения логики. Соединитель AS2 предоставляет только действия, а не триггеры. Если вы не работали с приложениями логики, см. руководства по [Azure Logic Apps](../logic-apps/logic-apps-overview.md) и [созданию первого приложения логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

* [Учетная запись интеграции](../logic-apps/logic-apps-enterprise-integration-create-integration-account.md) , связанная с подпиской Azure и связанная с приложением логики, где планируется использовать соединитель AS2. Приложение логики и учетная запись интеграции должны находиться в одном расположении или регионе Azure.

* По крайней мере два [торговых партнера](../logic-apps/logic-apps-enterprise-integration-partners.md) , которые уже определены в учетной записи интеграции с помощью квалификатора удостоверения AS2.

* Прежде чем можно будет использовать соединитель AS2, необходимо создать [соглашение](../logic-apps/logic-apps-enterprise-integration-agreements.md) AS2 между торговыми партнерами и сохранить это соглашение в учетной записи интеграции.

* Если для управления сертификатами используется [Azure Key Vault](../key-vault/key-vault-overview.md) , убедитесь, что ключи хранилища разрешает операции **шифрования** и **расшифровки** . В противном случае действия кодирования и декодирования завершаются ошибкой.

  В портал Azure перейдите в хранилище ключей, просмотрите **Разрешенные операции**ключа хранилища и убедитесь, что выбраны операции **шифрования** и **расшифровки** .

  ![Проверка операций с ключами хранилища](media/logic-apps-enterprise-integration-as2/vault-key-permitted-operations.png)

<a name="encode"></a>

## <a name="encode-as2-messages"></a>Кодирование сообщений AS2

1. Если вы еще этого не сделали, в [портал Azure](https://portal.azure.com)откройте приложение логики в конструкторе приложений логики.

1. В конструкторе добавьте новое действие в приложение логики.

1. В разделе **Выберите действие** под полем поиска выберите **Все**. В поле поиска введите "кодирование AS2" и убедитесь, что выбрано действие AS2 (v2): **Encoded AS2** .

   ![Выберите "кодирование AS2"](./media/logic-apps-enterprise-integration-as2/select-as2-encode.png)

1. Теперь предоставьте сведения для этих свойств:

   | Свойство | Описание |
   |----------|-------------|
   | **Сообщение для кодирования** | Полезные данные сообщения |
   | **AS2 из** | Идентификатор отправителя сообщения, указанный в соглашении AS2 |
   | **AS2 в** | Идентификатор получателя сообщений, указанный в соглашении AS2 |
   |||

   Пример.

   ![Свойства кодирования сообщений](./media/logic-apps-enterprise-integration-as2/as2-message-encoding-details.png)

<a name="decode"></a>

## <a name="decode-as2-messages"></a>Декодирование сообщений AS2

1. Если вы еще этого не сделали, в [портал Azure](https://portal.azure.com)откройте приложение логики в конструкторе приложений логики.

1. В конструкторе добавьте новое действие в приложение логики.

1. В разделе **Выберите действие** под полем поиска выберите **Все**. В поле поиска введите "декодирование AS2" и убедитесь, что выбрано действие AS2 (v2): **декодирование AS2** .

   ![Выберите "декодирование AS2"](media/logic-apps-enterprise-integration-as2/select-as2-decode.png)

1. **Чтобы сообщение было закодировано** и свойства **заголовка сообщения** , выберите эти значения из предыдущего триггера или выходных данных действия.

   Например, предположим, что приложение логики получает сообщения через триггер запроса. Вы можете выбрать выходные данные из этого триггера.

   ![Выберите текст и заголовки из выходных данных запроса](media/logic-apps-enterprise-integration-as2/as2-message-decoding-details.png)

## <a name="sample"></a>Пример

Чтобы попробовать развернуть полностью рабочее приложение логики и пример сценария AS2, см. [шаблон и сценарий приложения логики AS2](https://azure.microsoft.com/documentation/templates/201-logic-app-as2-send-receive/).

## <a name="connector-reference"></a>Справочник по соединителям

Для получения технических сведений, таких как триггеры, действия и ограничения, как описано в файле OpenAPI (ранее Swagger) соединителя, см. [страницу справочника по соединителю](/connectors/as2/).

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о [пакет интеграции Enterprise](logic-apps-enterprise-integration-overview.md)
