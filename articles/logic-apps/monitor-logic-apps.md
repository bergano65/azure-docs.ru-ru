---
title: Мониторинг состояния, Просмотр журнала и Настройка оповещений
description: Устранение неполадок приложений логики путем проверки состояния выполнения, просмотра журнала триггеров и включения оповещений в Azure Logic Apps
services: logic-apps
ms.suite: integration
ms.reviewer: divswa, logicappspm
ms.topic: article
ms.date: 05/04/2020
ms.openlocfilehash: 356353da639ab97a1a4e5483abf56050f5a236f8
ms.sourcegitcommit: 4cb89d880be26a2a4531fedcc59317471fe729cd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/27/2020
ms.locfileid: "92676056"
---
# <a name="monitor-run-status-review-trigger-history-and-set-up-alerts-for-azure-logic-apps"></a>Мониторинг состояния выполнения, Просмотр журнала триггеров и Настройка оповещений для Azure Logic Apps

После [создания и запуска приложения логики](../logic-apps/quickstart-create-first-logic-app-workflow.md)можно проверить состояние выполнения приложения логики, [историю выполнения](#review-runs-history), [Журнал триггеров](#review-trigger-history)и производительность. Для получения уведомлений о сбоях или других возможных проблемах настройте [оповещения](#add-azure-alerts). Например, можно создать оповещение, которое обнаруживает "более пяти запусков в течение часа, которые завершились сбоем".

Для наблюдения за событиями в реальном времени и расширенной отладки настройте ведение журнала диагностики для приложения логики с помощью [журналов Azure Monitor](../azure-monitor/overview.md). Эта служба Azure помогает отслеживать облачные и локальные среды, чтобы можно было легко поддерживать доступность и производительность. Затем можно находить и просматривать события, такие как события триггера, события запуска и события действий. Хранение этих сведений в [журналах Azure Monitor](../azure-monitor/platform/data-platform-logs.md)позволяет создавать [запросы журналов](../azure-monitor/log-query/log-query-overview.md) , помогающие находить и анализировать эти сведения. Эти диагностические данные также можно использовать с другими службами Azure, такими как служба хранилища Azure и концентраторы событий Azure. Дополнительные сведения см. в статье [мониторинг приложений логики с помощью Azure Monitor](../logic-apps/monitor-logic-apps-log-analytics.md).

> [!NOTE]
> Если приложения логики работают в [среде службы интеграции (ISE)](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md) , которая была создана для использования [внутренней конечной точки доступа](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md#endpoint-access), вы можете просматривать входные и выходные данные из журнала выполнения приложения логики *только из виртуальной сети* , а также получать доступ к ним. Убедитесь в наличии сетевого подключения между частными конечными точками и компьютером, с которого необходимо получить доступ к журналу запусков. Например, клиентский компьютер может находиться в виртуальной сети ISE или в виртуальной сети, подключенной к виртуальной сети ISE, например через пиринг или виртуальную частную сеть. Дополнительные сведения см. в разделе [Доступ к конечной точке среды службы интеграции](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md#endpoint-access). 

<a name="review-runs-history"></a>

## <a name="review-runs-history"></a>Просмотр журнала запусков

Каждый раз, когда триггер срабатывает для элемента или события, обработчик Logic Apps создает и запускает отдельный экземпляр рабочего процесса для каждого элемента или события. По умолчанию каждый экземпляр рабочего процесса выполняется параллельно, поэтому рабочий процесс не должен ожидать перед запуском. Вы можете проверить, что произошло во время этого запуска, включая состояние каждого шага в рабочем процессе, а также входные и выходные данные для каждого шага.

1. На [портале Azure](https://portal.azure.com) найдите приложение логики и откройте его в конструкторе приложений логики.

   Чтобы найти приложение логики, в главном поле поиска Azure введите `logic apps` , а затем выберите **Logic Apps** .

   ![Поиск и выбор службы "Logic Apps"](./media/monitor-logic-apps/find-your-logic-app.png)

   В портал Azure показаны все приложения логики, связанные с подписками Azure. Этот список можно отфильтровать по имени, подписке, группе ресурсов, расположению и т. д.

   ![Просмотр приложений логики, связанных с подписками](./media/monitor-logic-apps/logic-apps-list-in-subscription.png)

1. Выберите приложение логики и щелкните **Обзор** .

   На панели "Обзор" в разделе " **журнал запусков** " отображаются все предыдущие, текущие и все ожидающие выполнения приложения логики. Если в списке отображается много запусков и вы не можете найти нужную запись, попробуйте отфильтровать список.

   > [!TIP]
   > Если состояние выполнения не отображается, обновите страницу обзора, выбрав **Обновить** . Запуск не выполняется для триггера, который пропущен из-за условий неудовлетворенных или не удается найти данные.

   ![Обзор, журнал запусков и другие сведения о приложении логики](./media/monitor-logic-apps/overview-pane-logic-app-details-run-history.png)

   Возможные состояния выполнения:

   | Состояние выполнения | Описание |
   |------------|-------------|
   | **Прерывание** | Выполнение остановлено или не завершено из-за внешних проблем, например сбоя системы или подписки Azure. |
   | **Клонения** | Запуск был активирован и запущен, но получен запрос на отмену. |
   | **Сбой** | Не удалось выполнить по крайней мере одно действие в ходе выполнения. Последующие действия в рабочем процессе не были настроены для обработки сбоя. |
   | **Выполнение** | Запуск был запущен и выполняется, но это состояние также может отображаться для запуска, который регулируется из-за [ограничений действия](logic-apps-limits-and-config.md) или [текущего тарифного плана](https://azure.microsoft.com/pricing/details/logic-apps/). <p><p>**Совет** . Если вы настроили [ведение журнала диагностики](monitor-logic-apps-log-analytics.md), можно получить сведения о любых происходящих событиях регулирования. |
   | **Успешно** | Запуск выполнен. Если какое-либо действие завершилось сбоем, последующее действие в рабочем процессе обработало этот сбой. |
   | **Истекло время ожидания** | Время выполнения истекло, так как текущая длительность превысила ограничение продолжительности выполнения, которое управляется [параметром **срок хранения журнала выполнения в днях**](logic-apps-limits-and-config.md#run-duration-retention-limits). Длительность выполнения вычисляется с использованием времени начала и длительности выполнения в это время начала. <p><p>**Примечание** . Если длительность выполнения также превышает текущий *Размер журнала выполнения* , который также управляется [параметром **срок хранения журнала выполнения в днях**](logic-apps-limits-and-config.md#run-duration-retention-limits), запуск удаляется из журнала запусков заданием ежедневной очистки. Независимо от того, завершилось ли время ожидания выполнения или завершено, срок хранения всегда вычисляется с использованием времени начала выполнения и *текущего* предела удержания. Таким образом, при уменьшении предельной продолжительности выполняемого запуска время ожидания истекает. Однако выполнение либо остается, либо удаляется из журнала запусков в зависимости от того, превышает ли длительность выполнения предел удержания. |
   | **Ожидание** | Выполнение не началось или приостановлено, например, из-за более раннего экземпляра рабочего процесса, который еще работает. |
   |||

1. Чтобы проверить шаги и другие сведения для конкретного запуска, в разделе **журнал запусков** выберите этот запуск.

   ![Выберите конкретный запуск для проверки](./media/monitor-logic-apps/select-specific-logic-app-run.png)

   На панели **Запуск приложения логики** отображается каждый шаг в выбранном запуске, состояние выполнения каждого шага и время, затраченное на выполнение каждого шага, например:

   ![Каждое действие в определенном запуске](./media/monitor-logic-apps/logic-app-run-pane.png)

   Чтобы просмотреть эти сведения в виде списка, на панели инструментов **Запуск приложения логики** выберите **сведения о выполнении** .

   ![На панели инструментов выберите "сведения о запуске".](./media/monitor-logic-apps/select-run-details-on-toolbar.png)

   В представлении сведения о выполнении отображаются все шаги, их состояние и другие сведения.

   ![Ознакомьтесь с подробными сведениями о каждом шаге выполнения.](./media/monitor-logic-apps/review-logic-app-run-details.png)

   Например, можно получить свойство **идентификатора корреляции** запуска, которое может потребоваться при использовании [REST API для Logic Apps](/rest/api/logic).

1. Чтобы получить дополнительные сведения о конкретном шаге, выберите любой из вариантов:

   * В области **Запуск приложения логики** выберите шаг, чтобы расширить фигуру. Теперь вы можете просматривать такие сведения, как входные данные, выходные данные и любые ошибки, произошедшие на этом шаге, например:

     ![На панели выполнения приложения логики просмотрите шаг "сбой"](./media/monitor-logic-apps/specific-step-inputs-outputs-errors.png)

   * В области **сведения о выполнении приложения логики** выберите нужный шаг.

     ![На панели сведений о запуске просмотрите шаг "сбой"](./media/monitor-logic-apps/select-failed-step-in-failed-run.png)

     Теперь можно просмотреть такие сведения, как входные и выходные данные для этого шага, например:

   > [!NOTE]
   > Все сведения о времени выполнения и события шифруются в службе Logic Apps. Они расшифровываются только в том случае, когда пользователь запрашивает просмотр этих данных. Вы можете [Скрыть входные и выходные данные в журнале выполнения](../logic-apps/logic-apps-securing-a-logic-app.md#obfuscate) или управлять доступом пользователей к этим сведениям с помощью [управления доступом на основе ролей Azure (Azure RBAC)](../role-based-access-control/overview.md).

<a name="review-trigger-history"></a>

## <a name="review-trigger-history"></a>Просмотр журнала триггера

Каждое выполнение приложения логики начинается с триггера. В журнале триггеров перечислены все попытки запуска приложения логики и сведения о входных и выходных данных для каждой попытки триггера.

1. На [портале Azure](https://portal.azure.com) найдите приложение логики и откройте его в конструкторе приложений логики.

   Чтобы найти приложение логики, в главном поле поиска Azure введите `logic apps` , а затем выберите **Logic Apps** .

   ![Поиск и выбор службы "Logic Apps"](./media/monitor-logic-apps/find-your-logic-app.png)

   В портал Azure показаны все приложения логики, связанные с подписками Azure. Этот список можно отфильтровать по имени, подписке, группе ресурсов, расположению и т. д.

   ![Просмотр приложений логики, связанных с подписками](./media/monitor-logic-apps/logic-apps-list-in-subscription.png)

1. Выберите приложение логики и щелкните **Обзор** .

1. В меню приложения логики выберите **Обзор** . В разделе " **Сводка** " в разделе " **Оценка** " выберите **Просмотреть журнал триггеров** .

   ![Просмотр журнала триггеров для приложения логики](./media/monitor-logic-apps/overview-pane-logic-app-details-trigger-history.png)

   На панели Журнал триггеров отображаются все попытки активации, выполняемые приложением логики. Каждый раз, когда триггер срабатывает для элемента или события, обработчик Logic Apps создает отдельный экземпляр приложения логики, который запускает рабочий процесс. По умолчанию все экземпляры выполняются параллельно, чтобы ни один рабочий процесс не ожидал запуска. Поэтому, если приложение логики активирует несколько элементов одновременно, для каждого элемента отображается запись триггера с одинаковыми датой и временем.

   ![Несколько попыток активировать различные элементы](./media/monitor-logic-apps/logic-app-trigger-history.png)

   Возможные состояния попыток запуска:

   | Состояние триггера | Описание |
   |----------------|-------------|
   | **Сбой** | Произошла ошибка. Чтобы просмотреть созданные сообщения об ошибках для триггера, завершившегося сбоем, выберите соответствующую попытку активации и щелкните **Выходные данные** . Например, вы можете обнаружить недопустимые входные данные. |
   | **Пропущено** | Триггер проверил конечную точку, но не нашел данных, удовлетворяющих указанным критериям. |
   | **Успешно** | Триггер проверил конечную точку и нашел доступные данные. Как правило, рядом с этим состоянием также отображается состояние « **срабатывает** ». Если это не так, возможно, определение триггера содержит какое-либо условие или команду `SplitOn`, которая не была выполнена. <p><p>Это состояние может применяться к запускаемому вручную триггеру, а также повторяющему или опрашивающему триггеру. Триггер может быть успешно запущен, но сам запуск по-прежнему может завершиться ошибкой, если действия порождают необработанные ошибки. |
   |||

   > [!TIP]
   > Триггер можно проверить, не дожидаясь следующего повторения. На панели инструментов обзора выберите **запустить триггер** и выберите триггер, который вызывает проверку. Или щелкните **Запустить** на панели инструментов конструктора приложений логики.

1. Чтобы просмотреть сведения об определенной попытке активации, на панели триггера выберите событие триггера. Если в списке отображается много попыток запуска триггера и вы не можете найти нужную запись, попробуйте отфильтровать список. Если вы не нашли ожидаемые данные, попробуйте щелкнуть **Обновить** на панели инструментов.

   ![Просмотр конкретной попытки триггера](./media/monitor-logic-apps/select-trigger-event-for-review.png)

   Теперь можно просматривать сведения о выбранном событии триггера, например:

   ![Просмотр сведений о конкретном триггере](./media/monitor-logic-apps/view-specific-trigger-details.png)

<a name="add-azure-alerts"></a>

## <a name="set-up-monitoring-alerts"></a>Настройка оповещений мониторинга

Чтобы получать оповещения на основе конкретных метрик или превышения пороговых значений для приложения логики, настройте [оповещения в Azure Monitor](../azure-monitor/platform/alerts-overview.md). Узнайте подробнее о [метриках в Azure](../azure-monitor/platform/data-platform.md). Чтобы настроить оповещения без использования [Azure Monitor](../azure-monitor/log-query/log-query-overview.md), выполните следующие действия.

1. В меню приложения логики в разделе **мониторинг** выберите **оповещения**  >  **новое правило генерации оповещений** .

   ![Добавление оповещения для приложения логики](./media/monitor-logic-apps/add-new-alert-rule.png)

1. На панели **создать правило** в разделе **ресурс** выберите приложение логики, если оно еще не выбрано. В разделе **условие** выберите **Добавить** , чтобы можно было определить условие, которое запускает оповещение.

   ![Добавление условия для правила](./media/monitor-logic-apps/add-condition-for-rule.png)

1. На панели **Настройка логики сигнала** найдите и выберите сигнал, для которого требуется получить оповещение. Можно использовать поле поиска или отсортировать сигналы в алфавитном порядке, выбрав заголовок столбца **имя сигнала** .

   Например, если вы хотите отправить оповещение при сбое триггера, выполните следующие действия.

   1. В столбце **имя сигнала** найдите и выберите сигнал **сбой триггеров** .

      ![Выберите сигнал для создания оповещения](./media/monitor-logic-apps/find-and-select-signal.png)

   1. В области сведений, которая открывается для выбранного сигнала в разделе **логика оповещения** , настройте условие, например:

   1. В качестве **оператора** выберите **больше или равно** .

   1. В качестве **типа агрегирования** выберите **Count** .

   1. В качестве **порогового значения** введите `1` .

   1. В разделе **Предварительный просмотр условия** убедитесь, что условие отображается правильно.

   1. В разделе **оценено на основе** настройте интервал и частоту выполнения правила оповещения. Для **гранулярности статистической обработки (period)** выберите период для группирования данных. В поле **частота вычисления** выберите частоту проверки условия.

   1. Когда будете готовы, нажмите кнопку **Готово** .

   Вот завершенное условие:

   ![Настройка условия для оповещения](./media/monitor-logic-apps/set-up-condition-for-alert.png)

   На странице **Создание правила** теперь отображается созданное вами условие и затраты на выполнение этого оповещения.

   ![Новое оповещение на странице "Создание правила"](./media/monitor-logic-apps/finished-alert-condition-cost.png)

1. Укажите имя, необязательное описание и степень серьезности оповещения. Либо оставьте параметр **включить правило после** включения параметра Создание, либо отключите его, пока вы не будете готовы к включению правила.

1. Когда все будет готово, выберите **создать правило генерации оповещений** .

> [!TIP]
> Чтобы запустить приложение логики из оповещения, в рабочий процесс можно включить [триггер запроса](../connectors/connectors-native-reqres.md), что позволяет выполнять такие задачи, как указано ниже:
> 
> * [Публикация в Slack](https://github.com/Azure/azure-quickstart-templates/tree/master/201-alert-to-slack-with-logic-app)
> * [Отправка текста](https://github.com/Azure/azure-quickstart-templates/tree/master/201-alert-to-text-message-with-logic-app)
> * [Добавление сообщения в очередь](https://github.com/Azure/azure-quickstart-templates/tree/master/201-alert-to-queue-with-logic-app)

## <a name="next-steps"></a>Дальнейшие действия

* [Мониторинг приложений логики с помощью Azure Monitor](../logic-apps/monitor-logic-apps-log-analytics.md)
