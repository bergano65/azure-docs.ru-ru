---
title: Общие сценарии развертывания для доменных служб Azure AD | Документация Майкрософт
description: Узнайте о некоторых распространенных сценариях и вариантах использования Azure Active Directory доменных служб для предоставления ценности и удовлетворения бизнес-потребностей.
services: active-directory-ds
author: iainfoulds
manager: daveba
ms.assetid: c5216ec9-4c4f-4b7e-830b-9d70cf176b20
ms.service: active-directory
ms.subservice: domain-services
ms.workload: identity
ms.topic: conceptual
ms.date: 08/14/2020
ms.author: iainfou
ms.openlocfilehash: a27d97e7e030da216b2296f11b6876ccf28c8ad0
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "88722761"
---
# <a name="common-use-cases-and-scenarios-for-azure-active-directory-domain-services"></a>Распространенные варианты использования и сценарии для Azure Active Directory доменных служб

Доменные службы Azure Active Directory (Azure AD DS) предоставляют управляемые доменные службы, отвечающие за присоединение к домену, применение групповой политики, использование протокола LDAP (упрощенный протокол доступа к каталогам), выполнение аутентификации Kerberos или NTLM. Azure AD DS интегрируются с существующим клиентом Azure AD, что позволяет пользователям входить в систему с использованием существующих учетных данных. Эти доменные службы используются без необходимости развертывания, управления и обновления контроллеров домена в облаке, что обеспечивает более гладкий перенос локальных ресурсов в Azure.

В этой статье описаны некоторые распространенные бизнес-сценарии, в которых AD DS Azure предоставляет ценность и соответствует этим потребностям.

## <a name="common-ways-to-provide-identity-solutions-in-the-cloud"></a>Распространенные способы предоставления облачных решений для идентификации

При переносе существующих рабочих нагрузок в облако вы можете настроить LDAP для приложений, которые поддерживают доступ к каталогу, чтобы они выполняли чтение и запись в локальный каталог AD DS. Приложения, выполняемые в среде Windows Server, обычно развертываются на виртуальных машинах, присоединенных к домену. Это позволяет безопасно управлять ими с помощью групповой политики. Для аутентификации пользователей приложения могут также использовать функцию встроенной проверки подлинности Windows (например, Kerberos или NTLM).

Чтобы предоставить службу идентификации для приложений, работающих в Azure, ИТ-администраторы часто применяют одно из следующих решений:

* Настройка VPN-подключения типа "сеть — сеть" между рабочей нагрузкой в Azure и локальной средой AD DS.
    * Затем локальные контроллеры домена обеспечивают проверку подлинности через VPN-подключение.
* Создание реплик контроллеров домена с помощью виртуальных машин Azure для расширения домена или леса AD DS из локальной среды.
    * Контроллеры домена, работающие на виртуальных машинах Azure, обеспечивают проверку подлинности и реплицируют данные каталога из локальной среды AD DS.
* развертывание автономной среды AD DS в Azure на основе контроллеров домена, работающих на виртуальных машинах Azure.
    * Контроллеры домена, работающие на виртуальных машинах Azure, обеспечивают проверку подлинности, но данные каталога не реплицируются из локальной среды AD DS.

В таких сценариях зависимость от VPN-подключений к локальному каталогу повышает уязвимость приложений к временным сбоям или отключениям сети. Если вы развернете контроллеры домена на виртуальных машинах в Azure, ИТ-специалистам придется управлять ими, а затем защищать, устанавливать исправления, отслеживать, архивировать и устранять неполадки.

Azure AD DS предлагает альтернативные решения, устраняющие необходимость создавать VPN-подключения к локальной среде AD DS или запускать и администрировать виртуальные машины Azure для предоставления служб идентификации. Управляемая служба Azure AD DS снижает сложность интегрированного решения идентификации как в гибридных, так и в полностью облачных средах.

> [!div class="nextstepaction"]
> [Сравнение Azure AD DS с Azure AD и самостоятельно управляемым AD DS на виртуальных машинах Azure или в локальной среде][compare]

## <a name="azure-ad-ds-for-hybrid-organizations"></a>Azure AD DS для гибридных организаций

Многие организации используют гибридную инфраструктуру, в которую входят облачные и локальные рабочие нагрузки приложений. Устаревшие приложения, которые постепенно переносятся в Azure, могут использовать традиционные подключения LDAP для предоставления сведений об идентификации. Сведения об удостоверениях можно синхронизировать из локальной среды доменных служб Active Directory в клиент Azure AD, чтобы поддерживать гибридную инфраструктуру. После этого Azure AD DS будет предоставлять перенесенным в Azure старым приложениям источник данных об идентификации без дополнительной настройки подключений к локальным службам каталогов и управления ими.

Рассмотрим пример гибридной организации Litware Corporation, которая использует одновременно локальные ресурсы и облако Azure.

![Доменные службы Azure Active Directory для гибридной организации с синхронизацией локальных данных](./media/overview/synced-tenant.png)

* Приложения и серверные рабочие нагрузки, для которых требуются службы доменов, развертываются в виртуальной сети Azure.
    * Сюда относятся и старые приложения, перенесенные в Azure согласно стратегии lift-and-shift.
* Чтобы синхронизировать сведения об удостоверениях из локального каталога в клиент Azure AD, корпорация Litware развернула [Azure AD Connect][azure-ad-connect].
    * Среди прочего синхронизируются учетные записи пользователей и сведения о членстве в группах.
* ИТ-группа Litware включает Azure AD DS для клиента Azure AD в той же виртуальной сети или в другой, подключенной к ней через пиринг.
* Приложения и виртуальные машины, развернутые в виртуальной сети Azure, могут использовать такие функции, как присоединение к домену, чтение LDAP, привязка LDAP, проверка подлинности NTLM и Kerberos, а также использование групповой политики.

> [!IMPORTANT]
> Azure AD Connect следует устанавливать и настраивать только для синхронизации с локальными средами AD DS. Установка Azure AD Connect в управляемом домене для синхронизации объектов обратно в Azure AD не поддерживается.

## <a name="azure-ad-ds-for-cloud-only-organizations"></a>Azure AD DS для полностью облачных организаций

В облачном клиенте Azure AD не используется локальный источник удостоверений. Например, учетные записи пользователей и членства в группах создаются и управляются прямо в Azure AD.

Давайте рассмотрим пример облачной организации Contoso, которая использует для идентификации службу Azure AD. Все удостоверения пользователей, а также их учетные данные и сведения о членстве в группах создаются и управляются в Azure AD. В этом сценарии не требуется дополнительных действий, чтобы синхронизировать сведения об удостоверениях из локального каталога.

![Доменные службы Azure Active Directory для полностью облачной организации без синхронизации локальных данных](./media/overview/cloud-only-tenant.png)

* Приложения и серверные рабочие нагрузки, для которых требуются службы доменов, развертываются в виртуальной сети Azure.
* ИТ-группа Contoso включает Azure AD DS для клиента Azure AD в той же виртуальной сети или в другой, подключенной к ней через пиринг.
* Приложения и виртуальные машины, развернутые в виртуальной сети Azure, могут использовать такие функции, как присоединение к домену, чтение LDAP, привязка LDAP, проверка подлинности NTLM и Kerberos, а также использование групповой политики.

## <a name="secure-administration-of-azure-virtual-machines"></a>Безопасное Администрирование виртуальных машин Azure

Чтобы использовать один набор учетных данных AD, виртуальные машины Azure можно присоединить к управляемому домену Azure AD DS. Такой подход сокращает количество проблем с управлением учетными данными, например поддержание локальных учетных записей администраторов на каждой виртуальной машине или отдельных учетных записей и паролей между средами.

Виртуальные машины, присоединенные к управляемому домену, также можно администрировать и защищать с помощью групповой политики. Необходимые базовые показатели безопасности можно применить к виртуальным машинам, чтобы заблокировать их в соответствии с правилами безопасности Организации. Например, можно использовать возможности управления групповой политикой для ограничения типов приложений, которые могут быть запущены на виртуальной машине.

![Упрощенное администрирование виртуальных машин Azure](./media/active-directory-domain-services-scenarios/streamlined-vm-administration.png)

Рассмотрим типичный пример сценария. По мере того, как серверы и другие инфраструктуры прийдут к концу жизни, компания Contoso хочет перенести приложения, размещенные локально в облаке. Их текущий ИТ-стандарт требует, чтобы серверы, на которых размещены корпоративные приложения, были присоединены к домену и управлялись с помощью групповой политики.

ИТ – администратор компании Contoso предпочитает присоединить к домену виртуальные машины, развернутые в Azure, чтобы упростить администрирование, так как пользователи могут выполнять вход с использованием корпоративных учетных данных. При присоединении к домену виртуальные машины также могут быть настроены на соответствие необходимым базовым показателям безопасности с помощью объектов групповой политики (GPO). Contoso предпочитает не развертывать и отслеживать собственные контроллеры домена в Azure, а также управлять ими.

AD DS Azure отлично подходит для этого варианта использования. Управляемый домен позволяет присоединять к домену виртуальные машины, использовать единый набор учетных данных и применять групповую политику. А так как это управляемый домен, вам не нужно настраивать и обслуживать контроллеры домена самостоятельно.

### <a name="deployment-notes"></a>Примечания по развертыванию

Следующие рекомендации по развертыванию относятся к этому примеру использования:

* По умолчанию управляемые домены используют одну плоскую структуру подразделений (OU). Все виртуальные машины, присоединенные к домену, находятся в одном подразделении. При необходимости можно создать [пользовательские подразделения][custom-ou].
* AD DS Azure использует встроенный объект групповой политики для контейнеров пользователей и компьютеров. Для дополнительного контроля можно [создать пользовательские объекты групповой политики][create-gpo] и выбрать их для пользовательских подразделений.
* Azure AD DS поддерживает схему объектов базового компьютера AD. Невозможно расширить схему объекта Computer.

## <a name="lift-and-shift-on-premises-applications-that-use-ldap-bind-authentication"></a>Локальные приложения с нулификацией и сдвигом, использующие проверку подлинности LDAP BIND

В качестве примера сценария компания Contoso имеет локальное приложение, которое было приобретено в несколько лет назад от независимых поставщиков программных продуктов. Приложение в настоящее время находится в режиме обслуживания независимо от поставщика программного обеспечения, и запрос изменений в приложении является недорогим. Это приложение имеет веб-интерфейс, который собирает учетные данные пользователя с помощью веб-формы, а затем проверяет подлинность пользователей, выполняя привязку LDAP к локальной среде AD DS.

![Привязка LDAP](./media/active-directory-domain-services-scenarios/ldap-bind.png)

Contoso хочет перенести это приложение в Azure. Приложение должно продолжать работать "как есть", и никаких изменений не требуется. Кроме того, пользователи должны иметь возможность проходить проверку подлинности с помощью существующих корпоративных учетных данных и без дополнительного обучения. Он должен быть прозрачным для конечных пользователей, где работает приложение.

В этом сценарии Azure AD DS позволяет приложениям выполнять привязку LDAP в процессе проверки подлинности. Устаревшие локальные приложения могут преноситься в Azure и без каких-либо изменений в конфигурации или в пользовательском интерфейсе.

### <a name="deployment-notes"></a>Примечания по развертыванию

Следующие рекомендации по развертыванию относятся к этому примеру использования:

* Убедитесь, что приложению не нужно изменять или записывать в каталог. Доступ на запись LDAP к управляемому домену не поддерживается.
* Нельзя изменять пароли непосредственно в управляемом домене. Конечные пользователи могут изменить свой пароль либо с помощью [механизма самостоятельного изменения пароля Azure AD][sspr] , либо в локальном каталоге. Затем эти изменения автоматически синхронизируются и становятся доступными в управляемом домене.

## <a name="lift-and-shift-on-premises-applications-that-use-ldap-read-to-access-the-directory"></a>Локальные приложения с нулификацией и сдвигом, использующие LDAP Read для доступа к каталогу

Как и в предыдущем примере сценария, предположим, что у компании Contoso есть локальное бизнес-приложение, которое было разработано почти в десять лет назад. Это приложение учитывает каталог и предназначено для использования протокола LDAP для чтения сведений и атрибутов пользователей из AD DS. Приложение не изменяет атрибуты или не выполняет запись в каталог.

Компания Contoso хочет перенести это приложение в Azure и снять с учета срок давности локальное оборудование, в котором размещено это приложение. Приложение не может быть переписано для использования современных API каталогов, таких как API-интерфейсы Microsoft Graph на основе RESTFUL. Чтобы приложение можно было перенести в облако, не изменяя код или переписывая приложение, необходимо выбрать параметр точности и сдвига.

Чтобы помочь в этом сценарии, Azure AD DS позволяет приложениям выполнять операции чтения LDAP для управляемого домена, чтобы получить необходимые сведения об атрибутах. Приложение не нуждается в переписывания, поэтому в Azure вы можете продолжать использовать приложение, не зная, где он выполняется.

### <a name="deployment-notes"></a>Примечания по развертыванию

Следующие рекомендации по развертыванию относятся к этому примеру использования:

* Убедитесь, что приложению не нужно изменять или записывать в каталог. Доступ на запись LDAP к управляемому домену не поддерживается.
* Убедитесь, что приложению не требуется пользовательская или расширенная схема Active Directory. Расширения схемы не поддерживаются в AD DS Azure.

## <a name="migrate-an-on-premises-service-or-daemon-application-to-azure"></a>Перенос локальной службы или управляющего приложения в Azure

Некоторые приложения включают несколько уровней, где один из уровней должен выполнять проверку подлинности вызовов к серверной категории, например к базе данных. В этих сценариях обычно используются учетные записи служб Active Directory. При перетаскивании приложений в Azure Azure AD DS позволяет продолжать использовать учетные записи служб таким же образом. Вы можете использовать ту же учетную запись службы, которая синхронизируется из локального каталога с Azure AD, или создать настраиваемое подразделение, а затем создать отдельную учетную запись службы в этом подразделении. При любом подходе приложения продолжают работать таким же образом, чтобы выполнять проверку подлинности вызовов к другим уровням и службам.

![Учетная запись службы с WIA](./media/active-directory-domain-services-scenarios/wia-service-account.png)

В этом примере сценария компания Contoso имеет пользовательское приложение хранилища программного обеспечения, которое включает в себя веб-интерфейс, сервер SQL Server и внутренний сервер FTP. Встроенная проверка подлинности Windows, использующая учетные записи служб, выполняет проверку подлинности клиентского веб-сервера. Веб-интерфейс настраивается для запуска в качестве учетной записи службы. Внутренний сервер настраивается для авторизации доступа к учетной записи службы для веб-интерфейса. Contoso не хочет развертывать собственные виртуальные машины контроллера домена в облаке и управлять ими, чтобы переместить это приложение в Azure.

В этом сценарии серверы, на которых размещается веб-интерфейс, SQL Server и сервер FTP, можно перенести на виртуальные машины Azure и присоединить к управляемому домену. Затем виртуальные машины могут использовать одну и ту же учетную запись службы в локальном каталоге для проверки подлинности приложения, которая синхронизируется с помощью Azure AD, используя Azure AD Connect.

### <a name="deployment-notes"></a>Примечания по развертыванию

Следующие рекомендации по развертыванию относятся к этому примеру использования:

* Убедитесь, что приложения используют имя пользователя и пароль для проверки подлинности. Azure AD DS не поддерживает проверку подлинности на основе сертификата или смарт-карты.
* Нельзя изменять пароли непосредственно в управляемом домене. Конечные пользователи могут изменить свой пароль либо с помощью [механизма самостоятельного изменения пароля Azure AD][sspr] , либо в локальном каталоге. Затем эти изменения автоматически синхронизируются и становятся доступными в управляемом домене.

## <a name="windows-server-remote-desktop-services-deployments-in-azure"></a>Развертывания служб удаленных рабочих столов Windows Server в Azure

Вы можете использовать AD DS Azure, чтобы предоставить управляемые доменные службы серверам удаленных рабочих столов, развернутым в Azure.

Дополнительные сведения об этом сценарии развертывания см. [в статье Интеграция доменных служб Azure AD с развертыванием RDS][windows-rds].

## <a name="domain-joined-hdinsight-clusters"></a>Присоединенные к домену кластеры HDInsight

Вы можете настроить кластер Azure HDInsight, присоединенный к управляемому домену, с включенным Apache Ranger. Вы можете создавать и применять политики Hive с помощью Apache Ranger и разрешать пользователям, таким как специалисты по обработке и анализу данных, подключаться к Hive с помощью таких средств на основе ODBC, как Excel или Tableau. Мы продолжаем работать над добавлением других рабочих нагрузок, таких как HBase, Spark и прочее, к присоединенному к домену HDInsight.

Дополнительные сведения об этом сценарии развертывания см. [в статье Настройка присоединенных к домену кластеров HDInsight][hdinsight] .

## <a name="next-steps"></a>Дальнейшие действия

Чтобы приступить к работе, [Создайте и настройте управляемый домен доменных служб Azure Active Directory][tutorial-create-instance].

<!-- INTERNAL LINKS -->
[hdinsight]: ../hdinsight/domain-joined/apache-domain-joined-configure-using-azure-adds.md
[tutorial-create-instance]: tutorial-create-instance.md
[custom-ou]: create-ou.md
[create-gpo]: manage-group-policy.md
[sspr]: ../active-directory/authentication/overview-authentication.md#self-service-password-reset
[compare]: compare-identity-solutions.md
[azure-ad-connect]: ../active-directory/hybrid/whatis-azure-ad-connect.md

<!-- EXTERNAL LINKS -->
[windows-rds]: /windows-server/remote/remote-desktop-services/rds-azure-adds